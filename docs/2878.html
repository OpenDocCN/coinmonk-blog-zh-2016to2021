<html>
<head>
<title>Creating a Hyperledger Fabric network from scratch( v 1.4)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始创建Hyperledger结构网络(1.4版)</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/creating-a-hyperledger-fabric-network-from-scratch-v-1-4-695906dbb7c6?source=collection_archive---------0-----------------------#2020-03-29">https://medium.com/coinmonks/creating-a-hyperledger-fabric-network-from-scratch-v-1-4-695906dbb7c6?source=collection_archive---------0-----------------------#2020-03-29</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="5d05" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">由于互联网上关于hyperledger fabric网络设置的教程并不多，而且几乎所有的教程都解释了第一个网络或将其作为参考，因此在本教程中，<strong class="is hu">我将向大家展示如何从头开始创建hyperledger fabric网络！</strong> <em class="jo">只有了解hyperledger fabric的架构，才能按照本教程学习。</em></p><blockquote class="jp jq jr"><p id="bde2" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hm dt translated">注意:这是我的第一篇文章，所以欢迎任何建议或更正。</p></blockquote></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="d46e" class="kc kd ht bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">先决条件:-</h1><ol class=""><li id="aadc" class="la lb ht is b it lc ix ld jb le jf lf jj lg jn lh li lj lk dt translated">hyperledger fabric架构的基础知识</li><li id="bfb0" class="la lb ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk dt translated">docker-compose知识</li><li id="4762" class="la lb ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk dt translated">码头工人。按照中的<a class="ae lq" href="https://docs.docker.com/install/" rel="noopener ugc nofollow" target="_blank">进行安装。</a></li><li id="3fee" class="la lb ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk dt translated">docker-撰写。按照中的<a class="ae lq" href="https://docs.docker.com/compose/install/" rel="noopener ugc nofollow" target="_blank">进行安装。</a></li><li id="f780" class="la lb ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk dt translated">OpenSSL。它预装在大多数Linux发行版上，Windows用户遵循<a class="ae lq" href="https://tecadmin.net/install-openssl-on-windows/" rel="noopener ugc nofollow" target="_blank">这个</a></li><li id="db0f" class="la lb ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk dt translated">Hyperledger结构二进制文件:-</li></ol><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="2333" class="ma kd ht lw b fv mb mc l md me">$ curl -L -o bin.tar.gz  "<a class="ae lq" href="https://www.dropbox.com/s/1o8xwur74z176ci/bin.tar.gz?dl=1" rel="noopener ugc nofollow" target="_blank">https://www.dropbox.com/s/1o8xwur74z176ci/bin.tar.gz?dl=1</a>"</span><span id="76ac" class="ma kd ht lw b fv mf mc l md me">$ tar -xvf bin.tar.gz<br/>$ sudo mv bin/configtxgen /usr/local/bin<br/>$ sudo mv bin/fabric-ca-client /usr/local/bin<br/>$ sudo rm -rf bin/</span></pre><h1 id="9934" class="kc kd ht bd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz dt translated">网络概述</h1><p id="cf46" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">我将尽可能保持简单，因为主要目的是教你基础知识，从零开始创建一个网络，然后可以扩展到创建更复杂的网络。</p><p id="a8f8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">该网络将包括:-</p><ol class=""><li id="7cbf" class="la lb ht is b it iu ix iy jb mo jf mp jj mq jn lh li lj lk dt translated">1个ca服务器，用于所有MSP生成证书。</li><li id="e37a" class="la lb ht is b it ll ix lm jb ln jf lo jj lp jn lh li lj lk dt translated">1台tls ca服务器，用于生成所有节点和客户端用于tls通信的证书。</li></ol><p id="a292" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">3.同一个组织名称“org0”下的3个木筏订购者。</p><p id="3739" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">4.“org1”的1个对等体。</p><p id="908d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">5.1个cli节点为<em class="jo"> org1创建通道。</em></p><blockquote class="jp jq jr"><p id="af28" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hm dt translated">注意:我们可以使用同一个ca服务器来生成两种证书，但这不是一个好的做法</p></blockquote><h1 id="73a1" class="kc kd ht bd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz dt translated">什么是MSP？</h1><p id="8c5c" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated"><strong class="is hu">根据总账结构文档:- </strong></p><blockquote class="jp jq jr"><p id="9ce2" class="iq ir jo is b it iu iv iw ix iy iz ja js jc jd je jt jg jh ji ju jk jl jm jn hm dt translated">成员资格服务提供商(MSP)是一个Hyperledger Fabric组件，提供成员资格操作的抽象。<br/>具体而言，MSP抽象出发布证书、验证证书和用户认证背后的所有加密机制和协议。MSP可以定义自己的身份概念，以及管理(身份验证)和认证(签名生成和验证)这些身份的规则。</p></blockquote><p id="4f1a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我会用更基本的方式来解释。假设一个结构网络正在运行，并且您想要加入一个新的对等网络。网络如何知道对等体是否可以加入它？<br/> Ans。它知道这一点，因为我们在网络设置期间在genesis块中传递了该信息(当然，我们可以在运行时更改它)。在<a class="ae lq" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/build_network.html" rel="noopener ugc nofollow" target="_blank"> byfn </a>教程中，configtx.yaml包含组织部分:-</p><p id="f434" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们在这里定义Org1 MSP以及其他组织，基本上，主要的东西是<strong class="is hu"> MSPDir，</strong>这个目录包含:- <em class="jo"> admincerts </em>，<em class="jo"> cacerts </em>，<em class="jo"> tlscacerts。</em>因此，如果一个对等体想要加入<em class="jo"> Org1MSP </em>内部的网络，它的证书的根证书应该在这个<em class="jo"> MSPDir </em>的<em class="jo"> cacerts </em>文件夹中，它的TLS证书应该由<em class="jo">TLS certs中的证书签名。</em></p><figure class="lr ls lt lu fq ms fe ff paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="fe ff mr"><img src="../Images/1ab8da14e3a3cd88e50d2549422e7144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zP_y-zJIWRS9L-rcc7gu5A.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Org1 section inside configtx.yaml</figcaption></figure><h1 id="129b" class="kc kd ht bd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz dt translated">步骤1(创建项目文件夹)</h1><p id="c5e3" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">创建一个名为tutorial的文件夹，并将其作为您的工作目录。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="7542" class="ma kd ht lw b fv mb mc l md me">$ mkdir tutorial<br/>$ cd tutorial</span></pre><h1 id="6f9c" class="kc kd ht bd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz dt translated">步骤2(设置结构CA服务器)</h1><p id="c81b" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">CA (certificate authority)是管理证书生命周期的权威机构，它是颁发证书和撤销证书的CA。</p><p id="0768" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将使用结构CA生成所有订购者和同行的证书，它仅由hyperledger结构提供，我们将推出2个结构CA服务器，一个用于CA，一个用于TLSCA。<br/>我们将使用docker启动服务器，CA服务器将在端口7054上运行，TLSCA将在端口8054上运行。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="1380" class="ma kd ht lw b fv mb mc l md me">$ nano docker-compose-ca.yaml</span></pre><p id="d2db" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将以下文本复制到该文件中。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="03fa" class="ma kd ht lw b fv mb mc l md me">version: '2'<br/>networks:<br/>  fabric:<br/>services:<br/>  ca.vaibhav.com:<br/>    image: hyperledger/fabric-ca:1.4<br/>    hostname: ca.vaibhav.com<br/>    environment:<br/>      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server<br/>      - FABRIC_CA_SERVER_CA_NAME=rootca<br/>      - FABRIC_CA_SERVER_TLS_ENABLED=false<br/>      - FABRIC_CA_SERVER_TLS_CERTFILE=/etc/hyperledger/fabric-ca-server-config/server.crt<br/>      - FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/server.key<br/>      - FABRIC_CA_SERVER_PORT=7054<br/>    ports:<br/>      - "7054:7054"<br/>    command: sh -c 'fabric-ca-server start --ca.certfile /etc/hyperledger/fabric-ca-server-config/server.crt --ca.keyfile /etc/hyperledger/fabric-ca-server-config/server.key -b admin:adminpw -d'<br/>    volumes:<br/>      - ./ca:/etc/hyperledger/fabric-ca-server-config<br/>    networks:<br/>      fabric:<br/>        aliases:<br/>          - ca.vaibhav.com<br/>  tlsca.vaibhav.com:<br/>    image: hyperledger/fabric-ca:1.4<br/>    hostname: tlsca.vaibhav.com<br/>    environment:<br/>      - FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server<br/>      - FABRIC_CA_SERVER_CA_NAME=roottlsca<br/>      - FABRIC_CA_SERVER_TLS_ENABLED=false<br/>      - FABRIC_CA_SERVER_TLS_CERTFILE=/etc/hyperledger/fabric-ca-server-config/server.crt<br/>      - FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/server.key<br/>      - FABRIC_CA_SERVER_PORT=8054<br/>    ports:<br/>      - "8054:8054"<br/>    command: sh -c 'fabric-ca-server start --ca.certfile /etc/hyperledger/fabric-ca-server-config/server.crt --ca.keyfile /etc/hyperledger/fabric-ca-server-config/server.key -b admin:adminpw -d'<br/>    volumes:<br/>      - ./tlsca:/etc/hyperledger/fabric-ca-server-config<br/>    networks:<br/>      fabric:<br/>        aliases:<br/>          - tlsca.vaibhav.com</span></pre><p id="5e8d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用docker-compose启动服务器。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="ff0b" class="ma kd ht lw b fv mb mc l md me">$ docker-compose -f docker-compose-ca.yaml up -d</span></pre><p id="c7c1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">此后，两个ca服务器的容器都将启动并运行。<br/>使用以下命令检查它们是否正在运行，并且仅当您看到两个容器都已启动并运行时才继续</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="5542" class="ma kd ht lw b fv mb mc l md me">$ docker ps</span></pre><h1 id="1fb5" class="kc kd ht bd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz dt translated">步骤3(为订购方和对等方生成证书)</h1><p id="69ef" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">现在，我们将使用生成的ca为订购者和对等方生成MSP和TLS证书。</p><p id="f35b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">根据结构<a class="ae lq" href="https://hyperledger-fabric.readthedocs.io/en/latest/msp.html#msp-setup-on-the-peer-orderer-side" rel="noopener ugc nofollow" target="_blank">文档</a>，以下是订购方和对等方的msp结构</p><figure class="lr ls lt lu fq ms fe ff paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="fe ff nd"><img src="../Images/eda166b56695f8c9ad423a8fb0dfe96a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9THBFPYqTyZVaAcThRCYQ.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">msp folder structure for orderers and peers</figcaption></figure><p id="dcd0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">四个必选文件夹分别是:- </strong> <br/> 1。<em class="jo"> admincerts </em> :-我们需要手动创建这个文件夹并将管理员的CA证书放入其中，我们将生成管理员证书并放入其中。<br/> 2。<em class="jo"> cacerts </em> :-由fabric CA在生成证书时自动创建。<br/> 3。<em class="jo"> signcerts </em> :-由fabric CA在生成证书时自动创建。<br/> 4。<em class="jo">密钥库</em> :-由fabric CA在生成证书时自动创建。</p><p id="4ab5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">首先，我们将创建<em class="jo"> org0 </em>和<em class="jo"> org1 </em> MSP结构。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="7f5d" class="ma kd ht lw b fv mb mc l md me">$ mkdir -p {orderers/org0/{msp/{cacerts,tlscacerts,admincerts},orderer1,orderer2,orderer3},peers/org1/{msp/{cacerts,tlscacerts,admincerts},peer1},rootca-admin,roottlsca-admin}</span></pre><p id="0374" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们现在将生成CA服务器的管理证书，该证书将用于在CA服务器上注册对等方和订购方，在注册之后，可以为它们生成证书。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="a631" class="ma kd ht lw b fv mb mc l md me">$ export FABRIC_CA_HOME=./rootca-admin<br/>$ fabric-ca-client enroll -u <a class="ae lq" href="http://admin:adminpw@localhost:7054" rel="noopener ugc nofollow" target="_blank">http://admin:adminpw@localhost:7054</a></span></pre><p id="7fe0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">生成MSP证书</strong></p><p id="d414" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将在每个组织中生成订购者和同行证书以及1个管理员证书。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="de51" class="ma kd ht lw b fv mb mc l md me">$ fabric-ca-client register --id.name orderer1.org0.com --id.secret secret --id.type orderer -u <a class="ae lq" href="http://localhost:7054C" rel="noopener ugc nofollow" target="_blank">http://localhost:7054</a></span><span id="ae3d" class="ma kd ht lw b fv mf mc l md me">$ fabric-ca-client register --id.name orderer2.org0.com --id.secret secret --id.type orderer -u <a class="ae lq" href="http://localhost:7054C" rel="noopener ugc nofollow" target="_blank">http://localhost:7054</a></span><span id="79d3" class="ma kd ht lw b fv mf mc l md me">$ fabric-ca-client register --id.name orderer3.org0.com --id.secret secret --id.type orderer -u <a class="ae lq" href="http://localhost:7054C" rel="noopener ugc nofollow" target="_blank">http://localhost:7054</a></span><span id="9fd9" class="ma kd ht lw b fv mf mc l md me">$ fabric-ca-client register --id.name peer1.org1.com --id.secret secret --id.type peer -u <a class="ae lq" href="http://localhost:7054" rel="noopener ugc nofollow" target="_blank">http://localhost:7054</a></span><span id="eeef" class="ma kd ht lw b fv mf mc l md me">$ fabric-ca-client register --id.name admin.org0.com --id.secret secret --id.type admin -u <a class="ae lq" href="http://localhost:7054" rel="noopener ugc nofollow" target="_blank">http://localhost:7054</a></span><span id="1dba" class="ma kd ht lw b fv mf mc l md me">$ fabric-ca-client register --id.name admin.org1.com --id.secret secret --id.type admin -u <a class="ae lq" href="http://localhost:7054" rel="noopener ugc nofollow" target="_blank">http://localhost:7054</a></span><span id="eded" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./orderers/org0/orderer1/<br/>$ fabric-ca-client enroll --csr.hosts "orderer1.org0.com" -u <a class="ae lq" href="http://admin:adminpw@localhost:7054" rel="noopener ugc nofollow" target="_blank">http://orderer1.org0.com:secret@localhost:7054</a></span><span id="deed" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./orderers/org0/orderer2/<br/>$ fabric-ca-client enroll --csr.hosts "orderer2.org0.com" -u <a class="ae lq" href="http://admin:adminpw@localhost:7054" rel="noopener ugc nofollow" target="_blank">http://orderer2.org0.com:secret@localhost:7054</a></span><span id="9760" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./orderers/org0/orderer3/<br/>$ fabric-ca-client enroll --csr.hosts "orderer3.org0.com" -u <a class="ae lq" href="http://admin:adminpw@localhost:7054" rel="noopener ugc nofollow" target="_blank">http://orderer3.org0.com:secret@localhost:7054</a></span><span id="cf77" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./peers/org1/peer1/<br/>$ fabric-ca-client enroll --csr.hosts "peer1.org1.com" -u <a class="ae lq" href="http://peer1.org1.com:secret@localhost:7054" rel="noopener ugc nofollow" target="_blank">http://peer1.org1.com:secret@localhost:7054</a></span><span id="5437" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./orderers/org0/orderer1/msp/user/<br/>$ fabric-ca-client enroll --csr.hosts "admin.org0.com" -u <a class="ae lq" href="http://admin.org0.com:secret@localhost:7054" rel="noopener ugc nofollow" target="_blank">http://admin.org0.com:secret@localhost:7054</a> -M admin</span><span id="32ef" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./peers/org1/peer1/msp/user/<br/>$ fabric-ca-client enroll --csr.hosts "admin.org1.com" -u <a class="ae lq" href="http://admin.org0.com:secret@localhost:7054" rel="noopener ugc nofollow" target="_blank">http://admin.org1.com:secret@localhost:7054</a> -M admin</span></pre><p id="b176" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">生成TLS证书</strong></p><p id="b829" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这将与生成MSP证书相同，但我们将使用TLS-CA服务器而不是CA服务器，我们不会生成管理员的TLS证书，因为我们不会使用mutual-tls将客户端连接到网络。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="06b5" class="ma kd ht lw b fv mb mc l md me">$ export FABRIC_CA_HOME=./roottlsca-admin<br/>$ fabric-ca-client enroll -u <a class="ae lq" href="http://admin:adminpw@localhost:7054" rel="noopener ugc nofollow" target="_blank">http://admin:adminpw@localhost:</a>8054</span><span id="e897" class="ma kd ht lw b fv mf mc l md me">$ fabric-ca-client register --id.name orderer1.org0.com --id.secret secret --id.type orderer -u <a class="ae lq" href="http://localhost:8054" rel="noopener ugc nofollow" target="_blank">http://localhost:8054</a></span><span id="2df1" class="ma kd ht lw b fv mf mc l md me">$ fabric-ca-client register --id.name orderer2.org0.com --id.secret secret --id.type orderer -u <a class="ae lq" href="http://localhost:8054" rel="noopener ugc nofollow" target="_blank">http://localhost:8054</a></span><span id="0fce" class="ma kd ht lw b fv mf mc l md me">$ fabric-ca-client register --id.name orderer3.org0.com --id.secret secret --id.type orderer -u <a class="ae lq" href="http://localhost:8054" rel="noopener ugc nofollow" target="_blank">http://localhost:8054</a></span><span id="4195" class="ma kd ht lw b fv mf mc l md me">$ fabric-ca-client register --id.name peer1.org1.com --id.secret secret --id.type peer -u <a class="ae lq" href="http://localhost:8054" rel="noopener ugc nofollow" target="_blank">http://localhost:8054</a></span><span id="855a" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./orderers/org0/orderer1/<br/>$ fabric-ca-client enroll --csr.hosts "orderer1.org0.com" -u <a class="ae lq" href="http://orderer1.org0.com:secret@localhost:8054" rel="noopener ugc nofollow" target="_blank">http://orderer1.org0.com:secret@localhost:8054</a> -M tls</span><span id="ce1b" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./orderers/org0/orderer2/<br/>$ fabric-ca-client enroll --csr.hosts "orderer2.org0.com" -u <a class="ae lq" href="http://orderer2.org0.com:secret@localhost:8054" rel="noopener ugc nofollow" target="_blank">http://orderer2.org0.com:secret@localhost:8054</a> -M tls</span><span id="75ad" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./orderers/org0/orderer3/<br/>$ fabric-ca-client enroll --csr.hosts "orderer3.org0.com" -u <a class="ae lq" href="http://orderer3.org0.com:secret@localhost:8054" rel="noopener ugc nofollow" target="_blank">http://orderer3.org0.com:secret@localhost:8054</a> -M tls</span><span id="1f72" class="ma kd ht lw b fv mf mc l md me">$ export FABRIC_CA_HOME=./peers/org1/peer1/<br/>$ fabric-ca-client enroll --csr.hosts "peer1.org1.com" -u <a class="ae lq" href="http://peer1.org1.com:secret@localhost:8054" rel="noopener ugc nofollow" target="_blank">http://peer1.org1.com:secret@localhost:8054</a> -M tls</span></pre><p id="4168" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们还将更改tls私钥的名称，因为CA会为此生成一个随机名称，并且我们需要在稍后创建<em class="jo"> docker-compose.yaml </em>时引用它的路径。所以，我们把名字改成“server.key”。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="b201" class="ma kd ht lw b fv mb mc l md me">$ mv orderers/org0/orderer1/tls/keystore/* orderers/org0/orderer1/tls/keystore/server.key</span><span id="6fdc" class="ma kd ht lw b fv mf mc l md me">$ mv orderers/org0/orderer2/tls/keystore/* orderers/org0/orderer2/tls/keystore/server.key</span><span id="2d2d" class="ma kd ht lw b fv mf mc l md me">$ mv orderers/org0/orderer3/tls/keystore/* orderers/org0/orderer3/tls/keystore/server.key</span><span id="9c80" class="ma kd ht lw b fv mf mc l md me">$ mv peers/org1/peer1/tls/keystore/* peers/org1/peer1/tls/keystore/server.key</span></pre><h1 id="d7d5" class="kc kd ht bd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz dt translated">步骤4(为org0和org1创建MSP文件夹)</h1><p id="59a5" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">我已经解释了什么是MSP以及它为什么重要。你可以在这里了解更多关于MSP <a class="ae lq" href="https://hyperledger-fabric.readthedocs.io/en/latest/msp.html#msp-setup-on-the-peer-orderer-side" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="2590" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我们的网络中，我们有两个组织“org0”和“org1”。<br/>为两个组织生成<em class="jo"> msp </em>文件夹。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="eda0" class="ma kd ht lw b fv mb mc l md me">$ cp ca/server.crt orderers/org0/msp/cacerts</span><span id="78c6" class="ma kd ht lw b fv mf mc l md me">$ cp ca/server.crt peers/org1/msp/cacerts</span><span id="03b2" class="ma kd ht lw b fv mf mc l md me">$ cp tlsca/server.crt orderers/org0/msp/tlscacerts</span><span id="6cb9" class="ma kd ht lw b fv mf mc l md me">$ cp tlsca/server.crt peers/org1/msp/tlscacerts</span><span id="16ac" class="ma kd ht lw b fv mf mc l md me">$ cp orderers/org0/orderer1/msp/user/admin/signcerts/cert.pem orderers/org0/msp/admincerts/<br/>$ cp peers/org1/peer1/msp/user/admin/signcerts/cert.pem peers/org1/msp/admincerts/</span><span id="1b64" class="ma kd ht lw b fv mf mc l md me">$ mkdir orderers/org0/orderer1/msp/admincerts orderers/org0/orderer2/msp/admincerts orderers/org0/orderer3/msp/admincerts peers/org1/peer1/msp/admincerts</span><span id="1c37" class="ma kd ht lw b fv mf mc l md me">$ cp orderers/org0/orderer1/msp/user/admin/signcerts/cert.pem orderers/org0/orderer1/msp/admincerts</span><span id="5a3a" class="ma kd ht lw b fv mf mc l md me">$ cp orderers/org0/orderer1/msp/user/admin/signcerts/cert.pem orderers/org0/orderer2/msp/admincerts</span><span id="251c" class="ma kd ht lw b fv mf mc l md me">$ cp orderers/org0/orderer1/msp/user/admin/signcerts/cert.pem orderers/org0/orderer3/msp/admincerts</span><span id="ce2c" class="ma kd ht lw b fv mf mc l md me">$ cp peers/org1/peer1/msp/user/admin/signcerts/cert.pem peers/org1/peer1/msp/admincerts</span><span id="57c6" class="ma kd ht lw b fv mf mc l md me">$ mkdir peers/org1/peer1/msp/user/admin/admincerts<br/>$ cp peers/org1/peer1/msp/user/admin/signcerts/cert.pem peers/org1/peer1/msp/user/admin/admincerts/</span></pre><h1 id="17b6" class="kc kd ht bd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz dt translated">步骤5(生成起源块和通道)</h1><p id="8b20" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">为了启动订购者，包含网络信息的起源块是重要的，它包含关于它识别的MSP的信息，作为这些MSP的一部分的组织将能够参与网络。我们将提供在上一步中刚刚创建的msp文件夹来生成genesis块。<br/>还将创建一个样本通道，只是为了加入它并检查整个网络是否正常工作。<br/>创建新文件:-</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="72ef" class="ma kd ht lw b fv mb mc l md me">$ nano configtx.yaml</span></pre><p id="ad99" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将以下内容粘贴到该文件中:-</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="18b2" class="ma kd ht lw b fv mb mc l md me">Organizations:<br/>    - &amp;org0<br/>        Name: org0<br/># ID to load the MSP definition as<br/>        ID: org0<br/># MSPDir is the filesystem path which contains the MSP configuration<br/>        MSPDir: orderers/org0/msp<br/>        Policies:<br/>            Readers:<br/>                Type: Signature<br/>                Rule: "OR('org0.member')"<br/>            Writers:<br/>                Type: Signature<br/>                Rule: "OR('org0.member')"<br/>            Admins:<br/>                Type: Signature<br/>                Rule: "OR('org0.admin')"<br/>    - &amp;org1<br/>            # DefaultOrg defines the organization which is used in the sampleconfig<br/>            # of the fabric.git development environment<br/>            Name: org1<br/>    # ID to load the MSP definition as<br/>            ID: org1<br/>            MSPDir: peers/org1/msp<br/>            Policies:<br/>                Readers:<br/>                    Type: Signature<br/>                    Rule: "OR('org1.admin', 'org1.peer', 'org1.client')"<br/>                Writers:<br/>                    Type: Signature<br/>                    Rule: "OR('org1.admin', 'org1.client')"<br/>                Admins:<br/>                    Type: Signature<br/>                    Rule: "OR('org1.admin')"<br/>Capabilities:<br/>    Channel: &amp;ChannelCapabilities<br/>        V1_4_2: true<br/># Orderer capabilities apply only to the orderers, and may be safely<br/>    # used with prior release peers.<br/>    # Set the value of the capability to true to require it.<br/>    Orderer: &amp;OrdererCapabilities<br/>        V1_4_2: true<br/># Application capabilities apply only to the peer network, and may be safely<br/>    # used with prior release orderers.<br/>    # Set the value of the capability to true to require it.<br/>    Application: &amp;ApplicationCapabilities<br/>        V1_4_2: true<br/>Application: &amp;ApplicationDefaults<br/># Organizations is the list of orgs which are defined as participants on<br/>    # the application side of the network<br/>    Organizations:<br/>    Policies:<br/>        Readers:<br/>            Type: ImplicitMeta<br/>            Rule: "ANY Readers"<br/>        Writers:<br/>            Type: ImplicitMeta<br/>            Rule: "ANY Writers"<br/>        Admins:<br/>            Type: ImplicitMeta<br/>            Rule: "MAJORITY Admins"<br/>        LifecycleEndorsement:<br/>            Type: ImplicitMeta<br/>            Rule: "MAJORITY Endorsement"<br/>        Endorsement:<br/>            Type: ImplicitMeta<br/>            Rule: "MAJORITY Endorsement"<br/>    Capabilities:<br/>        &lt;&lt;: *ApplicationCapabilities<br/>Orderer: &amp;OrdererDefaults<br/># Orderer Type: The orderer implementation to start<br/>    OrdererType: etcdraft<br/>    EtcdRaft:<br/>        Consenters:<br/>        - Host: orderer1.org0.com<br/>          Port: 7050<br/>          ClientTLSCert: orderers/org0/orderer1/tls/signcerts/cert.pem<br/>          ServerTLSCert: orderers/org0/orderer1/tls/signcerts/cert.pem<br/>        - Host: orderer2.org0.com<br/>          Port: 7050<br/>          ClientTLSCert: orderers/org0/orderer2/tls/signcerts/cert.pem<br/>          ServerTLSCert: orderers/org0/orderer2/tls/signcerts/cert.pem<br/>        - Host: orderer3.org0.com<br/>          Port: 7050<br/>          ClientTLSCert: orderers/org0/orderer3/tls/signcerts/cert.pem<br/>          ServerTLSCert: orderers/org0/orderer3/tls/signcerts/cert.pem<br/># Batch Timeout: The amount of time to wait before creating a batch<br/>    BatchTimeout: 2s<br/># Batch Size: Controls the number of messages batched into a block<br/>    BatchSize:<br/># Max Message Count: The maximum number of messages to permit in a batch<br/>        MaxMessageCount: 10<br/># Absolute Max Bytes: The absolute maximum number of bytes allowed for<br/>        # the serialized messages in a batch.<br/>        AbsoluteMaxBytes: 99 MB<br/># Preferred Max Bytes: The preferred maximum number of bytes allowed for<br/>        # the serialized messages in a batch. A message larger than the preferred<br/>        # max bytes will result in a batch larger than preferred max bytes.<br/>        PreferredMaxBytes: 512 KB<br/># Organizations is the list of orgs which are defined as participants on<br/>    # the orderer side of the network<br/>    Organizations:<br/># Policies defines the set of policies at this level of the config tree<br/>    # For Orderer policies, their canonical path is<br/>    #   /Channel/Orderer/&lt;PolicyName&gt;<br/>    Policies:<br/>        Readers:<br/>            Type: ImplicitMeta<br/>            Rule: "ANY Readers"<br/>        Writers:<br/>            Type: ImplicitMeta<br/>            Rule: "ANY Writers"<br/>        Admins:<br/>            Type: ImplicitMeta<br/>            Rule: "MAJORITY Admins"<br/>        # BlockValidation specifies what signatures must be included in the block<br/>        # from the orderer for the peer to validate it.<br/>        BlockValidation:<br/>            Type: ImplicitMeta<br/>            Rule: "ANY Writers"<br/>Channel: &amp;ChannelDefaults<br/>    # Policies defines the set of policies at this level of the config tree<br/>    # For Channel policies, their canonical path is<br/>    #   /Channel/&lt;PolicyName&gt;<br/>    Policies:<br/>        # Who may invoke the 'Deliver' API<br/>        Readers:<br/>            Type: ImplicitMeta<br/>            Rule: "ANY Readers"<br/>        # Who may invoke the 'Broadcast' API<br/>        Writers:<br/>            Type: ImplicitMeta<br/>            Rule: "ANY Writers"<br/>        # By default, who may modify elements at this config level<br/>        Admins:<br/>            Type: ImplicitMeta<br/>            Rule: "MAJORITY Admins"<br/># Capabilities describes the channel level capabilities, see the<br/>    # dedicated Capabilities section elsewhere in this file for a full<br/>    # description<br/>    Capabilities:<br/>        &lt;&lt;: *ChannelCapabilities<br/>################################################################################<br/>#<br/>#   Profile<br/>#<br/>#   - Different configuration profiles may be encoded here to be specified<br/>#   as parameters to the configtxgen tool<br/>#<br/>################################################################################<br/>Profiles:<br/>    default:<br/>        Consortium: SampleConsortium<br/>        &lt;&lt;: *ChannelDefaults<br/>        Application:<br/>            &lt;&lt;: *ApplicationDefaults<br/>            Organizations:<br/>                - *org1<br/>            Capabilities:<br/>                &lt;&lt;: *ApplicationCapabilities<br/>    genesis:<br/>        &lt;&lt;: *ChannelDefaults<br/>        Capabilities:<br/>            &lt;&lt;: *ChannelCapabilities<br/>        Orderer:<br/>            &lt;&lt;: *OrdererDefaults<br/>            OrdererType: etcdraft<br/>            Addresses:<br/>                - orderer1.org0.com:7050<br/>                - orderer2.org0.com:7050<br/>                - orderer3.org0.com:7050<br/>            Organizations:<br/>                - *org0<br/>            Capabilities:<br/>                &lt;&lt;: *OrdererCapabilities<br/>        Application:<br/>            &lt;&lt;: *ApplicationDefaults<br/>            Organizations:<br/>            - &lt;&lt;: *org0<br/>        Consortiums:<br/>            SampleConsortium:<br/>                Organizations:<br/>                - *org1</span></pre><p id="7968" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用<em class="jo"> configtxgen </em>二进制文件生成genesis块和默认通道。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="907c" class="ma kd ht lw b fv mb mc l md me">$ mkdir channel-artifacts</span><span id="f2f6" class="ma kd ht lw b fv mf mc l md me">$ configtxgen -profile genesis -outputBlock channel-artifacts/genesis.block</span><span id="6c69" class="ma kd ht lw b fv mf mc l md me">$ configtxgen -profile default -outputCreateChannelTx channel-artifacts/default.tx -channelID default</span></pre><p id="7425" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我们有了创建通道的genesis块和事务，我们可以继续打开我们的网络。</p><h1 id="6ab7" class="kc kd ht bd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz dt translated">步骤6(启动网络)</h1><p id="7acd" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">首先，我们将创建一个docker-compose.yaml文件。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="9070" class="ma kd ht lw b fv mb mc l md me">$ nano docker-compose.yaml</span></pre><p id="ff27" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将下面的内容复制粘贴到这个文件中。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="c918" class="ma kd ht lw b fv mb mc l md me">version: '2'<br/>volumes:<br/>  orderer1.org0.com:<br/>  orderer2.org0.com:<br/>  orderer3.org0.com:<br/>  peer1.org1.com:<br/>networks:<br/>  fabric:<br/>services:<br/>  orderer1.org0.com:<br/>    hostname: orderer1.org0.com<br/>    image: hyperledger/fabric-orderer:1.4.4<br/>    environment:<br/>      - FABRIC_LOGGING_SPEC=DEBUG<br/>      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0<br/>      - ORDERER_GENERAL_GENESISMETHOD=file<br/>      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block<br/>      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp<br/>      - ORDERER_GENERAL_LOCALMSPID=org0<br/>      - ORDERER_GENERAL_TLS_ENABLED=true<br/>      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/keystore/server.key<br/>      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/signcerts/cert.pem<br/>      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/cacerts/localhost-8054.pem]<br/>      - ORDERER_GENERAL_CLUSTER_CLIENTCERTIFICATE=/var/hyperledger/orderer/tls/signcerts/cert.pem<br/>      - ORDERER_GENERAL_CLUSTER_CLIENTPRIVATEKEY=/var/hyperledger/orderer/tls/keystore/server.key<br/>      - ORDERER_GENERAL_CLUSTER_ROOTCAS=[/var/hyperledger/orderer/tls/cacerts/localhost-8054.pem]<br/>    working_dir: /opt/gopath/src/github.com/hyperledger/fabric<br/>    command: orderer<br/>    volumes:<br/>        - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block<br/>        - ./orderers/org0/orderer1/msp:/var/hyperledger/orderer/msp<br/>        - ./orderers/org0/orderer1/tls/:/var/hyperledger/orderer/tls<br/>        - orderer1.org0.com:/var/hyperledger/production/orderer<br/>    networks:<br/>      fabric:<br/>        aliases:<br/>          - orderer1.org0.com<br/>  orderer2.org0.com:<br/>    hostname: orderer2.org0.com<br/>    image: hyperledger/fabric-orderer:1.4.4<br/>    environment:<br/>      - FABRIC_LOGGING_SPEC=DEBUG<br/>      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0<br/>      - ORDERER_GENERAL_GENESISMETHOD=file<br/>      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block<br/>      - ORDERER_GENERAL_LOCALMSPID=org0<br/>      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp<br/>      - ORDERER_GENERAL_TLS_ENABLED=true<br/>      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/keystore/server.key<br/>      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/signcerts/cert.pem<br/>      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/cacerts/localhost-8054.pem]<br/>      - ORDERER_GENERAL_CLUSTER_CLIENTCERTIFICATE=/var/hyperledger/orderer/tls/signcerts/cert.pem<br/>      - ORDERER_GENERAL_CLUSTER_CLIENTPRIVATEKEY=/var/hyperledger/orderer/tls/keystore/server.key<br/>      - ORDERER_GENERAL_CLUSTER_ROOTCAS=[/var/hyperledger/orderer/tls/cacerts/localhost-8054.pem]<br/>    working_dir: /opt/gopath/src/github.com/hyperledger/fabric<br/>    command: orderer<br/>    volumes:<br/>        - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block<br/>        - ./orderers/org0/orderer2/msp:/var/hyperledger/orderer/msp<br/>        - ./orderers/org0/orderer2/tls/:/var/hyperledger/orderer/tls<br/>        - orderer2.org0.com:/var/hyperledger/production/orderer<br/>    networks:<br/>      fabric:<br/>        aliases:<br/>          - orderer2.org0.com<br/>  orderer3.org0.com:<br/>    hostname: orderer3.org0.com<br/>    image: hyperledger/fabric-orderer:1.4.4<br/>    environment:<br/>      - FABRIC_LOGGING_SPEC=DEBUG<br/>      - ORDERER_GENERAL_LISTENADDRESS=0.0.0.0<br/>      - ORDERER_GENERAL_GENESISMETHOD=file<br/>      - ORDERER_GENERAL_GENESISFILE=/var/hyperledger/orderer/orderer.genesis.block<br/>      - ORDERER_GENERAL_LOCALMSPID=org0<br/>      - ORDERER_GENERAL_LOCALMSPDIR=/var/hyperledger/orderer/msp<br/>      - ORDERER_GENERAL_TLS_ENABLED=true<br/>      - ORDERER_GENERAL_TLS_PRIVATEKEY=/var/hyperledger/orderer/tls/keystore/server.key<br/>      - ORDERER_GENERAL_TLS_CERTIFICATE=/var/hyperledger/orderer/tls/signcerts/cert.pem<br/>      - ORDERER_GENERAL_TLS_ROOTCAS=[/var/hyperledger/orderer/tls/cacerts/localhost-8054.pem]<br/>      - ORDERER_GENERAL_CLUSTER_CLIENTCERTIFICATE=/var/hyperledger/orderer/tls/signcerts/cert.pem<br/>      - ORDERER_GENERAL_CLUSTER_CLIENTPRIVATEKEY=/var/hyperledger/orderer/tls/keystore/server.key<br/>      - ORDERER_GENERAL_CLUSTER_ROOTCAS=[/var/hyperledger/orderer/tls/cacerts/localhost-8054.pem]<br/>    working_dir: /opt/gopath/src/github.com/hyperledger/fabric<br/>    command: orderer<br/>    volumes:<br/>        - ./channel-artifacts/genesis.block:/var/hyperledger/orderer/orderer.genesis.block<br/>        - ./orderers/org0/orderer3/msp:/var/hyperledger/orderer/msp<br/>        - ./orderers/org0/orderer3/tls/:/var/hyperledger/orderer/tls<br/>        - orderer3.org0.com:/var/hyperledger/production/orderer<br/>    networks:<br/>      fabric:<br/>        aliases:<br/>          - orderer3.org0.com<br/>  peer1.org1.com:<br/>    container_name: peer1.org1.com<br/>    hostname: peer1.org1.com<br/>    image: hyperledger/fabric-peer:1.4.4<br/>    environment:<br/>      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock<br/>      - FABRIC_LOGGING_SPEC=DEBUG<br/>      - CORE_PEER_TLS_ENABLED=true<br/>      - CORE_PEER_GOSSIP_USELEADERELECTION=false<br/>      - CORE_PEER_GOSSIP_ORGLEADER=true<br/>      - CORE_PEER_PROFILE_ENABLED=true<br/>      - CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/signcerts/cert.pem<br/>      - CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/keystore/server.key<br/>      - CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/cacerts/localhost-8054.pem<br/>      # Allow more time for chaincode container to build on install.<br/>      - CORE_CHAINCODE_EXECUTETIMEOUT=300s<br/>      - CORE_PEER_ID=peer1.org1.com<br/>      - CORE_PEER_ADDRESS=peer1.org1.com:7051<br/>      - CORE_PEER_LISTENADDRESS=0.0.0.0:7051<br/>      - CORE_PEER_CHAINCODEADDRESS=peer1.org1.com:7052<br/>      - CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052<br/>      - CORE_PEER_GOSSIP_BOOTSTRAP=peer1.org1.com:7051<br/>      - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer1.org1.com:7051<br/>      - CORE_PEER_LOCALMSPID=org1<br/>    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer<br/>    command: peer node start<br/>    volumes:<br/>        - /var/run/:/host/var/run/<br/>        - ./peers/org1/peer1/msp:/etc/hyperledger/fabric/msp<br/>        - ./peers/org1/peer1/tls:/etc/hyperledger/fabric/tls<br/>        - peer1.org1.com:/var/hyperledger/production<br/>    networks:<br/>      fabric:<br/>        aliases:<br/>          - peer1.org1.com<br/>  <br/>  cli:<br/>    container_name: cli<br/>    image: hyperledger/fabric-tools:1.4.4<br/>    tty: true<br/>    stdin_open: true<br/>    environment:<br/>      - GOPATH=/opt/gopath<br/>      - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock<br/>      #- FABRIC_LOGGING_SPEC=DEBUG<br/>      - FABRIC_LOGGING_SPEC=INFO<br/>      - CORE_PEER_ID=cli<br/>      - CORE_PEER_ADDRESS=peer1.org1.com:7051<br/>      - CORE_PEER_LOCALMSPID=org1<br/>      - CORE_PEER_TLS_ENABLED=true<br/>#      - CORE_PEER_TLS_CERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/server.crt<br/>#      - CORE_PEER_TLS_KEY_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/server.key<br/>      - CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/org1/msp/tlscacerts/server.crt<br/>      - CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/org1/peer1/msp/user/admin<br/>    working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer<br/>    command: /bin/bash<br/>    volumes:<br/>        - /var/run/:/host/var/run/<br/>        - ./peers/org1/:/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/org1/<br/>        - ./channel-artifacts:/opt/gopath/src/github.com/hyperledger/fabric/peer/channel-artifacts<br/>    networks:<br/>      fabric:</span></pre><p id="ce42" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">调出网络</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="30a9" class="ma kd ht lw b fv mb mc l md me">$ docker-compose up -d</span></pre><p id="ee35" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">检查是否所有容器都已启动并运行</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="0aaa" class="ma kd ht lw b fv mb mc l md me">$ docker ps</span></pre><p id="7875" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你看到容器在运行，祝贺我们的网络运行成功。</p><h1 id="fd16" class="kc kd ht bd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv mk kx ky kz dt translated">步骤7(创建和加入渠道)</h1><p id="d75f" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">现在，让我们创建一个通道，并加入我们唯一的同行。首先，让我们来看看我们的cli容器</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="fee0" class="ma kd ht lw b fv mb mc l md me">$ docker exec -it cli bash</span></pre><p id="bea3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在容器内部，运行以下命令分别创建和加入对等通道。</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="e672" class="ma kd ht lw b fv mb mc l md me">$ peer channel create -f channel-artifacts/default.tx -c default -o orderer1.org0.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/org1/msp/tlscacerts/server.crt</span><span id="8565" class="ma kd ht lw b fv mf mc l md me">$ peer channel join -b default.block -o orderer1.org0.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/org1/msp/tlscacerts/server.crt</span></pre><p id="e3df" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">检查对等方是否加入了通道</p><pre class="lr ls lt lu fq lv lw lx ly aw lz dt"><span id="861b" class="ma kd ht lw b fv mb mc l md me">$ peer channel list</span></pre><p id="e90f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您应该看到一个名为<em class="jo"> default的通道。</em></p><p id="9656" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">感谢您学习本教程，您刚刚自己创建了一个简单的结构网络。:)</p><blockquote class="ne"><p id="b751" class="nf ng ht bd nh ni nj nk nl nm nn jn ek translated"><a class="ae lq" href="https://coincodecap.com?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="np nq nr ns nt ms fe ff paragraph-image"><a href="https://coincodecap.com?utm_source=coinmonks"><div class="fe ff no"><img src="../Images/160ce73bd06d46c2250251e7d5969f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*BoDnKUyK8p4hitHAJZ5Pdw.png"/></div></a></figure></div></div>    
</body>
</html>