<html>
<head>
<title>Integrating physical devices with IOTA — The IOTA payment terminal</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将物理设备与IOTA(IOTA支付终端)集成</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/integrating-physical-devices-with-iota-the-payment-terminal-3e7e56bd5a9e?source=collection_archive---------0-----------------------#2018-10-13">https://medium.com/coinmonks/integrating-physical-devices-with-iota-the-payment-terminal-3e7e56bd5a9e?source=collection_archive---------0-----------------------#2018-10-13</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="bde9" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">关于将物理设备与IOTA协议集成的初学者教程系列的第9部分。</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/d31fddcb3ef1d36dbde0bffe5e0e3c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gq9shC9PGo7R4Raqp_ryOw.jpeg"/></div></div></figure></div><div class="ab cl ju jv hb jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hm hn ho hp hq"><h1 id="b5ba" class="kb kc ht bd kd ke kf kg kh ki kj kk kl iz km ja kn jc ko jd kp jf kq jg kr ks dt translated">介绍</h1><p id="24f9" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">这是初学者教程系列的第9部分，我们将探索如何将物理设备与IOTA协议相集成。本教程是一系列教程的最后一部分，我们将尝试用基于IOTA的解决方案复制传统的基于菲亚特的借记卡支付解决方案。在本教程中，我们将使用一些低成本的现成组件构建一个简单的基于IOTA的支付终端。</p><p id="9b13" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">在你开始构建这个项目之前，你应该先看一下本系列的第<a class="ae lu" rel="noopener" href="/coinmonks/integrating-physical-devices-with-iota-the-iota-debit-card-part-1-42dc1a05f18">6</a>、<a class="ae lu" rel="noopener" href="/coinmonks/integrating-physical-devices-with-iota-the-iota-debit-card-part-2-1f073060ae1d">7</a>和<a class="ae lu" rel="noopener" href="/coinmonks/integrating-physical-devices-with-iota-the-iota-debit-card-part-3-bc0f03b8b2c9">8</a>教程，因为它们都为构建本教程中的项目提供了基础。</p></div><div class="ab cl ju jv hb jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hm hn ho hp hq"><h1 id="3db4" class="kb kc ht bd kd ke kf kg kh ki kj kk kl iz km ja kn jc ko jd kp jf kq jg kr ks dt translated">使用案例</h1><p id="e1ee" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">既然酒店老板已经建立并运行了他的IOTA借记卡支付系统，那么还有最后一个问题需要解决。这个问题与他的新IOTA借记卡解决方案如何在实际的最终用户支付场景中使用有关。到目前为止，与系统的交互一直基于连接到Raspberry PI USB端口的经典显示器和键盘。虽然这对于诸如创建和发行新的IOTA借记卡的管理任务来说是好的，但是作为终端用户支付接口来说可能不是很实用。想象一下，每当客人想为晚餐买单时，酒店餐厅的服务员都必须拖着一个大显示器和键盘。或者将一个大显示器和键盘连接到游泳池的储物柜上。这既不实际又昂贵。我们需要的是像便携式支付终端或一些简单的用户界面，可以集成到游泳池的储物柜。设计和构建一个漂亮的便携式支付终端或人机界面(HMI)超出了本教程的范围。然而，使用一些低成本的现成组件，我们应该能够构建一个原型，作为未来工业化版本的概念验证(PoC)。</p></div><div class="ab cl ju jv hb jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hm hn ho hp hq"><h1 id="3423" class="kb kc ht bd kd ke kf kg kh ki kj kk kl iz km ja kn jc ko jd kp jf kq jg kr ks dt translated">成分</h1><p id="c995" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">构建此项目所需的组件如下:</p><ol class=""><li id="dea4" class="lv lw ht kv b kw lp kz lq lc lx lg ly lk lz lo ma mb mc md dt translated">树莓派</li><li id="ee30" class="lv lw ht kv b kw me kz mf lc mg lg mh lk mi lo ma mb mc md dt translated">12键4x3矩阵-薄膜型键盘</li><li id="0f8a" class="lv lw ht kv b kw me kz mf lc mg lg mh lk mi lo ma mb mc md dt translated">带I2C的1602液晶显示器</li><li id="8779" class="lv lw ht kv b kw me kz mf lc mg lg mh lk mi lo ma mb mc md dt translated">RC522 RFID读写器模块</li><li id="380f" class="lv lw ht kv b kw me kz mf lc mg lg mh lk mi lo ma mb mc md dt translated">LED、试验板、一些电线和一个电阻</li></ol><p id="48e2" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated"><em class="mj">注意！<br/>除了键盘和1602 LCD显示屏之外的所有组件都已在之前的教程中讨论过，因此我将在本教程中跳过任何进一步的细节。</em></p><p id="b790" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated"><strong class="kv hu">12键— 4x3矩阵—薄膜式键盘</strong><br/><em class="mj">12键— 4x3矩阵—薄膜式键盘</em>是一种简单的键盘，可以用作任何需要数字输入的项目的输入设备。小键盘因其低成本和易用性在修补者中很受欢迎。你应该花几块钱就能在易趣上买到一个。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mk"><img src="../Images/2b97b5249545c77a6d6dd7fa251a1c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*8hupH9Sz4jQ7LZ-F6d7Zxw.jpeg"/></div></figure><p id="4752" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated"><em class="mj">注意！<br/>您也可以获得16 (4x4)键配置的键盘。除了获取数字输入之外，如果您需要执行其他功能，这可能会很方便。请注意，如果您选择使用16键版本，您必须对本教程中使用的键盘库进行一些调整。</em></p><p id="7679" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated"><strong class="kv hu">带I2C的1602 LCD显示器</strong><br/>1602 LCD显示器非常方便、紧凑，通常用于需要简单字符和基于数字的通信的项目。1602具有可调背光功能，使其在明亮和黑暗的环境中都能正常工作。我选择在这个项目中使用I2C版本的1602液晶显示器。1602 LCD的I2C版本在LCD背面附加了一个I2C模块(LCM1602 ),可用于串行通信。使用I2C模块，我们只需要最少数量的GIO引脚和连接来启动LCD并与PI一起运行。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff ml"><img src="../Images/8e83fcde126694369d23ede3c14c9c43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*p_I2FTtHnTIGyYRPnVCqxA.jpeg"/></div><figcaption class="mm mn fg fe ff mo mp bd b be z ek">1602 LCD (Front)</figcaption></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/8ccf945f87c7d7a579ddcbe8b6a415ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*H--G_cmEx_XEPp7czbKsiA.jpeg"/></div><figcaption class="mm mn fg fe ff mo mp bd b be z ek">1602 LCD with I2C module attached (Back)</figcaption></figure></div><div class="ab cl ju jv hb jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hm hn ho hp hq"><h1 id="1cb0" class="kb kc ht bd kd ke kf kg kh ki kj kk kl iz km ja kn jc ko jd kp jf kq jg kr ks dt translated">为项目布线</h1><p id="c1b6" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">使用以下连接图连接本项目中使用的各种组件。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff mr"><img src="../Images/215ad1d7763ca1a9d11be1a4727f7d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PGeeUnWjkq2Jlj3mHERaKw.png"/></div></div></figure></div><div class="ab cl ju jv hb jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hm hn ho hp hq"><h1 id="13c3" class="kb kc ht bd kd ke kf kg kh ki kj kk kl iz km ja kn jc ko jd kp jf kq jg kr ks dt translated">所需的软件和库</h1><p id="a8a6" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">在我们开始为这个项目编写Python代码之前，我们需要确保在我们的Raspberry PI上安装了所有需要的软件和库。有关安装Raspbian OS、Python、Pyota和RC522 RFID读写器库的更多信息，请参见之前的教程。</p><p id="f4f8" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">为了让我们的1602 LCD和键盘正常工作，我们首先需要向我们的项目添加两个新的Python库。</p><p id="3a62" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">要在您的项目中包含这些库，只需下载<a class="ae lu" href="https://gist.github.com/huggre/02045689aaeb153f2c4cf6573eb0bbcb" rel="noopener ugc nofollow" target="_blank"> I2C_LCD_driver.py </a>和<a class="ae lu" href="https://gist.github.com/huggre/1cf79a4e9848aa3cfd1f7aa8eb072be2" rel="noopener ugc nofollow" target="_blank"> keypad.py </a>文件，并将它们放在安装MFRC522-python库的同一个文件夹中。</p><p id="23bb" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">参见<a class="ae lu" href="http://www.circuitbasics.com/raspberry-pi-i2c-lcd-set-up-and-programming" rel="noopener ugc nofollow" target="_blank">此处</a>了解更多关于使用I2C_LCD_driver.py库提供的不同功能的信息。</p><p id="e725" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated"><em class="mj">注意！<br/>在我们让1602 LCD与I2C一起工作之前，我们必须确保I2C通信在树莓PI上启用。查看</em> <a class="ae lu" href="http://www.circuitbasics.com/raspberry-pi-i2c-lcd-set-up-and-programming" rel="noopener ugc nofollow" target="_blank"> <em class="mj">此处</em> </a> <em class="mj">了解更多关于在树莓PI上启用I2C的信息。</em></p><p id="2e34" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated"><em class="mj">注意！<br/>根据您使用的Raspberry PI版本，您可能需要对I2C_LCD_driver.py文件开头的I2CBUS和ADDRESS变量进行一些更改。对于旧版本的PI，您可能需要将I2CBUS变量更改为0。您可能还需要将地址变量更改为LCD使用的地址。我的I2C地址是27，所以我将把值改为0x27。</em></p></div><div class="ab cl ju jv hb jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hm hn ho hp hq"><h1 id="3726" class="kb kc ht bd kd ke kf kg kh ki kj kk kl iz km ja kn jc ko jd kp jf kq jg kr ks dt translated">Python代码</h1><p id="f0b6" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">本项目中使用的Python代码是在<a class="ae lu" rel="noopener" href="/coinmonks/integrating-physical-devices-with-iota-the-iota-debit-card-part-3-bc0f03b8b2c9">之前的教程</a>中使用的代码的变体，唯一的区别是我们将从小键盘而不是传统键盘获得用户输入。我们还将把显示器换成1602液晶显示器，用于视觉交流。</p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="ms mt l"/></div></figure><p id="63f4" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">你可以从<a class="ae lu" href="https://gist.github.com/huggre/55aa9337628706a4c8c5d6fbcd97c55a" rel="noopener ugc nofollow" target="_blank">这里</a>下载源代码</p></div><div class="ab cl ju jv hb jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hm hn ho hp hq"><h1 id="a40c" class="kb kc ht bd kd ke kf kg kh ki kj kk kl iz km ja kn jc ko jd kp jf kq jg kr ks dt translated">运行项目</h1><p id="8200" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">要运行项目，首先需要将上一节中的代码作为文本文件保存在安装MFRC522-python库的同一文件夹中。</p><p id="9261" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">注意Python程序文件使用。py扩展名，所以我们在树莓PI上把文件保存为<strong class="kv hu"><em class="mj">iota _ terminal . py</em></strong>。</p><p id="5766" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">要执行该程序，只需启动一个新的终端窗口，导航到保存<em class="mj"> iota_terminal.py </em>的文件夹，然后键入:</p><p id="2228" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated"><strong class="kv hu"> python iota_terminal.py </strong></p><p id="c066" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">您现在应该会在LCD上看到一条信息，询问您想要购买的<blinks>数量。使用键盘上的数字输入所需金额，完成后按#键。您可以使用*键进行更正。</blinks></p><p id="81ba" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">接下来，您将被要求输入当前分配给您的IOTA借记卡的PIN码。使用键盘上的数字输入4位PIN码，完成后按#键。您可以使用*键进行更正。</p><p id="6e09" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">接下来，您将被要求将您的IOTA借记卡靠近RFID读卡器。一旦卡被RFID读取器检测到，IOTA支付交易将被执行。交易过程的更新将显示在LCD上。</p><p id="9a9a" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">一旦交易被IOTA tangle确认，LED将根据支付的闪烁次数开始闪烁。</p></div><div class="ab cl ju jv hb jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hm hn ho hp hq"><h1 id="aabc" class="kb kc ht bd kd ke kf kg kh ki kj kk kl iz km ja kn jc ko jd kp jf kq jg kr ks dt translated">下一步是什么？</h1><p id="9140" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">你可以在这里找到本系列下一个教程的链接</p><h1 id="3100" class="kb kc ht bd kd ke mu kg kh ki mv kk kl iz mw ja kn jc mx jd kp jf my jg kr ks dt translated">贡献</h1><p id="280c" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">如果你想对本教程有所贡献，你可以在这里找到一个Github库</p></div><div class="ab cl ju jv hb jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hm hn ho hp hq"><h1 id="6f93" class="kb kc ht bd kd ke kf kg kh ki kj kk kl iz km ja kn jc ko jd kp jf kq jg kr ks dt translated">捐款</h1><p id="70bd" class="pw-post-body-paragraph kt ku ht kv b kw kx iu ky kz la ix lb lc ld le lf lg lh li lj lk ll lm ln lo hm dt translated">如果你喜欢这个教程，并希望我继续制作其他教程，请随时向下面显示的IOTA地址捐款。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mz"><img src="../Images/f898855aa9f02c497078a9bdbee25534.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*j2ENIzmDzXcGSgAdY4w-Jw.png"/></div></figure><p id="af6d" class="pw-post-body-paragraph kt ku ht kv b kw lp iu ky kz lq ix lb lc lr le lf lg ls li lj lk lt lm ln lo hm dt translated">nyzbhovsmdwabxsacajttwjoqrvvawlbsfqvsjswwbjjlsqknzfc 9 xcrpqsvfqzpbjcjrannpvmmezqjrqsvvgz</p><blockquote class="na"><p id="6e32" class="nb nc ht bd nd ne nf ng nh ni nj lo ek translated"><a class="ae lu" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="nl nm nn no np jn fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nk"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>