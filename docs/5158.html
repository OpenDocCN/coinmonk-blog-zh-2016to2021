<html>
<head>
<title>How to Debug Solidity contracts in Webstorm + Hardhat</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Webstorm + Hardhat中调试Solidity契约</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-debug-solidity-contracts-in-webstorm-hardhat-2ea0d3c4d582?source=collection_archive---------2-----------------------#2021-08-12">https://medium.com/coinmonks/how-to-debug-solidity-contracts-in-webstorm-hardhat-2ea0d3c4d582?source=collection_archive---------2-----------------------#2021-08-12</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/f5c6e00dbb4cf4b0e59eee0a4be7417c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3QwBXXo3ZDMPzlUL1OSp3g.png"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Debug Solidity contracts in Webstorm and Hardhat</figcaption></figure><div class=""/><p id="c6c2" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated"><em class="kd">这是我从</em> <a class="ae ke" href="https://allendefibank.medium.com/how-to-debug-solidity-contracts-with-webstorm-truffle-34cb7a10f98a" rel="noopener"> <em class="kd">用Truffle调试可靠性合同中学到的知识的延续。</em> </a> <em class="kd">如果您正在为本地开发环境使用Truffle，您可能希望从那里开始。</em></p></div><div class="ab cl kf kg hb kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hm hn ho hp hq"><p id="93e8" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">现在，Hardhat 是我进行局部可靠性开发的首选工具。虽然没有漂亮的GUI，但是CLI足以支持严肃的Solidity开发。它只是工作。你可以开发和测试的速度真的是无与伦比的(从我所看到的)。最重要的是，有许多不同用例的开源插件。</p><p id="a5ce" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">好的，如果这是你第一次戴头盔，你需要准备一些东西。抓取最新安装的NodeJS LTS版本(我用v.14.17.5测试过)，然后打开一个终端。</p><figure class="kn ko kp kq fq hv fe ff paragraph-image"><div class="fe ff km"><img src="../Images/505b8c6c7cc50ee9ead8610af74841b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*TbfsJ-TFS4OpkreM8p7ugQ.png"/></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Installing NodeJS with NVM</figcaption></figure><p id="523c" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">打开终端后，让我们调用第一个Hardhat任务来开始我们的简单项目。移动到一个新的干净目录，然后运行以下命令。</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="e1fc" class="kw kx ii ks b fv ky kz l la lb">mkdir -p ~/code/hardhat/welcome &amp;&amp; cd "$_" &amp;&amp; npx hardhat init</span></pre><p id="b82a" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">运行之后，NPM会用提供的参数下载、安装并运行Hardhat。反过来，你应该会看到一个安全帽欢迎屏幕。</p><figure class="kn ko kp kq fq hv fe ff paragraph-image"><div class="fe ff km"><img src="../Images/e2ffc9d321f29c27b0d55d2e2de602fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*G2Iu2fWzHnC9_T8CVij8Hw.png"/></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Hardhat welcome screen. All journeys start somewhere.</figcaption></figure><p id="347a" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">从这个欢迎屏幕，Hardhat开始项目调查。用下面的答案回答(按4次回车应该就够了)。回答完最后一个问题后，Hardhat将在指定的根文件路径下创建您的项目，其中包含一些示例文件，然后安装依赖项。这部分可能需要几分钟，取决于你的网速+ CPU。</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="eb18" class="kw kx ii ks b fv ky kz l la lb">✔ What do you want to do? · Create a sample project<br/>✔ Hardhat project root: · hardhat-sample<br/>✔ Do you want to add a .gitignore? (Y/n) · y<br/>✔ Do you want to install the sample project's dependencies with npm (hardhat <a class="ae ke" href="http://twitter.com/nomiclabs/hardhat-waffle" rel="noopener ugc nofollow" target="_blank">@nomiclabs/hardhat-waffle</a> ethereum-waffle chai <a class="ae ke" href="http://twitter.com/nomiclabs/hardhat-ethers" rel="noopener ugc nofollow" target="_blank">@nomiclabs/hardhat-ethers</a> ethers)? (Y/n) · y</span></pre><figure class="kn ko kp kq fq hv fe ff paragraph-image"><div class="fe ff km"><img src="../Images/c3414d00f7d6f7a92c75fb277787a056.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*9fud6WpNJggcGV5p3preiA.png"/></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Hardhat welcome project</figcaption></figure><p id="9afa" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">现在，让我们将终端指向新项目，看一看。如果一切看起来都像这样，我们可以继续。</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="bd3c" class="kw kx ii ks b fv ky kz l la lb">~/code/hardhat/welcome ⌚ 6:22:38<br/>$ ls<br/>contracts         node_modules      package.json      test<br/>hardhat.config.js package-lock.json scripts</span></pre><p id="351f" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">从这里，我们需要切换到网络风暴。在Webstorm中打开这个新项目。然后，打开<code class="eh lc ld le ks b">package.json</code>文件。让Webstorm build运行/调试配置唯一缺少的是<code class="eh lc ld le ks b">scripts</code>字段。让我们添加一个新的NPM运行脚本来执行我们的安全帽测试。你的<code class="eh lc ld le ks b">package.json</code>应该是这样的。</p><pre class="kn ko kp kq fq kr ks kt ku aw kv dt"><span id="5507" class="kw kx ii ks b fv ky kz l la lb">{<br/>  "name": "hardhat-project",<br/>  "scripts": {<br/>    "test": "hardhat test"<br/>  },<br/>  "devDependencies": {<br/>    "@nomiclabs/hardhat-ethers": "2.0.2",<br/>    "@nomiclabs/hardhat-waffle": "2.0.1",<br/>    "chai": "4.3.4",<br/>    "ethereum-waffle": "3.4.0",<br/>    "ethers": "5.4.4",<br/>    "hardhat": "2.6.0"<br/>  }<br/>}</span></pre><p id="e956" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">如果一切按计划进行，保存文件后，Webstorm应该会自动识别新的配置，并在编辑器窗格的左侧显示一个整洁的play图标。让我们点击它，然后在弹出菜单中点击<code class="eh lc ld le ks b">Debug "test"</code>。</p><figure class="kn ko kp kq fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff lf"><img src="../Images/ae19978e129b68b01ffc5cf497439be4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dM6S83AZK64g5n0wJ0zBhw.png"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Click the play icon on the scripts field in the package.json to automatically create a run configuration.</figcaption></figure><p id="99b5" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">一旦你这样做了，Webstorm就会负责启动NodeJS调试器进程，并且你可以开始在你的测试脚本中设置断点。如果你打开<code class="eh lc ld le ks b">sample-test.js</code>文件并开始设置断点来试试看。</p><figure class="kn ko kp kq fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff lg"><img src="../Images/f1bcdc2dfaf34c11f5766f0846532272.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QvLxmnh7PAtAfBHMMLl8oQ.png"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Breakpoint set within JavaScript to test Solidity contract.</figcaption></figure><p id="3f23" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">从这里开始，您可以测试大量令人惊叹的东西。这个设置可以让你在Solidity开发中走得更远。我知道这不是一个真正的坚固调试。我仍然在寻找一个插件，以帮助直接从Webstorm调试Solidity代码。Remix IDE 似乎是AFAIK唯一的选择。但是，我留待以后再说。—艾伦</p></div></div>    
</body>
</html>