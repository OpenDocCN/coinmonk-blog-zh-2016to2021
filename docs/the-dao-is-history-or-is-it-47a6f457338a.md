# 刀是历史…或者是吗？

> 原文：<https://medium.com/coinmonks/the-dao-is-history-or-is-it-47a6f457338a?source=collection_archive---------3----------------------->

![](img/b9559ff3c8fa0db87e1ecf8de24b9425.png)

没有多少人明白“道”黑客到底发生了什么。考虑到一个普通的加密持有者没有必要的技术背景来理解它，这并不奇怪。 ***而不，以太坊网络并没有进行任何反向交易，他们所做的要糟糕得多。***

为了了解这种情况，对整个系统有一个了解是很重要的。出于这个原因，我将从用门外汉的术语解释主要的区块链概念开始——细节被省略了，因为它们对于理解道的情况是不需要的。

# 区块链

区块链只是有序的交易序列。有点奇怪的是，事务不是单独添加的，而是一组事务打包在一起，放在我们称之为*的块*中。世界各地的用户提交交易以纳入区块链，一旦一个新的区块被添加到链中，他们的交易也会被添加。

因此，区块链只不过是一些非常酷的属性的交易时间表:

*   这是一个分布式网络，这意味着很难关闭或攻击它，因为没有单点故障/攻击
*   没人负责。你不必信任一个中间参与者来处理你的交易，它是由整个网络一起完成的，所以你只需要相信网络的大多数不是在做坏事

为了理解 DAO fork，您不需要理解块是如何创建的。

# 交易

到目前为止，我们知道人们可以提交包含在块中的事务，所以让我们定义什么是事务。
**交易是将价值‘X’从钱包‘A’转移到钱包‘B’。** 我们现在要问自己，谁可以提交这样的交易？如果任何人都可以提交任何交易，那么我可以提交一个从你的钱包里取钱并转移到我的钱包里的交易。这样一个世界更像一个幼儿园，而不是一个成熟的金融体系。我们需要一个围绕这一点的系统来防止生活在这样的混乱中。
**输入密码魔法** 每个钱包都配有一只特殊的笔，这只笔是该钱包独有的。交易只有在用发送者的钱包(A)的唯一笔签名时才有效，从而确认资金可以转移到接收者的钱包(B)。如果签名有效，则处理交易。 ***这是唯一让我们与这个破碎无用的世界保持距离的东西。***

# 自动化钱包，也叫智能合同

与只能由用户控制钱包的比特币(不完全正确)相比，以太坊网络能够通过计算机代码控制钱包——我们将上传的代码称为**智能合同**——它在区块链上公开，任何人都可以阅读。当代码被编写并提交给区块链时，任何人都能够与之交互，并且保证代码将完全按照合同中指定的方式执行，因为在这个世界中，代码就是法律，网络不关心人类对其执行的解释。

以太坊上写有许多契约，但有一个在以太坊历史上发挥了巨大作用——道契约。合同是由一家名为 **Slock** 的公司写的。由以前的以太坊公司创办。为了理解这个问题，代码做了什么并不重要，重要的是它只是以太坊网络上部署的许多契约中的一个。

# 刀客

6 月 17 日，有人在 reddit 上发帖称，道的合同正在被榨干。
[https://www . Reddit . com/r/ether eum/comments/4o i2ta/I _ think _ the Dao _ is _ getting _ right _ now/](https://www.reddit.com/r/ethereum/comments/4oi2ta/i_think_thedao_is_getting_drained_right_now/)

由于合同代码中的[递归调用错误，DAO 合同中约有 400 万以太网被耗尽，总计约 1 . 5 亿美元。重要的是要记住，这个错误不是以太坊网络本身的一部分，而是部署在网络上的一个写得很差的合同，所以网络本身运行正常。有人可能会说这个黑客没有做错什么——一个自称是 DAO 黑客的人在一个公开的帖子中提出了这样的观点](http://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/)

> 我已经仔细检查了 DAO 的代码，并在发现分裂以额外以太为奖励的特性后决定参与。我利用了这一特性，正当地要求得到 3，641，694 以太，并感谢道的这一奖赏。我的理解是，DAO 代码包含这个特性是为了促进去中心化和鼓励创建“子 DAO”。我对那些把故意使用这一特征描述为“偷窃”的人感到失望。根据智能合同条款，我正在利用这一明确编码的功能

以太坊是作为一个**代码即法律**网络出售的，所以没有人会想到从一份写得不好的合同中叉回资金，因为这违反了代码即法律的原则，对吗？毕竟，许多合同都被黑了，没有人想过用分叉来节省人们的钱——我们为什么还要讨论这个？

然而以太坊基金会考虑使用叉子。

![](img/0bdb3cf83c364e5b169c9ec1983fd6f6.png)

# 拯救 DAO 基金——硬分叉实施

很多人说以太坊逆转了交易，但这不是真的。如果他们没有逆转他们，他们做了什么？让我们看看 [go-ethereum(又名 Geth client](https://github.com/ethereum/go-ethereum/) )中实际的硬分叉实现。

![](img/1a405a1bf4413f311c2f95d6bc8b805e.png)

Call a function for custom state changes if the block is the DAO hard fork block — [https://github.com/ethereum/go-ethereum/blob/master/core/state_processor.go](https://github.com/ethereum/go-ethereum/blob/master/core/state_processor.go)

如果交易有效，函数进程通过应用其交易来处理块(提醒:如果交易是用*发送方的*专用笔签署的，则交易是有效的)。我们可以看到另一个条件，它检查该块是否是“dao fork”块(DAO fork 块在 chain-1920000 中有一个特定的位置)，在这种情况下，它执行名为“applydaohardfark*’*的附加函数。

![](img/cc23db9167317b9f285e946ca144cfd3.png)

A list of around 100 addresses from which we take money without their consent — [https://github.com/ethereum/go-ethereum/blob/master/params/dao.go](https://github.com/ethereum/go-ethereum/blob/master/params/dao.go)

![](img/31806041be787ce270717787c76b2e86.png)

Takes the money from predefined addresses and moves it to some other account — [https://github.com/ethereum/go-ethereum/blob/master/consensus/misc/dao.go](https://github.com/ethereum/go-ethereum/blob/master/consensus/misc/dao.go)

该代码从预定义的钱包列表中取钱，并将其转移到另一个钱包中。这一切都是通过跳过特殊的笔来实现的。通过直接改变状态，可以在没有任何签名的情况下任意转移资金，这意味着可以在没有所有者同意的情况下转移资金。****

撤销交易是一个可怕的想法，但这更糟糕，因为当你撤销交易时，你至少可以确定交易发生在过去，并且是用发送者的特殊笔签署的。这就限制了你能做什么——你不能逆转从未发生过的事情，你只能逆转已经完成并得到网络批准的行动。

如果你允许绕过加密安全层，它会把你带回到一个可以从任何地址向任何地址转移任何金额的世界。直接改变状态的能力比简单的逆转要强大得多，以太坊基金会表明，他们有能力在执行非常糟糕的投票基础上做到这一点——他们知道这一点。

![](img/11c5b44ccc9afc1a18541a43db623574.png)

# 碳投票

碳投票是一种非正式的方式来表达你对刀叉的看法。每一张选票都根据该地址拥有的乙醚量进行加权。这种投票需要某种带有时间戳的冻结，否则很容易受到“移动攻击”，这意味着单个用户可以通过将以太网移动到另一个地址来多次投票。我可能是错的，但我认为碳排放投票在那个时候很容易受到攻击。

虽然一开始有人说投票是非官方的，但后来人们得出了这样的结论，即“社区显然决定硬分叉”。

**否**。这不是群体的决定，原因如下

1.  7200 万以太是预先和当时的道黑客有大约 8200 万流通。以太坊基金会和斯洛克都有很多以太要投票，考虑到可能的法律后果，他们投票支持分叉几乎是意料之中的事
2.  硬币的分配如此糟糕，以至于称任何投票结果为社区决定都没有什么意义 DAO fork 投票证实了这一点，因为 25%的投票来自一个地址
3.  与没有投资道的人相比，投资道的人有更高的投票动机。可以有把握地假设，投资 DAO 合同的大多数人都投票支持 forking——这是一种自我救助，不应该被允许
4.  不到 6%的乙醚持有者参加了投票——许多人不知道投票发生了，或者不知道如何投票

![](img/ae820ea65e2dc05a27a791bcc2504a35.png)

投票结果可以在这里看到，还有投票给 http://v1.carbonvote.com/[的地址](http://v1.carbonvote.com/)

如上所述，碳投票最终支持硬分叉，这似乎是一个方便的借口，将硬分叉用作节点客户端的默认选项，尽管从历史上看，客户端被默认设置为非分叉版本，这可以从以太坊书的[摘录中读到](https://github.com/ethereumbook/ethereumbook/blob/develop/contrib/forks-history.asciidoc)

> 历史上的硬分叉是选择加入的(即比特币)，不投票就是投反对票。

[](https://elaineou.com/2016/07/18/stick-a-fork-in-ethereum/) [## 把叉子插在以太坊里

### 硬分叉是如何工作的:(我已经知道一个分叉是如何工作的，跳到 bitching)以太坊是一个节点网络，所有…

elaineou.com](https://elaineou.com/2016/07/18/stick-a-fork-in-ethereum/) 

# 以太坊分裂

在 hard fork block 攻击网络后，每个人都预期原始链会随着每个人移动到新链而消亡，然而让每个人惊讶的是，对没有“非法”状态更改的旧链的兴趣比预期的更大——包括以太坊基金会。这个有着未被篡改历史的原始连锁店被称为**以太坊经典(ETC)** ，尽管它受到了来自社区的所有憎恨，它还是设法生存了下来。在 fork 上线后不久，一个社区开始围绕旧的连锁店形成。许多人开始为 github 上的开源项目做出贡献，一个独立的 subreddit 开始吸引那些认为硬分叉是一个错误的人。

我承认道的情况不是一个容易的选择，我的一部分很高兴以太坊分叉，因为我相信他们已经做了一个巨大的帮助了许多不负责任的投资者。最终刀硬叉向我们展示了两件事:

1.  他们可以打破“代码就是法律”的规则
2.  如果他们愿意，他们可以忽略这些特殊的笔

有人可能会说这是为了网络的更大利益，但它很快变成了一个我无法信任的网络。

# 但是，但是…刀就是这么 2016！

黑客攻击没有结束，也永远不会结束。有人认为刀叉没有开创先例，我认为有。以太坊未来会因为类似情况而面临问题的预测成真了。最近，我们能够跟踪[一场关于恢复由于](https://github.com/ethereum/EIPs/pull/999/) [**奇偶校验的 multisig 智能合约**](/chain-cloud-company-blog/parity-multisig-hack-again-b46771eaa838) 中的一个错误而损失的资金的公开讨论和[投票](https://www.etherchain.org/coinvote/poll/35)。投票结果(尽管是非官方的)显示，55%的投票反对恢复损失的资金，总共有 330 票反对，平均投票数为 6600，这表明了类似于在 DAO 案中观察到的“鲸鱼投票”问题。

我个人并不关心投票结果，但是[提案(EIP 999)](https://github.com/ethereum/EIPs/pull/999/) 被考虑的事实表明事情已经发生了变化。如果有人打开了一个带有类似请求的以太坊经典提案，它将很快关闭，原因将是**“合同完全按照指定的方式工作”**。原来道不是一个单独的例子，现在出现了一个类似的情况，大约是 8 倍小，我们仍然不确定结果会是什么。也许真的从一开始就有两个以太，道的分裂把志同道合的人放在了同一个桶里。

有时候最好不要使用你的“非法”超能力，否则每个人都会期待你下次还会使用它们。

![](img/e1060b1821f1dd5f4db5a7222a7e7456.png)

快进 2 年，ETC 仍然存在，现在已经过了最初的恢复期。事实上，它不仅幸存下来，而且做得很好，这让我觉得它是加密货币领域最有弹性的社区之一。我相信它有一个光明的未来，它只是刚刚开始启动它的引擎。在社交媒体网站上，它仍然受到一些仇恨，但这主要是因为人们并不真正理解它的理由——它经常被比特币最大化主义者称为对以太坊的攻击。他们大错特错了。以太坊经典只是以太坊社区的一个子集，认为永恒是理所当然的。ツ

> **以太坊用自己的法则和规则定义了一个新世界。为了拯救某一特定人群而追溯性地改变这些是不应该容忍的。**

尽管有一些丑陋的历史，我希望两个网络都好，我认为他们可以互相学习，并可能合作。我将以回复我开始时的推文来结束

![](img/5bfc7a3858a8d29000d8be63eaadd29c.png)

Couldn’t have said it better myself (⌐■_■)

# 其他与 DAO 相关的资源

***操盘手描述刀情***
[https://medium . com/@ WhalePanda/以太坊-骗子链-盗贼-b04aaa0762cb](/@WhalePanda/ethereum-chain-of-liars-thieves-b04aaa0762cb)

***一个搞笑的刀戏仿*** [https://medium . com/@ WhalePanda/the-complete-story-of-ether eum-so-far-b85ba 182 bb 35](/@WhalePanda/the-complete-story-of-ethereum-so-far-b85ba182bb35)

***合同、代码和复杂性***
[https://Elaine ou . com/2016/06/19/Contracts-Code-and-Complexity/](https://elaineou.com/2016/06/19/contracts-code-and-complexity/)

***以太坊书关于叉子的章节***
[https://github . com/Ethereum book/Ethereum book/blob/3a 21b 603899 e 27427 ca 64 fc 5d 3 FD 57 af 96 a3 CBD 8/forks-history . asciidoc](https://github.com/ethereumbook/ethereumbook/blob/3a21b603899e27427ca64fc5d3fd57af96a3cbd8/forks-history.asciidoc)