<html>
<head>
<title>How to make a Bitcoin transaction with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python进行比特币交易</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-make-a-bitcoin-transaction-with-python-450d7d3db864?source=collection_archive---------2-----------------------#2020-07-14">https://medium.com/coinmonks/how-to-make-a-bitcoin-transaction-with-python-450d7d3db864?source=collection_archive---------2-----------------------#2020-07-14</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/6aaab8c6e4567569e4257bcdf65a7aa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GGsvsa9J4-FG25ZqZsajUQ.png"/></div></div></figure><div class=""/><div class=""><h2 id="6264" class="pw-subtitle-paragraph jb id ie bd b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ek translated">最初发表在<a class="ae jt" href="https://nownodes.io/blog/how-to-make-a-bitcoin-transaction-with-python" rel="noopener ugc nofollow" target="_blank"> NOWNodes博客</a>感谢<a class="ju jv gr" href="https://medium.com/u/87a61f1520ab?source=post_page-----450d7d3db864--------------------------------" rel="noopener" target="_blank"> Gaurav Agrawal </a>！</h2></div><p id="5332" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">在上一篇文章中，我们了解了<a class="ae jt" rel="noopener" href="/coinmonks/bitcoin-hierarchical-deterministic-wallet-in-python-5947147e3eda">创建比特币高清钱包</a>。今天，我们将讨论如何使用Python创建、签名和广播比特币交易。</p><h1 id="368e" class="ks kt ie bd ku kv kw kx ky kz la lb lc jk ld jl le jn lf jo lg jq lh jr li lj dt translated">先决条件</h1><p id="6c85" class="pw-post-body-paragraph jw jx ie jy b jz lk jf kb kc ll ji ke kf lm kh ki kj ln kl km kn lo kp kq kr hm dt translated">我们将使用<code class="eh lp lq lr ls b"><a class="ae jt" href="https://pypi.org/project/bit/" rel="noopener ugc nofollow" target="_blank">bit</a></code> python库，这是开发比特币相关应用程序的最快、最简单的库之一。使用以下命令安装<code class="eh lp lq lr ls b"><a class="ae jt" href="https://pypi.org/project/bit/" rel="noopener ugc nofollow" target="_blank">bit</a></code>。</p><pre class="lt lu lv lw fq lx ls ly lz aw ma dt"><span id="e9de" class="mb kt ie ls b fv mc md l me mf">pip install bit</span></pre><h1 id="42ee" class="ks kt ie bd ku kv kw kx ky kz la lb lc jk ld jl le jn lf jo lg jq lh jr li lj dt translated">创建比特币钱包(Testnet)</h1><p id="113e" class="pw-post-body-paragraph jw jx ie jy b jz lk jf kb kc ll ji ke kf lm kh ki kj ln kl km kn lo kp kq kr hm dt translated">在本教程中，我们将创建一个比特币testnet钱包。因为我们将创建交易并发送比特币，所以我们不希望您丢失真正的比特币。</p><p id="b9db" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">比特币测试网(Bitcoin Testnet)是一个模拟原始比特币网络但不具有任何货币价值的网络。Testnet有测试比特币。因此，不要把真实的比特币发送到testnet地址，你会丢失它们。</p><p id="5119" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">因此，让我们创建一个简单的testnet钱包。为此，创建一个简单的python文件<code class="eh lp lq lr ls b">transaction.py</code>，复制并粘贴下面的代码。</p><pre class="lt lu lv lw fq lx ls ly lz aw ma dt"><span id="06ef" class="mb kt ie ls b fv mc md l me mf">from bit import PrivateKeyTestnetmy_key = PrivateKeyTestnet()print(my_key.version)print(my_key.to_wif())print(my_key.address)</span></pre><p id="e509" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">这段代码将创建一个简单的钱包并打印<code class="eh lp lq lr ls b">wif</code> ( <a class="ae jt" href="https://en.bitcoin.it/wiki/Wallet_import_format" rel="noopener ugc nofollow" target="_blank">钱包导入格式</a>)。使用这个<code class="eh lp lq lr ls b">wif</code>我们可以再次得到我们的钱包。</p><p id="9c3b" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">否则<code class="eh lp lq lr ls b">my_key = PrivateKeyTestnet()</code>每次都会生成一个新的钱包。</p><p id="e913" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">所以一旦得到<code class="eh lp lq lr ls b">wif</code>就把<code class="eh lp lq lr ls b">my_key = PrivateKeyTestnet()</code>换成<code class="eh lp lq lr ls b">my_key = PrivateKeyTestnet('wif')</code>。这样，每次我们重新运行上述代码时，我们都将使用同一个钱包。</p><h1 id="4dbc" class="ks kt ie bd ku kv kw kx ky kz la lb lc jk ld jl le jn lf jo lg jq lh jr li lj dt translated">获取测试比特币</h1><p id="9756" class="pw-post-body-paragraph jw jx ie jy b jz lk jf kb kc ll ji ke kf lm kh ki kj ln kl km kn lo kp kq kr hm dt translated">现在，我们需要获得一些测试比特币，这样我们就可以将它发送到另一个钱包。</p><p id="67bf" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">要获得testnet比特币，请使用<a class="ae jt" href="https://testnet-faucet.mempool.co/" rel="noopener ugc nofollow" target="_blank">此链接</a>。输入上述钱包生成的地址。你可以在这里查看你的testnet交易<a class="ae jt" href="https://blockstream.info/testnet/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="450d" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">交易确认后，您还可以使用</p><pre class="lt lu lv lw fq lx ls ly lz aw ma dt"><span id="5749" class="mb kt ie ls b fv mc md l me mf">print(my_key.balance_as('usd'))</span></pre><p id="8899" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated"><strong class="jy if">注意:</strong> Testnet比特币没有任何货币价值。</p><h1 id="bf49" class="ks kt ie bd ku kv kw kx ky kz la lb lc jk ld jl le jn lf jo lg jq lh jr li lj dt translated">创建交易</h1><p id="e7e1" class="pw-post-body-paragraph jw jx ie jy b jz lk jf kb kc ll ji ke kf lm kh ki kj ln kl km kn lo kp kq kr hm dt translated">现在我们准备创建一个事务。但是等等，我们需要一个接收者地址，否则，我们将把事务发送到哪里。您可以使用上述方法创建另一个钱包。然而，为了简洁起见，我们将使用下面的testnet地址。</p><p id="2fe4" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated"><strong class="jy if">注意:</strong>下面的地址是一个比特币testnet地址，不要在这个地址上发送真实的比特币。</p><pre class="lt lu lv lw fq lx ls ly lz aw ma dt"><span id="a41c" class="mb kt ie ls b fv mc md l me mf">mkH41dfD4S8DEoSfcVSvEfpyZ9siogWWtr</span></pre><p id="8b07" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">现在，我们什么都有了，所以我们准备创建一个比特币交易。</p><pre class="lt lu lv lw fq lx ls ly lz aw ma dt"><span id="f03c" class="mb kt ie ls b fv mc md l me mf">tx_hash = my_key.send([('mkH41dfD4S8DEoSfcVSvEfpyZ9siogWWtr', 1, 'usd')])print(tx_hash)</span></pre><p id="6c6e" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">是的，使用<code class="eh lp lq lr ls b">bit</code>我们可以只用一个命令来创建、签署和广播事务。另外，<code class="eh lp lq lr ls b"><a class="ae jt" href="https://ofek.dev/bit/dev/api.html#bit.PrivateKey.send" rel="noopener ugc nofollow" target="_blank">send()</a></code>方法以一个数组作为参数。这意味着您可以一次创建和发送多个交易。</p><p id="b575" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">上面的代码将打印一个交易散列，我们可以在<a class="ae jt" href="https://blockstream.info/testnet/" rel="noopener ugc nofollow" target="_blank">比特币testnet block explorer </a>上查看。</p><p id="bf6b" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">交易确认后，您可以使用重新检查您的钱包余额。</p><pre class="lt lu lv lw fq lx ls ly lz aw ma dt"><span id="851f" class="mb kt ie ls b fv mc md l me mf">print(my_key.get_balance())</span></pre><p id="6642" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">如需进一步阅读，请查阅<code class="eh lp lq lr ls b"><a class="ae jt" href="https://ofek.dev/bit/" rel="noopener ugc nofollow" target="_blank">bit documentation</a></code>。</p></div><div class="ab cl mg mh hb mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hm hn ho hp hq"><p id="c039" class="pw-post-body-paragraph jw jx ie jy b jz ka jf kb kc kd ji ke kf kg kh ki kj kk kl km kn ko kp kq kr hm dt translated">NOWNodes —适用于40多个最受欢迎的区块链网络的资源管理器和API。<br/>在1个工作日内获得您的API。</p><blockquote class="mn"><p id="ed37" class="mo mp ie bd mq mr ms mt mu mv mw kr ek translated"><a class="ae jt" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="my mz na nb nc hv fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff mx"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>