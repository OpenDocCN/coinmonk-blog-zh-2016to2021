<html>
<head>
<title>How to verify smart contract on Etherscan?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Etherscan上验证智能合约？</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-verify-smart-contract-on-etherscan-b9a79cb8793a?source=collection_archive---------1-----------------------#2018-04-28">https://medium.com/coinmonks/how-to-verify-smart-contract-on-etherscan-b9a79cb8793a?source=collection_archive---------1-----------------------#2018-04-28</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="aa96" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为什么要验证您的智能合同？看情况。这主要取决于您的用例。它总是归结为透明。如果我对ICOs感兴趣，我会希望确保令牌和众筹合同代码执行白皮书(或者，呃…，视频)中描述的密码经济学。在GitHub上开源代码是一个好主意，但是不能保证库中的代码与运行在链上的代码有一点相似。毕竟这是一份合同，所以给其他各方一个熟悉他们将要“签署”的条件的机会是有好处的。验证源代码，即使不是每个人都有阅读它的编程技能。</p><p id="1b0f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于指向智能合约的地址，可以获取它们的代码。</p><pre class="jo jp jq jr fq js jt ju jv aw jw dt"><span id="a4bc" class="jx jy ht jt b fv jz ka l kb kc">web3.eth.getCode("0xd49d7704b72b373f7c7adc14623511e25ecc4a2d");</span></pre><p id="4a5e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">因为这给了你十六进制表示的二进制代码，所以试图理解契约在做什么是不可行的。</p><p id="2294" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以太扫描是非常受欢迎的(如果不是最受欢迎的)区块链探险家。很多人使用以太扫描来了解更多关于以太坊区块链的交易或特定地址。除了探索能力之外，它还提供多种服务。其中之一是确认特定地址下的二进制数据是指定源代码(您可以读取和分析)的编译结果。</p><h1 id="7370" class="kd jy ht bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">示例项目</h1><p id="f030" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hm dt translated">更有趣的是，我们的示例项目将有一个构造函数，它接受一个参数并扩展来自<a class="ae lf" href="https://github.com/OpenZeppelin/zeppelin-solidity" rel="noopener ugc nofollow" target="_blank"> zeppelin-solidity </a>的Ownable契约。这些简单的元素将展示您在尝试独自验证合同时可能会遇到的一些挑战。</p><pre class="jo jp jq jr fq js jt ju jv aw jw dt"><span id="48c2" class="jx jy ht jt b fv jz ka l kb kc">pragma solidity 0.4.23;</span><span id="b96d" class="jx jy ht jt b fv lg ka l kb kc">import "zeppelin-solidity/contracts/ownership/Ownable.sol";</span><span id="66d8" class="jx jy ht jt b fv lg ka l kb kc">contract MessageOfTheDay is Ownable {<br/>    string public message;</span><span id="2be5" class="jx jy ht jt b fv lg ka l kb kc">    constructor(string _message) public {<br/>        message = _message;<br/>    }</span><span id="b8d7" class="jx jy ht jt b fv lg ka l kb kc">    function setMessage(string _message)<br/>        public<br/>        onlyOwner<br/>        returns (bool)<br/>    {<br/>        message = _message;<br/>        return true;<br/>    }<br/>}</span></pre><p id="4495" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">完整的源代码可以在<a class="ae lf" href="https://github.com/MichalZalecki/verify-on-etherscan" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。您可以克隆它，部署它，并尝试按照我的步骤在Etherscan上确认您的实例。</p><pre class="jo jp jq jr fq js jt ju jv aw jw dt"><span id="4746" class="jx jy ht jt b fv jz ka l kb kc">$ ./node_modules/.bin/truffle migrate --network kovan</span><span id="79ec" class="jx jy ht jt b fv lg ka l kb kc">Using network 'kovan'.</span><span id="ed2b" class="jx jy ht jt b fv lg ka l kb kc">Running migration: 1_initial_migration.js<br/>  Replacing Migrations...<br/>  ... 0x1124628216610c4683fe4a81107dd9a34a2532a44e2a39f6e8cf7918517be8d8<br/>  Migrations: 0x16a49d6fe6831760e5208590435d911e7a462560<br/>Saving successful migration to network...<br/>  ... 0xf1c727123800989592d55c988aacc62b928b0ad36fc44c6bff97cce43f6a49cb<br/>Saving artifacts...<br/>Running migration: 2_message_of_the_day.js<br/>  Deploying MessageOfTheDay...<br/>  ... 0xb610d6ad2c1ac2eb742216a7248d49b65671d0712bf4e4863e006c1c1baf0e81<br/>  MessageOfTheDay: 0x91926e1e9c7bdb0be4d2226caf7036392cc06763<br/>Saving successful migration to network...<br/>  ... 0x065eece5dc0fc260bca4e71589c575b9f43ca5a69336738b6f4c7f4e91c4897a<br/>Saving artifacts...</span></pre><p id="312a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">了解更多关于部署的信息:<a class="ae lf" href="https://michalzalecki.com/deploying-smart-contracts-with-truffle/" rel="noopener ugc nofollow" target="_blank">使用Truffle部署智能合约</a></p><h1 id="7956" class="kd jy ht bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">准备</h1><p id="796a" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hm dt translated">在开始之前，我们需要准备ABI编码的构造函数参数。您可以通过使用web3对值进行编码来实现。更快的方法是使用<a class="ae lf" href="https://abi.hashex.org/" rel="noopener ugc nofollow" target="_blank">abi.hashex.org</a>或者直接从创建合同的<a class="ae lf" href="https://kovan.etherscan.io/tx/0xb610d6ad2c1ac2eb742216a7248d49b65671d0712bf4e4863e006c1c1baf0e81" rel="noopener ugc nofollow" target="_blank">事务</a>输出中读取它们。</p><p id="e1d9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">单个字符串参数的ABI编码表示形式:</p><pre class="jo jp jq jr fq js jt ju jv aw jw dt"><span id="e916" class="jx jy ht jt b fv jz ka l kb kc">0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000001948656c6c6f2c206d696368616c7a616c65636b692e636f6d2100000000000000</span></pre><p id="72e2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们必须准备一个包含合同全部源代码的文件，这样它就没有导入语句。让我们安装松露压扁器。</p><pre class="jo jp jq jr fq js jt ju jv aw jw dt"><span id="4bef" class="jx jy ht jt b fv jz ka l kb kc">npm install -D truffle-flattener</span><span id="db5e" class="jx jy ht jt b fv lg ka l kb kc">./node_modules/.bin/truffle-flattener \ ./contracts/MessageOfTheDay.sol &gt; flattened.sol</span></pre><p id="bb72" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您现在可以查看flattened.sol并找到Ownable.sol契约的源代码来代替import语句。</p><h1 id="810e" class="kd jy ht bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">确认</h1><p id="4349" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hm dt translated">要开始该过程，请转到<a class="ae lf" href="https://etherscan.io/verifyContract2" rel="noopener ugc nofollow" target="_blank">以太网扫描验证合同代码</a>页面。确保使用您部署了合同和2.0版本的网络(URL中带有verifyContract2)。</p><ol class=""><li id="244e" class="lh li ht is b it iu ix iy jb lj jf lk jj ll jn lm ln lo lp dt translated">粘贴合同地址</li><li id="7f86" class="lh li ht is b it lq ix lr jb ls jf lt jj lu jn lm ln lo lp dt translated">输入合同的名称</li><li id="33e4" class="lh li ht is b it lq ix lr jb ls jf lt jj lu jn lm ln lo lp dt translated">选择用于编译项目的编译器版本。您可以通过运行<code class="eh lv lw lx jt b">truffle version</code>来检查它</li><li id="7a8b" class="lh li ht is b it lq ix lr jb ls jf lt jj lu jn lm ln lo lp dt translated">根据您的项目设置来设置优化。记住也要设置正确的运行次数</li><li id="d3e5" class="lh li ht is b it lq ix lr jb ls jf lt jj lu jn lm ln lo lp dt translated">粘贴展平的源代码</li><li id="8cc9" class="lh li ht is b it lq ix lr jb ls jf lt jj lu jn lm ln lo lp dt translated">粘贴ABI编码的构造函数参数</li><li id="22d0" class="lh li ht is b it lq ix lr jb ls jf lt jj lu jn lm ln lo lp dt translated">单击“验证并发布”</li></ol><figure class="jo jp jq jr fq lz fe ff paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="fe ff ly"><img src="../Images/5a83981393a69684d5dc1ee5627dbd45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3hF7ByX1NniffN2L38HCrg.png"/></div></div><figcaption class="mg mh fg fe ff mi mj bd b be z ek">That’s it, you have successfully verified your smart contract!</figcaption></figure></div><div class="ab cl mk ml hb mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hm hn ho hp hq"><p id="8981" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="mr">原载于2018年4月28日michalzalecki.com</em><em class="mr">的</em> <a class="ae lf" href="https://michalzalecki.com/how-to-verify-smart-contract-on-etherscan/" rel="noopener ugc nofollow" target="_blank"> <em class="mr">。</em></a></p></div></div>    
</body>
</html>