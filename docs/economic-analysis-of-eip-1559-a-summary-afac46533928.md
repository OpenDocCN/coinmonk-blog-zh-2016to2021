# EIP 1559 年经济分析综述

> 原文：<https://medium.com/coinmonks/economic-analysis-of-eip-1559-a-summary-afac46533928?source=collection_archive---------1----------------------->

这篇文章总结了 Tim Roughgarden 的这篇优秀的研究论文。

我将概述 EIP-1559 提案，重申 Roughgarden 的“十大要点”，并对他论文中的证据/论点提供一点高层次的直观解释。(你也可以直接跳到结论。)

# 背景:以太坊交易

(如果你非常熟悉以太坊，可以跳过这一部分。)

像所有计算机一样，以太坊区块链是一个[状态机](https://en.wikipedia.org/wiki/Finite-state_machine)。以太坊的任何给定状态都“简单地”是地址和账户状态之间的[映射](https://en.wikipedia.org/wiki/Map_(mathematics))——账户状态只是账户存储的数据(例如，账户余额、合同代码等)，该账户由唯一的地址引用。

![](img/e7241da8ff0c23c8650c3850ae694bce.png)

A mapping of an address to its corresponding account state. ([Source](https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf).)

**事务**改变了这个全局状态。事务指定了一系列指令，这些指令通过以太坊虚拟机(EVM)的执行来改变全局状态。(更正式地说，EVM 是以太坊的[状态转移函数](https://en.wikipedia.org/wiki/Finite-state_machine#Mathematical_model)的实现，在定义任何状态机时都是必需的。)

![](img/5c14812bd857236b81e7a3f014f7addc.png)

A very simple state machine. The circles represent states and the arrows represent state transitions. Of course, the Ethereum state machine is much more complex: many state transition types implemented as [opcodes](https://github.com/crytic/evm-opcodes) and potentially infinite states¹. ([Source](https://www.chegg.com/homework-help/questions-and-answers/shown-state-transition-diagram-sequential-circuit-two-flip-flops-two-inputs-counts-binary--q9675611).)

交易的创建者必须指定**气体限制**和**气体价格**。

> gas 限制是交易强加给以太坊区块链的成本(在计算、存储等方面)的度量。天然气价格规定了交易创建者愿意支付的每单位天然气的价格(ETH)。例如，最基本的交易类型(简单的转让)需要 21，000 单位的天然气；更复杂的交易需要更多的汽油。典型的天然气价格反映了当前对 EVM 计算的需求，并随时间以数量级变化。

(注:本帖中的所有引文均摘自最初引用的文章。)

交易创建者支付:*气限×气价*。

**块**是事务和一些相关元数据的有序序列(重要的是，包括指向前一个块的引用/指针；因此，为什么它是一个区块链*。*

*![](img/872771aefd10cf31866357f9c2df8cd8.png)*

*©*PNGWing**

***最大块大小**是任何块可以包含的总计算量(由事务中的 gas 数量表示)的上限。目前，该最大值设定为 12.5 米天然气；这在理论上为每个块创建了大约 1000 个事务的上限(尽管实际上，这个上限要小得多)。**矿工**负责选择和订购区块交易，并提供[工作证明](https://en.wikipedia.org/wiki/Proof_of_work)。*

*对于本文的其余部分很重要:*

> ***交易费用机制** (TFM)是协议的一部分，它确定已确认交易的创建者支付的金额，以及支付给谁。*

# *当前的**交易费用机制***

*现在的以太坊交易收费机制是一个[首价拍卖](https://en.wikipedia.org/wiki/First-price_sealed-bid_auction)。*

*![](img/75fb85f9bda300f8bc06f8c03d5f1f71.png)*

*from Transaction Fee Mechanism Design for the Ethereum Blockchain: An Economic Analysis of EIP-1559*

*这导致“许多矿商将区块打包到最大区块尺寸，[贪婪地优先处理](https://en.wikipedia.org/wiki/Greedy_algorithm)天然气价格最高的未完成交易”。*

# *EIP-1559:关键思想*

*[在这里](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1559.md)你可以找到官方以太坊改进提案(EIP) #1559。*

***刻录依赖历史的基本费用***

1.  *每个区块都有一个协议计算的底价(每单位天然气)，称为**基本费用**。支付基本费用是加入区块的先决条件。*
2.  *基本费用仅是*前一程序块*的功能。*
3.  *所有来自基本费用的收入都被烧掉了——也就是说，永远从 ETH 的流通供应中消失了。*

***可变尺寸块***

1.  *最大区块尺寸加倍(如从 12.5M 天然气到 25M 天然气)，旧的最大值(如 12.5M 天然气)作为**目标区块尺寸**。*
2.  ***每当最新块的尺寸大于或小于目标块尺寸时，分别向上或向下调整基本费用**。*

***提示***

1.  *现在，一笔**交易包括小费**和费用上限，而不是单一的油价。只有当交易的费用上限至少是该交易块的基本费用时，该交易才会包含在该交易块中。*
2.  *谁支付什么？如果具有小费 *δ* 、费用上限 *c* 和气体限制 *g* 的交易包含在具有基本费用 *r* 的块中，则交易创建者支付 *g min(r+δ，c)* ETH。*
3.  *谁得到付款？来自基本费用的收入被**烧掉**，剩余部分被转移给该区块的矿工。*

*有趣的是，在阅读这些关键思想时，人们可能会认为它们相当武断，并且/或者这些“关键思想”中的一些与其他的有些正交。事实并非如此。不完全是。这些想法有着内在的联系，你会在这篇文章的剩余部分看到。*

## *作为需求代理的可变块大小*

*第一点:这些想法是内在联系的，是动态调整块大小的概念。为什么需要这样做？对此有一个简单的答案:当区块大小是动态的时，开采区块的实际大小可以用作需求的**代理**:*

> *然后，EIP-1559 中的机制使用过去的区块大小作为需求的链上测量，大区块(超过 1250 万天然气)和小区块(小于 1250 万天然气)分别表示需求的增加和减少*

## *更新公式*

*更新每个区块的基本收费的拟议公式为:*

*![](img/41a5208e5498e9b422099f003ed453db.png)*

*也就是说，在最大大小的块(即目标大小的两倍)之后，基本费用最多增加 12.5%，在空块之后，基本费用最多减少 12.5%。⅛因素是相当随意的。“良好”因素允许基本费用以适当的比率根据需求的向下/向上峰值进行调整。*

# *十大要点*

*在这里，我重申了 Roughgarden 论文中的“十大要点”,并为其背后的推理提供了一些直觉。*

## *[1.]任何交易费用机制，无论是 EIP-1559 还是其他，都不可能大幅降低平均交易费用；持续的高交易费用是可扩展性问题，而不是机制设计问题。*

*下面是以太坊网络中用于计算(由气体测量)的供给/需求图的典型示例。⁴*

*![](img/f420ccdc58557cf85b5be90be39043f0.png)*

*from Transaction Fee Mechanism Design for the Ethereum Blockchain: An Economic Analysis of EIP-1559*

*请注意，这完全独立于天然气价格机制。供需线的交叉点是**市场出清价格**，在这里，天然气需求总量等于可用供应量的价格。*

*Roughgarden 认为，所有(合理的)天然气价格机制都可以被视为“为这一理想而努力”。也就是说，努力达到最接近最佳交叉点的天然气价格。这个交叉点完全由供需决定——与天然气价格机制无关。*

> *通过增加供给或减少需求来降低市场出清价格，从根本上来说是一个可扩展性问题，而不是机制设计问题。⁵*

## *[2.] EIP-1559 应该通过可变大小块的灵活性来减少交易费用的差异和一些用户经历的延迟。*

*就像前面提到的“外卖”，每当需求超过供给的时候，交易费用就会很高。*

> *那么这个提议有什么意义呢？使交易费用更可预测，从而使费用估算问题(为交易选择最佳天然气价格的问题)尽可能简单明了。*

*从本质上讲，作者认为 EIP-1559 的主要好处是用户体验(UX)的一个。他通过他称之为“用户激励兼容性(UIC)”的东西使 UX 正式化。为了让这篇博文相对“轻松”，我将跳过这种形式主义的细节，但文中也提供了一个很好的直观类比:*

> *在亚马逊购物比在竞争激烈的房地产市场买房容易多了。在亚马逊上，你不需要有战略眼光或者事后批评自己；你要么愿意为列出的产品支付列出的价格，要么不愿意…*
> 
> *在追求房子，和其他潜在买家竞争的时候，一定要仔细考虑给卖家什么价格。不管你有多聪明，事后你可能会后悔你的出价——要么是因为你出价太低，结果在你愿意支付的价格上被超过，要么是因为你出价过高，支付的金额超过了你需要的金额。房子不需要卖给愿意出最高价的潜在买家(如果该买家过于激进地降低出价)，这是经济效率的损失。*

*![](img/7349ef5513c52ee2ff626d268ccc4e97.png)*

*An art auction at Sotheby’s. Admittedly, not the perfect analogy for what we’re dealing with re: gas prices, but it does make for a nice image, and the art world is always a fun topic of conversation :) Credit: ukartpics/Alamy Stock Photo*

*本质上，当前的天然气价格投标系统在市场上造成了许多“混乱”(从而导致了市场的许多低效率)，因为交易创建者通常不会诚实地说出他们愿意投标的价格，他们的决定通常会受到其他人(或他们认为其他人)正在做的事情的影响。直截了当地说，有一个固定的价格更简单，从而减少了市场的混乱和低效。*

## *[3.] EIP-1559 应该通过简单的费用估算来改善用户体验，在需求快速增长的时期之外，以“明显的最优出价”的形式。*

*论文中证实这一点的部分相当复杂，但它本质上归结为证明一种叫做“用户激励兼容性”的东西。本节(6.3)中的证明表明，1559 机制*通常*起到“标价机制”的作用(就像前面给出的亚马逊例子)。需要注意的是，在需求快速增长的时期，这是不成立的，因为:*

> *当基本费用过低时，用户必须通过他们的提示来竞争稀缺的块空间，并且 1559 机制有效地回复到第一价格拍卖。*

*也就是说，在需求激增期间，1559 看起来就像当前的系统一样运行。*

## *[4.]在 EIP-1559 法案下，对矿商执行协议的短期激励与第一价格拍卖一样强烈。*

*“按预期”本质上是指:*

*   *矿商没有创造虚假交易的动机*
*   *矿商没有动机与用户进行链外勾结*

*这些观点在 6.2 节和 6.4 节中得到正式证明。*

## *[5.]双重支出攻击、审查攻击、拒绝服务攻击和长期收入最大化策略(如操纵基本费用)的博弈论障碍在 EIP-1559 下似乎与第一价格拍卖一样强大。*

*对此的解释在第 7.5 节中解释得相当清楚，但关键的一点是:“主要的”攻击媒介在 EIP-1559 下并不比在当前的天然气价格机制下更容易被利用，因为它们“是可检测的，游戏理论上是脆弱的，或者两者兼而有之”。*

## *[6.] EIP-1559 至少应该通过燃烧交易费用来适度降低通货膨胀率。*

*不言而喻:燃烧越多意味着循环中的 ETH 越少。*

## *[7.]简单的费用估算和烧钱这两个看似正交的目标，通过链外协议的威胁紧密联系在一起。*

*这非常有趣:燃烧基本费用是 1559 机制的必要组成部分，因为否则(即，如果矿商只是收取这些费用)，整个 1559 机制将等同于第一价格拍卖；也就是我们现在所拥有的。也就是说，**如果 1559 被修改，使得*矿工赚取基本费用*，那么这将** [**降低**](https://en.wikipedia.org/wiki/Reduction_(complexity)) **到当前的天然气价格机制。***

*我认为这是一个关键点，因为我见过几次(非正式的)争论，认为 EIP-1559 将与目前的机制表现相同，但似乎*不是*的情况，特别是*因为*的燃烧。*

*此外，有一个论点表明，基本费用在这种设计中也是必要的，因为简单地燃烧第一价格拍卖的费用被证明是次优的(由于外链协议变得有利可图)。*

## *[8.]替代设计包括向未来区块的矿商支付基本费用收入，而不是烧掉它们；以及用固定的硬编码提示替换可变的用户指定提示。*

*这也是我认为非常重要的一点。作者表明，他在研究论文*中为 EIP-1559 提出的所有论点也适用于其他几种替代设计。**

*我将特别提到的另一个设计是:**向前支付基本费用**。由于提议的烧钱机制，反对 EIP-1559 的最大阻力来自矿商(见下面的警告部分)。*

> *[我们证明]要使一个区块的基本费用具有经济意义，它的收入不能转移给该区块的矿商。或许扣留这笔收入的最简单方法，如目前的 EIP-1559 规范，是烧掉这些收入，有效地向所有 ETH 持有者发放一次性退款。另一个解决方案是将这些收入转移给其他区块的一家或多家矿商。*

*这种 EIP-1559 *的替代品/改型*可能会影响矿工的意见。我很想听到更广泛的讨论/辩论。*

## *[9.] EIP-1559 的基本费用更新规则有些武断，应该随着时间的推移进行调整。*

*我已经在上面提到过这个(“⅛因子是相当任意的”)关于基本利率更新功能。2x 最大块大小也是一个有些随意的“好”数字。更一般地，1559 机制只需要满足几个条件，即:*

*   *依赖于历史的基本费用，以及*
*   *从一个区块的采矿者那里烧掉或以其他方式扣留的收入*

*![](img/2d2732a7e17767b8c7a55c53835e1a65.png)*

*An illustration of overshoot. This image is sourced from the Wikipedia article on [overshoot](https://en.wikipedia.org/wiki/Overshoot_(signal)), a topic from signal processing, and only somewhat related to the topic at hand :)*

*此外，Roughgarden 概述了基本费用更新规则所需的几个附加条件:*

1.  *向上调整(分别为。向下)在突然的峰值后相当快地(分别。下降)的需求。*
2.  *调整要足够缓慢，以避免对需求的微小或非常短暂的变化反应过度。*
3.  *不能被用户和/或矿工的卡特尔以游戏的方式操纵--理论上是稳健的方式。*
4.  *对攻击者来说，利用这一点代价很高。*

> *“相当快”是多快？“贵”有多贵？这样的问题…最好通过实验和社区讨论来回答。*

*也就是说，**可以有把握地假设，如果 EIP-1559 通过，我们可以期待未来的提案修改基本利率更新功能**。这是因为，这些初始参数设置不太可能是理想的，只有当它们在“野外”运行时，我们才能真正知道它们有多好。*

## ***【10。]可变大小的数据块带来了一种新的(但昂贵的)攻击手段:用一系列最大大小的数据块淹没网络。***

*一个“攻击性的矿商卡特尔”有可能创造出一系列最大尺寸的区块，以制造需求冲击，进而促使用户增加小费。这种做法成本很高，也可以通过使用更大的块大小来缓解。*

# *警告*

## *愤怒的矿工*

> *但这真的足以证明，根据 EIP-1559 法案，矿工勾结的有害影响不会比现在更严重吗？*

*似乎大多数矿工(至少是矿池)都反对 EIP-1559。⁶:这是因为，可以理解的是，他们认为烧费拿走了他们的部分利润。这带来了许多问题，也许最关键的是:如果大多数矿工拒绝含有 EIP-1559 的升级，这个更新实际上能实现吗？这会导致网络中的另一个分叉吗？*

*也有某些攻击媒介是“游戏理论上脆弱的”——例如，将区块大小保持在一定水平以人为减少供应——*然而*，足够多的愤怒的矿工可以成功地共谋实施这种否则“脆弱”的共谋策略并非完全不可能。*

*然后总是有这样的问题:这对更广泛的社区有什么影响？我不认为协议变更战和分叉会被更广泛的区块链社区正面看待。*

*我想借此机会再次强调蒂姆·拉夫加登建议的 EIP-1559 的变体:“向前支付基本费用”。或许这可以提供一个急需的中间地带？*

# *结论*

*   *EIP-1559 不太可能导致 T2 平均天然气价格的下降。*
*   *EIP-1559 很可能通过简单的费用估算和更少的可变天然气价格来改善用户体验(即*交易创建者*的体验)。*
*   *从传统博弈论的角度来看，EIP-1559 在某些假设下提供了与当前天然气价格选择机制相同的安全保证。*
*   *对此的警告是:更大的矿工勾结——由足够大的一群不满的矿工引起——可能会破坏这些结论所依据的一些更传统的博弈论假设。**足够大的一群对手会破坏我们的博弈论假设吗？并成功实施原本“脆弱”的共谋策略？***
*   *关于 Roughgarden 的 EIP-1559 版本:“向前支付基本费用”，我们可以进行更广泛的讨论吗？或许这可以提供一个急需的中间地带(在用户和矿商之间)？*

*附:https://twitter.com/sasamilic33/status/1370478042787713028?s=20*

# *脚注*

*[1]:拿技术来说，以太坊其实就是一个*无限*状态机:[https://medium . com/@ Samuel . brooks/区块链-the-infinite-state-machine-ffc 39 f 32 e 182](/@samuel.brooks/blockchain-the-infinite-state-machine-ffc39f32e182)*

*[2]:有很多关于首价拍卖的有趣研究(以及一般的拍卖，参见:[拍卖理论](https://en.wikipedia.org/wiki/Auction_theory))。特别是，许多依赖广告收入的主要科技公司最近已经从第二价格拍卖转向第一价格拍卖:[https://digiday . com/media/buyers-welcome-auction-standard ization-as-Google-finally-goes-all-in-first-price/](https://digiday.com/media/buyers-welcome-auction-standardization-as-google-finally-goes-all-in-on-first-price/)*

*[3]:这里有一些重要的警告。随着 DeFi(分散融资)的兴起，越来越多的矿商审查和重新安排交易，以便通过 DeFi 应用中存在的套利(和其他)机会获利。参见第 V-B 节“来自矿工可开采价值的威胁”此处:【https://arxiv.org/pdf/2101.08778.pdf*

*[4]:需求曲线可能不是线性的，但它与这个论点无关；即该论点适用于任何形状的需求曲线。*

*[5]: Roughgarden 补充道:“例如，典型的第一层扩展解决方案(如分片，其中区块链的不同部分并行操作)增加了交易吞吐量，因此降低了市场出清价格。典型的第二层扩展解决方案，如支付通道和汇总，有效地将一些交易移出链外，减少了对 EVM 计算的需求，同样也降低了市场出清价格”。*

*[6]:[https://medium . com/ether eum-cat-herders/EIP-1559-community-outreach-report-aa 18 be 0666 b 5](/ethereum-cat-herders/eip-1559-community-outreach-report-aa18be0666b5)*