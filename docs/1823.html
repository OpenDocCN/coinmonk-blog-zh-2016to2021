<html>
<head>
<title>HighCharts with drizzle-react-components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有毛毛雨-反应-组件的高图表</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/highchart-with-drizzle-react-components-fbce2e28a3a1?source=collection_archive---------0-----------------------#2018-11-25">https://medium.com/coinmonks/highchart-with-drizzle-react-components-fbce2e28a3a1?source=collection_archive---------0-----------------------#2018-11-25</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/bc9b11328842a84f25f4b34926f1bc31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Wd4iif2NDQTgcGPFiYKF_w.png"/></div></figure><p id="0433" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这个小故事来自我们在夏天早些时候做的一个黑客马拉松项目。</p><p id="7dd2" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">目标</strong>:通过以太坊区块链建立一个价值10亿美元的分销网络。</p><p id="ab64" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">听起来像一个有趣的<strong class="iz hu">哈克森</strong>项目对不对😏？</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><p id="7de9" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">技术堆栈如下所示:</p><p id="1703" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">前端:反应(<a class="ae kc" href="https://github.com/truffle-box/drizzle-box" rel="noopener ugc nofollow" target="_blank">松露盒/毛毛雨盒</a></p><p id="cc35" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">后端:<a class="ae kc" href="https://github.com/ethereum/solidity" rel="noopener ugc nofollow" target="_blank">坚固度</a>。<a class="ae kc" href="https://truffleframework.com/ganache" rel="noopener ugc nofollow" target="_blank">加纳切</a>。<a class="ae kc" href="https://github.com/ethereum/web3.js/" rel="noopener ugc nofollow" target="_blank"> Web3.js </a>。</p><p id="d1e4" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我的git代表有这篇文章需要的所有代码。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><p id="de23" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">后端方面，我们通过<a class="ae kc" href="https://github.com/trufflesuite/ganache-cli" rel="noopener ugc nofollow" target="_blank"> ganache-cli </a>建立了一个以太坊网络，然后创建/部署一个智能契约。(我不会在这篇文章中讨论智能合同，那家伙应该有自己的文章😂 ).</p><figure class="ke kf kg kh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kd"><img src="../Images/c4cce40aa0f7945b42ac5930d04caf1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_83pmJn0cNz7KLkGN9IxzA.jpeg"/></div></div></figure><p id="aba2" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">明智地说，我们基于一个叫做<a class="ae kc" href="https://github.com/trufflesuite/drizzle-react-components" rel="noopener ugc nofollow" target="_blank">毛毛雨-反应-组件</a>的毛毛雨盒子来构建我们的项目。</p><p id="b925" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我的回购中的代码是基于<a class="ae kc" href="https://github.com/truffle-box/drizzle-box" rel="noopener ugc nofollow" target="_blank">毛毛雨盒</a>，加上花哨UI的HighCharts以获得观众的<em class="km">惊叹</em>，并谈论如何和为什么。</p><p id="e778" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">继续克隆我的<a class="ae kc" href="https://github.com/lhong375/HighChart-drizzle-box" rel="noopener ugc nofollow" target="_blank">回购</a>。</p><p id="bea5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果你还没有安装松露/加纳切。</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="a74b" class="ks kt ht ko b fv ku kv l kw kx">npm install -g truffle<br/>npm install -g ganache-cli</span></pre><p id="b969" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">启动区块链服务器非常简单，如下所示:</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="224b" class="ks kt ht ko b fv ku kv l kw kx">ganache-cli -b 3 -p 8545</span></pre><ul class=""><li id="e35d" class="ky kz ht iz b ja jb je jf ji la jm lb jq lc ju ld le lf lg dt translated">-b 3表示你的格挡时间是3秒，对于UI来说，表示我们的react组件每3秒就会得到新的道具。</li><li id="f68e" class="ky kz ht iz b ja lh je li ji lj jm lk jq ll ju ld le lf lg dt translated">-p是端口号，它是可选的，但我强烈建议您指定它，因为每个版本的ganache-cli都可以有不同的默认端口号，请确保它与您在<em class="km"> truffle.js </em>中拥有的端口号相同</li></ul><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="0237" class="ks kt ht ko b fv ku kv l kw kx">//truffle.js<br/>module.exports = {<br/>     migrations_directory: “./migrations”,<br/>     networks: {<br/>     development: {<br/>         host: “localhost”,<br/>         port: 8545,<br/>         network_id: “*” // Match any network id<br/>     }<br/> },<br/> .....<br/>}</span></pre><p id="5cf2" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在，您的区块链网络已经启动并运行，但是等等，还没有智能合同，我们需要编译和部署它们。</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="af70" class="ks kt ht ko b fv ku kv l kw kx">npm run populate</span></pre><p id="6d39" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">以上将编译和部署/contracts/下的所有合同...</p><figure class="ke kf kg kh fq iu fe ff paragraph-image"><div class="fe ff lm"><img src="../Images/3b1eaeb838907994f10822b9a8c016ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*RDcThIfCUwKjI-Qwbp2FVQ.png"/></div></figure><p id="f3da" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这个<a class="ae kc" href="https://github.com/truffle-box/drizzle-box" rel="noopener ugc nofollow" target="_blank">投币盒</a>带有情侣合同，我们感兴趣的那个叫做<strong class="iz hu">选票</strong>。它保存了一个投票者列表，3个提案和它们的投票数，一个可以授予投票者权利的主席，和一个投票的功能。</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="0d1a" class="ks kt ht ko b fv ku kv l kw kx">//contracts/Ballot.sol<br/>pragma solidity ^0.4.23;<br/>pragma experimental ABIEncoderV2;</span><span id="a9a8" class="ks kt ht ko b fv ln kv l kw kx">contract Ballot {</span><span id="38a5" class="ks kt ht ko b fv ln kv l kw kx">    struct Voter {<br/>        ...<br/>    }<br/>    struct Proposal {<br/>        uint voteCount;<br/>    }</span><span id="36c6" class="ks kt ht ko b fv ln kv l kw kx">    address public chairperson;<br/>    mapping(address =&gt; Voter) voters;<br/>    mapping(address =&gt; Voter[]) voterslist;<br/>    Proposal[] proposals;</span><span id="4c50" class="ks kt ht ko b fv ln kv l kw kx">    ...</span></pre><p id="fef8" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">同样，我不打算在智能合约本身上过多的赘述，但是，我会在这篇文章的后面介绍我为这个演示添加的新功能。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><p id="0c7a" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在字体结束。</p><p id="b2cd" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">执行npm安装以处理前端依赖关系。</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="8832" class="ks kt ht ko b fv ku kv l kw kx">npm install</span></pre><p id="7116" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">要调出用户界面:</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="3e9c" class="ks kt ht ko b fv ku kv l kw kx">npm run start</span></pre><p id="8b57" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">它将打开您的浏览器并加载localhost:3000，如下所示。</p><figure class="ke kf kg kh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff lo"><img src="../Images/dde1d08ba9e5dcfcb3f1149c2e9827ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dEINWxFMwIqyMjy8JXs45w.png"/></div></div></figure><p id="180f" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在将一个数字从<strong class="iz hu"> 0，1，2 </strong>输入到建议输入框中，然后点击提交，如下图所示:</p><div class="lp lq fm fo lr ls"><a href="http://recordit.co/sfoIGnJT7Q" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab ej"><div class="lu ab lv cl cj lw"><h2 class="bd hu fv z el lx eo ep ly er et hs dt translated">Recordit:快速免费录制屏幕广播！有GIF支持！</h2><div class="lz l"><h3 class="bd b fv z el lx eo ep ly er et ek translated">编辑描述</h3></div><div class="ma l"><p class="bd b gc z el lx eo ep ly er et ek translated">recordit.co</p></div></div></div></a></div><p id="1520" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">不错！当我们投票时，投票号码会在图表中更新(嗯，还记得<strong class="iz hu"> 3秒</strong>的阻塞时间吗？这将是我们预期的延迟)。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><p id="bf5f" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">为了获得每个提案的投票数，我在Ballot中添加了新的函数。sol:</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="9e70" class="ks kt ht ko b fv ku kv l kw kx">//Ballot.sol</span><span id="2801" class="ks kt ht ko b fv ln kv l kw kx">contract Ballot {</span><span id="ef10" class="ks kt ht ko b fv ln kv l kw kx">    ...</span><span id="e70f" class="ks kt ht ko b fv ln kv l kw kx">    struct Proposal {<br/>        uint voteCount;<br/>    }</span><span id="a2f7" class="ks kt ht ko b fv ln kv l kw kx">    ...</span><span id="4829" class="ks kt ht ko b fv ln kv l kw kx">    Proposal[] proposals;</span><span id="e364" class="ks kt ht ko b fv ln kv l kw kx">    ...</span><span id="2c0c" class="ks kt ht ko b fv ln kv l kw kx">    function getAllProposal() public view returns (Proposal[]) {<br/>        return proposals;<br/>    }</span><span id="9dfa" class="ks kt ht ko b fv ln kv l kw kx">    function getAProposal(uint8 num) public view returns (Proposal)  {<br/>        return proposals[num];<br/>    }<br/>    ...</span><span id="bb00" class="ks kt ht ko b fv ln kv l kw kx">}</span></pre><p id="0f33" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">有两个新功能，<strong class="iz hu"> getAllProposal </strong>和<strong class="iz hu"> getAProposal </strong>。为了支持UI，我们一个接一个地绑定3个提议，所以<strong class="iz hu">get proposal</strong>是真正使用的那个。您还可以获取一个列表并进行迭代，这样getAllProposal会很有用。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><p id="275d" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">附带毛毛雨框(毛毛雨反应组件)的用户界面给我们提供了一个简单的列表，如下所示:</p><figure class="ke kf kg kh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff mb"><img src="../Images/57ad27cf95e85903a17e315233020109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W8mX72XFg9iA03Qq4YcXHQ.png"/></div></div></figure><p id="a5fe" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这是工作，但不是很讨人喜欢。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><figure class="ke kf kg kh fq iu fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/ecf5c047dd9570f6faa440ee07431d40.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*eBpSE097yr7FdNx7KSfV6Q.jpeg"/></div></figure><p id="88eb" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">为了引入HighCharts并正确地将Ballo合同数据绑定到它，我们需要理解<strong class="iz hu"> ContractData </strong>是如何工作的，并对HighCharts使用相同的魔法。</p><p id="206b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">但是…我提到过这是一个<strong class="iz hu"> hackson </strong>项目吗？我们在赶时间，队友需要你在智能合同上的帮助，需要尽快让UI工作，你会怎么做？</p><blockquote class="md me mf"><p id="8b16" class="ix iy km iz b ja jb jc jd je jf jg jh mg jj jk jl mh jn jo jp mi jr js jt ju hm dt translated">捷径🚤。</p></blockquote><p id="d818" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我在玩<a class="ae kc" href="https://github.com/truffle-box/drizzle-box" rel="noopener ugc nofollow" target="_blank">松露盒/毛毛雨盒</a>时注意到的是，一旦你将<strong class="iz hu"> ContractData </strong>带入UI，无论你绑定什么智能契约函数，都会被填充到组件的道具中。</p><p id="603f" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">看看Home.js，注意<strong class="iz hu">主席</strong>是如何绑定到UI的:</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="c569" class="ks kt ht ko b fv ku kv l kw kx">//Home.js</span><span id="e56f" class="ks kt ht ko b fv ln kv l kw kx">render() {<br/>    ...<br/>    return (<br/>      ...<br/>        &lt;p&gt;&lt;strong&gt;chairperson&lt;/strong&gt;: &lt;ContractData contract="Ballot" method="chairperson" /&gt;&lt;/p&gt;<br/>      ...<br/>    )<br/>}</span></pre><p id="34f7" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果你检查页面，并查看react选项卡(假设你的chrome中安装了React扩展)，注意到在我们的home组件的props中有<strong class="iz hu">选票</strong>，在它里面有<strong class="iz hu">主席</strong>:</p><figure class="ke kf kg kh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff mj"><img src="../Images/50a6d22737a5d7d0531b048c79d50172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKjHcYD835LTo0OdedE7hQ.png"/></div></div></figure><p id="df6a" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">所以从理论上讲，如果我们将提议绑定到UI中，我们应该能够用它来填充HighCharts😼。</p><blockquote class="md me mf"><p id="419e" class="ix iy km iz b ja jb jc jd je jf jg jh mg jj jk jl mh jn jo jp mi jr js jt ju hm dt translated">让我们测试一下，好吗？</p></blockquote><p id="4df6" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在Home.js中，将提议函数绑定到UI中:</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="06bc" class="ks kt ht ko b fv ku kv l kw kx">//Home.js</span><span id="d4e9" class="ks kt ht ko b fv ln kv l kw kx">render() {<br/>    ...<br/>    <br/>    return (<br/>      ...<br/>      &lt;p&gt;&lt;strong&gt;all proposals&lt;/strong&gt;:&lt;ContractData   contract="Ballot" method="getAllProposal"/&gt;&lt;/p&gt;<br/>         {listItemsProposals}<br/>      &lt;br/&gt;<br/>      ...<br/>   )<br/>}</span></pre><p id="a09f" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在查看页面，提案功能<strong class="iz hu">和</strong>显示出来🙌</p><figure class="ke kf kg kh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff mk"><img src="../Images/c7b8a1be1ad5db1628d27b17f0117165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8n0kT7wdCShaU6_kYS64wQ.png"/></div></div></figure><p id="4c3c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">又到了给我们的排行榜喂食的时候了，还是在Home.js:</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="b082" class="ks kt ht ko b fv ku kv l kw kx">//Home.js</span><span id="5042" class="ks kt ht ko b fv ln kv l kw kx">class Home extends Component {<br/>  state = {<br/>    ...<br/>    proposals: {},<br/>  };</span><span id="a4d4" class="ks kt ht ko b fv ln kv l kw kx">  componentDidMount() {<br/>    this.setProposals();<br/>  }</span><span id="5c41" class="ks kt ht ko b fv ln kv l kw kx">  setProposals() {<br/>    const val = Object.values(this.props.Ballot.getAllProposal);<br/>    var proposals = [], total = 0;<br/>    val[0] &amp;&amp; val[0].value.forEach((v, idx) =&gt; {<br/>      proposals[idx] = parseInt(v[0], 10);<br/>      ...<br/>    })<br/>    this.setState({<br/>      proposals<br/>    })<br/>    ...<br/>  }<br/>  ...</span><span id="1ea7" class="ks kt ht ko b fv ln kv l kw kx">  render() {</span><span id="b68d" class="ks kt ht ko b fv ln kv l kw kx">      const data = this.state.proposals;<br/>      ...</span><span id="da1f" class="ks kt ht ko b fv ln kv l kw kx">      const chartConfig = {<br/>          ...<br/>          series: [{<br/>              data: [{<br/>                  name: 'Proposal#0',<br/>                  color: '#8DC5BF',<br/>                  y: data[0],<br/>                  }, <br/>                  ...<br/>                  ]<br/>      }]}</span><span id="540d" class="ks kt ht ko b fv ln kv l kw kx">      &lt;ReactHighcharts config={chartConfig} /&gt;</span></pre><p id="f54b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">保存并刷新页面，然后…</p><p id="61de" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">不，不管你投多少票，这个州的提案都是0，为什么？</p><p id="7a66" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">哦，这是因为componentDidMount只被调用一次，而且是在你可以对UI进行任何投票之前。所以我们也需要在每次有新道具的时候更新:</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="817d" class="ks kt ht ko b fv ku kv l kw kx">//Home.js<br/>componentDidUpdate(prevProps) {<br/>    if (!isEqual(<br/>      prevProps.Ballot.getAllProposal,<br/>      this.props.Ballot.getAllProposal)<br/>    ) {<br/>      this.setProposals();<br/>    }<br/>}</span></pre><p id="c003" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">应该不错吧？</p><figure class="ke kf kg kh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff ml"><img src="../Images/8d340f1476e7e4bafb068e592d91e654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Yl9vsb0WeopyY6azlsGdA.png"/></div></div></figure><p id="ed61" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">哦不，怎么了？</p><p id="043c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">所以原来我们一直在获得新的道具(记得block time设置为3秒)，为了防止重复重新渲染，有<strong class="iz hu">shouldComponentUpdate</strong>—<strong class="iz hu"/>谢谢反应！</p><pre class="ke kf kg kh fq kn ko kp kq aw kr dt"><span id="0e1a" class="ks kt ht ko b fv ku kv l kw kx">//Home.js<br/>shouldComponentUpdate(nextProps, nextState) {<br/> return !isEqual(nextState, this.state) || !isEqual(nextProps,   this.props);<br/> }</span></pre><p id="8670" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">就是这样！</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><p id="1839" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这个<strong class="iz hu">黑客马拉松</strong>项目是我第一次体验区块链/以太坊/trulle/毛毛雨。</p><p id="4873" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">后端方面，建立一个简单的以太坊网络比我想象的要容易。</p><p id="e1fb" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">就字体端而言，像毛毛雨-反应-组件这样的现成库确实使我们的生活变得简单，但是它在后台的魔力需要一些时间来挖掘。</p><p id="aa13" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们上面提出的解决方案远非完美，但是对于一个<strong class="iz hu">黑客马拉松</strong>项目，我没有太多抱怨。</p><blockquote class="mm"><p id="a2e7" class="mn mo ht bd mp mq mr ms mt mu mv ju ek translated"><a class="ae kc" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="mx my mz na nb iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff mw"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>