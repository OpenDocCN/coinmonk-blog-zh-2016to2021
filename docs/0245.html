<html>
<head>
<title>Lightweight Contracts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">轻量级合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/lightweight-contracts-b738b6e29377?source=collection_archive---------0-----------------------#2018-04-10">https://medium.com/coinmonks/lightweight-contracts-b738b6e29377?source=collection_archive---------0-----------------------#2018-04-10</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/eedf04a2e513b2f3444d31f034d93e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KFnG0Bvzo5TRbF3_AnsyTg.png"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Lightweight Contracts — The Ardor answer to smart contracts. Image credit: Hudson Hintze, Unplash.</figcaption></figure><div class=""/><div class=""><h2 id="349b" class="pw-subtitle-paragraph jf ih ii bd b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw ek translated">聪明合同的热情回答</h2></div><p id="307c" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">查看所有<a class="ae kt" rel="noopener" href="/@lyaffe/lightweight-contracts-articles-49c3032a50da">轻量级合同条款</a></p><p id="d933" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">现有智能合约技术的主要瓶颈之一是，它要求区块链中的每个节点处理每个合约以达到相同的状态。但这真的有必要吗？</p><p id="f136" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">例如，当你在以太坊区块链上将一个晦涩的ERC20令牌从一个地址转移到另一个地址时，所有的<a class="ae kt" href="https://www.ethernodes.org/network/1" rel="noopener ugc nofollow" target="_blank"> 15306 </a>以太坊节点执行这个契约真的很重要吗？发送者、接收者，也许还有一些独立的验证者来执行契约，这难道还不够吗？隐猫繁殖呢？你知道我要去哪里吗？</p><p id="21c9" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">当然，如果契约最终更新了某些状态，例如帐户余额，这些更新必须由整个网络处理，但是如果所有节点不关心其结果，为什么它们需要重新处理整个契约呢？</p><p id="0ee8" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">在Ardor中，我们实现了一种更灵活、更可扩展的不同方法。我们不要求每个节点处理每个契约调用，而是只要求对契约感兴趣的各方处理它，并验证它们是否达到相同的状态。</p><p id="ce54" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">使用这种方法,“合同”代码本身是一个简单的Java类，它被上传到区块链，因此经过了数字签名和时间戳。然而,“契约”的执行仅由选择运行“ContractRunner”插件的节点来执行。</p><p id="7b85" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">契约的输入通常是带有附加消息的事务，该消息标识要执行的契约，并提供可选参数。契约的输出是提交给网络以更新区块链状态的一个或多个事务。合同提交的交易是正常的交易，必须遵守所有现有的协议规则。</p><p id="0cc2" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">换句话说，轻量级契约是实现特定接口的Java代码，存储在区块链上。契约代码由任何想要运行它的人执行，而不是由每个节点执行，并由区块链事务(或每个新块)触发。合同计算的结果作为Ardor支持的任何类型的一个或多个正常交易提交。</p><p id="de2c" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">它能用来做什么？轻量级契约基本上提供了以太坊智能契约所使用的一切，集成了Ardor已经提供的一切。例如重复任务的自动化、财务计算、可预测的随机数、从外部来源注册信息的Oracles等等。所有这些都与现有的内置Ardor硬币交换、资产交换、投票工具、市场、帐户属性、消息等整合在一起。这为依靠现有的内置API特性开发分散式应用程序提供了一个强大的工具。</p><p id="2bb7" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">但是，我们如何确保执行智能合同的人不作弊呢？由于Java类文件存储在区块链上，任何感兴趣的人都可以基于相同的输入执行相同的合同，或者在生产模式下以事务的形式提交输出，或者在批准模式下验证合同提交的事务确实遵循了正确的计算。</p><p id="0ffa" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">轻量级契约支持不同级别的信任。</p><p id="2c3b" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated"><strong class="jz ij">同行评审</strong> —合同作者可以发布Java源代码供同行评审，任何人都可以编译源代码并生成存储在区块链中的完全相同的类文件。即使源代码不是作者发布的，任何人都可以从区块链下载契约类，反编译它，并检查源代码以确保它没有bug或后门。</p><p id="358c" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated"><strong class="jz ij">结果验证— </strong>给定一个合同执行的事务，任何节点都可以执行同一个合同，并根据提供的输入和执行的代码，确认合同提交的事务代表正确的合同输出。这允许节点识别和标记欺诈者，但是不阻止他们的交易被包括在区块链中。对于不代表重大价值转移的简单合同，这就足够了。</p><p id="2357" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated"><strong class="jz ij">账户控制</strong>——运行合同的账户可以通过另一个账户的多重签名或三个账户中的两个账户进行账户控制。每当合约账户提交交易时，控制账户将重复计算。只有当他们达到相同的结果，他们将提交批准交易。</p><p id="51c3" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">示例:一个简单的Hello World契约</p><figure class="ku kv kw kx fq hv"><div class="bz el l di"><div class="ky kz l"/></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Ardor Hello World Lightweight Contract</figcaption></figure><p id="6e83" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">契约首先执行验证，然后组成sendMessage事务，用于向触发契约的消息的发送方帐户发送响应。</p><p id="3bc6" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">注意，这个契约只由选择执行它的节点执行，所以即使它进入无限循环，或者耗尽内存，或者导致堆栈溢出，也只会影响这些节点。它不会导致网络范围的系统问题。在最坏的情况下，这些节点将需要在禁用此契约执行后重新启动。这意味着我们不需要衡量合同的执行情况，也不需要一种类似以太坊的按指令付费的方法。合约账户将只支付其提交交易的交易费。</p><p id="0b2f" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">还要注意，我们的轻量级契约是无状态的，它们只能依赖触发事务提供的输入，存储在区块链上或从外部来源提取。因此，“取消”这些合同是没有问题的。只要运行合同的帐户的密码仍然可用，在发生灾难时就可以手动恢复资金(请注意，它们仍然受帐户控制规则的约束)</p><p id="7577" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">轻量级合同的黑客攻击仍然是一个问题。例如，如果有人能够利用DAO风格的错误，并导致合同使用有效的交易将资金发送到他们的帐户，这仍然可以工作。因此，对于非常敏感的高价值合同，可以添加人工验证步骤作为账户控制。</p><blockquote class="la"><p id="c05f" class="lb lc ii bd ld le lf lg lh li lj ks ek translated"><a class="ae kt" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="ll lm ln lo lp hv fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff lk"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><p id="c22d" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">因为我们的轻量级契约是用Java开发的，所以它们可以用最好的、标准的、可用的开发工具(IntelliJ、Eclipse、Netbeans)来开发，它们可以在testnet上调试，用JUnit进行单元测试，并且通常使用最好的编程工具。我们的合同可以使用用于数学、经济或物理计算的第三方基于Java的库的无限存储库，以便与使用几乎任何技术的任何外部系统进行接口。当然，您依赖的外部代码越多，您的信任就越少，因此这是应用程序开发人员需要考虑的一个权衡。</p><p id="62ee" class="pw-post-body-paragraph jx jy ii jz b ka kb jj kc kd ke jm kf kg kh ki kj kk kl km kn ko kp kq kr ks hm dt translated">总之，在已经投入了几十个开发人员年的热情的内置功能的基础上，我们的轻量级合同提供了一个灵活性和自动化层，这使得能够构建更加复杂的服务器端区块链应用程序。</p><figure class="ku kv kw kx fq hv"><div class="bz el l di"><div class="lq kz l"/></div></figure></div></div>    
</body>
</html>