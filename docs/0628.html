<html>
<head>
<title>Get a screen for your Google Home using Raspberry Pi and Dialogflow (Chromecast alternative) [part-2]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Raspberry Pi和Dialogflow (Chromecast替代品)为您的Google Home获得一个屏幕[第2部分]</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/get-a-screen-to-your-google-home-using-raspberry-pi-and-dialogflow-chromecast-alternative-59050bafbcd5?source=collection_archive---------5-----------------------#2018-05-27">https://medium.com/coinmonks/get-a-screen-to-your-google-home-using-raspberry-pi-and-dialogflow-chromecast-alternative-59050bafbcd5?source=collection_archive---------5-----------------------#2018-05-27</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="f1d8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我之前的文章中，我们已经看到了如何设置dialogflow来让Google Home理解和解析我们的查询。现在，我们将设置我们的后端服务，让这些查询在我们的raspberry pi上打开视频和网站。<br/>剩余设置<br/>数据策略- &gt;节点服务器- &gt;代码</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/e0ce140dcd0750c5bf27827f2b4b5c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jWJduHDFCOLStGBWcvjYgg.jpeg"/></div></div></figure><p id="fba3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为什么我们需要数据透明度？因为Google Home连接到了可以通过互联网访问的webhooks。尽管我们的GHome连接到本地网络，但查询来自Google云服务，因此，需要将我们的服务器移植到互联网上。我们可以使用dataplicity服务轻松地将我们的raspberry pi放在互联网上，而不用担心这个问题。</p><p id="3a57" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">首先，连接到raspberry pi【直接用HDMI甚至SSh】<br/>从终端中的以下命令获取最新的nodejs运行时。</p><pre class="jp jq jr js fq ka kb kc kd aw ke dt"><span id="98e6" class="kf kg ht kb b fv kh ki l kj kk"><em class="kl">curl -sL </em><a class="ae km" href="https://deb.nodesource.com/setup_8.x" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://deb.nodesource.com/setup_8.x</em></a><em class="kl"> | sudo -E bash -</em></span></pre><p id="634b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后使用安装它</p><pre class="jp jq jr js fq ka kb kc kd aw ke dt"><span id="f243" class="kf kg ht kb b fv kh ki l kj kk">sudo apt-get install -y nodejs</span></pre><p id="739e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后创建一个新文件</p><pre class="jp jq jr js fq ka kb kc kd aw ke dt"><span id="a35e" class="kf kg ht kb b fv kh ki l kj kk">nano webserver.js</span></pre><p id="81d7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后，将下面的代码插入文件中</p><p id="1993" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在这里，为了演示，我只使用了两个网站(谷歌，youtube)。人们可以编辑代码并进行相应的更改。</p><pre class="jp jq jr js fq ka kb kc kd aw ke dt"><span id="bf23" class="kf kg ht kb b fv kh ki l kj kk">bodyParser = require(‘body-parser’);<br/>var exec = require(‘child_process’).exec;<br/>var express = require(‘express’);<br/>var app = express();<br/>app.use(bodyParser.json());<br/>app.post(‘/’,function(req,res){<br/>let variable =req.body.queryResult.parameters.website;<br/> exec(“midori www.”+variable+”.com”, function(error, stdout, stderr) {<br/> console.log(“stdout: “ + stdout);<br/> console.log(“stderr: “ + stderr);<br/> if (error !== null) {<br/> console.log(“exec errror: “ + error);<br/> }<br/> });<br/>return res.end();<br/>});<br/>app.listen(80);</span></pre><p id="7177" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">上面的代码只是为了解释这个概念。我在代码中使用了midori浏览器，因为chromium不支持远程命令。我们也可以使用firefox。[在编写代码之前，我们必须在npm的帮助下安装body-parser、express模块]</p><p id="9d3e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">记住，我们应该只监听端口80，因为dataplicity只能转发raspberry pi的端口80。</p><p id="0492" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我们需要设置数据政策</p><p id="c64c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">转到Dataplicity网站并创建您的帐户，然后按照说明将raspberry pi添加到仪表板。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff kn"><img src="../Images/f61ce8703a21c2c9a1f33f803f17f159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-JSIV8jUvIYT-t66xyLNg.png"/></div></div></figure><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/bdb3a4b5c864a3472deab661ad631221.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*ch-Jwn348RarMb5sYqwGrA.png"/></div></figure><p id="f0b8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">之后，从设备列表中打开raspberry pi并选择wormhole来获得raspberry pi的唯一IP地址，我们可以在该地址上部署我们的节点服务器。</p><p id="6efa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将IP地址复制到剪贴板。</p><p id="3cee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在从raspberry pi终端运行代码</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kp"><img src="../Images/54513b65b079dafc089b8bbe20014053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*Je4nB24BC8NY4Hhwuhn2Yg.png"/></div></figure><pre class="jp jq jr js fq ka kb kc kd aw ke dt"><span id="7db7" class="kf kg ht kb b fv kh ki l kj kk">sudo node webserver.js</span></pre><p id="6f14" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果它显示任何关于显示或协议的错误…执行</p><pre class="jp jq jr js fq ka kb kc kd aw ke dt"><span id="26fd" class="kf kg ht kb b fv kh ki l kj kk">xhost +</span></pre><p id="420d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在返回到dialogflow，并点击履行部分</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff kq"><img src="../Images/0b3be0e5937f21358610d01c247573b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WYXnUlSJ06Ld1uHpBGbkgQ.png"/></div></div></figure><p id="b115" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在上面的空白处输入来自dataplicity的IP地址或url。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff kr"><img src="../Images/0a00600fb4d165973cf65762db262565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oc4cRh04e_Bzs-DzKb3anA.png"/></div></div></figure><p id="9ea7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，转到intents部分，从fulfillment选项卡启用webhook调用。</p><p id="1afc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">就是这样！现在回到你的谷歌主页，检查它是如何工作的！</p><p id="4cf7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下次见，黑客快乐:)</p></div></div>    
</body>
</html>