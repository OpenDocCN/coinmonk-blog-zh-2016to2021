<html>
<head>
<title>Machine Learning Tutorial #1: Preprocessing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习教程#1:预处理</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/machine-learning-tutorial-1-preprocessing-d90198e37577?source=collection_archive---------3-----------------------#2018-08-05">https://medium.com/coinmonks/machine-learning-tutorial-1-preprocessing-d90198e37577?source=collection_archive---------3-----------------------#2018-08-05</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="ee91" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">主题:数据清理、目标变量选择、特征提取、缩放、降维</h2></div><p id="1596" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在这个机器学习教程中，我将探索定义一个典型的机器学习项目的4个步骤:预处理、学习、评估和预测(部署)。在第一部分中，我将完成预处理步骤。本系列其他教程:#1预处理(本文)，<a class="ae ke" rel="noopener" href="/coinmonks/machine-learning-tutorial-2-training-f6f735830838"> #2训练</a>，<a class="ae ke" rel="noopener" href="/@adam5ny/machine-learning-tutorial-3-evaluation-a157f90914c9"> #3评测</a>，<a class="ae ke" rel="noopener" href="/@adam5ny/machine-learning-tutorial-4-deployment-79764123e9e1"> #4预测</a></p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kf"><img src="../Images/688f0991ea5b97411e4be5f98ba6db22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iPgIcpnc-nzkigs6RaTZBw.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Machine Learning project overview. Author: Adam Novotny</figcaption></figure><p id="0136" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我将使用股票价格数据作为主要数据集。这是本教程的一个好选择，原因如下:</p><ul class=""><li id="77c2" class="kv kw ht jk b jl jm jo jp jr kx jv ky jz kz kd la lb lc ld dt translated">根据定义，数据集是公开的，可以很容易地从多个来源下载，因此任何人都可以复制这项工作。</li><li id="9463" class="kv kw ht jk b jl le jo lf jr lg jv lh jz li kd la lb lc ld dt translated">并非所有的特征都可以从源中立即获得，需要使用领域知识来提取，类似于现实生活。</li><li id="3c60" class="kv kw ht jk b jl le jo lf jr lg jv lh jz li kd la lb lc ld dt translated">这个项目的<strong class="jk hu">结果是高度不确定的</strong>，它再次模拟了现实生活。每年都有数十亿美元投入到股票价格预测问题上，而且绝大多数项目都失败了。因此，本教程不是关于创造一个神奇的印钞机；它是关于复制机器学习工程师在项目中可能拥有的经验。</li></ul><p id="ccdc" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">所有代码都位于下面的<a class="ae ke" href="https://github.com/adam5ny/blogs/tree/master/ml-preprocessing" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中。文件“preprocessing.py”驱动分析。建议使用Python 3.6，该文件包含设置所有必要依赖项的说明。</p></div><div class="ab cl lj lk hb ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hm hn ho hp hq"><p id="655b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">首先，我们需要下载数据集。我会有些武断地选择微软股票数据(来源:<a class="ae ke" href="https://finance.yahoo.com/quote/MSFT/history?p=MSFT" rel="noopener ugc nofollow" target="_blank">雅虎财经</a>)。我将使用完整的可用历史，包括撰写本文时的1986年3月13日至2018年7月30日。在此期间，股价表现如下:</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff lq"><img src="../Images/a19fb0413612b15c71e5cfd9fbcdc934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lR8eaHKYLjtKsZY_J19pog.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">MSFT stock price. Source <a class="ae ke" href="https://finance.yahoo.com/chart/MSFT" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/chart/MSFT</a></figcaption></figure><p id="66d7" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">价格变动很有趣，因为它至少表现出两种行为模式:</p><ul class=""><li id="a3d9" class="kv kw ht jk b jl jm jo jp jr kx jv ky jz kz kd la lb lc ld dt translated">直到2000年科技股崩盘前的大幅上涨</li><li id="0063" class="kv kw ht jk b jl le jo lf jr lg jv lh jz li kd la lb lc ld dt translated">2000年以来的横盘整理</li></ul><p id="7634" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这导致了许多有趣的机器学习复杂性，例如训练和测试数据的采样。</p></div><div class="ab cl lj lk hb ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hm hn ho hp hq"><h1 id="5abb" class="lr ls ht bd lt lu lv lw lx ly lz ma mb iz mc ja md jc me jd mf jf mg jg mh mi dt translated">数据清理</h1><p id="3b24" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr ml jt ju jv mm jx jy jz mn kb kc kd hm dt translated">经过一些简单的操作并将csv数据加载到pandas DataFrame后，我们得到了以下数据集，其中开盘价、最高价、最低价和收盘价代表每个日期的价格和交易的股票总数。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mo"><img src="../Images/d4f99cfacd489cc50445e97b32345490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*psQ_9EoBHpiN78QgreAVOQ.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Raw dataset includes columns: date, prices (open, high, low, close), trading volume</figcaption></figure><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff mp"><img src="../Images/f96afad45b8e37aa6d4de8acb6632990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pF4V5GC6b2vfC-koQkAynw.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Raw dataset includes columns: date, prices (open, high, low, close), trading volume</figcaption></figure><p id="b371" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="jk hu">缺失值</strong>不存在，我通过运行以下命令确认了这一点:</p><pre class="kg kh ki kj fq mq mr ms mt aw mu dt"><span id="d60d" class="mv ls ht mr b fv mw mx l my mz">missing_values_count = df.isnull().sum()</span></pre><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff na"><img src="../Images/813dfe4c02ab8940ad055a40a9699e4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RxQtAFDbviXDbYcxU8j02Q.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">No missing values in dataset</figcaption></figure><p id="9579" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">离群值是我需要解决的下一个话题。这里要理解的关键点是，我们的数据集现在包括价格，但价格不是我试图预测的指标，因为它们是以绝对值衡量的，因此更难跨时间和其他资产进行比较。在上表中，第一个可用价格约为0.07美元，而最后一个价格为105.37美元。</p><p id="00ef" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">相反，我将尝试预测每日回报。例如，在第二个交易日结束时，回报率为+3.6% (0.073673/0.071132)。因此，我将创建一个return列，并使用它来分析可能的异常值。</p><p id="0208" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">数据集中出现的5个最小日收益率如下:</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nb"><img src="../Images/d10b2f3d64afe2cc9f2b293124c7c925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-FluO_dSIB7Gc8Rlvgry_w.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">5 smallest daily returns</figcaption></figure><p id="13ab" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">和5个最大的每日回报:</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nc"><img src="../Images/cf065ca332913c519645b64c8d99019e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CvJuQYGojLfLlxpnm9Ut1w.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">5 largest daily returns</figcaption></figure><p id="2962" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">最负的回报是-30%(指数405)，最大的是20%(指数3692)。通常，这里需要对异常值进行进一步的特定领域的分析。现在我将跳过它，并假设本教程只是出于说明的目的概述了这个过程。总的来说，考虑到1987年和2000年发生的市场崩溃与极度波动相关，这些数据似乎是有道理的。</p><p id="fb94" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">对于开放、高、低和体积柱将需要相同的分析。不可否认，数据清理有点学术，因为雅虎财经是一个非常广泛使用和可靠的来源。理解数据仍然是一个有用的练习。</p><h1 id="bf71" class="lr ls ht bd lt lu nd lw lx ly ne ma mb iz nf ja md jc ng jd mf jf nh jg mh mi dt translated">目标变量选择</h1><p id="6f6b" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr ml jt ju jv mm jx jy jz mn kb kc kd hm dt translated">我们需要定义我们的ML算法将试图预测什么。具体来说，我们将预测第二天的回报。这里回报的时机很重要，所以我们不会错误地预测今天或昨天的回报。将明天的回报定义为我们的目标变量的公式如下:</p><pre class="kg kh ki kj fq mq mr ms mt aw mu dt"><span id="58f3" class="mv ls ht mr b fv mw mx l my mz">df["y"] = df["return"].shift(-1)</span></pre><h1 id="5ff8" class="lr ls ht bd lt lu nd lw lx ly ne ma mb iz nf ja md jc ng jd mf jf nh jg mh mi dt translated">特征抽出</h1><p id="0036" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr ml jt ju jv mm jx jy jz mn kb kc kd hm dt translated">现在，我将转向价格、回报和交易量的一些简单转换，以<a class="ae ke" href="https://en.wikipedia.org/wiki/Feature_extraction" rel="noopener ugc nofollow" target="_blank">提取ML算法可以使用的特征</a>。金融从业者已经开发了100多个这样的功能，但我只展示几个。对冲基金在这一步花费了绝大部分时间，因为ML算法通常只有在数据可用时才有用。“垃圾进，垃圾出”。</p><p id="b7cd" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们可以考虑的一个特征是今天的收盘价如何与5个交易日(一个日历周)前的收盘价相关联。我把这个特征称为“5d_momentum”:</p><pre class="kg kh ki kj fq mq mr ms mt aw mu dt"><span id="b7b6" class="mv ls ht mr b fv mw mx l my mz">df[“5d_momentum”] = df[“close”] / df[“close”].shift(5)</span></pre><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff ni"><img src="../Images/6f99996deabf3dd76af8c0176f891742.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4dWC4F1sqjmpW5dohmF-Mg.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">New 5d_momentum feature</figcaption></figure><p id="8ac7" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">一个典型的趋势跟踪特征是<a class="ae ke" href="https://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:moving_average_convergence_divergence_macd" rel="noopener ugc nofollow" target="_blank"> MACD </a>(移动平均线收敛/发散振荡器)。熊猫的优势在这里大放异彩，因为只用4行代码就可以创建MACD。MACD指标的图表如下。在下图中，典型的买入信号是穿过橙色线的蓝色“macd_line ”,代表“macd_line”的9日指数移动平均线。反之，则代表卖出信号。</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nj"><img src="../Images/e3b20e0c18923202f4ab81766a7b88a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cA6MrDLu1Fuwd4pIDoS0fQ.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">MACD of stock price</figcaption></figure><p id="bbfc" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">上面提到的Github repo中的python代码“generate_features.py”包含了我们可能会考虑的其他特性。例如:</p><ul class=""><li id="772f" class="kv kw ht jk b jl jm jo jp jr kx jv ky jz kz kd la lb lc ld dt translated"><a class="ae ke" href="https://www.investopedia.com/articles/active-trading/052014/how-use-moving-average-buy-stocks.asp" rel="noopener ugc nofollow" target="_blank">趋势:移动平均线</a></li></ul><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nj"><img src="../Images/de4c491a7b6be71b8e4cc08b2ccb8de1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ip_ErJJ73742mxoNoGknA.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">MSFT Moving Average 50 day — 200 day</figcaption></figure><ul class=""><li id="4cce" class="kv kw ht jk b jl jm jo jp jr kx jv ky jz kz kd la lb lc ld dt translated"><a class="ae ke" href="https://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:parabolic_sar" rel="noopener ugc nofollow" target="_blank">趋势:抛物线SAR </a></li></ul><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nj"><img src="../Images/c53c8f27a0da761a98dab65ff96b2b91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uRA6nhA4QpXoqhl6dfECrg.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">MSFT SAR</figcaption></figure><ul class=""><li id="9252" class="kv kw ht jk b jl jm jo jp jr kx jv ky jz kz kd la lb lc ld dt translated"><a class="ae ke" href="https://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:stochastic_oscillator_fast_slow_and_full" rel="noopener ugc nofollow" target="_blank">动量:随机振荡器</a></li></ul><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff nj"><img src="../Images/30e26587066dc9f2556212c3b7d5f1db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qt0JrOJuvdUBelJ_ddGO1g.png"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">MSFT Stochastic Oscillator</figcaption></figure><ul class=""><li id="c0cd" class="kv kw ht jk b jl jm jo jp jr kx jv ky jz kz kd la lb lc ld dt translated"><a class="ae ke" href="https://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:commodity_channel_index_cci" rel="noopener ugc nofollow" target="_blank">动量:商品通道指数(CCI) </a></li><li id="c1c4" class="kv kw ht jk b jl le jo lf jr lg jv lh jz li kd la lb lc ld dt translated"><a class="ae ke" href="https://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:relative_strength_index_rsi" rel="noopener ugc nofollow" target="_blank">动量:相对强度指数</a></li><li id="d5e8" class="kv kw ht jk b jl le jo lf jr lg jv lh jz li kd la lb lc ld dt translated"><a class="ae ke" href="https://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:bollinger_bands" rel="noopener ugc nofollow" target="_blank">波动性:布林线</a></li><li id="506c" class="kv kw ht jk b jl le jo lf jr lg jv lh jz li kd la lb lc ld dt translated"><a class="ae ke" href="https://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:average_true_range_atr" rel="noopener ugc nofollow" target="_blank">波动率:平均真实范围</a></li><li id="579e" class="kv kw ht jk b jl le jo lf jr lg jv lh jz li kd la lb lc ld dt translated"><a class="ae ke" href="https://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:on_balance_volume_obv" rel="noopener ugc nofollow" target="_blank">卷:论平衡卷(OBV) </a></li><li id="0a01" class="kv kw ht jk b jl le jo lf jr lg jv lh jz li kd la lb lc ld dt translated"><a class="ae ke" href="https://stockcharts.com/school/doku.php?id=chart_school:technical_indicators:chaikin_oscillator" rel="noopener ugc nofollow" target="_blank">音量:柴金振荡器</a></li></ul><p id="7e4e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在特征提取过程的最后，我们有以下特征:</p><pre class="kg kh ki kj fq mq mr ms mt aw mu dt"><span id="8c1f" class="mv ls ht mr b fv mw mx l my mz">['return', 'close_to_open', 'close_to_high', 'close_to_low', 'macd_diff', 'ma_50_200', 'sar', 'stochastic_oscillator', 'cci', 'rsi', '5d_volatility', '21d_volatility', '60d_volatility', 'bollinger', 'atr', 'on_balance_volume', 'chaikin_oscillator']</span></pre><h1 id="ad5c" class="lr ls ht bd lt lu nd lw lx ly ne ma mb iz nf ja md jc ng jd mf jf nh jg mh mi dt translated">抽样</h1><p id="65f7" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr ml jt ju jv mm jx jy jz mn kb kc kd hm dt translated">我们需要将数据分成训练和测试两部分。我再怎么强调测试数据集也不应该用在学习阶段。它将仅用于评估步骤，以便绩效指标完全独立于培训，并代表实际绩效的无偏估计。</p><p id="bf12" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">通常，我们可以随机抽样测试数据，但时间序列数据通常不太适合随机抽样。原因是这会影响学习过程。例如，随机化可能会产生一种情况，即在学习步骤中使用2005年1月1日的数据点来预测2003年1月1日的回报率。</p><p id="54b6" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">因此，我将选择一种更简单的方法来对数据进行采样，并将前7000个样本用作学习的训练数据集，其余962个样本用作评估的测试数据集。</p><p id="0562" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">两个数据集都将保存为csv文件，因此我们通过存储4个文件(MSFT_X_learn.csv，MSFT_y_learn.csv，MSFT_X_test.csv，MSFT_y_test.csv)来结束ML教程的这一部分。这些将在本教程的后续步骤中使用。</p><h1 id="af50" class="lr ls ht bd lt lu nd lw lx ly ne ma mb iz nf ja md jc ng jd mf jf nh jg mh mi dt translated">缩放比例</h1><p id="a277" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr ml jt ju jv mm jx jy jz mn kb kc kd hm dt translated">特征缩放用于减少学习时间。这通常适用于<a class="ae ke" href="https://en.wikipedia.org/wiki/Feature_scaling#Application" rel="noopener ugc nofollow" target="_blank">随机梯度下降和SMV </a>。</p><p id="03f6" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">开源<a class="ae ke" href="http://scikit-learn.org/stable/index.html" rel="noopener ugc nofollow" target="_blank"> sklearn </a>包将用于大多数额外的ML应用，所以我将在这里开始使用它来<a class="ae ke" href="http://scikit-learn.org/stable/modules/preprocessing.html#standardization-or-mean-removal-and-variance-scaling" rel="noopener ugc nofollow" target="_blank">缩放所有特性</a>以具有零均值和单位方差:</p><pre class="kg kh ki kj fq mq mr ms mt aw mu dt"><span id="e9ef" class="mv ls ht mr b fv mw mx l my mz">from sklearn import preprocessing<br/>scaler_model = preprocessing.StandardScaler().fit(X_train)<br/>X_train_scaled = scaler_model.transform(X_train)<br/>X_test_scaled = scaler_model.transform(X_test)</span></pre><p id="5d09" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">重要的是，在修改特征之前进行数据采样，以避免测试数据泄漏的任何训练。</p><h1 id="bcc6" class="lr ls ht bd lt lu nd lw lx ly ne ma mb iz nf ja md jc ng jd mf jf nh jg mh mi dt translated">降维</h1><p id="2d55" class="pw-post-body-paragraph ji jj ht jk b jl mj iu jn jo mk ix jq jr ml jt ju jv mm jx jy jz mn kb kc kd hm dt translated">在这个阶段，我们的数据集17的特征。特征的数量对学习的速度有很大的影响。我们可以使用多种技术来减少特性的数量，以便只保留最“有用”的特性。</p><p id="a169" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">许多对冲基金在这个阶段会处理上百个特征，因此降维至关重要。在我们的例子中，我们只有17个说明性的特征，所以我将把它们都保存在数据集中，直到我探索不同算法的学习时间。</p><p id="ed6e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">然而，出于好奇，我将执行主成分分析<a class="ae ke" href="http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html" rel="noopener ugc nofollow" target="_blank"> (PCA) </a>来了解我们可以从数据集创建多少个特征，而不会失去有意义的解释能力。</p><pre class="kg kh ki kj fq mq mr ms mt aw mu dt"><span id="be2f" class="mv ls ht mr b fv mw mx l my mz">from sklearn.decomposition import PCA<br/>sk_model = PCA(n_components=10)<br/>sk_model.fit_transform(features_ndarray)<br/>print(sk_model.explained_variance_ratio_.cumsum())<br/># [0.30661571 0.48477408 0.61031358 0.71853895 0.78043556 0.83205298<br/> 0.8764804  0.91533986 0.94022672 0.96216244]</span></pre><p id="35bc" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">前8个特征解释了91.5%的数据差异。主成分分析的缺点是新特征位于低维空间，因此它们不再符合现实生活中的概念。例如，第一个原始特征可以是我在上面推导的“macd_line”。在PCA之后，第一个特征解释了31%的方差，但是我们不再有任何逻辑描述该特征在现实生活中代表什么。</p><p id="e475" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">现在，我将保留所有的特征17个原始特征，但注意，如果算法的学习时间太慢，PCA将是有帮助的。</p><p id="d649" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">本系列其他教程:#1预处理(本文)，<a class="ae ke" rel="noopener" href="/coinmonks/machine-learning-tutorial-2-training-f6f735830838"> #2训练</a>，<a class="ae ke" rel="noopener" href="/@adam5ny/machine-learning-tutorial-3-evaluation-a157f90914c9"> #3评测</a>，<a class="ae ke" rel="noopener" href="/@adam5ny/machine-learning-tutorial-4-deployment-79764123e9e1"> #4预测</a></p><p id="b4fb" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">作者网址:<a class="ae ke" href="https://www.adamnovotny.com/" rel="noopener ugc nofollow" target="_blank">adamnovotny.com</a></p></div></div>    
</body>
</html>