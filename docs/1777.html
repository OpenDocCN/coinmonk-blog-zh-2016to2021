<html>
<head>
<title>EOS API Best Practices for dApps and Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向dApps和应用的EOS API最佳实践</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/eos-api-best-practices-for-dapps-and-apps-2c5d295b06d5?source=collection_archive---------2-----------------------#2018-11-13">https://medium.com/coinmonks/eos-api-best-practices-for-dapps-and-apps-2c5d295b06d5?source=collection_archive---------2-----------------------#2018-11-13</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="e7a7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于钱包、脚本、应用和dApps的开发者来说，了解如何正确设置他们的API函数以从EOS链获取信息是很重要的。我有以下关于如何设置故障转移/回退服务器的信息。</p><h2 id="d8e8" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">EOS API的背景</h2><p id="f473" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">EOS有一个内置的API插件，用于主节点软件nodeos。有多种过滤器可应用于通过此流程过滤的交易历史记录。运行具有完整事务历史的API节点的成本非常高。目前，11月2日，nodeos插件上完整历史的RAM使用量为800GB，11月13日超过了1.2 TB。具有这种RAM容量的服务器每台成本超过3万美元，但是随着内存使用量的增长，运行nodeos是不可持续的。所以插件正在被分块重构。一个人的开发团队能够更好地与更具可伸缩性的数据库平台(如postgresql)集成。</p><h2 id="202b" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">不良做法</h2><p id="3fea" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">目前有太多人们硬编码一个API的例子(最常见的是Greymass)。这不是一个好的做法。不存在100%正常运行的API节点。我见过很多依赖于Greymass的应用程序和脚本，它们的节点会不时出现故障。(实际上，当我写这篇文章的时候，它已经在今天早上下线了。)</p><h2 id="8094" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">EOS API代理</h2><p id="90cc" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated"><a class="ae ko" href="http://blockmatrix.network" rel="noopener ugc nofollow" target="_blank"> Blockmatrix </a>团队为EOS API节点创建了一个优秀的<a class="ae ko" href="https://eosnode.tools/proxy" rel="noopener ugc nofollow" target="_blank"> geo-DNS冗余代理。代理会自动将请求路由到能够处理这些请求的最佳服务器，在过去的两周内，他已经处理了超过12亿个请求。</a></p><figure class="kq kr ks kt fq ku fe ff paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="fe ff kp"><img src="../Images/63060cae293b3e7f5e5d89d83bae5d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jz3TSwJdLbRQGMjNwYgHNQ.jpeg"/></div></div></figure><h2 id="70cb" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">配置示例:用于EOS API故障转移的Javascript函数</h2><p id="7d6d" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">下面是一个例子，说明我们如何建议在js函数中为API调用设置故障转移/回退。我推荐使用的主要API是<a class="ae ko" href="https://proxy.eosnode.tools" rel="noopener ugc nofollow" target="_blank">https://proxy . eosnode . tools</a>——其次应该至少有一个后备API节点(最好是另一个代理)。</p><p id="ebc8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在本例中，我将后备代理引用到了<a class="ae ko" href="https://sheos.org" rel="noopener ugc nofollow" target="_blank"> shEOS </a>高可用性裸机服务器，但是您可以使用EOS Nation report 中列出的<a class="ae ko" href="https://validate.eosnation.io/reports/endpoints.html" rel="noopener ugc nofollow" target="_blank">任何节点。</a></p><pre class="kq kr ks kt fq lb lc ld le aw lf dt"><span id="eaf4" class="jo jp ht lc b fv lg lh l li lj">EosRequest("/v1/chain/get_info", "<a class="ae ko" href="https://proxy.eosnode.tools" rel="noopener ugc nofollow" target="_blank">https://proxy.eosnode.tools</a>", "<a class="ae ko" href="https://api.proxy1a.sheos.org/" rel="noopener ugc nofollow" target="_blank">https://api.proxy1a.sheos.org/</a>");</span><span id="c5eb" class="jo jp ht lc b fv lk lh l li lj">function EosRequest(path, url, fallback, retry = false) {<br/>    let query = retry === false ? url : fallback;<br/>    fetch(query + path)<br/>        .then(function(response) {<br/>            if (!response.ok) {<br/>                if (retry === true) {<br/>                    throw Error(response.statusText);<br/>                } else {<br/>                    return EosRequest(path, url, fallback, true);<br/>                }<br/>            }<br/>            return response;<br/>        }).then(function(response) {<br/>            response.json().then(function(data) {<br/>                console.log(data)<br/>            });<br/>        }).catch(function(error) {<br/>            if (retry === true) {<br/>                console.log(error);<br/>            } else {<br/>                return EosRequest(path, url, fallback, true);<br/>            }<br/>        });<br/>}</span></pre><p id="d385" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">有任何问题或意见吗？你可以在推特上找到我。</p><blockquote class="ll"><p id="8da3" class="lm ln ht bd lo lp lq lr ls lt lu jn ek translated"><a class="ae ko" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="lw lx ly lz ma ku fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff lv"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>