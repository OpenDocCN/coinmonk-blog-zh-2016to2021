<html>
<head>
<title>Build your First AI game bot using OpenAI Gym, Keras, TensorFlow in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中使用OpenAI Gym、Keras、TensorFlow构建您的第一个人工智能游戏机器人</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/build-your-first-ai-game-bot-using-openai-gym-keras-tensorflow-in-python-50a4d4296687?source=collection_archive---------0-----------------------#2018-10-19">https://medium.com/coinmonks/build-your-first-ai-game-bot-using-openai-gym-keras-tensorflow-in-python-50a4d4296687?source=collection_archive---------0-----------------------#2018-10-19</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/07ad5ad2057964e6f3ac3c30f841da76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8QE4ZC_zKGG44jLa.png"/></div></div></figure><p id="690b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这篇帖子将解释关于<a class="ae jz" href="https://gym.openai.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jd hu"> OpenAI Gym </strong> </a>的内容，并向您展示如何应用<strong class="jd hu">深度学习</strong>来玩一个<strong class="jd hu">侧手翻</strong>游戏。</p><p id="f009" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">每当我听到关于谷歌DeepMind的AlphaGo的故事，我都会想，我希望我能建造一个类似的东西，至少是小规模的。我想上帝听到了我的愿望，他给我指明了方向😃。</p><p id="c0d1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最近了解了<strong class="jd hu"> OpenAI健身房</strong>和<strong class="jd hu">强化学习</strong>。我开始阅读这些，并爱上了它。我现在不使用强化学习来构建游戏机器人。我一定会为未来打算的。</p><p id="76bd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们需要建造一个游戏机器人，这意味着它需要做我们在玩游戏时做的事情。如果我们对一个游戏没有任何线索，在这种情况下我们通常会怎么做？</p><p id="d394" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们会问我们的朋友或阅读游戏说明，以了解在玩游戏时我们需要按什么键，对吗？</p><p id="6319" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后，我们开始玩游戏，观察游戏，根据当前的阶段或状态，我们按下按钮，如向上或向下或向右或向后或其他。</p><p id="e197" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这意味着我们的游戏机器人应该知道游戏的当前<strong class="jd hu">状态/阶段</strong>并且根据当前<strong class="jd hu">状态</strong>机器人需要按一个按钮意味着它需要执行某个<strong class="jd hu">动作</strong>。如果这是一个好的举措，那么我们将得到好的结果意味着<strong class="jd hu">积极的</strong> <strong class="jd hu">奖励</strong>如果不是，那么我们将得到不好的结果意味着<strong class="jd hu">消极的奖励</strong>。机器人每次都应该根据当前的状态重复这些动作，直到我们赢得或输掉游戏，也就是说直到我们完成游戏。</p><p id="38dd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">你可能想知道Bot是如何像我们一样了解游戏<strong class="jd hu">环境</strong>的当前状态的。我们通过眼睛观察比赛意味着我们应该实现计算机视觉来训练我们的机器人还是什么？</p><p id="914b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里<strong class="jd hu"> OpenAI健身房</strong>将帮助我们。OpenAI健身房会给我们当前的<strong class="jd hu">状态</strong>细节游戏手段<strong class="jd hu">环境</strong>。它将根据当前的<strong class="jd hu">状态</strong>/情况给我们句柄来执行我们想要执行的<strong class="jd hu">动作</strong>。</p><p id="9cb4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我假设你的系统中有Keras、TensorFlow和Python，如果没有，请先阅读<a class="ae jz" rel="noopener" href="/@ashok.tankala/build-your-first-deep-learning-neural-network-model-using-keras-tensorflow-in-python-a3e76a6b3ccb">这篇文章</a>。我们需要安装<strong class="jd hu">开放式健身房</strong>。安装在下面运行命令</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="8716" class="kj kk ht kf b fv kl km l kn ko"># If you are using python2 then use this command 'pip3 install gym'<br/>pip3 install gym</span></pre><p id="84de" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">每当我们学习一门新的语言时，我们就从“你好，世界”节目开始，通常是这样的。每当有人开始学习开放体操时，他们就从<strong class="jd hu">钢管舞</strong>游戏开始。在这篇文章中，我们将集中讨论这个游戏。</p><figure class="ka kb kc kd fq iu fe ff paragraph-image"><div class="fe ff kp"><img src="../Images/aed6d6863d1904436866555c95f4f2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*T-8ja_Ko04TVBzo7.gif"/></div></figure><p id="ec32" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">OpenAI Gym为我们提供了一个游戏的所有细节或信息及其当前状态。它也给了我们句柄去做我们想要执行的动作，以继续玩游戏，直到游戏完成。</p><p id="3cbc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在写代码之前，让我们先了解一些关于OpenAI Gym的词汇。</p><p id="2211" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">环境(environment)——它就像一个对象或界面，我们或我们的游戏机器人(代理)可以通过它与游戏进行交互，并获得当前状态的细节等。有几种不同的游戏或环境可供选择。你可以在这里找到它们。<br/> <strong class="jd hu">步骤</strong> :-这是一个功能，通过它我们可以在游戏的当前状态/阶段做一个我们真正想做的动作。<br/> <strong class="jd hu">动作:- </strong>这是我们在游戏当前状态/阶段基本想要做的一个值或对象。像向左或向右移动或跳跃等等。<br/> <strong class="jd hu">观察(对象):- </strong>一个环境特定的对象，代表你对环境的观察。例如，来自相机的像素数据、机器人的关节角度和关节速度，或者棋盘游戏中的棋盘状态。<br/> <strong class="jd hu">奖励(浮动):- </strong>上一次行动获得的奖励金额。规模因环境而异，但目标始终是增加你的总回报。<br/> <strong class="jd hu"> done (boolean):- </strong>是不是该重新设置环境了。大多数(但不是全部)任务被划分为定义明确的情节，done为True表示该情节已经终止。(例如，也许杆子倾斜得太厉害，或者你失去了上一条命。)<br/> <strong class="jd hu"> info (dict):- </strong>对调试有用的诊断信息。它有时对学习很有用(例如，它可能包含环境最后一次状态变化背后的原始概率)。但是，官方对你的代理人的评价是不允许用这个来学习的。</p></div><div class="ab cl kq kr hb ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hm hn ho hp hq"><p id="cc3a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们通过写一些<a class="ae jz" href="https://gym.openai.com/envs/CartPole-v1/" rel="noopener ugc nofollow" target="_blank">翻筋斗</a>的代码来了解一下OpenAI健身房。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="kx ky l"/></div></figure><p id="9e27" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们一行一行地理解上面的代码。</p><ol class=""><li id="48c3" class="kz la ht jd b je jf ji jj jm lb jq lc ju ld jy le lf lg lh dt translated">进口健身房套餐。</li><li id="d24d" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">创造了'<strong class="jd hu">翻跟斗</strong>的环境。</li><li id="cc34" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">重置环境。</li><li id="7bad" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">运行一个循环来做几个动作来玩游戏。现在，让我们尽可能多的玩。这就是为什么尝试在这里发挥高达1000步。</li><li id="4a6d" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">env.render() —用于渲染游戏。因此，我们可以看到当我们采取任何步骤/行动时实际发生了什么。</li><li id="9fa6" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">得到一个我们将要采取的随机行动。这里的“env.action_space.sample()”代码会给我们一个允许玩这个游戏的随机动作。</li><li id="fac3" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">通过阶跃函数做随机动作。这将返回我们的观察，奖励，完成，信息。</li></ol><p id="3d7c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">8–13.打印他们知道我们做了什么，到底发生了什么，我们得到了什么奖励，以及游戏是否完成。</p><p id="b9b9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">14–15.如果游戏完成/完成，停止采取下一步/行动。</p><p id="c247" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最后，这段代码会给出这样的输出。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="4f29" class="kj kk ht kf b fv kl km l kn ko">Step 0:<br/>action: 0<br/>observation: [-0.0120364  -0.21794704 -0.00759187  0.26062941]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 1:<br/>action: 1<br/>observation: [-0.01639534 -0.02271754 -0.00237928 -0.03443839]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 2:<br/>action: 1<br/>observation: [-0.0168497   0.17243845 -0.00306805 -0.32787105]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 3:<br/>action: 0<br/>observation: [-0.01340093 -0.02263969 -0.00962547 -0.03615722]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 4:<br/>action: 1<br/>observation: [-0.01385372  0.17261896 -0.01034861 -0.33186148]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 5:<br/>action: 1<br/>observation: [-0.01040134  0.36788668 -0.01698584 -0.6277898 ]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 6:<br/>action: 1<br/>observation: [-0.00304361  0.56324153 -0.02954164 -0.9257734 ]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 7:<br/>action: 1<br/>observation: [ 0.00822122  0.75874972 -0.04805711 -1.22759172]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 8:<br/>action: 1<br/>observation: [ 0.02339622  0.95445615 -0.07260894 -1.53493579]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 9:<br/>action: 1<br/>observation: [ 0.04248534  1.15037357 -0.10330766 -1.84936587]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 10:<br/>action: 1<br/>observation: [ 0.06549281  1.3464699  -0.14029497 -2.17226059]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 11:<br/>action: 0<br/>observation: [ 0.09242221  1.15296679 -0.18374019 -1.92596929]<br/>reward: 1.0<br/>done: False<br/>info: {}<br/>Step 12:<br/>action: 0<br/>observation: [ 0.11548155  0.96023062 -0.22225957 -1.69544763]<br/>reward: 1.0<br/>done: True<br/>info: {}</span></pre><p id="aac6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这将使我们对正在发生的事情有一些合理的想法。每走一步，我们得到奖励1.0，直到游戏结束。它还给出了杆和车的当前位置。这里，动作0表示向左移动购物车，1表示向右移动购物车。更多详情请访问其<a class="ae jz" href="https://github.com/openai/gym/wiki/CartPole-v0" rel="noopener ugc nofollow" target="_blank">维基页面</a>。</p><p id="5c64" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">所以我们对开放式健身房有了了解。所以是时候建立我们的模型了，这意味着我们需要一些数据来训练。因此，让我们玩一些随机动作的游戏，并收集我们玩得更好的游戏的数据。</p><p id="1b65" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">首先，让我们导入完成工作所需的包。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="3a2e" class="kj kk ht kf b fv kl km l kn ko">import gym<br/>import random<br/>import numpy as np<br/>from keras.models     import Sequential<br/>from keras.layers     import Dense<br/>from keras.optimizers import Adam</span></pre><p id="f4d5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后让我们初始化一些需要进一步的变量。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="7887" class="kj kk ht kf b fv kl km l kn ko">env = gym.make('CartPole-v1')<br/>env.reset()<br/>goal_steps = 500<br/>score_requirement = 60<br/>intial_games = 10000</span></pre><p id="bb68" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在下面的代码中，我们将使用来填充深度学习模型训练所需的数据。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="kx ky l"/></div></figure><p id="ece1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们了解一下我们在上面的模型_数据_准备函数中做了什么。</p><ol class=""><li id="8d45" class="kz la ht jd b je jf ji jj jm lb jq lc ju ld jy le lf lg lh dt translated">我们初始化了training_data和accepted_scores数组。</li><li id="2084" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">我们需要玩多次，这样我们可以收集数据，我们可以进一步使用。因此，我们将播放10000次，以便获得大量数据。这一行表示“游戏索引在范围内(初始游戏):”</li><li id="50ba" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">我们初始化了score、game_memory、previous_observation变量，这些变量将存储当前游戏的总分数和前一步观察值(表示推车和杆子的位置)以及我们为此采取的行动。</li><li id="8d96" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">对于范围内的step _ index(goal _ steps):—此代码将游戏玩500步，因为玩此游戏到500步意味着成功完成游戏。</li><li id="acb3" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">我们需要采取随机行动，这样我们就可以玩游戏，这可能会导致成功完成该步骤或输掉游戏。这里只允许向左(0)或向右(1)移动两个动作，所以这个代码(random.randrange(0，2))用于采取随机动作之一。</li><li id="3494" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">我们将采取那个行动/步骤。然后，我们将检查它是否是第一个行动/步骤，然后我们将存储之前的观察和我们为此采取的行动。然后，我们将添加分数，并检查游戏是否完成，如果是，然后停止玩它。</li><li id="647e" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">我们将检查这个游戏是否满足我们的最低要求，这意味着我们是否能够玩60步。</li><li id="d415" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">如果我们能够玩60步，那么我们将把这个分数添加到accept_scores中，我们进一步打印该分数，以了解我们将多少游戏数据及其分数输入到我们的模型中。</li><li id="dfdc" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">然后我们将对动作进行热编码，因为它的值0(向左移动)，1(向右移动)代表分类数据。</li><li id="3eac" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">然后我们会将它添加到我们的训练数据中。</li><li id="d031" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">我们将重置环境，以确保一切都清楚，开始玩下一个游戏。</li><li id="8cf4" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">print(accepted_scores) —该代码用于了解我们向模型中输入了多少游戏数据及其分数。然后我们会返回训练数据。</li></ol><p id="8267" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">该代码在执行后最终打印accepted_scores。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="3df7" class="kj kk ht kf b fv kl km l kn ko">[63.0, 62.0, 74.0, 66.0, 84.0, 69.0, 65.0, 64.0, 66.0, 63.0, 62.0, 67.0, 62.0, 60.0, 76.0, 65.0, 87.0, 85.0, 76.0, 81.0, 68.0, 63.0, 80.0, 65.0, 63.0, 60.0, 60.0, 61.0, 86.0, 71.0, 72.0, 60.0, 95.0, 65.0, 68.0, 68.0, 63.0, 95.0, 91.0, 99.0, 86.0, 68.0, 72.0, 69.0, 62.0, 74.0, 76.0, 74.0, 64.0, 77.0, 92.0, 67.0, 67.0, 99.0, 81.0, 81.0, 63.0, 73.0, 70.0, 68.0, 63.0, 77.0, 61.0, 62.0, 78.0, 61.0, 71.0, 77.0, 70.0, 72.0, 80.0, 61.0, 68.0, 61.0, 86.0, 145.0, 74.0, 68.0, 79.0, 61.0, 63.0, 65.0, 62.0, 64.0, 65.0, 80.0, 67.0, 78.0, 76.0, 66.0, 63.0, 110.0, 62.0, 70.0, 72.0, 109.0, 76.0, 75.0, 75.0, 73.0, 75.0, 65.0, 77.0, 64.0, 61.0, 60.0, 66.0, 61.0, 62.0, 71.0, 75.0, 82.0, 95.0, 67.0, 61.0, 66.0, 67.0, 65.0, 61.0, 65.0, 66.0, 62.0, 70.0, 89.0, 96.0, 86.0, 62.0, 61.0, 75.0, 84.0, 63.0, 66.0, 73.0, 68.0, 61.0, 66.0, 144.0, 64.0, 61.0, 62.0, 62.0, 67.0, 66.0, 65.0, 66.0, 71.0, 68.0, 81.0, 73.0, 75.0, 75.0, 79.0, 75.0, 104.0, 69.0, 66.0, 81.0, 73.0, 60.0, 64.0, 78.0, 115.0, 62.0, 91.0, 70.0, 69.0, 64.0, 86.0, 70.0, 70.0, 68.0]</span></pre><p id="3dd1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">所以我们的数据准备好了。是时候建立我们的神经网络了。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="62f2" class="kj kk ht kf b fv kl km l kn ko">def build_model(input_size, output_size):<br/>    model = Sequential()<br/>    model.add(Dense(128, input_dim=input_size, activation='relu'))<br/>    model.add(Dense(52, activation='relu'))<br/>    model.add(Dense(output_size, activation='linear'))<br/>    model.compile(loss='mse', optimizer=Adam())</span><span id="9247" class="kj kk ht kf b fv ln km l kn ko">return model</span></pre><p id="b77c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里我们将使用序列模型。</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="79a1" class="kj kk ht kf b fv kl km l kn ko">def train_model(training_data):<br/>    X = np.array([i[0] for i in training_data]).reshape(-1, len(training_data[0][0]))<br/>    y = np.array([i[1] for i in training_data]).reshape(-1, len(training_data[0][1]))<br/>    model = build_model(input_size=len(X[0]), output_size=len(y[0]))<br/>    <br/>    model.fit(X, y, epochs=10)<br/>    return model</span></pre><p id="cec4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们有训练数据，因此，我们将创建功能和标签。</p><p id="837e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后我们将开始训练</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="3380" class="kj kk ht kf b fv kl km l kn ko">trained_model = train_model(training_data)</span></pre><p id="fdb5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将得到这样的输出</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="3807" class="kj kk ht kf b fv kl km l kn ko">Epoch 1/10<br/>12236/12236 [==============================] - 1s 94us/step - loss: 0.2483<br/>Epoch 2/10<br/>12236/12236 [==============================] - 1s 71us/step - loss: 0.2348<br/>Epoch 3/10<br/>12236/12236 [==============================] - 1s 67us/step - loss: 0.2333<br/>Epoch 4/10<br/>12236/12236 [==============================] - 1s 68us/step - loss: 0.2334<br/>Epoch 5/10<br/>12236/12236 [==============================] - 1s 64us/step - loss: 0.2325<br/>Epoch 6/10<br/>12236/12236 [==============================] - 1s 63us/step - loss: 0.2324<br/>Epoch 7/10<br/>12236/12236 [==============================] - 1s 66us/step - loss: 0.2315<br/>Epoch 8/10<br/>12236/12236 [==============================] - 1s 65us/step - loss: 0.2318<br/>Epoch 9/10<br/>12236/12236 [==============================] - 1s 65us/step - loss: 0.2317<br/>Epoch 10/10<br/>12236/12236 [==============================] - 1s 65us/step - loss: 0.2318</span></pre><p id="8370" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">是时候让我们的游戏机器人为我们玩游戏了。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="kx ky l"/></div></figure><p id="dd97" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们来理解这个代码</p><ol class=""><li id="dfc2" class="kz la ht jd b je jf ji jj jm lb jq lc ju ld jy le lf lg lh dt translated">我们正在初始化分数和选择数组，它将存储我们得到的分数和做出的选择。</li><li id="7987" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">玩这个游戏100次。</li><li id="dd58" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">初始化score和prev_obs变量以存储当前分数和以前的观察值。</li><li id="7019" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">我们将玩500步游戏，这就是为什么这个循环(对于范围内的步长索引(目标步长):)</li><li id="8dcb" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">对于第一步，我们不知道状态和其他事情，所以我们将采取随机步骤。</li><li id="c3b9" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">从第二步开始，我们知道游戏的当前状态。因此，我们将把观察结果提供给我们的模型，以预测我们需要采取的行动。这部分(<strong class="jd hu">trained _ model . predict(prev _ OBS . shape(-1，len(prev_obs))) </strong>)的代码会给我们每个类别的概率。我们将采用最大概率类别并采取行动。</li><li id="49c3" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">我们将存储我们做出的选择，存储当前状态，并将奖励添加到我们的分数中。</li><li id="343f" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">我们将在完成游戏后重置环境以玩下一个游戏，并存储游戏的完成分数以打印。</li></ol><p id="1495" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们会得到这样的输出</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="8d62" class="kj kk ht kf b fv kl km l kn ko">[500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 247.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 259.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 264.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 241.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 255.0, 500.0, 500.0, 500.0, 245.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]<br/>Average Score: 485.11<br/>choice 1:0.5007936344334275  choice 0:0.49920636556657255</span></pre><p id="5ee2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最后，我们的机器人被训练了。它终于可以像专业选手一样打球了。</p><figure class="ka kb kc kd fq iu fe ff paragraph-image"><div class="ab fr cl lo"><img src="../Images/ab6407a76da8ec51bee0f2fc89cf819f.png" data-original-src="https://miro.medium.com/v2/1*oMSg2_mKguAGKy1C64UFlw.gif"/></div></figure><p id="6287" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">你可以在这里找到Jupyter笔记本来实现<a class="ae jz" href="https://github.com/tankala/ai-examples/blob/master/cart_pole_game_understanding.ipynb" rel="noopener ugc nofollow" target="_blank"/>。</p></div><div class="ab cl kq kr hb ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hm hn ho hp hq"><p id="7bec" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果你喜欢这篇文章，请给它一些掌声来表达你的爱👏。<br/>和平。快乐编码。<br/> <a class="ae jz" href="https://blog.tanka.la/2018/10/19/build-your-first-ai-game-bot-using-openai-gym-keras-tensorflow-in-python/" rel="noopener ugc nofollow" target="_blank">这里看我的原创文章。</a></p><blockquote class="lp"><p id="2153" class="lq lr ht bd ls lt lu lv lw lx ly jy ek translated">加入Coinmonks <a class="ae jz" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jz" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jz" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="kj kk ht bd lz ma mb mc md me mf mg mh jm mi mj mk jq ml mm mn ju mo mp mq mr dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="kz la ht jd b je ms ji mt jm mu jq mv ju mw jy mx lf lg lh dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae jz" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae jz" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="f33b" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae jz" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">开发人员的最佳加密API</a></li><li id="f1dd" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae jz" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="b359" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated">最佳<a class="ae jz" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated">杠杆代币的终极指南</li><li id="95d1" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/best-vpns-for-crypto-trading" rel="noopener ugc nofollow" target="_blank">加密交易的最佳VPN</a></li><li id="918f" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/huobi-crypto-trading-signals" rel="noopener ugc nofollow" target="_blank">用于Huobi的加密交易信号</a> | <a class="ae jz" rel="noopener" href="/coinmonks/hitbtc-review-c5143c5d53c2"> HitBTC审查</a></li><li id="58f1" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/traderwagon-review" rel="noopener ugc nofollow" target="_blank"> TraderWagon回顾</a> | <a class="ae jz" href="https://coincodecap.com/kraken-vs-gemini-vs-bityard" rel="noopener ugc nofollow" target="_blank">北海巨妖vs双子星vs BitYard </a></li><li id="ad10" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/ftx-futures-trading" rel="noopener ugc nofollow" target="_blank">如何在FTX交易所交易期货</a></li><li id="71f4" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/okex-kucoin" rel="noopener ugc nofollow" target="_blank"> OKEx vs KuCoin </a> | <a class="ae jz" href="https://coincodecap.com/celsius-alternatives" rel="noopener ugc nofollow" target="_blank">摄氏替代度</a> | <a class="ae jz" href="https://coincodecap.com/buy-vechain" rel="noopener ugc nofollow" target="_blank">如何购买VeChain </a></li><li id="e6a8" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/3commas-vs-pionex-vs-cryptohopper" rel="noopener ugc nofollow" target="_blank">3 commas vs . Pionex vs . crypto hopper</a></li><li id="0539" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/cornix-trading-bot" rel="noopener ugc nofollow" target="_blank">如何使用Cornix交易机器人</a></li><li id="7ed0" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/bitget-review" rel="noopener ugc nofollow" target="_blank"> Bitget回顾</a>|<a class="ae jz" href="https://coincodecap.com/gemini-vs-blockfi" rel="noopener ugc nofollow" target="_blank">Gemini vs block fi</a>cmd |<a class="ae jz" href="https://coincodecap.com/okex-futures-trading" rel="noopener ugc nofollow" target="_blank">OKEx期货交易</a></li><li id="60b3" class="kz la ht jd b je li ji lj jm lk jq ll ju lm jy mx lf lg lh dt translated"><a class="ae jz" href="https://coincodecap.com/buy-crypto-with-credit-card" rel="noopener ugc nofollow" target="_blank">用信用卡购买密码的10个最佳地点</a></li></ul></div></div>    
</body>
</html>