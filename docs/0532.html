<html>
<head>
<title>Taming the DApp with events</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用事件驯服DApp</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/taming-the-dapp-with-events-b73b7237f0d9?source=collection_archive---------8-----------------------#2018-05-15">https://medium.com/coinmonks/taming-the-dapp-with-events-b73b7237f0d9?source=collection_archive---------8-----------------------#2018-05-15</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/93dec8e4c1abfa4c448fca724a276e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*uQzemvuWDhUW2beiBuU5Hg.jpeg"/></div></figure><p id="1459" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">管理状态是艰难的。管理UI的复杂性是困难的。在以太坊区块链上管理你的应用程序的状态和处理你的UI的复杂性是……更困难的。</p><p id="03a8" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在过去的几年中，有一些前端架构展示了模型-视图-更新架构的强大功能(Elm和om，仅举两个例子),使代码易于推理，并且它们适合事件驱动的模型。幸运的是，Solidity有<a class="ae jv" href="http://solidity.readthedocs.io/en/v0.4.21/contracts.html#events" rel="noopener ugc nofollow" target="_blank">事件</a>来跟踪合同随时间变化的状态。我们能把这些东西连在一起吗？让我们来了解一下！</p><h2 id="6bcd" class="jw jx ht bd jy jz ka kb kc kd ke kf kg ji kh ki kj jm kk kl km jq kn ko kp kq dt translated">反应/还原</h2><p id="bede" class="pw-post-body-paragraph ix iy ht iz b ja kr jc jd je ks jg jh ji kt jk jl jm ku jo jp jq kv js jt ju hm dt translated">我使用React with Redux，这是一个将Elm架构引入普通javascript的库。</p><h2 id="6f56" class="jw jx ht bd jy jz ka kb kc kd ke kf kg ji kh ki kj jm kk kl km jq kn ko kp kq dt translated">项目结构</h2><p id="46cc" class="pw-post-body-paragraph ix iy ht iz b ja kr jc jd je ks jg jh ji kt jk jl jm ku jo jp jq kv js jt ju hm dt translated">应用程序的流程分为</p><ul class=""><li id="412b" class="kw kx ht iz b ja jb je jf ji ky jm kz jq la ju lb lc ld le dt translated">引导web3</li><li id="c98c" class="kw kx ht iz b ja lf je lg ji lh jm li jq lj ju lb lc ld le dt translated">启动应用程序(获取默认帐户，找到合同)</li><li id="ca9f" class="kw kx ht iz b ja lf je lg ji lh jm li jq lj ju lb lc ld le dt translated">启动用户界面</li></ul><p id="b516" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">一旦我们开始运行，我们会的</p><ul class=""><li id="3e3f" class="kw kx ht iz b ja jb je jf ji ky jm kz jq la ju lb lc ld le dt translated">指导用户事件更新合同</li><li id="b4df" class="kw kx ht iz b ja lf je lg ji lh jm li jq lj ju lb lc ld le dt translated">指导合同事件更新用户界面</li></ul><p id="c31b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我将在本文中展示最后两个部分；如果你想看所有的代码，你会想看这里的<a class="ae jv" href="https://github.com/p14n/eth-remittance" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="bcd0" class="jw jx ht bd jy jz ka kb kc kd ke kf kg ji kh ki kj jm kk kl km jq kn ko kp kq dt translated"><span class="l lk ll lm bm ln lo lp lq lr di"> U </span> ser事件</h2><figure class="ls lt lu lv fq iu"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="fff4" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在这个表单中，您可以看到<code class="eh ly lz ma mb b">onSubmit</code>调用<code class="eh ly lz ma mb b">dispatch</code>，动作类型为<code class="eh ly lz ma mb b">pay</code>，值在我们的表单中。</p><figure class="ls lt lu lv fq iu"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="cafc" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">该应用程序有一些定制的中间件来捕捉这个动作，并将其定向到我们的合同。除非交易失败，否则这就是一劳永逸；我们会让合同告诉我们什么时候完成。</p><figure class="ls lt lu lv fq iu"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="9830" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">当我们启动用户界面时；我们观察来自契约的事件，这样我们可以将它们作为动作发送。</p><figure class="ls lt lu lv fq iu"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="11d9" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这显示了我们的<a class="ae jv" href="https://redux.js.org/basics/reducers" rel="noopener ugc nofollow" target="_blank">减速器</a>的一个片段。我们从合同中接收动作，并改变应用程序的状态以反映这一点。重要的状态变化是<code class="eh ly lz ma mb b">status</code>。我们在下面看到这是如何影响UI的。</p><figure class="ls lt lu lv fq iu"><div class="bz el l di"><div class="lw lx l"/></div></figure><p id="0c0e" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">最后，显示哪些表单取决于该状态；只有当状态为<code class="eh ly lz ma mb b">payable</code>时，我们才会显示<code class="eh ly lz ma mb b">PayForm</code>。我们的应用程序越大越容易推理；并且很好地分开，这样我们可以编写一些测试来验证它对于每个状态变化的行为。</p></div></div>    
</body>
</html>