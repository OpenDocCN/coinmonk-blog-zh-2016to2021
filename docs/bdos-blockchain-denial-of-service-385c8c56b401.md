# BDoS:区块链拒绝服务

> 原文：<https://medium.com/coinmonks/bdos-blockchain-denial-of-service-385c8c56b401?source=collection_archive---------1----------------------->

迈克尔·米尔金，严季，乔纳森·庞，·克拉格斯-穆特，伊塔·埃亚尔，阿里·朱尔斯

TL；*我们发现了一种对类似比特币的区块链的拒绝服务攻击，这种攻击比之前描述的攻击要便宜得多。这种区块链依靠激励来提供安全保障。我们展示了攻击者是如何破坏这些动机来促使理性的矿工停止采矿的。技术报告* [*这里*](https://arxiv.org/abs/1912.07497) *。*

![](img/70551b2c1c035ca3474dfae616e458c0.png)

从早期开始，拒绝服务(DoS)攻击就一直困扰着互联网。DoS 攻击者将各种服务作为攻击目标，以获取乐趣和利润。最常见的情况是，它们向服务器发送大量请求，导致服务器过于繁忙，无法为合法用户提供服务。对策通常通过识别泛滥的来源来防止这种攻击的幼稚实现。因此，攻击者必须在所谓的*分布式拒绝服务* (DDoS)攻击中从多台机器上组织洪水。

**有趣的事实**:分布式来源通常是不知情的用户被入侵的机器，它们形成了一个僵尸网络，或者一个*僵尸网络*。

比特币等加密货币是 DoS 攻击的特别有利可图的目标。原则上，期货市场和保证金交易允许攻击者卖空加密货币，通过压低货币价格来获利。相互竞争的加密货币和担心加密货币对金融主权影响的政府是其他潜在的攻击者。然而，据我们所知，在实践中还没有针对著名加密货币的成功的 DoS 攻击。

原因是区块链协议的*分散*本质。在区块链中，没有可攻击的中央服务器。操作区块链的机器叫做*矿工*，它们完全复制区块链的数据。虽然[攻击](https://diode.io/blockchain/how-blockquick-super-light-client-protocol-can-help-mitigate-eclipse-attacks-19161/) [攻击](https://bitcoinmagazine.com/articles/researchers-explore-eclipse-attacks-ethereum-blockchain/) [单个](/speaking-frankly/eclipse-attacks-on-bitcoin-s-peer-to-peer-network-e0da797302c2) [机器](http://hackingdistributed.com/2017/05/01/bgp-attacks-on-btc/)是已知的，但是几个机器的完全关机甚至妥协对整个系统的可用性几乎没有影响。

**更有趣的事实**:比特币的点对点网络是为了抵御攻击而建立的，[从僵尸网络中吸取教训](https://www.usenix.org/node/190891)是为了抵御反恶意软件公司的反击而建立的。

事实上，像比特币这样针对区块链的已知 DoS 攻击代价极其高昂。由化名中本聪提出的比特币协议依靠 [*工作证明*](https://en.wikipedia.org/wiki/Proof_of_work) (PoW)来保证安全。矿工只能通过证明他们已经消耗了系统外的资源(即计算能力)来创建区块。只有当系统中的大多数计算能力表现适当时，区块链安全才能得到维护。因此，DoS 攻击可能由计算能力超过所有其他参与者总和的攻击者执行，也就是 51%的攻击。对于主要的加密货币来说，51%的攻击对大多数实体来说都是极其昂贵的。

此类攻击在 2018 年底比特币 ABC 和比特币 SV 的“哈希大战”期间就有尝试，其中[有限](https://cointelegraph.com/news/abc-vs-cv-assessing-the-consequences-of-the-bitcoin-cash-war)成功。

**输入 bdo**

我们发现 Nakamoto 协议的固有属性使其暴露于明显更便宜的 DoS 攻击。我们利用区块链协议依赖于*激励*来获得安全性的事实。被称为*矿工*的区块链参与者因参与加密货币而获得奖励。当这些激励不再有助于促进良好行为时，系统就处于危险之中。我们的攻击名为 *Blockchain DoS* (BDoS)，利用了矿工的理性，给予他们与系统对抗比遵守规则更高的利润。

为了充分发挥效力，攻击者需要矿工意识到攻击，以及他们可以通过不当行为增加利润的事实。这种战略行为显然不是在挖矿软件中预编程的。因此，我们认为此次攻击不会带来迫在眉睫的风险，因为矿工在面临攻击时将不得不重新编程他们的采矿设备，以实现利润最大化。

这种攻击的存在也许并不令人惊讶，它确实是布莱恩·福特和莱纳·böhme 提出的理论的体现，他们认为从理性代理的角度分析系统的效用有限，因为外部激励与拜占庭行为没有什么区别。

下面，我们概述了我们的 BDoS 攻击机制。但首先，对于外地人来说，中本聪的土地，我们先来了解一些背景。

**背景**

绝大多数加密货币(就市值而言)使用中本聪为比特币提出的区块链协议。在中本区块链中，系统中的所有交易都被放置在块中，这形成了一个不断增长的链。采矿者通过用新的事务形成新的块来扩展这个链，它们将这些新的事务发布给所有其他系统参与者。通过要求矿工在他们的砖块中包含工作证明(破解密码难题的方法)来控制砖块的生产速度。(根据定义，没有功率块是无效的。)为了补偿矿工的努力，块生成被奖励一些设定的奖励(例如，截至今天，每块 12.5 比特币)。如果矿工不是太大的 T2，他们会因此受到激励去延伸产业链和收集奖励。

由于采矿者遍布全球，偶尔会有两个或两个以上的采矿者同时开采区块。这些块有相同的父块。结果是一个*分支*，其中链有多个分支。要确定单链要延长，中本聪的规则是最长的链是*主链*，所有矿工都要延长；偏离该链的方块以及它们的奖励被忽略。

众所周知，为了避免损失奖励，矿工们会在收到和确认最新区块之前就开始采矿。相反，一旦在头中收到元数据，它们就开始在最新的块上挖掘。因此，他们避免了在旧区块浪费采矿资源，并增加了开采下一个区块的机会。这通常不是一个好的做法，并且会引发超出本文范围的安全问题。这种基于报头进行挖掘的方法被称为 *SPV 挖掘*，在轻量级客户端用于部分区块链验证的合法*简化支付验证*协议之后。

![](img/bc2949471d8c49534475fe0b333d17ba.png)

**攻击**

我们介绍的 BDoS 攻击通过操纵理性矿工的奖励使区块链停止。攻击者将系统带入一种状态，在这种状态下，理性矿工的最佳行动方案是停止采矿。她向其他矿工证明，系统处于这种状态。

为了诱导这种状态和伴随的证明，攻击者生成一个块并发布它的头，而*只发布它的头*。给定一个矿车，一个理性的矿工有三种可能的行动:(1)她可以延长主链，忽略矿车，(2)她可以延长区块矿车(SPV 矿)，或者(3)她可以停止采矿，既不消耗力量也不赢得奖励。

![](img/248ae42aba85c90c69401db33b018dff.png)

如果一个 rational 挖掘器遵循选项 1 并扩展主链，找到并广播一个新的块，攻击的挖掘器使用他相对高的连通性(如在自私的挖掘中)并传播对应于头 BA 的整个块。这导致了两组矿工之间的竞争，一组先听到攻击者的块数据，另一组先听到 rational 矿工的块。

![](img/27d658e0570faed0f8ebd3186b0ea40f.png)

在某种概率下，理性矿工输掉了比赛，并且块 Bi 永远不会被包括在主链中。与“无攻击”的情况相比，这降低了在最后一个完整区块采矿的预期回报。

如果 rational miner 遵循选项 2，并且成功地扩展了攻击者的头 BA，那么攻击者的反应就是从不发布完整的块 BA。这导致 rational miner 块永远不会被包含在主链中，导致该块的预期回报为零。

因此，如果“不攻击”设置中的原始收益率不是太高，在这两种情况下，攻击者都可以确保诚实的矿工最终*损失*金钱。因此，BDoS 攻击者的威胁意味着诚实的矿工最好放弃，不要采矿，也就是说，选择 3。正如电影*战争游戏*中的一句名言，“唯一的制胜之举就是不去玩。”

![](img/7749a69ed1d1b90ffbbefc90fa83be56.png)

【BDoS 成功的条件

我们现在解释攻击者在什么条件下成功。具体来说，我们考虑，对于特定的理性开采者 *i* ，在什么条件下 *i* 停止开采比继续开采更有利可图，而不考虑其他参与者的行动。答案取决于三个因素。首先，如果攻击者的哈希速率足够大，攻击就会成功。第二，如果 miner *i* 的 hash 率足够小，就会成功。最后，如果矿商一开始没有赚很多钱，它就会成功。

如果没有攻击发生，矿工的盈利系数是她在采矿上每一美元投资的回报。下图显示了不同攻击者规模(X 轴)和矿工规模(不同曲线)的成功攻击的最大获利能力。

![](img/6887735a59577bffddfc957c2bacfeee.png)

在我们的分析中，我们使用一个称为盈利能力因子的属性，它代表每美元投资的回报。这取决于采矿设备和电力成本，以及被开采货币的价格。

作为一个具体的例子，如果最大的矿商在总开采权中所占的份额是 20%，那么一个散列率为 20%的对手可以激励所有矿商停止开采，如果他们的获利系数低于 1.37 的话。

目前，对于比特币来说，电价为 0.05 美元/千瓦时的比特大陆 Antminer S17 Pro 的盈利能力接近 2，而 Antminer S9 的盈利能力接近 1。如果价格大幅下跌，难度增加，攻击者将能够刺激现有矿工停止采矿，导致比特币完全关闭。此外，预计到 2020 年，整体薪酬将减半，相应地降低盈利能力。

**双硬币模型**

请注意，我们的模型是慷慨的，在某种意义上低估了攻击者的机会。到目前为止，我们假设矿工可以开采或停止开采，利润为零。然而，加密货币矿商通常可以将他们的开采工作转移到第二种货币，即使是暂时的。如果两个硬币的初始盈利能力(攻击前)相似，那么如果有攻击，切换到另一个硬币几乎总是盈利的。这意味着在我们称之为*双币模型*的环境中，攻击的威胁甚至比我们上面的分析所建议的还要高。事实上，双硬币模型是一个现实的场景。例如，有证据表明，矿工[定期在比特币和比特币现金](https://sites.google.com/view/btc-vs-bch/)之间切换，这取决于利润率。

**缓解和责任披露**

我们没有租用一些采矿设备，做空比特币，或者退休到一个没有引渡条约的国家，而是遵循道德安全研究最佳实践，经历了一段负责任的披露期。我们向受影响的主要加密货币的开发者发出了攻击警报，并讨论了缓解措施。

我们建议对一致性规则做一个小的改变，使得*挖掘器对其报头在块主体*之前超过某个阈值时间(例如，1 分钟)已知的块给予较低的优先级。这将增加攻击者在块传播竞赛中失败的机会，从而降低 BDoS 攻击的有效性。不幸的是，这个对策并不是决定性的。正如我们在论文中解释的，攻击者可以使用*智能契约*或 *ZK 证明*来证明她找到了一个块(而不是发布块头)。使用这种技术，可能无法在比赛中区分攻击者的区块和 rational miner 的区块，从而使缓解技术无效。

BDoS 攻击的另一个可能的解决方案是使用*大叔 block* 奖励机制，就像以太坊一样。大叔区块奖励机制授予一个采矿者一个奖励，这个采矿者已经开采了一个没有在主链中结束但是直接连接到主链的区块。考虑到大叔区块奖励的使用，一个理性的矿工在 BDoS 攻击中停止采矿的动机会低得多，因为即使她输掉了比赛，她也会得到奖励(相当于以太坊中⅞的完整区块奖励)。然而，有一个权衡，因为叔叔阻止[减少](https://arxiv.org/pdf/1805.08832.pdf)安全对抗自私的采矿攻击。此外，另一种类似 BDoS 的攻击可能使用比单头链更长的链，使竞争失败再次变得至关重要。

**结论**

BDoS 对区块链中本共识是一个威胁，因为它允许拒绝服务，比以前的攻击杂凑率小得多。我们已经展示了攻击者如何扭曲激励机制，并导致追求利润的矿工停止采矿活动。我们提出的缓解措施易于应用(不需要网络分叉)，但只影响特定类型的 BDoS 攻击。如果没有更强有力的缓解措施，中本聪区块链的生存依赖于矿工们不顾收入损失遵守协议的意愿——也就是说，依赖于利他主义。

全部细节在我们的[技术报告](https://arxiv.org/abs/1912.07497)中。

*我们感谢莎拉·艾伦*、 *IC3 社区经理*、*帮助我们撰写这篇博文。*

*矿工形象作者拉蒙·文森【CC*[*BY-SA 3.0*](https://creativecommons.org/licenses/by-sa/3.0)

> *[直接在您的收件箱中获得最佳软件交易](https://coincodecap.com/?utm_source=coinmonks)*

*[![](img/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png)](https://coincodecap.com/?utm_source=coinmonks)**[![](img/a06b758bdcc47dca7c2504f298674d87.png)](https://coincodecap.com)*