<html>
<head>
<title>Modern Approach to Smart Contracts with Hyperledger Fabric 2.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Hyperledger Fabric 2.0实现智能合同的现代方法</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/modern-approach-to-smart-contracts-with-hyperledger-fabric-2-0-664b0b0d8592?source=collection_archive---------1-----------------------#2020-03-06">https://medium.com/coinmonks/modern-approach-to-smart-contracts-with-hyperledger-fabric-2-0-664b0b0d8592?source=collection_archive---------1-----------------------#2020-03-06</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="d6a8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Hyperledger fabric已经成为企业构建区块链解决方案的首选之一，并且通过自身的发展已经走过了漫长的道路，以构建强大而智能的系统</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/8207032c65aba65fb30bc50960db7be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2vTPP_yKPI4ZAz-Ef10FPg.png"/></div></div></figure><p id="353b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">随着最近2.0版本的发布，Hyperledger fabric再次提高了<a class="ae ka" href="https://blog.coincodecap.com/tag/blockchain/" rel="noopener ugc nofollow" target="_blank">区块链</a>系统的标准，因为它为用户和运营商提供了重要的新功能和变化。</p><p id="1def" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Fabric v2.0包括对新应用和隐私模式的支持，围绕<a class="ae ka" href="https://decentraland.org/whitepaper.pdf" rel="noopener ugc nofollow" target="_blank">智能合同</a>的增强治理，以及操作节点的新选项。使用基于Alpine的docker映像，fabric映像变得更小，提供了更快的下载和启动时间，并在主机系统上占用更少的磁盘空间</p><p id="abf5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这次改变的主要修改和令人兴奋的特性之一是<strong class="is hu">链码生命周期</strong>。Fabric v2.0为<a class="ae ka" href="https://decentraland.org/whitepaper.pdf" rel="noopener ugc nofollow" target="_blank">智能契约</a>引入了去中心化治理，通过一个新的流程在您的对等体上安装链码，并在一个通道上启动它</p><p id="64e0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在Fabric的早期1.x版本中，一个组织可以在实例化链码时为所有其他渠道成员设置链码的参数(例如认可策略),而其他组织只能选择拒绝安装链码，因此不能参与调用链码的事务。新的结构链码生命周期是一个允许多个组织在链码可用于渠道之前就其操作方式达成一致的过程。它更加灵活，因为它既支持集中式信任模型(如前一生命周期模型)，也支持分散式模型，后者要求足够数量的组织在链码在渠道上激活之前就认可策略和其他细节达成一致。</p><p id="b1ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">因此，今天在本文中，我们将探讨在Hyperledger结构网络上部署链码的新方法</p><p id="b99e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">首先，我已经在运营一个<strong class="is hu"> byfn </strong>网络，频道和主播同行已经就位</p><p id="1e6e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">因此，在本文中，我们将从在我们的网络上安装和定义链码的步骤开始</p><p id="976d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">借助新的链码部署方法，渠道成员需要就建立链码监管的链码定义达成一致，为此，我们需要在链码安装到我们的同行之前对其进行打包。对于我们创建的每个包，您需要提供一个链码包标签作为链码的描述</p><p id="4d8e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">步骤1 </strong> : <strong class="is hu">打包</strong>，在打包Golang链码之前，需要出售Go依赖项，我们将进入链码文件夹</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="3642" class="kg kh ht kc b fv ki kj l kk kl"><strong class="kc hu">cd <em class="km">/</em></strong><em class="km">opt</em><strong class="kc hu"><em class="km">/</em></strong><em class="km">gopath</em><strong class="kc hu"><em class="km">/</em></strong><em class="km">src</em><strong class="kc hu"><em class="km">/</em></strong><em class="km">github</em><strong class="kc hu"><em class="km">.</em></strong><em class="km">com</em><strong class="kc hu"><em class="km">/</em></strong><em class="km">hyperledger</em><strong class="kc hu"><em class="km">/</em></strong><em class="km">fabric</em><strong class="kc hu"><em class="km">-</em></strong><em class="km">samples</em><strong class="kc hu"><em class="km">/</em></strong><em class="km">chaincode</em><strong class="kc hu"><em class="km">/</em></strong><em class="km">abstore</em><strong class="kc hu"><em class="km">/</em></strong><em class="km">go</em></span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/86b8a427faee93818361f0c2503caa32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*UIa7RTVG-83V3VRajMNj8A.png"/></div></figure><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="42a5" class="kg kh ht kc b fv ki kj l kk kl"><em class="km">GO111MODULE</em><strong class="kc hu"><em class="km">=</em></strong><em class="km">on go mod vendor</em></span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/6be0d6d637918f5fa36ea32004482641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*wxcvMBsOSJcG0ag6WlSArA.png"/></div></figure><p id="7a9e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">GO111MODULE将处理我们的链代码的所有打包和依赖性</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/da7f362ef074c0ce32fd6e888f86940d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*V9ptu6J-5i79Lis3GKZVbA.png"/></div></figure><p id="405b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在让我们用“cd -”返回到之前的目录，并运行下面的命令</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="594e" class="kg kh ht kc b fv ki kj l kk kl">peer lifecycle chaincode package mycc<strong class="kc hu">.</strong>tar<strong class="kc hu">.</strong>gz <strong class="kc hu">--</strong>path github<strong class="kc hu">.</strong>com<strong class="kc hu">/</strong>hyperledger<strong class="kc hu">/</strong>fabric<strong class="kc hu">-</strong>samples<strong class="kc hu">/</strong>chaincode<strong class="kc hu">/</strong>abstore<strong class="kc hu">/</strong>go<strong class="kc hu">/</strong> <strong class="kc hu">--</strong>lang golang <strong class="kc hu">--</strong>label mycc_1</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/6c0abd75214d338b46d6ac4a745ef4c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*XsunLZmc1ftg2vNyV650pQ.png"/></div></figure><p id="dc6c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这将打包我们的Golang链码，并将创建一个名为mycc.tar.gz<strong class="is hu">的链码包，我们可以用它在我们的对等体上安装链码</strong></p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/49b54c654404862a4b3a87afbcd4fd39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*qAMj_X8vtMwJ8Axi05HD0Q.png"/></div></figure><p id="8f44" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">步骤2 </strong> : <strong class="is hu">安装chaincode </strong>，接下来我们将在Org1的peer0上安装chaincode，因为它的环境变量在我们的cli中被设置为默认值</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="c8c8" class="kg kh ht kc b fv ki kj l kk kl">“peer lifecycle chaincode install mycc<strong class="kc hu">.</strong>tar<strong class="kc hu">.</strong>gz”</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/4afd25fd45d58eae7deaa766d953ed0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*9RHKlxkyrNZKtaHhIQUeBA.png"/></div></figure><p id="1d4d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">回应:</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="6062" class="kg kh ht kc b fv ki kj l kk kl"><br/>2020-02-19 12:43:18.379 UTC [cli.lifecycle.chaincode] submitInstallProposal -&gt; INFO 001 Installed remotely: response:&lt;status:200 payload:"\nGmycc_1:4299989154fdb5067fe54d92922003ff6281201e1a39916a9c3bfbddbf7fd3a7\022\006mycc_1" &gt;</span><span id="5d13" class="kg kh ht kc b fv kp kj l kk kl">2020-02-19 12:43:18.379 UTC [cli.lifecycle.chaincode] submitInstallProposal -&gt; INFO 002 Chaincode code package identifier: <strong class="kc hu"><em class="km">mycc_1:4299989154fdb5067fe54d92922003ff6281201e1a39916a9c3bfbddbf7fd3a7</em></strong></span></pre><p id="b8cf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在一个对等体上安装链码会用我们已安装的链码的包标识符来回应，万一错过了，你也可以用下面的命令检索包标识符</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="a1ab" class="kg kh ht kc b fv ki kj l kk kl">peer lifecycle chaincode queryinstalled</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/d9ded701597ef1c5bb3d58e05525b7fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*DLXDHcW7nfZDiJr9Ob5nXg.png"/></div></figure><p id="cf6b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">"<strong class="is hu">mycc _ 1:4299989154 fdb 5067 Fe 54d 92922003 ff 6281201 E1 a 39916 a9 C3 bfbddbf 7 FD 3a 7</strong>"是为我的chaincode生成的包id，对于您来说，该值可能会有所不同，因此请记下它</p><p id="d9dc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来，我们将在接下来的步骤中需要这个包ID，所以让我们使用命令将它存储在一个环境变量中:</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="f282" class="kg kh ht kc b fv ki kj l kk kl">CC_PACKAGE_ID=mycc_1:4299989154fdb5067fe54d92922003ff6281201e1a39916a9c3bfbddbf7fd3a7</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/5353bff20a3750bc3696c722ce8ee64d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*vKvQwsPPkZhcMe2ED5fvOQ.png"/></div></figure><p id="cc8a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在让我们在其他对等体上安装chaincode，我们将为Org2的peer0设置peer环境变量</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="38a6" class="kg kh ht kc b fv ki kj l kk kl">CORE_PEER_MSPCONFIGPATH<strong class="kc hu">=/</strong>opt<strong class="kc hu">/</strong>gopath<strong class="kc hu">/</strong>src<strong class="kc hu">/</strong>github<strong class="kc hu">.</strong>com<strong class="kc hu">/</strong>hyperledger<strong class="kc hu">/</strong>fabric<strong class="kc hu">/</strong>peer<strong class="kc hu">/</strong>crypto<strong class="kc hu">/</strong>peerOrganizations<strong class="kc hu">/</strong>org2<strong class="kc hu">.</strong>example<strong class="kc hu">.</strong>com<strong class="kc hu">/</strong>users<strong class="kc hu">/</strong>Admin@org2<strong class="kc hu">.</strong>example<strong class="kc hu">.</strong>com<strong class="kc hu">/</strong>msp</span><span id="2868" class="kg kh ht kc b fv kp kj l kk kl">CORE_PEER_ADDRESS<strong class="kc hu">=</strong>peer0<strong class="kc hu">.</strong>org2<strong class="kc hu">.</strong>example<strong class="kc hu">.</strong>com:9051</span><span id="e1c5" class="kg kh ht kc b fv kp kj l kk kl">CORE_PEER_LOCALMSPID<strong class="kc hu">=</strong>"Org2MSP"</span><span id="305a" class="kg kh ht kc b fv kp kj l kk kl">CORE_PEER_TLS_ROOTCERT_FILE<strong class="kc hu">=/</strong>opt<strong class="kc hu">/</strong>gopath<strong class="kc hu">/</strong>src<strong class="kc hu">/</strong>github<strong class="kc hu">.</strong>com<strong class="kc hu">/</strong>hyperledger<strong class="kc hu">/</strong>fabric<strong class="kc hu">/</strong>peer<strong class="kc hu">/</strong>crypto<strong class="kc hu">/</strong>peerOrganizations<strong class="kc hu">/</strong>org2<strong class="kc hu">.</strong>example<strong class="kc hu">.</strong>com<strong class="kc hu">/</strong>peers<strong class="kc hu">/</strong>peer0<strong class="kc hu">.</strong>org2<strong class="kc hu">.</strong>example<strong class="kc hu">.</strong>com<strong class="kc hu">/</strong>tls<strong class="kc hu">/</strong>ca<strong class="kc hu">.</strong>crt</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/c6d96af0ee9e52176af1474e5a82cf1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*DoAIQR1HXBu5N9C6GJzgmQ.png"/></div></figure><p id="36ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后重复相同的命令来安装chaincode</p><p id="90ab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">命令:</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="70b8" class="kg kh ht kc b fv ki kj l kk kl">peer lifecycle chaincode install mycc<strong class="kc hu">.</strong>tar<strong class="kc hu">.</strong>gz</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/df1d920ed8aa1cc9a2b3e4f59e80724d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*qnRuoSTV7SEFkWjFUdsK4Q.png"/></div></figure><p id="4b69" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">回应:</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="2d71" class="kg kh ht kc b fv ki kj l kk kl">bash-5.0# peer lifecycle chaincode install mycc.tar.gz</span><span id="d601" class="kg kh ht kc b fv kp kj l kk kl">2020-02-19 12:56:41.970 UTC [cli.lifecycle.chaincode] submitInstallProposal -&gt; INFO 001 Installed remotely: response:&lt;status:200 payload:"\nGmycc_1:4299989154fdb5067fe54d92922003ff6281201e1a39916a9c3bfbddbf7fd3a7\022\006mycc_1" &gt;</span><span id="c788" class="kg kh ht kc b fv kp kj l kk kl">2020-02-19 12:56:41.970 UTC [cli.lifecycle.chaincode] submitInstallProposal -&gt; INFO 002 Chaincode code package identifier: <strong class="kc hu">mycc_1:4299989154fdb5067fe54d92922003ff6281201e1a39916a9c3bfbddbf7fd3a7</strong></span></pre><p id="d1a5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">请注意，此命令后返回的包标识符与在Org1的peer0上安装chaincode时获得的包标识符相同</p><p id="7ab6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">第三步</strong> : <strong class="is hu">批准链码</strong>，在我们安装软件包后，各个组织需要批准链码定义，其中包括链码治理的重要参数，如认可政策、链码名称、版本。</p><p id="8f97" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将对Org1的peer0和Org2的peer0执行以下命令，所有组织都需要在使用链码之前就定义达成一致</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="fcc4" class="kg kh ht kc b fv ki kj l kk kl">peer lifecycle chaincode approveformyorg --channelID $CHANNEL_NAME --name mycc --version 1.0 --init-required --package-id $CC_PACKAGE_ID --sequence 1 --tls true --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff kq"><img src="../Images/002d5182aec9ef1d1cdddfd3fc876772.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F0lxb759z_Sq4enqidP1DA.png"/></div></div></figure><p id="14f3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">批准被分发给每个组织内的对等方，因此该命令不需要针对组织内的每个对等方。</p><p id="c055" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">步骤4 </strong> : <strong class="is hu">提交链码</strong>，要继续在Hyperledger fabric 2.0的通道上启用链码，而不是实例化链码，我们必须提交链码，这就是区别所在</p><p id="e57d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果有足够数量的渠道成员批准了链码定义，我们只能将链码提交给渠道，之后任何一个成员都可以将定义提交给渠道。默认情况下，在提交定义之前，大多数渠道成员需要批准该定义。我们还可以通过发出以下查询来检查链码的批准状态:</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="0ffe" class="kg kh ht kc b fv ki kj l kk kl">peer lifecycle chaincode checkcommitreadiness --channelID $CHANNEL_NAME --name mycc --version 1.0 --init-required --sequence 1 --tls true --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem --output json</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff kr"><img src="../Images/6af2b385716b1da79ca23c703a49408a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6EQEKeaEJ35CBJ8RoKEppg.png"/></div></div></figure><p id="a89b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如我们所见，两个渠道成员都批准了链码，我们可以继续在渠道上提交链码，这也是一个一次性流程，因此我们可以从Org1或Org2对等方进行提交</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="0c6c" class="kg kh ht kc b fv ki kj l kk kl">peer lifecycle chaincode commit -o orderer.example.com:7050 --channelID $CHANNEL_NAME --name mycc --version 1.0 --sequence 1 --init-required --tls true --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt --peerAddresses peer0.org2.example.com:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff ks"><img src="../Images/17e8168c1342460bc570c5f5c502392b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvX1lSoaltSNgpZNHmIVsQ.png"/></div></div></figure><p id="ef95" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当我们看到提交成功时，让我们尝试与链代码交互</p><p id="8f96" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">第五步</strong>:调用链码</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="e9dc" class="kg kh ht kc b fv ki kj l kk kl">peer chaincode invoke -o orderer.example.com:7050 --isInit --tls true --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt --peerAddresses peer0.org2.example.com:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt -c '{"Args":["Init","a","100","b","100"]}' --waitForEvent</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff kt"><img src="../Images/81225a5bc93de20eb48c4e063144c397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*frOlH7rmFUI1TCMWmdPMDA.png"/></div></div></figure><p id="89ea" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个命令将启动链码容器</p><p id="861e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我们将查询chaincode以确保容器正确启动并且状态数据库被填充。查询的语法如下:</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="a651" class="kg kh ht kc b fv ki kj l kk kl">peer chaincode query -C $CHANNEL_NAME -n mycc -c '{"Args":["query","a"]}'</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ku"><img src="../Images/b3234c90376e4e7e5b07cb0f77a4ab80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*gMRZDKaFG_xwLNEWqi-43Q.png"/></div></figure><p id="288b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在让我们用下面的命令将10从a移动到b</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="4390" class="kg kh ht kc b fv ki kj l kk kl">peer chaincode invoke -o orderer.example.com:7050 --tls true --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt --peerAddresses peer0.org2.example.com:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt -c '{"Args":["invoke","a","b","10"]}' --waitForEvent</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff kv"><img src="../Images/f0cbd0d9d41e5a4bb3cecdfc98d4d57b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6DphhvGcQS3m2SdQxJSdnQ.png"/></div></div></figure><p id="3357" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们确认一下我们之前的调用是否正确执行。我们用值100初始化键a，并在前面的调用中删除了10。因此，对a的查询应该返回90。查询的语法如下。</p><p id="56c8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">#确保正确设置-C和-n标志</p><pre class="jp jq jr js fq kb kc kd ke aw kf dt"><span id="5dc3" class="kg kh ht kc b fv ki kj l kk kl">peer chaincode query -C $CHANNEL_NAME -n mycc -c '{"Args":["query","a"]}'</span></pre><p id="8770" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们应该看到以下内容:</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kw"><img src="../Images/5ef3333b16dcda65fe051b59376adfd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*em1QXsSDFD2cAWws0_xWiA.png"/></div></figure><p id="99fe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这就是Hyperledger Fabric 2.0如何改变了我们在<a class="ae ka" href="https://blog.coincodecap.com/tag/blockchain/" rel="noopener ugc nofollow" target="_blank">区块链</a>网络上设置链码/智能合同的方式，通过改进审批和托管链码的方法，它增加了一层额外的透明度和信任。加上这种不断的改进和设置区块链系统的详细过程，Hyperledger fabric真的为数字时代树立了一个标志</p><p id="8144" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">感谢阅读:)</p><blockquote class="kx"><p id="aa45" class="ky kz ht bd la lb lc ld le lf lg jn ek translated"><a class="ae ka" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="li lj lk ll lm jt fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff lh"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>