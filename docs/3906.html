<html>
<head>
<title>How To Take a Backup For Your Hyperledger Fabric Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何备份您的Hyperledger Fabric网络</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-take-a-backup-for-your-hyperledger-fabric-network-d42f1a4eb6d0?source=collection_archive---------1-----------------------#2021-01-16">https://medium.com/coinmonks/how-to-take-a-backup-for-your-hyperledger-fabric-network-d42f1a4eb6d0?source=collection_archive---------1-----------------------#2021-01-16</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="24b0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">本文将演示为您的光纤网络获取备份的不同方法。将先前提交的数据部署到不同主机中的相同hyperledger结构网络。两种方法，第一种是从结构docker容器中进行备份。第二个是复制所有事务并配置<code class="eh jo jp jq jr b">docker-compose</code>文件来绑定我们的docker容器卷。</p><figure class="jt ju jv jw fq jx fe ff paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="fe ff js"><img src="../Images/d6da8cc861c999c2a912c8965d26588c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eBk_GvqDBF_-4zI2.png"/></div></div></figure><h1 id="c601" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">Docker备份方法(简单的一种)</h1><p id="8e36" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hm dt translated">所有hyperledger fabric组件都在运行throw docker容器。因此，您可以通过以下步骤保存正在运行的容器并将它们放在您想要的任何地方。我不推荐这种方式，因为这是一种变通方法，但如果您是DevOps开发人员，这可能会更容易。对区块链没有太多经验。</p><p id="05c8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您可能面临的一些问题</p><p id="e3a9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">1-保存容器体积并再次关联它们可能很复杂。尤其是使用hyperledger fabric，您可能需要管理二十多个容器。</p><p id="cd42" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2-丢失最近的交易。假设您在处理某个事务时停止了容器。</p><p id="0206" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">3-你无法再有效地管理你的网络。现在你需要抛出docker容器命令。</p><h1 id="9b16" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb dt translated">保存所有交易和网络组件</h1><p id="7d21" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hm dt translated">下面这个方法比第一个好。它将为您提供复制和重新部署区块链的最佳方式。第一步是创建备份文件夹。</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="02a0" class="ll kf ht jr b fv lm ln l lo lp">mkdir backup<br/>cd backup</span></pre><p id="2abb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我们需要复制三样东西:</p><p id="5bd2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">单通道伪影</p><p id="4322" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2-系统-成因-地块</p><p id="d830" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">3-组织。</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="67e5" class="ll kf ht jr b fv lm ln l lo lp"> sudo cp -aR ~/&lt;Your-Project-Location&gt;/channel-artifacts/ .<br/> sudo cp -aR ~/&lt;Your-Project-Location&gt;/system-genesis-block/ .<br/> sudo cp -aR ~/&lt;Your-Project-Location&gt;/organizations/  .</span></pre><p id="0528" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后复制docker容器用于对等和订购。</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="8dc4" class="ll kf ht jr b fv lm ln l lo lp">mkdir orderer peer0.org1 peer0.org2</span><span id="a2c6" class="ll kf ht jr b fv lq ln l lo lp">docker cp peer0.org1.example.com:/var/hyperledger/production/ peer0.org1/</span><span id="e408" class="ll kf ht jr b fv lq ln l lo lp">docker cp peer0.org2.example.com:/var/hyperledger/production/ peer0.org2/</span><span id="2934" class="ll kf ht jr b fv lq ln l lo lp">docker cp orderer.example.com:/var/hyperledger/production/orderer/ .</span></pre><p id="1d19" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">假设您想将备份文件从远程主机复制到本地主机。您可能会遇到一些问题，因为有些文件具有安全的根用户访问权限。</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="7032" class="ll kf ht jr b fv lm ln l lo lp">sudo find . -type f -exec chmod 644 {} \;<br/>sudo find . -type d -exec chmod 755 {} \;</span></pre><p id="100a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用secure copy命令下载备份目录。</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="d496" class="ll kf ht jr b fv lm ln l lo lp">scp -i ../&lt;FILE&gt;.pem -r ubuntu@&lt;ipAddress&gt;:&lt;location&gt;/backup/ .</span></pre><p id="e8aa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">就这样，现在您已经成功备份了您的区块链。接下来的步骤是恢复你的区块链。</p><p id="d455" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Rest脚本权限</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="81e8" class="ll kf ht jr b fv lm ln l lo lp">chmod 774 organizations/ccp-* organizations/fabric-ca/registerEnroll.sh organizations/cryptogen/*</span></pre><p id="ea8b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将备份内容复制到您的hyperledger fabric网络目录中。</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="da40" class="ll kf ht jr b fv lm ln l lo lp">cd &lt;network-location&gt;/<br/>sudo cp -Ra &lt;backup location&gt;/backup/* .</span></pre><p id="b1cc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在最重要的部分是从我们的备份文件绑定卷。得到文件docker-compose-test-net.yaml</p><p id="5592" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于订购量，请更换</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="1de7" class="ll kf ht jr b fv lm ln l lo lp">orderer.example.com:/var/hyperledger/production/orderer</span></pre><p id="d0c6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">随着</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="cc55" class="ll kf ht jr b fv lm ln l lo lp">../orderer/:/var/hyperledger/production/orderer</span></pre><p id="f85d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于peer1卷，请更换</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="9a2e" class="ll kf ht jr b fv lm ln l lo lp">peer0.org1.example.com:/var/hyperledger/production</span></pre><p id="eaea" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">随着</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="1b1c" class="ll kf ht jr b fv lm ln l lo lp">.../peer0.org1/:/var/hyperledger</span></pre><p id="fd70" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当然，如果您有多个对等体，您将为所有对等体绑定卷。就我而言，我有两个同事</p><p id="9dd1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于peer2，更换</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="1da3" class="ll kf ht jr b fv lm ln l lo lp">peer0.org2.example.com:/var/hyperledger/production</span></pre><p id="f940" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">随着</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="6a54" class="ll kf ht jr b fv lm ln l lo lp">.../peer0.org2/:/var/hyperledger</span></pre><p id="83c8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在，您已经准备好启动结构网络。</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="0038" class="ll kf ht jr b fv lm ln l lo lp">./network.sh up</span></pre><p id="6ae6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">或者如果您正在使用数据库。</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="86a2" class="ll kf ht jr b fv lm ln l lo lp">./network.sh up -s couchdb</span></pre><p id="db4d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对等端将需要几分钟时间来与信道同步；那么所有的链代码都将启动并使用以前的数据运行。您可以使用对等日志来检查它们</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="3cba" class="ll kf ht jr b fv lm ln l lo lp">docker logs peer0.org1.example.com -f</span></pre><p id="a44b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了确保一切正常，你可以检查对等容器中最后提交的块。</p><pre class="jt ju jv jw fq lh jr li lj aw lk dt"><span id="2099" class="ll kf ht jr b fv lm ln l lo lp">peer channel getinfo -c &lt;channel-Name&gt;</span></pre><p id="dcb6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">谢谢！</p><blockquote class="lr"><p id="acc7" class="ls lt ht bd lu lv lw lx ly lz ma jn ek translated">加入Coinmonks <a class="ae mb" href="https://t.me/joinchat/EPmjKpNYwRMsBI4p" rel="noopener ugc nofollow" target="_blank"> Telegram group </a>，了解加密交易和投资</p></blockquote><h2 id="bd97" class="ll kf ht bd kg mc md me kk mf mg mh ko jb mi mj ks jf mk ml kw jj mm mn la mo dt translated">另外，阅读</h2><ul class=""><li id="6ed0" class="mp mq ht is b it lc ix ld jb mr jf ms jj mt jn mu mv mw mx dt translated"><a class="ae mb" href="http://blog.coincodecap.com/go/learn" rel="noopener ugc nofollow" target="_blank">学习以太坊和Web3开发</a></li><li id="259b" class="mp mq ht is b it my ix mz jb na jf nb jj nc jn mu mv mw mx dt translated">最好的<a class="ae mb" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="5241" class="mp mq ht is b it my ix mz jb na jf nb jj nc jn mu mv mw mx dt translated">了解比特币的<a class="ae mb" rel="noopener" href="/coinmonks/what-are-the-best-books-to-learn-bitcoin-409aeb9aff4b">最佳书籍有哪些？</a></li></ul><blockquote class="lr"><p id="b751" class="ls lt ht bd lu lv nd ne nf ng nh jn ek translated"><a class="ae mb" rel="noopener" href="/coinmonks/newsletters/coinmonks">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="nj nk nl nm nn jx fe ff paragraph-image"><a href="https://medium.com/coinmonks/newsletters/coinmonks"><div class="fe ff ni"><img src="../Images/160ce73bd06d46c2250251e7d5969f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*BoDnKUyK8p4hitHAJZ5Pdw.png"/></div></a></figure></div></div>    
</body>
</html>