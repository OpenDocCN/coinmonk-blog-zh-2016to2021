<html>
<head>
<title>Designing a Hyperledger Fabric Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设计Hyperledger结构网络</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/designing-a-hyperledger-fabric-network-7adcd78dabc3?source=collection_archive---------1-----------------------#2019-01-26">https://medium.com/coinmonks/designing-a-hyperledger-fabric-network-7adcd78dabc3?source=collection_archive---------1-----------------------#2019-01-26</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="fa17" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated"><em class="ji">本文介绍了IBM Research的研究科学家Petr Novotny如何设计Hyperledger fabric网络，他在软件系统的工程和研究方面拥有超过15年的经验。</em></h2></div><h1 id="9abb" class="jj jk ht bd jl jm jn jo jp jq jr js jt iz ju ja jv jc jw jd jx jf jy jg jz ka dt translated">设计Hyperledger结构网络</h1><p id="7642" class="pw-post-body-paragraph kb kc ht kd b ke kf iu kg kh ki ix kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">为应用程序确定Hyperledger Fabric网络结构的第一步是列出参与组织。从逻辑上讲，组织是一个安全域，是一个身份和凭据单元。它管理一个或多个网络对等体，并依赖于一个<strong class="kd hu">成员资格服务提供商</strong> ( <strong class="kd hu"> MSP </strong>)为对等体以及智能合约访问特权的客户端颁发身份和证书。订购服务是结构网络的基础，通常被分配给自己的组织。下图说明了典型的对等网络结构，包括客户端、MSP和逻辑组织分组。</p><blockquote class="kx"><p id="5c0b" class="ky kz ht bd la lb lc ld le lf lg kw ek translated"><a class="ae lh" href="https://coincodecap.com" rel="noopener ugc nofollow" target="_blank">发现并回顾最佳区块链软件</a></p></blockquote><p id="1bcc" class="pw-post-body-paragraph kb kc ht kd b ke li iu kg kh lj ix kj kk lk km kn ko ll kq kr ks lm ku kv kw hm dt translated">批准交易(或调用)的标准是背书政策。它是根据参与应用网络的组织而不是对等体本身来构建的:</p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff ln"><img src="../Images/6cfbbad00fd3cb3e53d290a3a3bdf1b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gn6sjQ7RiuOhg4QeGHlIdw.jpeg"/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">Blockchain network with peers distributed among organizations, and clients obtaining credentials from organizations to submit queries and invocations to the chaincode</figcaption></figure><p id="cdb1" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">必须预先决定对等体的集合、它们所属的组织以及为每个组织服务的成员资格服务提供者，以便可以在那些机器上安装和运行适当的服务。</p><p id="e1f9" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">我们的示例贸易网络将由四个组织组成，分别代表出口商、进口商、承运商和监管者。后两者分别代表运营商和监管机构。然而，出口商组织代表出口实体及其银行。同样，进口商组织代表进口实体及其银行。从安全性和成本的角度来看，将实体及其信任方分组到一个组织中是有意义的。运行Fabric peer是一项繁重且成本高昂的任务，因此对于可能拥有更多资源和大量客户的银行来说，代表自己和客户运行这样的peer就足够了。交易实体以客户的身份获得提交交易或从其组织读取分类帐状态的权利。因此，我们的区块链网络需要四个对等体，每个对等体属于不同的组织。除了同行之外，我们的网络由四个组织中每个组织的一个MSP和一个以solo模式运行的订购服务组成。</p><p id="1b87" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">订购服务属于它自己的独立组织，有一个MSP。下图显示了我们交易网络中的组织及其MSP、同行和客户:</p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff mi"><img src="../Images/8832802c78f68fa6799d9064489c09c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i-uELfUNicaZa2eBZxOrHg.jpeg"/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">A trade network with peers, an orderer, and clients in their respective organizations</figcaption></figure><h2 id="3b59" class="mj jk ht bd jl mk ml mm jp mn mo mp jt kk mq mr jv ko ms mt jx ks mu mv jz mw dt translated">安装先决条件</h2><p id="8217" class="pw-post-body-paragraph kb kc ht kd b ke kf iu kg kh ki ix kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">有了网络设计，让我们安装必要的工具:</p><p id="1127" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">1.确保您拥有最新版本的:</p><p id="360d" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">码头工人使用<a class="ae lh" href="https://docs.docker.com/install/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/install/</a></p><p id="9699" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">Docker-Compose使用:<a class="ae lh" href="https://docs.docker.com/compose/install/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/compose/install/</a></p><p id="3826" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">2.我们将使用GitHub来分享我们教程的源代码。要访问GitHub，需要安装Git客户端并配置GitHub的身份验证。欲了解更多信息，请访问GitHub的官方网站，地址为<a class="ae lh" href="https://help.github.com/articles/set-up-git/" rel="noopener ugc nofollow" target="_blank">https://help.github.com/articles/set-up-git/</a>。</p><p id="5efb" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">3.从<a class="ae lh" href="https://hyperledger.github.io/composer/latest/installing/installing-prereqs" rel="noopener ugc nofollow" target="_blank">https://hyperledger . github . io/composer/latest/installing/installing-prereqs</a>安装业务网络示例所需的软件。以上说明适用于Mac和Linux。请注意，在使用Windows时，我们建议使用类似于vagger的解决方案，在虚拟机中运行开发环境。</p><p id="04f1" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">4.Fabric是用Go语言实现的。</p><p id="0671" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">Go在语法上类似于C++</p><p id="af68" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">我们还将使用Go来编写链码</p><p id="b902" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">Go可以从<a class="ae lh" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank">https://golang.org/</a>安装</p><p id="af52" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">5.接下来，我们需要设置我们的环境变量。</p><p id="7483" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated"><code class="eh mx my mz na b">GOPATH</code>指向<code class="eh mx my mz na b">go</code>源代码的工作区，例如:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="5997" class="mj jk ht na b fv nf ng l nh ni">$ export GOPATH=$HOME/go</span></pre><p id="2191" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated"><code class="eh mx my mz na b">PATH</code>需要包含用于存储库和可执行文件的Go <code class="eh mx my mz na b">bin</code>目录，正如我们在下面的代码片段中看到的:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="c04b" class="mj jk ht na b fv nf ng l nh ni">$ export PATH=$PATH:$GOPATH/bin</span></pre><h1 id="1848" class="jj jk ht bd jl jm jn jo jp jq jr js jt iz ju ja jv jc jw jd jx jf jy jg jz ka dt translated">分叉和克隆贸易-金融-物流知识库</h1><p id="84da" class="pw-post-body-paragraph kb kc ht kd b ke kf iu kg kh ki ix kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">现在，我们需要通过派生GitHub上的存储库来获得原始源代码的副本。然后，我们可以通过以下步骤将源代码克隆到本地机器目录中:</p><p id="9c29" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">1.<strong class="kd hu">在GitHub中，导航到位于</strong><a class="ae lh" href="https://github.com/HyperledgerHandsOn/trade-finance-logistics" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/hyperledger handson/trade-finance-logistics</a>的存储库</p><p id="6356" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">2.<strong class="kd hu">派生存储库</strong>:使用页面右上角的Fork按钮为您的帐户创建一个源代码副本</p><p id="cfee" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">3.<strong class="kd hu">获取克隆URL </strong>:导航到您的贸易-金融-物流存储库的分支。点击<code class="eh mx my mz na b"><strong class="kd hu">Clone or download</strong></code>按钮，复制网址</p><p id="6abe" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">4.<strong class="kd hu">克隆存储库</strong>:在Go工作区中，如下克隆存储库:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="a595" class="mj jk ht na b fv nf ng l nh ni">$ cd $GOPATH/src</span><span id="970b" class="mj jk ht na b fv nj ng l nh ni">$ git clone <a class="ae lh" href="https://github.com/YOUR-USERNAME/trade-finance-logistics" rel="noopener ugc nofollow" target="_blank">https://github.com/YOUR-USERNAME/trade-finance-logistics</a></span></pre><p id="dec1" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">我们现在有了所有贸易-金融-物流教程材料的本地副本。</p><h1 id="6c97" class="jj jk ht bd jl jm jn jo jp jq jr js jt iz ju ja jv jc jw jd jx jf jy jg jz ka dt translated">创建和运行网络配置</h1><p id="63a3" class="pw-post-body-paragraph kb kc ht kd b ke kf iu kg kh ki ix kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">配置和启动我们网络的代码可以在我们存储库的network文件夹中找到(这是对<a class="ae lh" href="https://github.com/hyperledger/fabric-samples/tree/master/first-network" rel="noopener ugc nofollow" target="_blank">fabric-samples/first-network</a>的改编)。在本练习中，我们将在一台物理机或虚拟机上运行整个网络，各种网络元素在适当配置的Docker容器中运行。假设读者对使用Docker的容器化和使用Docker-compose的配置有基本的了解。一旦满足了前一节中列出的先决条件，就足以运行该节中的命令，而不需要读者具备任何额外的知识或配置。</p><h2 id="5231" class="mj jk ht bd jl mk ml mm jp mn mo mp jt kk mq mr jv ko ms mt jx ks mu mv jz mw dt translated">准备网络</h2><p id="03d7" class="pw-post-body-paragraph kb kc ht kd b ke kf iu kg kh ki ix kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">在生成网络加密材料之前，我们需要执行以下步骤:</p><p id="6829" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">1.克隆Fabric(<a class="ae lh" href="https://github.com/hyperledger/fabric/" rel="noopener ugc nofollow" target="_blank">https://github.com/hyperledger/fabric/</a>)源代码库。</p><p id="8786" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">2.运行<code class="eh mx my mz na b">make docker</code>为同行和订购者构建Docker映像。</p><p id="8286" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">3.运行<code class="eh mx my mz na b">make configtxgen cryptogen</code>生成必要的工具来运行本节描述的网络创建命令。</p><p id="0a63" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">4.克隆Fabric-CA(<a class="ae lh" href="https://github.com/hyperledger/fabric-ca" rel="noopener ugc nofollow" target="_blank">https://github.com/hyperledger/fabric-ca</a>)源代码库。</p><p id="5117" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">5.运行<code class="eh mx my mz na b">make docker</code>为MSP构建Docker映像。</p><h2 id="dc24" class="mj jk ht bd jl mk ml mm jp mn mo mp jt kk mq mr jv ko ms mt jx ks mu mv jz mw dt translated">生成网络加密材料</h2><p id="e559" class="pw-post-body-paragraph kb kc ht kd b ke kf iu kg kh ki ix kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">网络配置的第一步包括为每个对等方和订购方组织的MSP以及基于TLS的通信创建证书和签名密钥。我们还需要为每个对等节点和订购节点创建证书和密钥，以便能够相互通信以及与它们各自的MSP通信。这种配置必须在我们代码库中的<code class="eh mx my mz na b">network</code>文件夹中的<code class="eh mx my mz na b">crypto-config.yaml</code>文件中指定。</p><p id="619e" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">该文件包含组织结构、每个组织中的对等体数量以及组织中必须为其创建证书和密钥的默认用户数量(注意，默认情况下会创建一个<code class="eh mx my mz na b">admin</code>用户)。例如，参见文件中进口商组织的定义，如下所示:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="0f68" class="mj jk ht na b fv nf ng l nh ni">PeerOrgs:</span><span id="14d2" class="mj jk ht na b fv nj ng l nh ni">- Name: ImporterOrg</span><span id="6167" class="mj jk ht na b fv nj ng l nh ni">Domain: importerorg.trade.com</span><span id="a839" class="mj jk ht na b fv nj ng l nh ni">EnableNodeOUs: true</span><span id="8a82" class="mj jk ht na b fv nj ng l nh ni">Template:</span><span id="d27b" class="mj jk ht na b fv nj ng l nh ni">Count: 1</span><span id="6b99" class="mj jk ht na b fv nj ng l nh ni">Users:</span><span id="c811" class="mj jk ht na b fv nj ng l nh ni">Count: 2</span></pre><p id="8a7f" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">这个配置表明标记为<code class="eh mx my mz na b">ImporterOrg</code>的组织将包含一个对等体。还将创建两个非管理员用户。还定义了对等方要使用的组织域名。</p><p id="b614" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">要为所有组织生成加密材料，运行<code class="eh mx my mz na b">cryptogen</code>命令，如下所示:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="2ef3" class="mj jk ht na b fv nf ng l nh ni">cryptogen generate — config=./crypto-config.yaml</span></pre><p id="f344" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">输出被保存到<code class="eh mx my mz na b">crypto-config</code>文件夹。</p><h2 id="a1f9" class="mj jk ht bd jl mk ml mm jp mn mo mp jt kk mq mr jv ko ms mt jx ks mu mv jz mw dt translated">产生信道伪像</h2><p id="6653" class="pw-post-body-paragraph kb kc ht kd b ke kf iu kg kh ki ix kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">为了根据组织的结构创建一个网络，并引导一个渠道，我们将需要生成以下工件:</p><p id="37b9" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">起源块，包含用于初始化结构区块链的组织特定证书。</p><p id="0c51" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">通道配置信息。</p><p id="9cb0" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">每个组织的锚定对等配置。锚定对等体充当组织内的支点，用于使用Fabric gossip协议的跨组织分类帐同步。</p><p id="58df" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">像<code class="eh mx my mz na b">crypto-config.yaml</code>文件一样，信道属性在一个标记为<code class="eh mx my mz na b">configtx.yaml</code>的文件中指定，在我们的源代码中，这个文件可以在<code class="eh mx my mz na b">network</code>文件夹中找到。我们贸易网络的高层组织可以在<code class="eh mx my mz na b">Profiles</code>部分找到，如下所示:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="918c" class="mj jk ht na b fv nf ng l nh ni">Profiles:</span><span id="924a" class="mj jk ht na b fv nj ng l nh ni">FourOrgsTradeOrdererGenesis:</span><span id="787a" class="mj jk ht na b fv nj ng l nh ni">Capabilities:</span><span id="4124" class="mj jk ht na b fv nj ng l nh ni">&lt;&lt;: *ChannelCapabilities</span><span id="7695" class="mj jk ht na b fv nj ng l nh ni">Orderer:</span><span id="4bc7" class="mj jk ht na b fv nj ng l nh ni">&lt;&lt;: *OrdererDefaults</span><span id="7875" class="mj jk ht na b fv nj ng l nh ni">Organizations:</span><span id="ba1f" class="mj jk ht na b fv nj ng l nh ni">- *TradeOrdererOrg</span><span id="951a" class="mj jk ht na b fv nj ng l nh ni">Capabilities:</span><span id="187a" class="mj jk ht na b fv nj ng l nh ni">&lt;&lt;: *OrdererCapabilities</span><span id="7f8c" class="mj jk ht na b fv nj ng l nh ni">Consortiums:</span><span id="b1e9" class="mj jk ht na b fv nj ng l nh ni">TradeConsortium:</span><span id="6877" class="mj jk ht na b fv nj ng l nh ni">Organizations:</span><span id="afdf" class="mj jk ht na b fv nj ng l nh ni">- *ExporterOrg</span><span id="b998" class="mj jk ht na b fv nj ng l nh ni">- *ImporterOrg</span><span id="c862" class="mj jk ht na b fv nj ng l nh ni">- *CarrierOrg</span><span id="35a2" class="mj jk ht na b fv nj ng l nh ni">- *RegulatorOrg</span><span id="9662" class="mj jk ht na b fv nj ng l nh ni">FourOrgsTradeChannel:</span><span id="6f2c" class="mj jk ht na b fv nj ng l nh ni">Consortium: TradeConsortium</span><span id="8d02" class="mj jk ht na b fv nj ng l nh ni">Application:</span><span id="89f7" class="mj jk ht na b fv nj ng l nh ni">&lt;&lt;: *ApplicationDefaults</span><span id="b575" class="mj jk ht na b fv nj ng l nh ni">Organizations:</span><span id="1800" class="mj jk ht na b fv nj ng l nh ni">- *ExporterOrg</span><span id="2b5c" class="mj jk ht na b fv nj ng l nh ni">- *ImporterOrg</span><span id="4e0c" class="mj jk ht na b fv nj ng l nh ni">- *CarrierOrg</span><span id="3f48" class="mj jk ht na b fv nj ng l nh ni">- *RegulatorOrg</span><span id="7673" class="mj jk ht na b fv nj ng l nh ni">Capabilities:</span><span id="4193" class="mj jk ht na b fv nj ng l nh ni">&lt;&lt;: *ApplicationCapabilities</span></pre><p id="9755" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">正如我们所看到的，我们将要创建的通道被命名为<code class="eh mx my mz na b">FourOrgsTradeChannel</code>，它是在概要文件中定义的。参与该通道的四个组织被标记为<code class="eh mx my mz na b">ExporterOrg</code>、<code class="eh mx my mz na b">ImporterOrg</code>、<code class="eh mx my mz na b">CarrierOrg</code>和<code class="eh mx my mz na b">RegulatorOrg</code>，每一个都引用了在<code class="eh mx my mz na b">Organizations</code>部分中定义的一个子部分。订购者属于自己的名为<code class="eh mx my mz na b">TradeOrdererOrg</code>的组织。每个组织部分包含有关其MSP的信息(ID以及加密材料的位置，如密钥和证书)，以及其锚定对等体的主机名和端口信息。例如，<code class="eh mx my mz na b">ExporterOrg</code>部分包含以下内容:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="b41d" class="mj jk ht na b fv nf ng l nh ni">- &amp;ExporterOrg</span><span id="a309" class="mj jk ht na b fv nj ng l nh ni">Name: ExporterOrgMSP</span><span id="8616" class="mj jk ht na b fv nj ng l nh ni">ID: ExporterOrgMSP</span><span id="126b" class="mj jk ht na b fv nj ng l nh ni">MSPDir: crypto-config/peerOrganizations/exporterorg.trade.com/msp</span><span id="73a8" class="mj jk ht na b fv nj ng l nh ni">AnchorPeers:</span><span id="43a9" class="mj jk ht na b fv nj ng l nh ni">- Host: peer0.exporterorg.trade.com</span><span id="5af0" class="mj jk ht na b fv nj ng l nh ni">Port: 7051</span></pre><p id="e936" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">如您所见，本规范中的<code class="eh mx my mz na b">MSPDir</code>变量(代表一个文件夹)引用了我们之前使用<code class="eh mx my mz na b">cryptogen</code>工具生成的加密材料。</p><p id="d4a0" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">为了生成通道工件，我们使用<code class="eh mx my mz na b">configtxgen</code>工具。要生成genesis块(将在网络引导期间发送给订购方)，从<code class="eh mx my mz na b">network</code>文件夹运行以下命令:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="ce3b" class="mj jk ht na b fv nf ng l nh ni">configtxgen -profile FourOrgsTradeOrdererGenesis -outputBlock ./channel-artifacts/genesis.block</span></pre><p id="3dd6" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated"><code class="eh mx my mz na b">FourOrgsTradeOrdererGenesis</code>关键字对应于<code class="eh mx my mz na b">Profiles</code>部分中的配置文件名。genesis块将保存在<code class="eh mx my mz na b">channel-artifacts</code>文件夹的<code class="eh mx my mz na b">genesis.block</code>文件中。若要生成通道配置，请运行以下代码:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="1e61" class="mj jk ht na b fv nf ng l nh ni">configtxgen -profile FourOrgsTradeChannel -outputCreateChannelTx ./channel-artifacts/channel.tx -channelID tradechannel</span></pre><p id="9567" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">我们将创建的通道命名为<code class="eh mx my mz na b">tradechannel</code>，其配置存储在<code class="eh mx my mz na b">channel-artifacts/channel.tx</code>中。要为导出者组织生成锚点对等配置，请运行:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="6b56" class="mj jk ht na b fv nf ng l nh ni">configtxgen -profile FourOrgsTradeChannel -outputAnchorPeersUpdate ./channel-artifacts/ExporterOrgMSPanchors.tx -channelID tradechannel -asOrg ExporterOrgMSP</span></pre><p id="61a7" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">应该对其他三个组织重复相同的过程，同时在前面的命令中更改组织名称。</p><h2 id="e932" class="mj jk ht bd jl mk ml mm jp mn mo mp jt kk mq mr jv ko ms mt jx ks mu mv jz mw dt translated">在一个操作中生成配置</h2><p id="3397" class="pw-post-body-paragraph kb kc ht kd b ke kf iu kg kh ki ix kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">为了方便起见，<code class="eh mx my mz na b">trade.sh</code>脚本被配置为使用前面描述的命令和配置文件来生成通道工件以及加密材料。只需在<code class="eh mx my mz na b">network</code>文件夹中运行以下命令:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="6a6d" class="mj jk ht na b fv nf ng l nh ni">./trade.sh generate -c tradechannel</span></pre><p id="b650" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">尽管您可以在这里指定任何通道名称，但是请注意，用于开发中间件的配置将依赖于该名称。</p><h2 id="d0be" class="mj jk ht bd jl mk ml mm jp mn mo mp jt kk mq mr jv ko ms mt jx ks mu mv jz mw dt translated">构建一个样本贸易网络</h2><p id="86fb" class="pw-post-body-paragraph kb kc ht kd b ke kf iu kg kh ki ix kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">最后一个命令还具有生成网络配置文件<code class="eh mx my mz na b">docker-compose-e2e.yaml</code>的作用，该文件用于使用docker-compose工具启动作为一组Docker容器的网络。文件本身依赖于静态配置的文件<code class="eh mx my mz na b">base/peer-base.yaml</code>和<code class="eh mx my mz na b">base/docker-compose-base.yaml</code>。这些文件共同指定服务及其属性，使我们能够在Docker容器中一次性运行它们，而不必在一台或多台机器上手动运行这些服务的实例。我们需要运行的服务如下:</p><p id="92d2" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">一个结构对等体的四个实例，每个组织一个</p><p id="2a39" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">织物订购者的一个实例</p><p id="bc23" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">一个结构CA的五个实例，对应于每个组织的MSP</p><p id="a2c4" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">可以从Docker Hub(<a class="ae lh" href="https://hub.docker.com/u/hyperledger/" rel="noopener ugc nofollow" target="_blank">https://hub.docker.com/u/hyperledger/</a>)上的Hyperledger项目中获得每一个的Docker映像，映像分别是hyperledger/fabric-peer、Hyperledger/fabric-orderer、Hyperledger/fabric-ca for peer、order和MSP。</p><p id="7d0e" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">对等端的基本配置如下(请参见base/peer-base.yaml):</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="310a" class="mj jk ht na b fv nf ng l nh ni">peer-base:</span><span id="ec5b" class="mj jk ht na b fv nj ng l nh ni">image: hyperledger/fabric-peer:$IMAGE_TAG</span><span id="d13a" class="mj jk ht na b fv nj ng l nh ni">environment:</span><span id="25ab" class="mj jk ht na b fv nj ng l nh ni">- CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock</span><span id="416b" class="mj jk ht na b fv nj ng l nh ni">-   CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${COMPOSE_PROJECT_NAME}_trade</span><span id="816d" class="mj jk ht na b fv nj ng l nh ni">- CORE_LOGGING_LEVEL=INFO</span><span id="287a" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_TLS_ENABLED=true</span><span id="1fe8" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_GOSSIP_USELEADERELECTION=true</span><span id="31a9" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_GOSSIP_ORGLEADER=false</span><span id="38e1" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_PROFILE_ENABLED=true</span><span id="1522" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_TLS_CERT_FILE=/etc/hyperledger/fabric/tls/server.crt</span><span id="dac9" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_TLS_KEY_FILE=/etc/hyperledger/fabric/tls/server.key</span><span id="9481" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_TLS_ROOTCERT_FILE=/etc/hyperledger/fabric/tls/ca.crt</span><span id="ca93" class="mj jk ht na b fv nj ng l nh ni">working_dir: /opt/gopath/src/github.com/hyperledger/fabric/peer</span><span id="e376" class="mj jk ht na b fv nj ng l nh ni">command: peer node start</span></pre><p id="8470" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">可以在这里设置Fabric配置参数，但是如果您为<code class="eh mx my mz na b">fabric-peer</code>使用预构建的Docker映像，默认值足以启动并运行对等服务。运行对等服务的命令在配置的最后一行被指定为<code class="eh mx my mz na b">peer node start</code>；如果您希望通过下载Fabric源代码并在您的本地机器上构建它来运行一个peer，那么您必须运行这个命令。还要确保使用<code class="eh mx my mz na b">CORE_LOGGING_LEVEL</code>变量适当地配置日志记录级别。在我们的配置中，变量被设置为<code class="eh mx my mz na b">INFO</code>，这意味着只记录信息、警告和错误消息。如果您希望调试一个对等体并需要更广泛的日志记录，您可以将这个变量设置为<code class="eh mx my mz na b">DEBUG</code>。</p><p id="aceb" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">此外，我们需要为每个对等体配置主机名和端口，并将生成的加密材料(使用<code class="eh mx my mz na b">cryptogen</code>)同步到容器文件系统。出口组织中的对等方在<code class="eh mx my mz na b">base/docker-compose-base.yaml</code>中配置如下:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="6a13" class="mj jk ht na b fv nf ng l nh ni">peer0.exporterorg.trade.com:</span><span id="1371" class="mj jk ht na b fv nj ng l nh ni">container_name: peer0.exporterorg.trade.com</span><span id="4468" class="mj jk ht na b fv nj ng l nh ni">extends:</span><span id="df57" class="mj jk ht na b fv nj ng l nh ni">file: peer-base.yaml</span><span id="e56f" class="mj jk ht na b fv nj ng l nh ni">service: peer-base</span><span id="41d9" class="mj jk ht na b fv nj ng l nh ni">environment:</span><span id="b8db" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_ID=peer0.exporterorg.trade.com</span><span id="1c48" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_ADDRESS=peer0.exporterorg.trade.com:7051</span><span id="f156" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_GOSSIP_BOOTSTRAP=peer0.exporterorg.trade.com:7051</span><span id="b36a" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer0.exporterorg.trade.com:7051</span><span id="180c" class="mj jk ht na b fv nj ng l nh ni">- CORE_PEER_LOCALMSPID=ExporterOrgMSP</span><span id="4200" class="mj jk ht na b fv nj ng l nh ni">volumes:</span><span id="e773" class="mj jk ht na b fv nj ng l nh ni">- /var/run/:/host/var/run/</span><span id="21cc" class="mj jk ht na b fv nj ng l nh ni">- ../crypto-config/peerOrganizations/exporterorg.trade.com/peers/peer0.exporterorg.trade.com/msp:/etc/hyperledger/fabric/msp</span><span id="9064" class="mj jk ht na b fv nj ng l nh ni">- ../crypto-config/peerOrganizations/exporterorg.trade.com/peers/peer0.exporterorg.trade.com/tls:/etc/hyperledger/fabric/tls</span><span id="c71b" class="mj jk ht na b fv nj ng l nh ni">- peer0.exporterorg.trade.com:/var/hyperledger/production</span><span id="0318" class="mj jk ht na b fv nj ng l nh ni">ports:</span><span id="2b41" class="mj jk ht na b fv nj ng l nh ni">- 7051:7051</span><span id="c454" class="mj jk ht na b fv nj ng l nh ni">- 7053:7053</span></pre><p id="1bd2" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">如<code class="eh mx my mz na b">extends</code>参数所示，这扩展了基本配置。请注意，ID ( <code class="eh mx my mz na b">CORE_PEER_ID</code>)与在<code class="eh mx my mz na b">configtx.yaml</code>中为该对等体指定的ID相匹配。这个身份是在导出者组织中运行的对等体的主机名，并将在中间件代码中使用。volumes部分指示将在<code class="eh mx my mz na b">crypto-config</code>文件夹中生成的加密材料复制到容器的规则。对等服务本身监听端口<code class="eh mx my mz na b">7051</code>，客户端可以用来订阅事件的端口被设置为<code class="eh mx my mz na b">7053</code>。</p><p id="8151" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">订购者服务的配置与此类似，如下面来自<code class="eh mx my mz na b">base/docker-compose-base.yaml indicates</code>的片段所示:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="befd" class="mj jk ht na b fv nf ng l nh ni">orderer.trade.com:</span><span id="a944" class="mj jk ht na b fv nj ng l nh ni">container_name: orderer.trade.com</span><span id="bffb" class="mj jk ht na b fv nj ng l nh ni">image: hyperledger/fabric-orderer:$IMAGE_TAG</span><span id="739f" class="mj jk ht na b fv nj ng l nh ni">environment:</span><span id="baa8" class="mj jk ht na b fv nj ng l nh ni">- ORDERER_GENERAL_LOGLEVEL=INFO</span><span id="93e7" class="mj jk ht na b fv nj ng l nh ni">……</span><span id="3cca" class="mj jk ht na b fv nj ng l nh ni">command: orderer</span><span id="83fa" class="mj jk ht na b fv nj ng l nh ni">……</span></pre><p id="c61a" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">如代码所示，启动订购者的命令很简单<code class="eh mx my mz na b">orderer</code>。日志记录级别可以使用<code class="eh mx my mz na b">ORDERER_GENERAL_LOGLEVEL</code>变量进行配置，在我们的配置中设置为<code class="eh mx my mz na b">INFO</code>。</p><p id="61f3" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">我们将运行的实际网络配置基于一个名为<code class="eh mx my mz na b">docker-compose-e2e.yaml</code>的文件。该文件不存在于存储库中，而是由命令<code class="eh mx my mz na b">./trade.sh generate -c tradechannel</code>创建的，我们之前运行该命令来生成通道和加密材料。这个文件依赖于<code class="eh mx my mz na b">base/docker-compose-base.yaml</code>(并间接依赖于<code class="eh mx my mz na b">base/peer-base.yaml</code>)，通过检查文件内容可以看出这一点。它实际上是从一个名为<code class="eh mx my mz na b">docker-compose-e2e-template.yaml</code>的模板<code class="eh mx my mz na b">YAML</code>文件创建的，你可以在<code class="eh mx my mz na b">network</code>文件夹中找到它。模板文件包含变量，作为使用<code class="eh mx my mz na b">cryptogen</code>生成的关键文件名的替代。当生成<code class="eh mx my mz na b">docker-compose-e2e.yaml</code>时，这些变量名被替换为<code class="eh mx my mz na b">crypto-config</code>文件夹中的实际文件名。</p><p id="fa4c" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">例如，考虑<code class="eh mx my mz na b">docker-compose-e2e-template.yaml</code>中的<code class="eh mx my mz na b">exporter-ca</code>部分:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="ea64" class="mj jk ht na b fv nf ng l nh ni">exporter-ca:</span><span id="9b52" class="mj jk ht na b fv nj ng l nh ni">image: hyperledger/fabric-ca:$IMAGE_TAG</span><span id="775d" class="mj jk ht na b fv nj ng l nh ni">environment:</span><span id="e8a2" class="mj jk ht na b fv nj ng l nh ni">……</span><span id="8b2c" class="mj jk ht na b fv nj ng l nh ni">- FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/EXPORTER_CA_PRIVATE_KEY</span><span id="0634" class="mj jk ht na b fv nj ng l nh ni">……</span><span id="b356" class="mj jk ht na b fv nj ng l nh ni">command: sh -c ‘fabric-ca-server start — ca.certfile /etc/hyperledger/fabric-ca-server-config/ca.exporterorg.trade.com-cert.pem — ca.keyfile /etc/hyperledger/fabric-ca-server-config/EXPORTER_CA_PRIVATE_KEY -b admin:adminpw -d’</span></pre><p id="8ff0" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">现在，看看生成的文件<code class="eh mx my mz na b">docker-compose-e2e.yaml</code>中的相同部分:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="b93c" class="mj jk ht na b fv nf ng l nh ni">exporter-ca:</span><span id="2a40" class="mj jk ht na b fv nj ng l nh ni">image: hyperledger/fabric-ca:$IMAGE_TAG</span><span id="ca88" class="mj jk ht na b fv nj ng l nh ni">environment:</span><span id="7923" class="mj jk ht na b fv nj ng l nh ni">……</span><span id="cc0a" class="mj jk ht na b fv nj ng l nh ni">- FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/ cc58284b6af2c33812cfaef9e40b8c911dbbefb83ca2e7564e8fbf5e7039c22e_sk</span><span id="2df6" class="mj jk ht na b fv nj ng l nh ni">……</span><span id="28a3" class="mj jk ht na b fv nj ng l nh ni">command: sh -c ‘fabric-ca-server start — ca.certfile /etc/hyperledger/fabric-ca-server-config/ca.exporterorg.trade.com-cert.pem — ca.keyfile /etc/hyperledger/fabric-ca-server-config/cc58284b6af2c33812cfaef9e40b8c911dbbefb83ca2e7564e8fbf5e7039c22e_sk -b admin:adminpw -d’</span></pre><p id="e5be" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">如您所见，在环境变量和命令中，变量<code class="eh mx my mz na b">EXPORTER_CA_PRIVATE_KEY</code>都被替换为<code class="eh mx my mz na b">cc58284b6af2c33812cfaef9e40b8c911dbbefb83ca2e7564e8fbf5e7039c22e_sk</code>。如果您现在检查<code class="eh mx my mz na b">crypto-config</code>文件夹的内容，您会注意到在文件夹<code class="eh mx my mz na b">crypto-config/peerOrganizations/exporterorg.trade.com/ca/</code>中存在一个名为<code class="eh mx my mz na b">cc58284b6af2c33812cfaef9e40b8c911dbbefb83ca2e7564e8fbf5e7039c22e_sk</code>的文件。该文件包含导出组织的MSP私有(秘密)签名密钥。</p><p id="4c55" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">现在让我们更详细地看看MSP的配置，以出口组织MSP为例，如<code class="eh mx my mz na b">docker-compose-e2e.yaml</code>中所述:</p><pre class="lo lp lq lr fq nb na nc nd aw ne dt"><span id="1754" class="mj jk ht na b fv nf ng l nh ni">exporter-ca:</span><span id="daf7" class="mj jk ht na b fv nj ng l nh ni">image: hyperledger/fabric-ca:$IMAGE_TAG</span><span id="ec9a" class="mj jk ht na b fv nj ng l nh ni">environment:</span><span id="0580" class="mj jk ht na b fv nj ng l nh ni">- FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server</span><span id="de77" class="mj jk ht na b fv nj ng l nh ni">- FABRIC_CA_SERVER_CA_NAME=ca-exporterorg</span><span id="6856" class="mj jk ht na b fv nj ng l nh ni">- FABRIC_CA_SERVER_TLS_ENABLED=true</span><span id="97eb" class="mj jk ht na b fv nj ng l nh ni">- FABRIC_CA_SERVER_TLS_CERTFILE=/etc/hyperledger/fabric-ca-server-config/ca.exporterorg.trade.com-cert.pem</span><span id="760c" class="mj jk ht na b fv nj ng l nh ni">- FABRIC_CA_SERVER_TLS_KEYFILE=/etc/hyperledger/fabric-ca-server-config/cc58284b6af2c33812cfaef9e40b8c911dbbefb83ca2e7564e8fbf5e7039c22e_sk</span><span id="930c" class="mj jk ht na b fv nj ng l nh ni">ports:</span><span id="f4c5" class="mj jk ht na b fv nj ng l nh ni">- “7054:7054”</span><span id="409b" class="mj jk ht na b fv nj ng l nh ni">command: sh -c ‘fabric-ca-server start — ca.certfile /etc/hyperledger/fabric-ca-server-config/ca.exporterorg.trade.com-cert.pem — ca.keyfile /etc/hyperledger/fabric-ca-server-config/cc58284b6af2c33812cfaef9e40b8c911dbbefb83ca2e7564e8fbf5e7039c22e_sk -b admin:adminpw -d’</span><span id="14eb" class="mj jk ht na b fv nj ng l nh ni">volumes:</span><span id="01e6" class="mj jk ht na b fv nj ng l nh ni">- ./crypto-config/peerOrganizations/exporterorg.trade.com/ca/:/etc/hyperledger/fabric-ca-server-config</span><span id="08f3" class="mj jk ht na b fv nj ng l nh ni">container_name: ca_peerExporterOrg</span><span id="e14e" class="mj jk ht na b fv nj ng l nh ni">networks:</span><span id="05ca" class="mj jk ht na b fv nj ng l nh ni">- trade</span></pre><p id="68b4" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">将在MSP中运行的服务是<code class="eh mx my mz na b">fabric-ca-server</code>，它监听端口<code class="eh mx my mz na b">7054</code>，使用使用<code class="eh mx my mz na b">cryptogen</code>创建的证书和密钥进行引导，并使用在<code class="eh mx my mz na b">fabric-ca</code>映像中配置的默认登录和密码(分别为<code class="eh mx my mz na b">admin</code>和<code class="eh mx my mz na b">adminpw</code>)。启动Fabric CA服务器实例的命令是<code class="eh mx my mz na b">fabric-ca-server start …</code>，正如您在前面的代码中看到的。</p><p id="f576" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">如前面的配置所示，对等体和ca被配置用于基于TLS的通信。读者必须注意，如果TLS在一个中被禁用，那么它在另一个中也必须被禁用。</p><p id="11ec" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated">此外，通过检查<code class="eh mx my mz na b">docker-compose-e2e.yaml</code>可以看出，我们没有为订购者的组织创建一个结构CA服务器(和容器)。对于本练习，为订购者静态创建的管理员用户和凭证就足够了；我们不会动态注册新的订购者组织用户，因此不需要结构CA服务器。</p><p id="cfc7" class="pw-post-body-paragraph kb kc ht kd b ke md iu kg kh me ix kj kk mf km kn ko mg kq kr ks mh ku kv kw hm dt translated"><em class="nk">如果您觉得这篇文章很有趣，您可以使用Hyperledger </em>  <em class="nk">亲自探索</em> <a class="ae lh" href="https://www.amazon.com/Hands-Blockchain-Hyperledger-decentralized-applications/dp/1788994523" rel="noopener ugc nofollow" target="_blank"> <em class="nk">区块链，利用Hyperledger Fabric的强大功能轻松开发基于区块链的分布式账本。</em> </a><a class="ae lh" href="https://www.packtpub.com/big-data-and-business-intelligence/hands-blockchain-hyperledger" rel="noopener ugc nofollow" target="_blank"> <em class="nk">使用Hyperledger的动手区块链</em> </a> <em class="nk">是一个使用Hyperledger技术探索和构建区块链网络的简单参考。</em></p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><a href="http://bit.ly/2G71Sp7"><div class="fe ff nl"><img src="../Images/449450761cd76f44f9ae574333f9e9af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKX2mtg7p1lOs7JmosPLsA.png"/></div></a></figure><blockquote class="kx"><p id="776a" class="ky kz ht bd la lb nm nn no np nq kw ek translated"><a class="ae lh" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="ns nt nu nv nw ls fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nr"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>