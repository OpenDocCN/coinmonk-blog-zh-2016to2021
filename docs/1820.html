<html>
<head>
<title>A crash course on Proof-of-Stake (Part II)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利害关系证明速成班(第二部分)</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/a-crash-course-on-proof-of-stake-part-ii-96aeea8a0f58?source=collection_archive---------1-----------------------#2018-11-23">https://medium.com/coinmonks/a-crash-course-on-proof-of-stake-part-ii-96aeea8a0f58?source=collection_archive---------1-----------------------#2018-11-23</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="b126" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">利益证明的概念证明</h2></div><h2 id="b3a0" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">目录</h2><ul class=""><li id="b07e" class="kg kh ht ki b kj kk kl km jt kn jx ko kb kp kq kr ks kt ku dt translated"><a class="ae kv" rel="noopener" href="/coinmonks/a-crash-course-on-proof-of-stake-part-i-843e7a44c682">先决条件和动机</a></li><li id="c142" class="kg kh ht ki b kj kw kl kx jt ky jx kz kb la kq kr ks kt ku dt translated">一个概念证明用于证明<strong class="ki hu"> <em class="lb">(本帖)</em> </strong></li><li id="089d" class="kg kh ht ki b kj kw kl kx jt ky jx kz kb la kq kr ks kt ku dt translated"><a class="ae kv" rel="noopener" href="/coinmonks/a-crash-course-on-proof-of-stake-part-iii-67aa720ea08f">分散随机数生成简介</a></li><li id="71ed" class="kg kh ht ki b kj kw kl kx jt ky jx kz kb la kq kr ks kt ku dt translated">可验证延迟函数和可验证秘密共享<em class="lb">(即将推出)</em></li><li id="7a77" class="kg kh ht ki b kj kw kl kx jt ky jx kz kb la kq kr ks kt ku dt translated">没什么利害关系和远程攻击<em class="lb">(即将推出)</em></li></ul><figure class="ld le lf lg fq lh fe ff paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="fe ff lc"><img src="../Images/295f5304f0a26b2b31d67635c0278183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPJbzQ37PVfqKFwuxeJ3zg.png"/></div></div><figcaption class="lo lp fg fe ff lq lr bd b be z ek">Adopted from an original by <a class="ae kv" href="https://pixabay.com/en/users/analogicus-8164369/" rel="noopener ugc nofollow" target="_blank">analogicus</a> on pixabay.com</figcaption></figure><p id="0677" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">到目前为止，我们已经了解到利害关系证明的核心思想是使用“利害关系”而不是“工作”或计算能力来保护区块链的投票机制免受<a class="ae kv" href="https://en.wikipedia.org/wiki/Sybil_attack" rel="noopener ugc nofollow" target="_blank"> Sybil攻击</a>。这种替换只有在分散随机数生成(DRNG)机制的帮助下才可能选择下一个挖掘器；与工作证明不同，这种机制不需要大量的计算。</p><p id="57aa" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">在这篇文章中，我介绍了一个简单实用的利害关系证明方案，并对其进行了检验，以获得一些关于利害关系证明的一般理解。除了教育意义之外，这种天真的实用方案还具有历史意义，因为它实现了第一个真实世界实现的利害关系证明区块链，如<a class="ae kv" href="https://en.wikipedia.org/wiki/Nxt" rel="noopener ugc nofollow" target="_blank"> NXT </a>和<a class="ae kv" href="https://en.wikipedia.org/wiki/Peercoin" rel="noopener ugc nofollow" target="_blank"> Peercoin </a>。</p></div><div class="ab cl mh mi hb mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hm hn ho hp hq"><h1 id="46cc" class="mo jj ht bd jk mp mq mr jo ms mt mu js iz mv ja jw jc mw jd ka jf mx jg ke my dt translated">利益证明的概念证明</h1><p id="8f76" class="pw-post-body-paragraph ls lt ht ki b kj kk iu lv kl km ix lx jt mz lz ma jx na mc md kb nb mf mg kq hm dt translated">假设我们想从比特币中构建一个股权证明分叉！我们称之为比特币做赌注凭证，简称BTP。首先，我们必须向系统添加两种新的特殊用途交易类型，如下所示:</p><ul class=""><li id="a74e" class="kg kh ht ki b kj lu kl lw jt nc jx nd kb ne kq kr ks kt ku dt translated"><strong class="ki hu">赌注交易</strong>:任何人都可以在这类交易中下注(锁定)任何金额，成为利益相关者。</li><li id="69f8" class="kg kh ht ki b kj kw kl kx jt ky jx kz kb la kq kr ks kt ku dt translated"><strong class="ki hu">提款交易</strong>:利益相关者，也就是那些已经通过下注交易下注了一些硬币的人，可以通过这种类型的交易提取他们的股份。</li></ul><p id="4b91" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">按照普通交易，任何人都可以生成<em class="lb">押记</em>或<em class="lb">提款</em>交易，需要纳入区块链才能生效。此外，我们将终止工作证明。因此，我们分块移除<a class="ae kv" href="https://en.bitcoin.it/wiki/Nonce" rel="noopener ugc nofollow" target="_blank"> nonce </a>字段。(<em class="lb">回想一下:每个有效块都包括一个黄金随机数，它是一个32位的数字，使得整个块的散列值低于目标值。黄金随机数是矿工应该解决的哈希难题的答案。</em>)</p><p id="6723" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">假设利益相关者已经下注了一些硬币。在每一轮中，在创建每个新块后，协议必须从可用的利益相关者中随机选择下一个块的矿工，其概率与他们的股份与总股份的比率有关。让我们使用最后一个块的<a class="ae kv" href="https://en.wikipedia.org/wiki/Hash_function" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hu">散列</strong> </a> <strong class="ki hu">作为随机性的来源，并根据它选择下一个块的矿工。虽然哈希函数是确定性函数，但是它们对输入的变化非常敏感，并且通常传统上使用任意输入的哈希函数的结果作为随机性的来源。</strong></p><p id="2cb1" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">准确地说，我们按照地址的顺序对<em class="lb"> N </em>个可用的利益相关者进行排序，并为每个利益相关者分配一个非重叠区间，该区间的长度等于其股份与总股份乘以散列函数输出范围的比值(因此，分配区间的长度之和等于<em class="lb">max(hash(x))-min(hash(x))+1</em>)。其对应区间包含上一个块的哈希的利益相关者有机会挖掘下一个块，如果他这样做了，他将获得奖励。</p><p id="b539" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated"><strong class="ki hu">我们使用<a class="ae kv" href="https://en.wikipedia.org/wiki/SHA-2" rel="noopener ugc nofollow" target="_blank"><em class="lb">SHA256</em></a><em class="lb"/>作为我们的哈希函数，sha 256的输出是一个256位的数，所以它的范围是2 ⁵⁶.我只是对每个块的哈希做了一些假设。</strong></p><figure class="ld le lf lg fq lh fe ff paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="fe ff nf"><img src="../Images/335873270c582f4342ab72b60277c93c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SdDJfML9SOYqZS88ToPFOg.png"/></div></div><figcaption class="lo lp fg fe ff lq lr bd b be z ek">A snapshot from the blockchain of BTP. At block #m, number of available validators is N = 3.</figcaption></figure><p id="7aa7" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">请注意，块之间必须有一个强制的最小延迟，比如说<em class="lb"> d </em>秒，以便<strong class="ki hu">为新块提供足够的时间在整个网络中传播</strong>。因此，尽管块创建不需要解决耗费大量时间的硬散列难题，我们仍然需要延迟这个过程。</p><p id="6ff2" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">但是如果被选中的矿工不广播新块呢？选定的矿工可能会崩溃或碰巧是恶意的。好吧，如果被选中的矿工在<em class="lb"> D </em>秒内没有响应，显然是<em class="lb"> D &gt; d </em>，协议通过<strong class="ki hu">烧掉其部分股权</strong>来惩罚他，并将生产新区块的任务分配给名单中的下一个利益相关者。</p><p id="6c80" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">所谓的协议将以分散的方式执行。这意味着每个人都在他们的电脑上运行协议，每个人都可以看到区块链的本地视图。因此，<strong class="ki hu">每个人必须本地决定</strong>下一个块的选定矿工是否已经延迟超过<em class="lb"> D </em>秒。例如，假设现在最长的链的长度是<em class="lb"> m </em>并且<em class="lb"> V </em>被选择作为块号<em class="lb"> m+1的挖掘者。</em>如果你在<em class="lb"> D </em>秒前收到<em class="lb"> V </em>创造的新方块，而我在<em class="lb"> D </em>秒后收到，在你看来，<em class="lb"> V </em>已经诚实行事并获得了奖励，而在我看来，<em class="lb"> V </em>是恶意的或不负责任的并受到了惩罚。因此，<strong class="ki hu">网络延迟或恶意行为可能会导致在区块链分叉</strong>。</p><p id="9ee2" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">我们已经完成了说明书的关键部分，找到了一些市场合作伙伴，并准备为BTP福克开展大规模的宣传活动！耶！</p><p id="7a5f" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">但是等一下，让我们先做一些安全分析😁。</p><h2 id="ef76" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">BTP的安全分析</h2><p id="a9f9" class="pw-post-body-paragraph ls lt ht ki b kj kk iu lv kl km ix lx jt mz lz ma jx na mc md kb nb mf mg kq hm dt translated"><strong class="ki hu"> 1)最后一个块散列的偏差</strong></p><p id="6b15" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">假设您是生成下一个块的选定利益相关者。您可以决定将哪组事务放入您的块中。因此，您可以控制散列函数的输入，从而控制其结果输出。为什么不试着让自己再次成为下一个矿工？你需要在超时之前测试一些不同的事务集，在<em class="lb"> D </em>秒过去之前，希望找到一组事务，让你再次成为下一个块的矿工。所以最后一个块的散列作为一个随机数是有偏差的，这是不好的。我们将在下一篇关于分散随机数生成的文章中研究这个问题。</p><figure class="ld le lf lg fq lh fe ff paragraph-image"><div class="fe ff ng"><img src="../Images/f760d4e9e590df2c8410c3cfb9cbc8b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*vjSTcnmaiDqw_0ZfMnztdQ.png"/></div><figcaption class="lo lp fg fe ff lq lr bd b be z ek">Maybe this gives you an idea about marketing strategies for BTP! Copyright reserved for <a class="ae kv" href="https://xkcd.com/1277/" rel="noopener ugc nofollow" target="_blank">xkcd.com</a>.</figcaption></figure><p id="9130" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated"><strong class="ki hu"> 2)需要新的选叉规则</strong></p><p id="c0ca" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">正如我前面提到的，在BTP，分叉可能是由于网络延迟或被选中的矿商封锁(不公开广播开采区块的行为)而发生的。这些分叉需要得到解决；否则，过不了多久，网络就会过时，因为人们不再能就交易的顺序达成一致。分叉选择规则是在不同分叉之间进行选择的共同基础。</p><p id="17c1" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">工作证明使用“遵循最长的链”作为分叉选择规则，它保证了规范区块链上的最终协议，但是如果我们在这里使用相同的思想，恶意方可以很容易地攻击并使整个系统停止运行！</p><p id="0c87" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated"><em class="lb">下面是方法:</em>假设你是被选中的下一个矿工，你是一个值得尊敬的攻击者！首先，你不公开发表任何东西，假装下一个被选中的矿工没有回应，然后继续下一个矿工，直到根据协议你再次成为被选中的矿工，然后重复同样的过程。与此同时，随着你获得回报，你在你私人持有的区块链中的股份越来越多，所以随着你持有的股份越来越多，你的工作会变得更容易。虽然<strong class="ki hu">公共网络被迫等待至少<em class="lb"> d </em>秒</strong>才能传播每个块，但你可以尽可能快地生成新块(这比每<em class="lb"> d </em>秒生成一个块要快得多)。最终，你有一个更长的链，然后你发布它。恭喜您，您已经恢复了此期间的所有交易，甚至赢得了可观的奖励。这种攻击被称为<em class="lb">远程攻击</em>。</p><p id="2d53" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">从上面我们已经看到，“跟随最长的链”作为我们的证据方案的叉选择规则是不可接受的，但是也许其他选项如“跟随具有最大利害关系的链”对我们来说是有用的。我们将在接下来的帖子中讨论分叉选择规则，以及它与典型攻击的关系。</p></div><div class="ab cl mh mi hb mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hm hn ho hp hq"><h1 id="de26" class="mo jj ht bd jk mp mq mr jo ms mt mu js iz mv ja jw jc mw jd ka jf mx jg ke my dt translated">下一步是什么？</h1><p id="610d" class="pw-post-body-paragraph ls lt ht ki b kj kk iu lv kl km ix lx jt mz lz ma jx na mc md kb nb mf mg kq hm dt translated">我们已经了解了“利害关系证明”的核心理念，以及实施这一理念的简单实用的方法。然而，正如你已经理解的那样，我们需要更仔细地研究分散式随机数生成和可能的攻击，这正是我们在下面的帖子中要做的。</p><p id="1d27" class="pw-post-body-paragraph ls lt ht ki b kj lu iu lv kl lw ix lx jt ly lz ma jx mb mc md kb me mf mg kq hm dt translated">如果您准备好进行分散随机数生成，请转至<a class="ae kv" rel="noopener" href="/@mmjahanara/a-crash-course-on-proof-of-stake-part-iii-67aa720ea08f"> <em class="lb">第三部分</em> </a>。</p><blockquote class="nh"><p id="af7d" class="ni nj ht bd nk nl nm nn no np nq kq ek translated"><a class="ae kv" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="ns nt nu nv nw lh fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nr"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>