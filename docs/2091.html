<html>
<head>
<title>Teach yourself — Hyperledger in 24 hours — Hour 02:00 — Hyperledger Fabric — Architecture Deep Dive</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自学—24小时内的Hyperledger—02:00—Hyperledger结构—体系结构深度探讨</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/teach-yourself-hyperledger-in-24-hours-hour-02-00-hyperledger-fabric-architecture-deep-dive-a2f52c1d01ad?source=collection_archive---------2-----------------------#2019-02-20">https://medium.com/coinmonks/teach-yourself-hyperledger-in-24-hours-hour-02-00-hyperledger-fabric-architecture-deep-dive-a2f52c1d01ad?source=collection_archive---------2-----------------------#2019-02-20</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/cd3bc8fad655f7f4522cae2aa0a07f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uHj1Az44Tb6ZTZ6B.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">Source: Google</figcaption></figure><p id="7bbb" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">您好，感谢您花时间阅读本系列。我相信，您已经从<a class="ae kd" rel="noopener" href="/@lokeshwaran.a82/teach-yourself-hyperledger-in-24-hours-hour-00-00-hyperledger-introduction-34675fcd629a">小时00:00 </a>开始，如果没有，请在继续下一步之前完成。</p><p id="91f6" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">在开始编码之前，理解核心架构是非常重要的。因为不知道basic是如何工作的，你将会在研究和调试中浪费大量的时间。所以在本文中，我们将重点介绍Hyperledger Fabric架构原理！..</p><p id="3146" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">Hyperledger结构的基本构建块如下</p><ul class=""><li id="4de0" class="ke kf ht jh b ji jj jm jn jq kg ju kh jy ki kc kj kk kl km dt translated">系统结构</li><li id="76f5" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">交易工作流程</li><li id="574e" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">背书政策</li></ul><p id="099d" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">了解这三个，会让你更好地了解织物的工作原理。在区块链中，多个节点相互对话。节点只不过是一个系统或实例或虚拟机。</p><p id="1c49" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">读者:这是否意味着，区块链应该总是在多台机器上执行？</p><p id="da9b" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">我:不完全是，你也可以在单个节点上设置区块链并测试它。但是对于生产，不建议使用单节点系统，因为单点故障非常高。</p><h2 id="0693" class="ks kt ht bd ku kv kw kx ky kz la lb lc jq ld le lf ju lg lh li jy lj lk ll lm dt translated">系统结构</h2><h2 id="819c" class="ks kt ht bd ku kv kw kx ky kz la lb lc jq ld le lf ju lg lh li jy lj lk ll lm dt translated">节点</h2><p id="974a" class="pw-post-body-paragraph jf jg ht jh b ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy lr ka kb kc hm dt translated">Hyperledger中的节点基本上可以分为三类，</p><ul class=""><li id="1ec4" class="ke kf ht jh b ji jj jm jn jq kg ju kh jy ki kc kj kk kl km dt translated">客户端—代表帮助最终用户提交交易的应用程序</li><li id="468f" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">对等体—有两种类型，“提交对等体”和“认可对等体”。</li><li id="2081" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">订购服务——它是节点结构中非常重要的组件，处理对等点和客户端之间的通信广播。在测试模式中，您可以使用“Solo”订购程序，而对于生产系统，则始终使用“Kafka”。</li></ul><p id="630c" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated"><strong class="jh hu">区块链数据结构:</strong></p><ul class=""><li id="68cd" class="ke kf ht jh b ji jj jm jn jq kg ju kh jy ki kc kj kk kl km dt translated">有两个元素(状态、分类账)，我们称之为区块链数据结构</li></ul><p id="269e" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">状态</p><ul class=""><li id="15ff" class="ke kf ht jh b ji jj jm jn jq kg ju kh jy ki kc kj kk kl km dt translated">世界状态表示所有分类帐状态的当前值。这非常有用，因为程序通常需要一个分类帐状态的当前值，并且总是很容易得到。您不需要遍历整个区块链来计算任何分类帐州的当前值—您只需直接从世界州获得它。</li><li id="6c15" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">状态在“对等体”上维护</li></ul><p id="9dbc" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">分类帐</p><ul class=""><li id="b39e" class="ke kf ht jh b ji jj jm jn jq kg ju kh jy ki kc kj kk kl km dt translated">它包含状态更改成功的所有事务。</li><li id="ef8e" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">分类账在“同行”和可选的“订购者”中维护</li></ul><p id="d543" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">因此，大多数情况下，当我们想要检索特定资产的当前状态时，您总是从“world state”中获取，而如果您想要获取包括当前价值在内的交易历史，您将最终查询分类账。</p><h2 id="8a83" class="ks kt ht bd ku kv kw kx ky kz la lb lc jq ld le lf ju lg lh li jy lj lk ll lm dt translated"><strong class="ak">交易工作流程</strong></h2><p id="cca7" class="pw-post-body-paragraph jf jg ht jh b ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy lr ka kb kc hm dt translated">好，让我们举这个例子，假设你是一个著名的魔术师&amp;你想在一个安全的建筑里表演一个节目。最重要的是，作为一个游客，你应该有你的有效身份证，对吗？，然后你必须把它出示给安检人员@“安检”门。一旦你的身份证通过验证，你将被允许进入大楼，但你必须获得管理层的许可才能进行路演。一旦你得到了适当的认可，那么你将被允许做同样的事情，否则你将被赶出去。</p><p id="0412" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">所以这里的关键部分是，ID..在诸如Hyperledger的许可网络中，没有适当的证书，用户不能进入网络。这些证书我们称之为ID，证书的发行将由会员服务提供商(简称MSP)处理</p><p id="3135" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">这里需要理解的组件很少</p><ul class=""><li id="881c" class="ke kf ht jh b ji jj jm jn jq kg ju kh jy ki kc kj kk kl km dt translated">背书对等体</li><li id="5076" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">订购服务</li><li id="b8db" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">提交对等方</li><li id="c00a" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">客户端(应用程序)</li><li id="4ace" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">证书颁发机构—颁发令牌</li></ul><p id="2f0a" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">这里，在hyperledger中，每个参与者都应该拥有有效的令牌(ID —由MSP颁发),通过该令牌他们可以访问网络。因此，当参与者发起交易(路演)提案时，将首先由<strong class="jh hu">“背书同行”</strong>(安全)进行验证，他们将检查参与者是否具有有效id，还将检查“背书”政策，该参与者是否真的可以执行该交易，这些检查将在此处执行。在你通过这个检查之后，交易模拟将会发生，如果你的交易被执行会发生什么，那将会是结果。这里最重要的一点你应该注意，交易模拟不会改变分类帐中数据的状态。它将简单地显示模拟结果，然后通过“认可对等体”签名级联回客户端。</p><p id="37ec" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated"><strong class="jh hu">客户端(应用)</strong>将再次触发相同的“事务模拟结果”，这一次<strong class="jh hu">“订购服务”</strong>将接收这些事务以及网络中按时间顺序排列的其他事务&amp;创建一个事务序列，这将被级联到<strong class="jh hu">“提交对等体”</strong>，后者实际上在分类帐&amp;中插入数据并相应地改变状态。</p><p id="8936" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">因此，提交方非常重要，它持有“账本”。当你有多节点系统时，你必须声明哪个节点是支持者，哪个是提交者。背书对等体也可以作为承诺对等体，但承诺对等体不能背书！—切记！</p><p id="b0c9" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated"><strong class="jh hu">读者:</strong>那么我如何确定哪个节点是背书者或者提交对等体呢？，我们有什么可配置的选项吗？</p><p id="465f" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">我:在某种程度上，你是对的，所有加入特定渠道的对等体都可以作为提交对等体。而那些安装了“链码——智能合约”的对等体，可以充当“背书对等体”。您也可以在yaml文件endorsingPeer=true中设置它——我们将在接下来的系列文章中更多地讨论“通道”、“链码”、“安装”等，但现在请记住这些提示。</p><p id="b4ac" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">在这里，所有的业务逻辑都将使用编程语言编写，如“GO”、“Python”、“Java”，它被称为“链码”——智能合同</p><p id="3429" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">简而言之，这就是流程…</p><p id="7cce" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">I)客户端通过<strong class="jh hu">应用【客户端】</strong>发起交易=== <strong class="jh hu"> </strong></p><p id="2b5c" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">ii)签核方验证签名并执行交易===通过<strong class="jh hu">签核方</strong></p><p id="bec2" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">iii)提案响应由<strong class="jh hu">应用程序(客户)</strong>进行检查===</p><p id="9c00" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">iv)客户端通过<strong class="jh hu">应用程序(客户端)</strong>将背书组装成交易=== <strong class="jh hu"> </strong>，并将其发送给<strong class="jh hu">“订购服务”</strong></p><p id="26fb" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">v)交易由<strong class="jh hu">“订购服务”</strong>验证并提交===并将其发送给<strong class="jh hu">“提交对等体”</strong></p><p id="4edc" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">vi)分类账更新===由<strong class="jh hu">“提交同行”</strong></p><p id="a88f" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">注意:只有“写”交易才完全执行上述流程，而对于“查询/读取”分类账，它在<strong class="jh hu">步骤iii) </strong>处停止。因为一旦从分类帐中查询到数据，应用程序/客户端将认为任务已经完成。</p><p id="3114" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">更多详情请查看<a class="ae kd" href="https://hyperledger-fabric.readthedocs.io/en/latest/txflow.html" rel="noopener ugc nofollow" target="_blank"> TxFlow </a></p><h2 id="9ac3" class="ks kt ht bd ku kv kw kx ky kz la lb lc jq ld le lf ju lg lh li jy lj lk ll lm dt translated">背书政策</h2><p id="dd36" class="pw-post-body-paragraph jf jg ht jh b ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy lr ka kb kc hm dt translated">为了保证区块链和安全属性，背书策略集<strong class="jh hu">应该是一组经过验证的策略集</strong>，具有有限的功能集，以确保有限的执行时间(终止)、确定性、性能和安全保证。</p><p id="e7b5" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">Hyperledger Fabric使用<em class="ls">背书策略</em>来定义哪些对等方应该执行哪些交易。</p><p id="34aa" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">背书政策的示例可能是:</p><ul class=""><li id="8606" class="ke kf ht jh b ji jj jm jn jq kg ju kh jy ki kc kj kk kl km dt translated">对等体A、B、C和F都必须签署T类型的事务</li><li id="b811" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">渠道中的大多数同行必须认可U类交易</li><li id="3daa" class="ke kf ht jh b ji kn jm ko jq kp ju kq jy kr kc kj kk kl km dt translated">A、B、C、D、E、F、G中至少有3位同行必须签署V类交易</li></ul><p id="86ac" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">查看这篇文章了解更多关于<a class="ae kd" rel="noopener" href="/kokster/hyperledger-fabric-endorsing-transactions-3c1b7251a709"/>Kynan Rilee的“代言政策”</p><p id="204c" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">我们已经介绍了Hyperledger的基本构建模块，作为一名开发人员/程序员/经理，除了区块链数据结构之外，您还必须了解交易流程及其工作方式。因此，请重新研究这篇文章，直到您清楚地了解数据是如何流动的。</p><figure class="lu lv lw lx fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lt"><img src="../Images/6093e021479f2aa8bd9007a4fa2f2f6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a2_ud1OZtaOts-8I.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">Source: Hyperledger documents</figcaption></figure><p id="6594" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">注:喜欢这篇文章？给Logeswaran竖起大拇指(鼓掌)并在Linkedin上关注他</p><p id="9a4b" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated"><strong class="jh hu">查看此:</strong> <a class="ae kd" rel="noopener" href="/@lokeshwaran.a82/teach-yourself-hyperledger-in-24-hours-32ac151bbde7"> <strong class="jh hu">自学:24小时内Hyperledger</strong></a><strong class="jh hu">获取完整教程</strong></p><blockquote class="ly"><p id="48a9" class="lz ma ht bd mb mc md me mf mg mh kc ek translated"><a class="ae kd" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="mj mk ml mm mn iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff mi"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>