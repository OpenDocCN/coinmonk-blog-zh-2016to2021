<html>
<head>
<title>Building your first DApp on Tezos: Part 1 — Writing Smart Contract on SmartPy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Tezos上构建您的第一个DApp:第1部分——在SmartPy上编写智能合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/building-your-first-dapp-on-tezos-part-1-writing-smart-contract-on-smartpy-d7cdf27476f9?source=collection_archive---------1-----------------------#2021-04-29">https://medium.com/coinmonks/building-your-first-dapp-on-tezos-part-1-writing-smart-contract-on-smartpy-d7cdf27476f9?source=collection_archive---------1-----------------------#2021-04-29</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="f40f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">区块链是一种不可变的共享数字分类账，记录对等网络中的交易。它见证了许多领域的巨大需求，包括银行、医疗保健和公共管理。</p><p id="26c2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Tezos是一个去中心化的开源区块链网络，可以执行点对点交易，并作为部署智能合约的平台。</p><p id="0a80" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在本教程中，我们将创建一个DApp，用于匿名发布博客，并以匿名捐赠的形式获得公众支持，这些捐赠将在Tezos Blockchain上得到保护。</p><h2 id="48c3" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">项目解决的问题</h2><p id="3747" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">媒体是民主的第四大支柱。但是许多人认为媒体被政府控制，政府压制他们的言论自由。</p><h2 id="e0d8" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">问题的解决方法</h2><p id="8fdc" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">牢记这一点，我想到建立一个博客网站，任何人都可以匿名分享他们的观点，作家也可以通过匿名捐款的形式获得支持。这将确保没有中央机构控制文章的内容。</p><h2 id="ec76" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">履行</h2><p id="0b4a" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated"><a class="ae ko" href="https://smartpy.io/" rel="noopener ugc nofollow" target="_blank"> SmartPy </a>是一个用于构建Tezos智能合约的python库。SmartPy IDE有许多工具，使得智能合约的开发和部署非常容易。</p><h2 id="2a07" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">快速启动</h2><ul class=""><li id="c791" class="kp kq ht is b it kj ix kk jb kr jf ks jj kt jn ku kv kw kx dt translated">让我们跳到<a class="ae ko" href="https://smartpy.io/" rel="noopener ugc nofollow" target="_blank"> SmartPy </a>。在顶部栏中，转到在线编辑器。这将打开SmartPy编辑器。</li></ul><figure class="kz la lb lc fq ld fe ff paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="fe ff ky"><img src="../Images/d4ac5e677a2f9d8bea9ce96571c736a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZDCCw4iiRpumHwM0XZoXA.png"/></div></div></figure><ul class=""><li id="acf0" class="kp kq ht is b it iu ix iy jb lk jf ll jj lm jn ku kv kw kx dt translated">在上面的弹出窗口中，转到<em class="ln">常规模板</em>并从<em class="ln">简单示例</em>中选择<em class="ln">存储值</em>并导入该合同。</li></ul><figure class="kz la lb lc fq ld fe ff paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="fe ff ky"><img src="../Images/91def6d6b89f3a1239d7a132b97e9f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7cJSnFBVxSvS6qGN7jUKDQ.png"/></div></div></figure><h2 id="0ff4" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">撰写智能合同</h2><figure class="kz la lb lc fq ld"><div class="bz el l di"><div class="lo lp l"/></div></figure><ul class=""><li id="1095" class="kp kq ht is b it iu ix iy jb lk jf ll jj lm jn ku kv kw kx dt translated">为了使用SmartPy库的特性，我们首先必须导入它。</li><li id="9b6d" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">之后，我们需要创建一个类，在那里我们将编写所有需要执行的函数。就像上面的例子一样，有一个类<code class="eh lv lw lx ly b">StoreValue</code>，我们在其中定义了所有的入口点。</li><li id="fca6" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated"><code class="eh lv lw lx ly b">StoreValue</code>类需要从<code class="eh lv lw lx ly b">sp.Contract</code>类继承。</li><li id="5092" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated"><code class="eh lv lw lx ly b">__init__</code>函数是<code class="eh lv lw lx ly b">StoreValue</code>类的构造函数，我们在其中初始化<code class="eh lv lw lx ly b">storedValue</code>变量。</li><li id="103c" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">下一步是为特定的函数创建入口点。入口点是可以从外部调用的方法。需要用<code class="eh lv lw lx ly b">@sp.entrypoint</code>装饰器标记。</li><li id="dbf5" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">在<code class="eh lv lw lx ly b">replace</code>函数中，我们有params，它是一个用于访问传递给函数的所有参数的对象，可以作为<code class="eh lv lw lx ly b">params.value</code>来访问<code class="eh lv lw lx ly b">value</code>参数。</li><li id="2c09" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">和大多数语言一样，SmartPy也有表达式。例如<code class="eh lv lw lx ly b">self.data.x</code>代表存储字段<code class="eh lv lw lx ly b">x</code>。</li><li id="47e5" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">在上面的例子中，<code class="eh lv lw lx ly b">replace</code>函数用用户使用<code class="eh lv lw lx ly b">self.data.storedValue = params.value</code>传递的值替换<code class="eh lv lw lx ly b">storedValue</code>。</li><li id="1c7f" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">现在，为了测试我们的智能合约，我们将编写如下测试。</li></ul><figure class="kz la lb lc fq ld"><div class="bz el l di"><div class="lo lp l"/></div></figure><h2 id="aeb1" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">测试和场景</h2><ul class=""><li id="8e7d" class="kp kq ht is b it kj ix kk jb kr jf ks jj kt jn ku kv kw kx dt translated"><code class="eh lv lw lx ly b">c1</code>是<code class="eh lv lw lx ly b">StoreValue</code>类的一个对象。</li><li id="cc28" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated"><code class="eh lv lw lx ly b">scenario</code>描述一系列动作:发起契约、计算表达式、调用入口点等。</li><li id="216c" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated"><code class="eh lv lw lx ly b">sp.test_scenario()</code>呼吁对我们的智能合同进行测试。</li><li id="fc8e" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated"><code class="eh lv lw lx ly b">scenario.h1("Store Value")</code>是我们测试输出的标题，类似于HTML标题。</li><li id="f3dd" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated"><code class="eh lv lw lx ly b">scenario += c1</code>显示c1的初始状态。</li><li id="c0e4" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated"><code class="eh lv lw lx ly b">scenario += c1.replace(value = 15)</code>显示调用入口点<code class="eh lv lw lx ly b">replace</code>后c1的状态。</li></ul><h2 id="87b1" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">运行和测试我们的智能合同</h2><p id="4112" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">运行代码以查看右侧的测试结果。</p><figure class="kz la lb lc fq ld fe ff paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="fe ff ky"><img src="../Images/29d8ff7b45e8ad8d7a7305afcbb9cc39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mCQ_tOvOCxZMmJT406yYaQ.png"/></div></div></figure><h2 id="4ed3" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">部署智能合同</h2><ul class=""><li id="50d5" class="kp kq ht is b it kj ix kk jb kr jf ks jj kt jn ku kv kw kx dt translated">在右侧点击<em class="ln">部署</em> <em class="ln">迈克尔逊</em> <em class="ln">合同。</em></li></ul><figure class="kz la lb lc fq ld fe ff paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="fe ff ky"><img src="../Images/3b3e62b8a76ea054b7d405e95003ea87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vJR8_SiWOAM6qeCjSlbbeA.png"/></div></div></figure><ul class=""><li id="9a0e" class="kp kq ht is b it iu ix iy jb lk jf ll jj lm jn ku kv kw kx dt translated">选择Edonet作为节点。</li><li id="2f57" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">选择SmartPy wallet。</li></ul><figure class="kz la lb lc fq ld fe ff paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="fe ff ky"><img src="../Images/12b46747cf83890dbca018cff3222a5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fjjQbOR3V6HqiyP8XM-iGg.png"/></div></div></figure><ul class=""><li id="3197" class="kp kq ht is b it iu ix iy jb lk jf ll jj lm jn ku kv kw kx dt translated">选择水龙头，转到提供的链接，并生成您自己的水龙头帐户。</li><li id="57d9" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">复制并粘贴您的水龙头信息在这里。</li><li id="50ef" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">关闭弹出窗口，然后激活帐户，然后显示它。</li><li id="8cff" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">向下点击<em class="ln">从RPC估算成本。</em></li><li id="1b1c" class="kp kq ht is b it lq ix lr jb ls jf lt jj lu jn ku kv kw kx dt translated">最后，点击<em class="ln">部署合同</em>。</li></ul></div><div class="ab cl lz ma hb mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hm hn ho hp hq"><p id="5972" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">呜哇！我们已经成功创建和部署了智能合同。现在，您可以进入<em class="ln">浏览合同</em>页面与合同进行交互。</p><h2 id="4df3" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">下一步是什么</h2><p id="b727" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">在接下来的部分中，我们将构建一个更高级的智能契约，然后将其与前端集成。</p></div></div>    
</body>
</html>