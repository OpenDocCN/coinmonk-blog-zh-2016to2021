<html>
<head>
<title>How to Compile Bitcoin Core from Source</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从源码编译比特币核心</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-compile-bitcoin-core-from-source-5539ff9fbce5?source=collection_archive---------0-----------------------#2021-10-24">https://medium.com/coinmonks/how-to-compile-bitcoin-core-from-source-5539ff9fbce5?source=collection_archive---------0-----------------------#2021-10-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="4181" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">从Linux系统源代码编译比特币核心的简单指南</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/c2d2d6d56b9ad246377d54709b87d353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VSBmc4ShufNlMN7m"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Photo by <a class="ae jy" href="https://unsplash.com/@aronpw?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">AronPW</a> on <a class="ae jy" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="a1a6" class="jz ka ht bd kb kc kd ke kf kg kh ki kj iz kk ja kl jc km jd kn jf ko jg kp kq dt translated">步骤1:安装所有依赖项</h1><p id="7e10" class="pw-post-body-paragraph kr ks ht kt b ku kv iu kw kx ky ix kz la lb lc ld le lf lg lh li lj lk ll lm hm dt translated">更新您的系统，以便您的所有软件包都是最新的</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="bbb3" class="ls ka ht lo b fv lt lu l lv lw">$ sudo apt update</span></pre><p id="ed37" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">更新所有软件包后，安装所有依赖项</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="bcbc" class="ls ka ht lo b fv lt lu l lv lw">$ sudo apt-get install build-essential libtool autotools-dev automake pkg-config bsdmainutils python3 libssl-dev libevent-dev libboost-system-dev libboost-filesystem-dev libboost-chrono-dev libboost-test-dev libboost-thread-dev libminiupnpc-dev libzmq3-dev libqt5gui5 libqt5core5a libqt5dbus5 qttools5-dev qttools5-dev-tools libprotobuf-dev protobuf-compiler git libsqlite3-dev ccache</span></pre><h1 id="38d1" class="jz ka ht bd kb kc kd ke kf kg kh ki kj iz kk ja kl jc km jd kn jf ko jg kp kq dt translated">步骤2:安装比特币核心</h1><p id="efcb" class="pw-post-body-paragraph kr ks ht kt b ku kv iu kw kx ky ix kz la lb lc ld le lf lg lh li lj lk ll lm hm dt translated">安装完所有依赖项后，从GitHub下载比特币核心库。</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="f870" class="ls ka ht lo b fv lt lu l lv lw">$ git clone <a class="ae jy" href="https://github.com/bitcoin/bitcoin.git" rel="noopener ugc nofollow" target="_blank">https://github.com/bitcoin/bitcoin.git</a></span></pre><h1 id="21b5" class="jz ka ht bd kb kc kd ke kf kg kh ki kj iz kk ja kl jc km jd kn jf ko jg kp kq dt translated">步骤3:安装Berkeley DB</h1><p id="009b" class="pw-post-body-paragraph kr ks ht kt b ku kv iu kw kx ky ix kz la lb lc ld le lf lg lh li lj lk ll lm hm dt translated">输入您的比特币回购本地副本:</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="0cfd" class="ls ka ht lo b fv lt lu l lv lw">$ cd bitcoin</span></pre><p id="3108" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">一旦你在你的比特币回购的根，运行:</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="3e4c" class="ls ka ht lo b fv lt lu l lv lw">$ ./contrib/install_db4.sh `pwd`</span></pre><p id="40c2" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">一旦Berkeley DB完成下载，输出应该如下所示:</p><p id="51a3" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">db4构建完成。</p><p id="260d" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">编译bitcoind时，运行`。/configure `以下列方式:</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="decc" class="ls ka ht lo b fv lt lu l lv lw">export BDB_PREFIX=’&lt;PATH-TO&gt;/db4'</span><span id="c35b" class="ls ka ht lo b fv mc lu l lv lw">./configure BDB_LIBS=”-L${BDB_PREFIX}/lib -ldb_cxx-4.8" BDB_CFLAGS=”-I${BDB_PREFIX}/include”</span></pre><p id="4b2b" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">记下终端中的输出，稍后会用到它。</p><h1 id="a06e" class="jz ka ht bd kb kc kd ke kf kg kh ki kj iz kk ja kl jc km jd kn jf ko jg kp kq dt translated">第四步:编译比特币核心</h1><p id="a4d3" class="pw-post-body-paragraph kr ks ht kt b ku kv iu kw kx ky ix kz la lb lc ld le lf lg lh li lj lk ll lm hm dt translated">默认情况下，您的比特币回购本地副本将与最近的代码更改保持同步，这可能不稳定。这就是为什么在编译代码之前，通过选择签出标签来选择特定的版本。</p><p id="55cc" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">运行以下命令获取按最近更改排序的标记列表。</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="ef43" class="ls ka ht lo b fv lt lu l lv lw">$ git tag | sort -V</span></pre><p id="c161" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">通过运行命令选择一个类似v0.21.0的标记</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="27a6" class="ls ka ht lo b fv lt lu l lv lw">$ git checkout v0.21.0</span></pre><p id="12cb" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">选择标记的分支后，运行以下命令</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="7435" class="ls ka ht lo b fv lt lu l lv lw">$ export BDB_PREFIX=’&lt;PATH-TO&gt;/db4'<br/>Use the &lt;PATH-TO&gt; value from the output script from install_db4.sh</span><span id="18da" class="ls ka ht lo b fv mc lu l lv lw">$ /autogen.sh<br/>$ ./configure BDB_LIBS=”-L${BDB_PREFIX}/lib -ldb_cxx-4.8" BDB_CFLAGS=”-I${BDB_PREFIX}/include” if using BDB 4.8, otherwise ./configure — with-incompatible-bdb</span></pre><p id="7533" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">那就跑</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="290b" class="ls ka ht lo b fv lt lu l lv lw">$ make</span></pre><p id="6b13" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">或者，如果您有一个具有多个内核的CPU，您可以通过以下方式利用它们并通过使用您的内核来加快处理速度</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="4b4a" class="ls ka ht lo b fv lt lu l lv lw">$ make -j "$(($(nproc)+1))"</span></pre><h1 id="fbde" class="jz ka ht bd kb kc kd ke kf kg kh ki kj iz kk ja kl jc km jd kn jf ko jg kp kq dt translated">步骤5:测试构建</h1><p id="7cba" class="pw-post-body-paragraph kr ks ht kt b ku kv iu kw kx ky ix kz la lb lc ld le lf lg lh li lj lk ll lm hm dt translated">您可以通过运行以下命令来检查您的构建(您应该这样做)</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="9ea2" class="ls ka ht lo b fv lt lu l lv lw">$ make check</span></pre><p id="b1a7" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">或者通过以下方式利用多重处理</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="e82e" class="ls ka ht lo b fv lt lu l lv lw">$ make -j “$(($(nproc)+1))”</span></pre><p id="d7ed" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">运行功能测试</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="6044" class="ls ka ht lo b fv lt lu l lv lw">$ test/functional/test_runner.py --extended</span></pre><p id="0a97" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">如果您想跳过一些测试，请忽略扩展测试。</p><h1 id="f744" class="jz ka ht bd kb kc kd ke kf kg kh ki kj iz kk ja kl jc km jd kn jf ko jg kp kq dt translated">第六步:安装比特币</h1><p id="d2fa" class="pw-post-body-paragraph kr ks ht kt b ku kv iu kw kx ky ix kz la lb lc ld le lf lg lh li lj lk ll lm hm dt translated">此时，您可以通过以下方式开始使用比特币</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="87a8" class="ls ka ht lo b fv lt lu l lv lw">$ src/bitcoind</span></pre><p id="653f" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">或者，您可以通过运行以下命令来全局安装比特币</p><pre class="jj jk jl jm fq ln lo lp lq aw lr dt"><span id="b315" class="ls ka ht lo b fv lt lu l lv lw">$ sudo make install</span></pre><p id="25f6" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">这将在你的系统中全局安装比特币。安装后，您可以从系统的任何地方调用bitcoind或bitcoin-cli。</p><p id="6d34" class="pw-post-body-paragraph kr ks ht kt b ku lx iu kw kx ly ix kz la lz lc ld le ma lg lh li mb lk ll lm hm dt translated">恭喜你，你刚刚从源代码中编译了比特币，你刚刚增加了你的设置的不可信任度。</p></div></div>    
</body>
</html>