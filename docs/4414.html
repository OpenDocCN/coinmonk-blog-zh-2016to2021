<html>
<head>
<title>Writing, Compiling, Deploying Solidity 2021.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写、编译、部署Solidity 2021。</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/writing-compiling-deploying-solidity-2021-b9b915e8dd5f?source=collection_archive---------3-----------------------#2021-04-18">https://medium.com/coinmonks/writing-compiling-deploying-solidity-2021-b9b915e8dd5f?source=collection_archive---------3-----------------------#2021-04-18</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/1723dcc630f41da967ffddb828c4c11b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DJhi2wU0jnV3lAP0"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Photo by <a class="ae ig" href="https://unsplash.com/@lorenzoherrera?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lorenzo Herrera</a> on <a class="ae ig" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="f461" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在区块链这种尖端技术中，即使是初学者也很容易感到迷失。以太坊领域的开发者工具包也在快速发展。因此，本教程将向您展示如何编写基本的solidity程序，在本地编译，并部署到一个测试网络，如Rinkeby的最新版本。</p></div><div class="ab cl ke kf hb kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hm hn ho hp hq"><h2 id="56fe" class="kl km ij bd kn ko kp kq kr ks kt ku kv jr kw kx ky jv kz la lb jz lc ld le lf dt translated">我们开始吧🌠</h2><ul class=""><li id="981c" class="lg lh ij ji b jj li jn lj jr lk jv ll jz lm kd ln lo lp lq dt translated">您将需要通过npm安装一些依赖项。所以让我们先抓住他们</li><li id="287c" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">创建一个新的目录并放入光盘。那就跑</li></ul><pre class="lw lx ly lz fq ma mb mc md aw me dt"><span id="df21" class="kl km ij mb b fv mf mg l mh mi">npm init -y <em class="mj">//to start a new project</em><br/>npm i solc web3 @truffle/hdwallet-provider <em class="mj">//to install dependencies</em></span></pre><blockquote class="mk ml mm"><p id="10a6" class="jg jh mj ji b jj jk jl jm jn jo jp jq mn js jt ju mo jw jx jy mp ka kb kc kd hm dt translated"><strong class="ji ik"/><strong class="ji ik">合同</strong></p></blockquote><figure class="lw lx ly lz fq hv"><div class="bz el l di"><div class="mq mr l"/></div></figure><h2 id="44e0" class="kl km ij bd kn ko kp kq kr ks kt ku kv jr kw kx ky jv kz la lb jz lc ld le lf dt translated"><strong class="ak">简要说明</strong></h2><ul class=""><li id="b3fa" class="lg lh ij ji b jj li jn lj jr lk jv ll jz lm kd ln lo lp lq dt translated">使用pragma定义使用哪个版本的solidity</li><li id="7ed4" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">契约定义了一个变量x</li><li id="1771" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">在实例化协定时调用的构造函数，就像其他语言中的构造函数一样</li><li id="fc68" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">函数来设置x的新值并获取x的值</li></ul><blockquote class="mk ml mm"><p id="76da" class="jg jh mj ji b jj jk jl jm jn jo jp jq mn js jt ju mo jw jx jy mp ka kb kc kd hm dt translated"><strong class="ji ik">编译脚本</strong></p></blockquote><figure class="lw lx ly lz fq hv"><div class="bz el l di"><div class="mq mr l"/></div></figure><p id="e5ca" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">让我们先运行这段代码，看看它做了什么</p><pre class="lw lx ly lz fq ma mb mc md aw me dt"><span id="5c87" class="kl km ij mb b fv mf mg l mh mi">node compile.js <em class="mj">//the compile file can be named anything</em></span></pre><h2 id="39d7" class="kl km ij bd kn ko kp kq kr ks kt ku kv jr kw kx ky jv kz la lb jz lc ld le lf dt translated">简要说明</h2><ul class=""><li id="83c2" class="lg lh ij ji b jj li jn lj jr lk jv ll jz lm kd ln lo lp lq dt translated">我们引入了solc编译器</li><li id="3d31" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">然后是<em class="mj">路径</em>和<em class="mj"> fs </em>模块。为什么这么问？path模块获取合同文件的绝对路径(不考虑操作系统),而<em class="mj"> fs </em>读取文件，这样我们可以将它存储在一个变量中，在本例中为<em class="mj"> source </em>。</li><li id="0d96" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">然后我们必须把它传递给编译器，但是等待，它期望一个特定的格式，所以我们为它创建了<em class="mj">输入</em>变量，并把<em class="mj">源</em>传递给它，如你所见</li><li id="b47c" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">现在一切都完成了，我们通过<em class="mj">字符串化</em>它，把它提供给编译器。</li><li id="3495" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">慢慢查看控制台日志，如果愿意，甚至可以进一步展开它。</li><li id="021b" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">为什么要那样导出？问得好。请记住，我们仍然需要部署它，答案就在那里。</li></ul><blockquote class="mk ml mm"><p id="3cd3" class="jg jh mj ji b jj jk jl jm jn jo jp jq mn js jt ju mo jw jx jy mp ka kb kc kd hm dt translated"><strong class="ji ik">部署脚本</strong></p></blockquote><p id="faa5" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">很好，我们将部署到测试网络rinkeby，为了本教程的简单，我假设你已经安装了元掩码(如果没有，这很简单),你在rinkeby网络的元掩码中有一些测试以太网，或者你希望部署的测试网络(你可以从<a class="ae ig" href="https://faucet.rinkeby.io/" rel="noopener ugc nofollow" target="_blank">https://faucet.rinkeby.io/</a>或相应的水龙头中得到一些)</p><figure class="lw lx ly lz fq hv"><div class="bz el l di"><div class="mq mr l"/></div></figure><p id="1751" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mj">注意:这个脚本中有很多东西需要解开，我会尽量简短明了</em></p><p id="9f6f" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mj">注意:12个单词的助记短语是保密的，泄露或丢失它意味着您的帐户可能会受到威胁</em></p><h2 id="122d" class="kl km ij bd kn ko kp kq kr ks kt ku kv jr kw kx ky jv kz la lb jz lc ld le lf dt translated">简要说明</h2><p id="bc96" class="pw-post-body-paragraph jg jh ij ji b jj li jl jm jn lj jp jq jr ms jt ju jv mt jx jy jz mu kb kc kd hm dt translated"><em class="mj"> HDWalletProvider </em> —部署成本是以太的，因此该软件包使用</p><ul class=""><li id="62dd" class="lg lh ij ji b jj jk jn jo jr mv jv mw jz mx kd ln lo lp lq dt translated">你的12个单词的助记符来获得账户和签署交易，这样你就不用手动操作了。</li><li id="a92c" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">第二个参数是<a class="ae ig" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> infura </a> api，什么是infura？区块链网络由存储所有数据并不间断运行的节点[计算机]组成，因此要在其上部署，您需要自己拥有区块链的完整副本，这意味着设置您自己的节点，这不太实际，是吗？所以基本上infura给我们提供了他们的api，直接连接到区块链。所以使用infura的api避免了很多麻烦。</li></ul><p id="6ddc" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mj"> Web3js </em> —这个库允许我们用javascript以一种简单的方式与节点交流。它需要一个我们传递给它的提供者。</p><ul class=""><li id="74fe" class="lg lh ij ji b jj jk jn jo jr mv jv mw jz mx kd ln lo lp lq dt translated">记住库提供给我们一个构造函数，所以它的大写字母“W”web 3，然后我们用“W”web 3实例化它</li></ul><p id="038b" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mj"> abi </em>，<em class="mj">字节码</em>——这两样东西是我们部署所必需的，这是编译器吐出来的，abi以json格式包含你的契约的功能，字节码是你的低级机器码的契约</p><p id="7f02" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mj">deploy()函数</em> —这里没有太多解释，但是有一些需要注意的地方</p><ul class=""><li id="4010" class="lg lh ij ji b jj jk jn jo jr mv jv mw jz mx kd ln lo lp lq dt translated">我们传入abi和字节码</li><li id="1d67" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">参数数组是为我们的构造函数准备的，记住它需要一个参数<em class="mj"> _x，</em>如果我们的构造函数不需要任何参数，我们就不会传递参数数组</li><li id="eb86" class="lg lh ij ji b jj lr jn ls jr lt jv lu jz lv kd ln lo lp lq dt translated">部署后，控制台登录"<em class="mj"> contract" </em>"包含像我们的契约方法这样的信息，重要的是它部署到的地址。</li></ul><p id="e2e4" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">你会得到合同的地址，你可以在https://rinkeby.etherscan.io/搜索</p><p id="6028" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">祝贺你，你在这篇文章中学到了很多，至少我希望如此。 <em class="mj"> tada！！</em></p></div></div>    
</body>
</html>