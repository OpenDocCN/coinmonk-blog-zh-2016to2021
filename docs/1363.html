<html>
<head>
<title>ARCore, Sceneform &amp; Augmented Images #4 Android AR app</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ARCore，Sceneform和增强图像#4 Android AR应用程序</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/arcore-sceneform-augmented-images-4-android-ar-app-2a4890a9bb09?source=collection_archive---------4-----------------------#2018-08-20">https://medium.com/coinmonks/arcore-sceneform-augmented-images-4-android-ar-app-2a4890a9bb09?source=collection_archive---------4-----------------------#2018-08-20</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="57ae" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用ARCore和Sceneform构建AR应用程序</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/1f49c4c411e0d73eddf81bfcc7814a89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yURWCflOP1dbvAbFzoKcMg.png"/></div></div></figure><p id="6feb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">嘿大家好。在接下来的系列文章中，我们将介绍ARCore、Sceneform和AugmentedImages的概念</p><h1 id="996b" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">系列零件:</h1><ul class=""><li id="944b" class="ky kz ht is b it la ix lb jb lc jf ld jj le jn lf lg lh li dt translated"><a class="ae lj" rel="noopener" href="/@neerajmoudgil/arcore-and-sceneform-1-an">第1部分—AR和ARCore概述</a></li><li id="e97f" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn lf lg lh li dt translated"><a class="ae lj" rel="noopener" href="/@neerajmoudgil/arcore-and-sceneform-2-android-augmented-reality-8108451cd484">第2部分Sceneform增强图像及其核心API概述</a></li><li id="b3a7" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn lf lg lh li dt translated"><a class="ae lj" rel="noopener" href="/@neerajmoudgil/arcore-sceneform-augmented-images-3-android-ar-app-2c0990f65df2">第3部分—使用Sceneform构建ARCore应用</a></li><li id="d92a" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn lf lg lh li dt translated">第4部分—继续构建增强现实应用程序—增强图像</li></ul><p id="0ecb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是第4部分，我们将继续第3部分留下的构建应用程序的步骤。</p><p id="712b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在第3部分<a class="ae lj" rel="noopener" href="/@neerajmoudgil/arcore-sceneform-augmented-images-3-android-ar-app-2c0990f65df2">中，我们完成了以下步骤:</a></p><ol class=""><li id="bc38" class="ky kz ht is b it iu ix iy jb lp jf lq jj lr jn ls lg lh li dt translated">导入3D资产</li><li id="26f4" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn ls lg lh li dt translated">配置Sceneform和Sceneform插件</li><li id="7c19" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn ls lg lh li dt translated">创建<code class="eh lt lu lv lw b">sfa</code>和<code class="eh lt lu lv lw b">sfb</code>文件。</li><li id="d34f" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn ls lg lh li dt translated">配置特定于ARCore应用程序的Manifest.xml文件</li><li id="0c43" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn ls lg lh li dt translated">初始化ArFragmen</li></ol><p id="5dfa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来，我们有以下步骤:</p><h2 id="7dcb" class="lx kb ht bd kc ly lz ma kg mb mc md kk jb me mf ko jf mg mh ks jj mi mj kw mk dt translated">步骤6:初始化增强图像数据库，并将图像添加到数据库中</h2><p id="27f3" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">为了让我们的应用程序识别我们的汽车图像，我们需要创建一个图像数据库。这里有一些关于图像尺寸和质量的指南，可以在<a class="ae lj" href="https://developers.google.com/ar/develop/c/augmented-images/" rel="noopener ugc nofollow" target="_blank">这里</a>查看。对于这个应用程序，我只会在运行时添加我们的参考图像，但是你也可以使用<a class="ae lj" href="https://developers.google.com/ar/develop/java/augmented-images/arcoreimg" rel="noopener ugc nofollow" target="_blank"> Arcoreimg工具</a>来创建数据库。</p><pre class="jp jq jr js fq mo lw mp mq aw mr dt"><span id="8b87" class="lx kb ht lw b fv ms mt l mu mv">AugmentedImageDatabase imageDatabase = new AugmentedImageDatabase();</span></pre><p id="4c39" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后您需要将图像添加到数据库中。我使用了下面的图片，不过你可以随意使用任何图片，创造出身临其境的体验。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff mw"><img src="../Images/3ab17e1f32bf8031cf32cc2a121e51d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSoATBRoxKWsmn-q095cWA.jpeg"/></div></div><figcaption class="mx my fg fe ff mz na bd b be z ek">credits : <a class="ae lj" href="https://images.unsplash.com/photo-1533468659570-9cc9354310e4?ixlib=rb-0.3.5&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;s=c7c619a149494f5c32f7581b5213b1d0&amp;auto=format&amp;fit=crop&amp;w=877&amp;q=80" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d2ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将图像保存在assets文件夹中，然后使用<code class="eh lt lu lv lw b">.addImage()</code>方法将该图像添加到AugmentedImageDatabase中。它采取位图格式的图像。</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="adc9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我们的数据库已经准备好了，图像也添加进去了，我们可以开始检测图像了。</p><h2 id="3466" class="lx kb ht bd kc ly lz ma kg mb mc md kk jb me mf ko jf mg mh ks jj mi mj kw mk dt translated">步骤6:检测增强图像</h2><p id="d254" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">我们可以通过在相机的AR场景上添加<code class="eh lt lu lv lw b">updateListener</code>来跟踪ARCore的会话。这将持续跟踪帧，我们可以利用它来检测增强图像。</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="nb nc l"/></div></figure><p id="cb1e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将在检测到的图像的中心渲染我们的模型。</p><h2 id="a6ee" class="lx kb ht bd kc ly lz ma kg mb mc md kk jb me mf ko jf mg mh ks jj mi mj kw mk dt translated">步骤7:检测增强图像</h2><p id="1683" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">一旦我们检测到图像，我们必须渲染我们的3D模型(还记得我们导出的<code class="eh lt lu lv lw b">.sfb</code>文件)。</p><pre class="jp jq jr js fq mo lw mp mq aw mr dt"><span id="294b" class="lx kb ht lw b fv ms mt l mu mv"><strong class="lw hu">private void </strong>renderObject(ArFragment fragment, Anchor anchor, <strong class="lw hu">int </strong>model){<br/>    ModelRenderable.<em class="nd">builder</em>()<br/>            .setSource(<strong class="lw hu">this</strong>, model)<br/>            .build()<br/>            .thenAccept(renderable -&gt; addNodeToScene(fragment, anchor, renderable))<br/>            .exceptionally((throwable -&gt; {<br/>                AlertDialog.Builder builder = <strong class="lw hu">new </strong>AlertDialog.Builder(<strong class="lw hu">this</strong>);<br/>                builder.setMessage(throwable.getMessage())<br/>                        .setTitle(<strong class="lw hu">"Error!"</strong>);<br/>                AlertDialog dialog = builder.create();<br/>                dialog.show();<br/>                <strong class="lw hu">return null</strong>;<br/>            }));<br/><br/>}<br/><br/><strong class="lw hu">private void </strong>addNodeToScene(ArFragment fragment, Anchor anchor, Renderable renderable){<br/>    AnchorNode anchorNode = <strong class="lw hu">new </strong>AnchorNode(anchor);<br/>    TransformableNode node = <strong class="lw hu">new </strong>TransformableNode(fragment.getTransformationSystem());<br/>    node.setRenderable(renderable);<br/>    node.setParent(anchorNode);<br/>    fragment.getArSceneView().getScene().addChild(anchorNode);<br/>    node.select();<br/>}</span></pre><p id="bfc2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh lt lu lv lw b">ModelRenderable</code>负责加载我们的3D资产，然后我们创建<code class="eh lt lu lv lw b">AnchorNode</code>并将其添加到在屏幕上呈现我们的对象的场景中。它定义了对象停留在特定的位置。对我们来说，位置是由<code class="eh lt lu lv lw b">augmentedImage.getCenterPose()</code>给出的检测图像的中心</p><p id="8d3a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh lt lu lv lw b">Tranformable</code>节点就是可以旋转或变换的节点。然后我们将renderable设置为TransformableNode。</p><p id="ee60" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">终于！如果你一直跟踪到这里，那么你应该可以看到你的模型在现实世界中的图像上，就像这样:</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ne"><img src="../Images/5e215effd70aa476d2cbe920b5b9f0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/1*AjiY9IGT9PFBuqsvZMHROg.gif"/></div><figcaption class="mx my fg fe ff mz na bd b be z ek">MyARCar</figcaption></figure><h1 id="030e" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">完整的代码可以在这里找到:</h1><div class="nf ng fm fo nh ni"><a href="https://github.com/NeerajMoudgil/MyARCar" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab ej"><div class="nk ab nl cl cj nm"><h2 class="bd hu fv z el nn eo ep no er et hs dt translated">NeerajMoudgil/MyARCar</h2><div class="np l"><h3 class="bd b fv z el nn eo ep no er et ek translated">MyARCar -使用ARCore和Sceneform的Android AR应用程序</h3></div><div class="nq l"><p class="bd b gc z el nn eo ep no er et ek translated">github.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw jy ni"/></div></div></a></div><p id="72b3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">如果你面临任何问题，请随时发表评论或通过</strong><a class="ae lj" href="https://in.linkedin.com/in/neeraj-moudgil" rel="noopener ugc nofollow" target="_blank"><strong class="is hu">LinkedIn</strong></a><strong class="is hu">联系我。</strong></p><h2 id="72f1" class="lx kb ht bd kc ly lz ma kg mb mc md kk jb me mf ko jf mg mh ks jj mi mj kw mk dt translated">构建此应用程序时面临的挑战</h2><ul class=""><li id="24c4" class="ky kz ht is b it la ix lb jb lc jf ld jj le jn lf lg lh li dt translated">配置ARCore和scene form——您需要注意添加gradle中的依赖项和AndroidManifest中的特性。错过任何一个都会导致意想不到的行为。</li><li id="02af" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn lf lg lh li dt translated">生成的模型的规模可能太大。如果你正面临这个问题，那么将你的模型文件中的<strong class="is hu">比例改为较小的比例值:0.20000 </strong></li></ul><h1 id="4f6c" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">学完这个可能的应用:</h1><p id="4abc" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb ml jd je jf mm jh ji jj mn jl jm jn hm dt translated">您可以通过多种方式实现增强图像增强现实，例如</p><ul class=""><li id="2c82" class="ky kz ht is b it iu ix iy jb lp jf lq jj lr jn lf lg lh li dt translated">创建一个live cards应用程序，您可以使用打印的卡片，然后在上面渲染类似的3D对象</li><li id="c8f9" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn lf lg lh li dt translated">将此与机器学习相结合来检测对象，然后通过放置相应的3D模型来赋予检测到的对象生命</li><li id="d275" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn lf lg lh li dt translated">将动画应用于模型。你可以从这里开始<a class="ae lj" href="https://developers.google.com/ar/develop/java/sceneform/build-scene#animate_nodes" rel="noopener ugc nofollow" target="_blank">制作节点</a>动画。</li></ul><h1 id="855c" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">资源:</h1><ul class=""><li id="63c7" class="ky kz ht is b it la ix lb jb lc jf ld jj le jn lf lg lh li dt translated"><a class="ae lj" href="https://developers.google.com/ar/" rel="noopener ugc nofollow" target="_blank"> ARCore </a></li><li id="5978" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn lf lg lh li dt translated"><a class="ae lj" href="https://developers.google.com/ar/develop/java/sceneform/" rel="noopener ugc nofollow" target="_blank">场景表单</a></li><li id="a418" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn lf lg lh li dt translated"><a class="ae lj" href="https://developers.google.com/ar/develop/java/augmented-images/" rel="noopener ugc nofollow" target="_blank">增强图像</a></li><li id="cfcf" class="ky kz ht is b it lk ix ll jb lm jf ln jj lo jn lf lg lh li dt translated"><a class="ae lj" href="https://poly.google.com/view/7bF7UVAoYRG" rel="noopener ugc nofollow" target="_blank">聚</a>感谢<a class="ae lj" href="https://poly.google.com/view/7bF7UVAoYRG" rel="noopener ugc nofollow" target="_blank">克里斯·童</a>带来的酷炫卡玛洛</li></ul><p id="d331" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">感谢阅读。如果你觉得这篇文章有帮助，用掌声鼓励我。传播并帮助他人学习。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff nx"><img src="../Images/1fe26383361acfff51f623aa906e2165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*99sn8aeNAlBH62kbql9E7Q.gif"/></div></figure><blockquote class="ny"><p id="0fe3" class="nz oa ht bd ob oc od oe of og oh jn ek translated"><a class="ae lj" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="oj ok ol om on jt fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff oi"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>