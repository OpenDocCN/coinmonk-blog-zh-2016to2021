# åœ¨ Python ä¸­ä½¿ç”¨ OpenAI Gymã€Kerasã€TensorFlow æ„å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªäººå·¥æ™ºèƒ½æ¸¸æˆæœºå™¨äºº

> åŸæ–‡ï¼š<https://medium.com/coinmonks/build-your-first-ai-game-bot-using-openai-gym-keras-tensorflow-in-python-50a4d4296687?source=collection_archive---------0----------------------->

![](img/07ad5ad2057964e6f3ac3c30f841da76.png)

è¿™ç¯‡å¸–å­å°†è§£é‡Šå…³äº [**OpenAI Gym**](https://gym.openai.com/) çš„å†…å®¹ï¼Œå¹¶å‘æ‚¨å±•ç¤ºå¦‚ä½•åº”ç”¨**æ·±åº¦å­¦ä¹ **æ¥ç©ä¸€ä¸ª**ä¾§æ‰‹ç¿»**æ¸¸æˆã€‚

æ¯å½“æˆ‘å¬åˆ°å…³äºè°·æ­Œ DeepMind çš„ AlphaGo çš„æ•…äº‹ï¼Œæˆ‘éƒ½ä¼šæƒ³ï¼Œæˆ‘å¸Œæœ›æˆ‘èƒ½å»ºé€ ä¸€ä¸ªç±»ä¼¼çš„ä¸œè¥¿ï¼Œè‡³å°‘æ˜¯å°è§„æ¨¡çš„ã€‚æˆ‘æƒ³ä¸Šå¸å¬åˆ°äº†æˆ‘çš„æ„¿æœ›ï¼Œä»–ç»™æˆ‘æŒ‡æ˜äº†æ–¹å‘ğŸ˜ƒã€‚

æœ€è¿‘äº†è§£äº† **OpenAI å¥èº«æˆ¿**å’Œ**å¼ºåŒ–å­¦ä¹ **ã€‚æˆ‘å¼€å§‹é˜…è¯»è¿™äº›ï¼Œå¹¶çˆ±ä¸Šäº†å®ƒã€‚æˆ‘ç°åœ¨ä¸ä½¿ç”¨å¼ºåŒ–å­¦ä¹ æ¥æ„å»ºæ¸¸æˆæœºå™¨äººã€‚æˆ‘ä¸€å®šä¼šä¸ºæœªæ¥æ‰“ç®—çš„ã€‚

æˆ‘ä»¬éœ€è¦å»ºé€ ä¸€ä¸ªæ¸¸æˆæœºå™¨äººï¼Œè¿™æ„å‘³ç€å®ƒéœ€è¦åšæˆ‘ä»¬åœ¨ç©æ¸¸æˆæ—¶åšçš„äº‹æƒ…ã€‚å¦‚æœæˆ‘ä»¬å¯¹ä¸€ä¸ªæ¸¸æˆæ²¡æœ‰ä»»ä½•çº¿ç´¢ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬é€šå¸¸ä¼šæ€ä¹ˆåšï¼Ÿ

æˆ‘ä»¬ä¼šé—®æˆ‘ä»¬çš„æœ‹å‹æˆ–é˜…è¯»æ¸¸æˆè¯´æ˜ï¼Œä»¥äº†è§£åœ¨ç©æ¸¸æˆæ—¶æˆ‘ä»¬éœ€è¦æŒ‰ä»€ä¹ˆé”®ï¼Œå¯¹å—ï¼Ÿ

ç„¶åï¼Œæˆ‘ä»¬å¼€å§‹ç©æ¸¸æˆï¼Œè§‚å¯Ÿæ¸¸æˆï¼Œæ ¹æ®å½“å‰çš„é˜¶æ®µæˆ–çŠ¶æ€ï¼Œæˆ‘ä»¬æŒ‰ä¸‹æŒ‰é’®ï¼Œå¦‚å‘ä¸Šæˆ–å‘ä¸‹æˆ–å‘å³æˆ–å‘åæˆ–å…¶ä»–ã€‚

è¿™æ„å‘³ç€æˆ‘ä»¬çš„æ¸¸æˆæœºå™¨äººåº”è¯¥çŸ¥é“æ¸¸æˆçš„å½“å‰**çŠ¶æ€/é˜¶æ®µ**å¹¶ä¸”æ ¹æ®å½“å‰**çŠ¶æ€**æœºå™¨äººéœ€è¦æŒ‰ä¸€ä¸ªæŒ‰é’®æ„å‘³ç€å®ƒéœ€è¦æ‰§è¡ŒæŸä¸ª**åŠ¨ä½œ**ã€‚å¦‚æœè¿™æ˜¯ä¸€ä¸ªå¥½çš„ä¸¾æªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¾—åˆ°å¥½çš„ç»“æœæ„å‘³ç€**ç§¯æçš„** **å¥–åŠ±**å¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¾—åˆ°ä¸å¥½çš„ç»“æœæ„å‘³ç€**æ¶ˆæçš„å¥–åŠ±**ã€‚æœºå™¨äººæ¯æ¬¡éƒ½åº”è¯¥æ ¹æ®å½“å‰çš„çŠ¶æ€é‡å¤è¿™äº›åŠ¨ä½œï¼Œç›´åˆ°æˆ‘ä»¬èµ¢å¾—æˆ–è¾“æ‰æ¸¸æˆï¼Œä¹Ÿå°±æ˜¯è¯´ç›´åˆ°æˆ‘ä»¬å®Œæˆæ¸¸æˆã€‚

ä½ å¯èƒ½æƒ³çŸ¥é“ Bot æ˜¯å¦‚ä½•åƒæˆ‘ä»¬ä¸€æ ·äº†è§£æ¸¸æˆ**ç¯å¢ƒ**çš„å½“å‰çŠ¶æ€çš„ã€‚æˆ‘ä»¬é€šè¿‡çœ¼ç›è§‚å¯Ÿæ¯”èµ›æ„å‘³ç€æˆ‘ä»¬åº”è¯¥å®ç°è®¡ç®—æœºè§†è§‰æ¥è®­ç»ƒæˆ‘ä»¬çš„æœºå™¨äººè¿˜æ˜¯ä»€ä¹ˆï¼Ÿ

è¿™é‡Œ **OpenAI å¥èº«æˆ¿**å°†å¸®åŠ©æˆ‘ä»¬ã€‚OpenAI å¥èº«æˆ¿ä¼šç»™æˆ‘ä»¬å½“å‰çš„**çŠ¶æ€**ç»†èŠ‚æ¸¸æˆæ‰‹æ®µ**ç¯å¢ƒ**ã€‚å®ƒå°†æ ¹æ®å½“å‰çš„**çŠ¶æ€**/æƒ…å†µç»™æˆ‘ä»¬å¥æŸ„æ¥æ‰§è¡Œæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„**åŠ¨ä½œ**ã€‚

æˆ‘å‡è®¾ä½ çš„ç³»ç»Ÿä¸­æœ‰ Kerasã€TensorFlow å’Œ Pythonï¼Œå¦‚æœæ²¡æœ‰ï¼Œè¯·å…ˆé˜…è¯»[è¿™ç¯‡æ–‡ç« ](/@ashok.tankala/build-your-first-deep-learning-neural-network-model-using-keras-tensorflow-in-python-a3e76a6b3ccb)ã€‚æˆ‘ä»¬éœ€è¦å®‰è£…**å¼€æ”¾å¼å¥èº«æˆ¿**ã€‚å®‰è£…åœ¨ä¸‹é¢è¿è¡Œå‘½ä»¤

```
# If you are using python2 then use this command 'pip3 install gym'
pip3 install gym
```

æ¯å½“æˆ‘ä»¬å­¦ä¹ ä¸€é—¨æ–°çš„è¯­è¨€æ—¶ï¼Œæˆ‘ä»¬å°±ä»â€œä½ å¥½ï¼Œä¸–ç•Œâ€èŠ‚ç›®å¼€å§‹ï¼Œé€šå¸¸æ˜¯è¿™æ ·çš„ã€‚æ¯å½“æœ‰äººå¼€å§‹å­¦ä¹ å¼€æ”¾ä½“æ“æ—¶ï¼Œä»–ä»¬å°±ä»**é’¢ç®¡èˆ**æ¸¸æˆå¼€å§‹ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†é›†ä¸­è®¨è®ºè¿™ä¸ªæ¸¸æˆã€‚

![](img/aed6d6863d1904436866555c95f4f2f8.png)

OpenAI Gym ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ¸¸æˆçš„æ‰€æœ‰ç»†èŠ‚æˆ–ä¿¡æ¯åŠå…¶å½“å‰çŠ¶æ€ã€‚å®ƒä¹Ÿç»™äº†æˆ‘ä»¬å¥æŸ„å»åšæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„åŠ¨ä½œï¼Œä»¥ç»§ç»­ç©æ¸¸æˆï¼Œç›´åˆ°æ¸¸æˆå®Œæˆã€‚

åœ¨å†™ä»£ç ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€äº›å…³äº OpenAI Gym çš„è¯æ±‡ã€‚

ç¯å¢ƒ(environment)â€”â€”å®ƒå°±åƒä¸€ä¸ªå¯¹è±¡æˆ–ç•Œé¢ï¼Œæˆ‘ä»¬æˆ–æˆ‘ä»¬çš„æ¸¸æˆæœºå™¨äºº(ä»£ç†)å¯ä»¥é€šè¿‡å®ƒä¸æ¸¸æˆè¿›è¡Œäº¤äº’ï¼Œå¹¶è·å¾—å½“å‰çŠ¶æ€çš„ç»†èŠ‚ç­‰ã€‚æœ‰å‡ ç§ä¸åŒçš„æ¸¸æˆæˆ–ç¯å¢ƒå¯ä¾›é€‰æ‹©ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å®ƒä»¬ã€‚
**æ­¥éª¤** :-è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥åœ¨æ¸¸æˆçš„å½“å‰çŠ¶æ€/é˜¶æ®µåšä¸€ä¸ªæˆ‘ä»¬çœŸæ­£æƒ³åšçš„åŠ¨ä½œã€‚
**åŠ¨ä½œ:-** è¿™æ˜¯æˆ‘ä»¬åœ¨æ¸¸æˆå½“å‰çŠ¶æ€/é˜¶æ®µåŸºæœ¬æƒ³è¦åšçš„ä¸€ä¸ªå€¼æˆ–å¯¹è±¡ã€‚åƒå‘å·¦æˆ–å‘å³ç§»åŠ¨æˆ–è·³è·ƒç­‰ç­‰ã€‚
**è§‚å¯Ÿ(å¯¹è±¡):-** ä¸€ä¸ªç¯å¢ƒç‰¹å®šçš„å¯¹è±¡ï¼Œä»£è¡¨ä½ å¯¹ç¯å¢ƒçš„è§‚å¯Ÿã€‚ä¾‹å¦‚ï¼Œæ¥è‡ªç›¸æœºçš„åƒç´ æ•°æ®ã€æœºå™¨äººçš„å…³èŠ‚è§’åº¦å’Œå…³èŠ‚é€Ÿåº¦ï¼Œæˆ–è€…æ£‹ç›˜æ¸¸æˆä¸­çš„æ£‹ç›˜çŠ¶æ€ã€‚
**å¥–åŠ±(æµ®åŠ¨):-** ä¸Šä¸€æ¬¡è¡ŒåŠ¨è·å¾—çš„å¥–åŠ±é‡‘é¢ã€‚è§„æ¨¡å› ç¯å¢ƒè€Œå¼‚ï¼Œä½†ç›®æ ‡å§‹ç»ˆæ˜¯å¢åŠ ä½ çš„æ€»å›æŠ¥ã€‚
**done (boolean):-** æ˜¯ä¸æ˜¯è¯¥é‡æ–°è®¾ç½®ç¯å¢ƒäº†ã€‚å¤§å¤šæ•°(ä½†ä¸æ˜¯å…¨éƒ¨)ä»»åŠ¡è¢«åˆ’åˆ†ä¸ºå®šä¹‰æ˜ç¡®çš„æƒ…èŠ‚ï¼Œdone ä¸º True è¡¨ç¤ºè¯¥æƒ…èŠ‚å·²ç»ç»ˆæ­¢ã€‚(ä¾‹å¦‚ï¼Œä¹Ÿè®¸æ†å­å€¾æ–œå¾—å¤ªå‰å®³ï¼Œæˆ–è€…ä½ å¤±å»äº†ä¸Šä¸€æ¡å‘½ã€‚)
**info (dict):-** å¯¹è°ƒè¯•æœ‰ç”¨çš„è¯Šæ–­ä¿¡æ¯ã€‚å®ƒæœ‰æ—¶å¯¹å­¦ä¹ å¾ˆæœ‰ç”¨(ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½åŒ…å«ç¯å¢ƒæœ€åä¸€æ¬¡çŠ¶æ€å˜åŒ–èƒŒåçš„åŸå§‹æ¦‚ç‡)ã€‚ä½†æ˜¯ï¼Œå®˜æ–¹å¯¹ä½ çš„ä»£ç†äººçš„è¯„ä»·æ˜¯ä¸å…è®¸ç”¨è¿™ä¸ªæ¥å­¦ä¹ çš„ã€‚

è®©æˆ‘ä»¬é€šè¿‡å†™ä¸€äº›[ç¿»ç­‹æ–—](https://gym.openai.com/envs/CartPole-v1/)çš„ä»£ç æ¥äº†è§£ä¸€ä¸‹ OpenAI å¥èº«æˆ¿ã€‚

è®©æˆ‘ä»¬ä¸€è¡Œä¸€è¡Œåœ°ç†è§£ä¸Šé¢çš„ä»£ç ã€‚

1.  è¿›å£å¥èº«æˆ¿å¥—é¤ã€‚
2.  åˆ›é€ äº†'**ç¿»è·Ÿæ–—**çš„ç¯å¢ƒã€‚
3.  é‡ç½®ç¯å¢ƒã€‚
4.  è¿è¡Œä¸€ä¸ªå¾ªç¯æ¥åšå‡ ä¸ªåŠ¨ä½œæ¥ç©æ¸¸æˆã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°½å¯èƒ½å¤šçš„ç©ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°è¯•åœ¨è¿™é‡Œå‘æŒ¥é«˜è¾¾ 1000 æ­¥ã€‚
5.  env.render() â€”ç”¨äºæ¸²æŸ“æ¸¸æˆã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“æˆ‘ä»¬é‡‡å–ä»»ä½•æ­¥éª¤/è¡ŒåŠ¨æ—¶å®é™…å‘ç”Ÿäº†ä»€ä¹ˆã€‚
6.  å¾—åˆ°ä¸€ä¸ªæˆ‘ä»¬å°†è¦é‡‡å–çš„éšæœºè¡ŒåŠ¨ã€‚è¿™é‡Œçš„â€œenv.action_space.sample()â€ä»£ç ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªå…è®¸ç©è¿™ä¸ªæ¸¸æˆçš„éšæœºåŠ¨ä½œã€‚
7.  é€šè¿‡é˜¶è·ƒå‡½æ•°åšéšæœºåŠ¨ä½œã€‚è¿™å°†è¿”å›æˆ‘ä»¬çš„è§‚å¯Ÿï¼Œå¥–åŠ±ï¼Œå®Œæˆï¼Œä¿¡æ¯ã€‚

8â€“13.æ‰“å°ä»–ä»¬çŸ¥é“æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Œåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä»€ä¹ˆå¥–åŠ±ï¼Œä»¥åŠæ¸¸æˆæ˜¯å¦å®Œæˆã€‚

14â€“15.å¦‚æœæ¸¸æˆå®Œæˆ/å®Œæˆï¼Œåœæ­¢é‡‡å–ä¸‹ä¸€æ­¥/è¡ŒåŠ¨ã€‚

æœ€åï¼Œè¿™æ®µä»£ç ä¼šç»™å‡ºè¿™æ ·çš„è¾“å‡ºã€‚

```
Step 0:
action: 0
observation: [-0.0120364  -0.21794704 -0.00759187  0.26062941]
reward: 1.0
done: False
info: {}
Step 1:
action: 1
observation: [-0.01639534 -0.02271754 -0.00237928 -0.03443839]
reward: 1.0
done: False
info: {}
Step 2:
action: 1
observation: [-0.0168497   0.17243845 -0.00306805 -0.32787105]
reward: 1.0
done: False
info: {}
Step 3:
action: 0
observation: [-0.01340093 -0.02263969 -0.00962547 -0.03615722]
reward: 1.0
done: False
info: {}
Step 4:
action: 1
observation: [-0.01385372  0.17261896 -0.01034861 -0.33186148]
reward: 1.0
done: False
info: {}
Step 5:
action: 1
observation: [-0.01040134  0.36788668 -0.01698584 -0.6277898 ]
reward: 1.0
done: False
info: {}
Step 6:
action: 1
observation: [-0.00304361  0.56324153 -0.02954164 -0.9257734 ]
reward: 1.0
done: False
info: {}
Step 7:
action: 1
observation: [ 0.00822122  0.75874972 -0.04805711 -1.22759172]
reward: 1.0
done: False
info: {}
Step 8:
action: 1
observation: [ 0.02339622  0.95445615 -0.07260894 -1.53493579]
reward: 1.0
done: False
info: {}
Step 9:
action: 1
observation: [ 0.04248534  1.15037357 -0.10330766 -1.84936587]
reward: 1.0
done: False
info: {}
Step 10:
action: 1
observation: [ 0.06549281  1.3464699  -0.14029497 -2.17226059]
reward: 1.0
done: False
info: {}
Step 11:
action: 0
observation: [ 0.09242221  1.15296679 -0.18374019 -1.92596929]
reward: 1.0
done: False
info: {}
Step 12:
action: 0
observation: [ 0.11548155  0.96023062 -0.22225957 -1.69544763]
reward: 1.0
done: True
info: {}
```

è¿™å°†ä½¿æˆ‘ä»¬å¯¹æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…æœ‰ä¸€äº›åˆç†çš„æƒ³æ³•ã€‚æ¯èµ°ä¸€æ­¥ï¼Œæˆ‘ä»¬å¾—åˆ°å¥–åŠ± 1.0ï¼Œç›´åˆ°æ¸¸æˆç»“æŸã€‚å®ƒè¿˜ç»™å‡ºäº†æ†å’Œè½¦çš„å½“å‰ä½ç½®ã€‚è¿™é‡Œï¼ŒåŠ¨ä½œ 0 è¡¨ç¤ºå‘å·¦ç§»åŠ¨è´­ç‰©è½¦ï¼Œ1 è¡¨ç¤ºå‘å³ç§»åŠ¨è´­ç‰©è½¦ã€‚æ›´å¤šè¯¦æƒ…è¯·è®¿é—®å…¶[ç»´åŸºé¡µé¢](https://github.com/openai/gym/wiki/CartPole-v0)ã€‚

æ‰€ä»¥æˆ‘ä»¬å¯¹å¼€æ”¾å¼å¥èº«æˆ¿æœ‰äº†äº†è§£ã€‚æ‰€ä»¥æ˜¯æ—¶å€™å»ºç«‹æˆ‘ä»¬çš„æ¨¡å‹äº†ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä¸€äº›æ•°æ®æ¥è®­ç»ƒã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬ç©ä¸€äº›éšæœºåŠ¨ä½œçš„æ¸¸æˆï¼Œå¹¶æ”¶é›†æˆ‘ä»¬ç©å¾—æ›´å¥½çš„æ¸¸æˆçš„æ•°æ®ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¯¼å…¥å®Œæˆå·¥ä½œæ‰€éœ€çš„åŒ…ã€‚

```
import gym
import random
import numpy as np
from keras.models     import Sequential
from keras.layers     import Dense
from keras.optimizers import Adam
```

ç„¶åè®©æˆ‘ä»¬åˆå§‹åŒ–ä¸€äº›éœ€è¦è¿›ä¸€æ­¥çš„å˜é‡ã€‚

```
env = gym.make('CartPole-v1')
env.reset()
goal_steps = 500
score_requirement = 60
intial_games = 10000
```

åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥å¡«å……æ·±åº¦å­¦ä¹ æ¨¡å‹è®­ç»ƒæ‰€éœ€çš„æ•°æ®ã€‚

è®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹æˆ‘ä»¬åœ¨ä¸Šé¢çš„æ¨¡å‹ _ æ•°æ® _ å‡†å¤‡å‡½æ•°ä¸­åšäº†ä»€ä¹ˆã€‚

1.  æˆ‘ä»¬åˆå§‹åŒ–äº† training_data å’Œ accepted_scores æ•°ç»„ã€‚
2.  æˆ‘ä»¬éœ€è¦ç©å¤šæ¬¡ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ”¶é›†æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ä½¿ç”¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†æ’­æ”¾ 10000 æ¬¡ï¼Œä»¥ä¾¿è·å¾—å¤§é‡æ•°æ®ã€‚è¿™ä¸€è¡Œè¡¨ç¤ºâ€œæ¸¸æˆç´¢å¼•åœ¨èŒƒå›´å†…(åˆå§‹æ¸¸æˆ):â€
3.  æˆ‘ä»¬åˆå§‹åŒ–äº† scoreã€game_memoryã€previous_observation å˜é‡ï¼Œè¿™äº›å˜é‡å°†å­˜å‚¨å½“å‰æ¸¸æˆçš„æ€»åˆ†æ•°å’Œå‰ä¸€æ­¥è§‚å¯Ÿå€¼(è¡¨ç¤ºæ¨è½¦å’Œæ†å­çš„ä½ç½®)ä»¥åŠæˆ‘ä»¬ä¸ºæ­¤é‡‡å–çš„è¡ŒåŠ¨ã€‚
4.  å¯¹äºèŒƒå›´å†…çš„ step _ index(goal _ steps):â€”æ­¤ä»£ç å°†æ¸¸æˆç© 500 æ­¥ï¼Œå› ä¸ºç©æ­¤æ¸¸æˆåˆ° 500 æ­¥æ„å‘³ç€æˆåŠŸå®Œæˆæ¸¸æˆã€‚
5.  æˆ‘ä»¬éœ€è¦é‡‡å–éšæœºè¡ŒåŠ¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç©æ¸¸æˆï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æˆåŠŸå®Œæˆè¯¥æ­¥éª¤æˆ–è¾“æ‰æ¸¸æˆã€‚è¿™é‡Œåªå…è®¸å‘å·¦(0)æˆ–å‘å³(1)ç§»åŠ¨ä¸¤ä¸ªåŠ¨ä½œï¼Œæ‰€ä»¥è¿™ä¸ªä»£ç (random.randrange(0ï¼Œ2))ç”¨äºé‡‡å–éšæœºåŠ¨ä½œä¹‹ä¸€ã€‚
6.  æˆ‘ä»¬å°†é‡‡å–é‚£ä¸ªè¡ŒåŠ¨/æ­¥éª¤ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ£€æŸ¥å®ƒæ˜¯å¦æ˜¯ç¬¬ä¸€ä¸ªè¡ŒåŠ¨/æ­¥éª¤ï¼Œç„¶åæˆ‘ä»¬å°†å­˜å‚¨ä¹‹å‰çš„è§‚å¯Ÿå’Œæˆ‘ä»¬ä¸ºæ­¤é‡‡å–çš„è¡ŒåŠ¨ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ·»åŠ åˆ†æ•°ï¼Œå¹¶æ£€æŸ¥æ¸¸æˆæ˜¯å¦å®Œæˆï¼Œå¦‚æœæ˜¯ï¼Œç„¶ååœæ­¢ç©å®ƒã€‚
7.  æˆ‘ä»¬å°†æ£€æŸ¥è¿™ä¸ªæ¸¸æˆæ˜¯å¦æ»¡è¶³æˆ‘ä»¬çš„æœ€ä½è¦æ±‚ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿç© 60 æ­¥ã€‚
8.  å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿç© 60 æ­¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æŠŠè¿™ä¸ªåˆ†æ•°æ·»åŠ åˆ° accept_scores ä¸­ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥æ‰“å°è¯¥åˆ†æ•°ï¼Œä»¥äº†è§£æˆ‘ä»¬å°†å¤šå°‘æ¸¸æˆæ•°æ®åŠå…¶åˆ†æ•°è¾“å…¥åˆ°æˆ‘ä»¬çš„æ¨¡å‹ä¸­ã€‚
9.  ç„¶åæˆ‘ä»¬å°†å¯¹åŠ¨ä½œè¿›è¡Œçƒ­ç¼–ç ï¼Œå› ä¸ºå®ƒçš„å€¼ 0(å‘å·¦ç§»åŠ¨)ï¼Œ1(å‘å³ç§»åŠ¨)ä»£è¡¨åˆ†ç±»æ•°æ®ã€‚
10.  ç„¶åæˆ‘ä»¬ä¼šå°†å®ƒæ·»åŠ åˆ°æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®ä¸­ã€‚
11.  æˆ‘ä»¬å°†é‡ç½®ç¯å¢ƒï¼Œä»¥ç¡®ä¿ä¸€åˆ‡éƒ½æ¸…æ¥šï¼Œå¼€å§‹ç©ä¸‹ä¸€ä¸ªæ¸¸æˆã€‚
12.  print(accepted_scores) â€”è¯¥ä»£ç ç”¨äºäº†è§£æˆ‘ä»¬å‘æ¨¡å‹ä¸­è¾“å…¥äº†å¤šå°‘æ¸¸æˆæ•°æ®åŠå…¶åˆ†æ•°ã€‚ç„¶åæˆ‘ä»¬ä¼šè¿”å›è®­ç»ƒæ•°æ®ã€‚

è¯¥ä»£ç åœ¨æ‰§è¡Œåæœ€ç»ˆæ‰“å° accepted_scoresã€‚

```
[63.0, 62.0, 74.0, 66.0, 84.0, 69.0, 65.0, 64.0, 66.0, 63.0, 62.0, 67.0, 62.0, 60.0, 76.0, 65.0, 87.0, 85.0, 76.0, 81.0, 68.0, 63.0, 80.0, 65.0, 63.0, 60.0, 60.0, 61.0, 86.0, 71.0, 72.0, 60.0, 95.0, 65.0, 68.0, 68.0, 63.0, 95.0, 91.0, 99.0, 86.0, 68.0, 72.0, 69.0, 62.0, 74.0, 76.0, 74.0, 64.0, 77.0, 92.0, 67.0, 67.0, 99.0, 81.0, 81.0, 63.0, 73.0, 70.0, 68.0, 63.0, 77.0, 61.0, 62.0, 78.0, 61.0, 71.0, 77.0, 70.0, 72.0, 80.0, 61.0, 68.0, 61.0, 86.0, 145.0, 74.0, 68.0, 79.0, 61.0, 63.0, 65.0, 62.0, 64.0, 65.0, 80.0, 67.0, 78.0, 76.0, 66.0, 63.0, 110.0, 62.0, 70.0, 72.0, 109.0, 76.0, 75.0, 75.0, 73.0, 75.0, 65.0, 77.0, 64.0, 61.0, 60.0, 66.0, 61.0, 62.0, 71.0, 75.0, 82.0, 95.0, 67.0, 61.0, 66.0, 67.0, 65.0, 61.0, 65.0, 66.0, 62.0, 70.0, 89.0, 96.0, 86.0, 62.0, 61.0, 75.0, 84.0, 63.0, 66.0, 73.0, 68.0, 61.0, 66.0, 144.0, 64.0, 61.0, 62.0, 62.0, 67.0, 66.0, 65.0, 66.0, 71.0, 68.0, 81.0, 73.0, 75.0, 75.0, 79.0, 75.0, 104.0, 69.0, 66.0, 81.0, 73.0, 60.0, 64.0, 78.0, 115.0, 62.0, 91.0, 70.0, 69.0, 64.0, 86.0, 70.0, 70.0, 68.0]
```

æ‰€ä»¥æˆ‘ä»¬çš„æ•°æ®å‡†å¤‡å¥½äº†ã€‚æ˜¯æ—¶å€™å»ºç«‹æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œäº†ã€‚

```
def build_model(input_size, output_size):
    model = Sequential()
    model.add(Dense(128, input_dim=input_size, activation='relu'))
    model.add(Dense(52, activation='relu'))
    model.add(Dense(output_size, activation='linear'))
    model.compile(loss='mse', optimizer=Adam())return model
```

è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨åºåˆ—æ¨¡å‹ã€‚

```
def train_model(training_data):
    X = np.array([i[0] for i in training_data]).reshape(-1, len(training_data[0][0]))
    y = np.array([i[1] for i in training_data]).reshape(-1, len(training_data[0][1]))
    model = build_model(input_size=len(X[0]), output_size=len(y[0]))

    model.fit(X, y, epochs=10)
    return model
```

æˆ‘ä»¬æœ‰è®­ç»ƒæ•°æ®ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»ºåŠŸèƒ½å’Œæ ‡ç­¾ã€‚

ç„¶åæˆ‘ä»¬å°†å¼€å§‹è®­ç»ƒ

```
trained_model = train_model(training_data)
```

æˆ‘ä»¬å°†å¾—åˆ°è¿™æ ·çš„è¾“å‡º

```
Epoch 1/10
12236/12236 [==============================] - 1s 94us/step - loss: 0.2483
Epoch 2/10
12236/12236 [==============================] - 1s 71us/step - loss: 0.2348
Epoch 3/10
12236/12236 [==============================] - 1s 67us/step - loss: 0.2333
Epoch 4/10
12236/12236 [==============================] - 1s 68us/step - loss: 0.2334
Epoch 5/10
12236/12236 [==============================] - 1s 64us/step - loss: 0.2325
Epoch 6/10
12236/12236 [==============================] - 1s 63us/step - loss: 0.2324
Epoch 7/10
12236/12236 [==============================] - 1s 66us/step - loss: 0.2315
Epoch 8/10
12236/12236 [==============================] - 1s 65us/step - loss: 0.2318
Epoch 9/10
12236/12236 [==============================] - 1s 65us/step - loss: 0.2317
Epoch 10/10
12236/12236 [==============================] - 1s 65us/step - loss: 0.2318
```

æ˜¯æ—¶å€™è®©æˆ‘ä»¬çš„æ¸¸æˆæœºå™¨äººä¸ºæˆ‘ä»¬ç©æ¸¸æˆäº†ã€‚

è®©æˆ‘ä»¬æ¥ç†è§£è¿™ä¸ªä»£ç 

1.  æˆ‘ä»¬æ­£åœ¨åˆå§‹åŒ–åˆ†æ•°å’Œé€‰æ‹©æ•°ç»„ï¼Œå®ƒå°†å­˜å‚¨æˆ‘ä»¬å¾—åˆ°çš„åˆ†æ•°å’Œåšå‡ºçš„é€‰æ‹©ã€‚
2.  ç©è¿™ä¸ªæ¸¸æˆ 100 æ¬¡ã€‚
3.  åˆå§‹åŒ– score å’Œ prev_obs å˜é‡ä»¥å­˜å‚¨å½“å‰åˆ†æ•°å’Œä»¥å‰çš„è§‚å¯Ÿå€¼ã€‚
4.  æˆ‘ä»¬å°†ç© 500 æ­¥æ¸¸æˆï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªå¾ªç¯(å¯¹äºèŒƒå›´å†…çš„æ­¥é•¿ç´¢å¼•(ç›®æ ‡æ­¥é•¿):)
5.  å¯¹äºç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¸çŸ¥é“çŠ¶æ€å’Œå…¶ä»–äº‹æƒ…ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†é‡‡å–éšæœºæ­¥éª¤ã€‚
6.  ä»ç¬¬äºŒæ­¥å¼€å§‹ï¼Œæˆ‘ä»¬çŸ¥é“æ¸¸æˆçš„å½“å‰çŠ¶æ€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†æŠŠè§‚å¯Ÿç»“æœæä¾›ç»™æˆ‘ä»¬çš„æ¨¡å‹ï¼Œä»¥é¢„æµ‹æˆ‘ä»¬éœ€è¦é‡‡å–çš„è¡ŒåŠ¨ã€‚è¿™éƒ¨åˆ†(**trained _ model . predict(prev _ OBS . shape(-1ï¼Œlen(prev_obs)))** )çš„ä»£ç ä¼šç»™æˆ‘ä»¬æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚æˆ‘ä»¬å°†é‡‡ç”¨æœ€å¤§æ¦‚ç‡ç±»åˆ«å¹¶é‡‡å–è¡ŒåŠ¨ã€‚
7.  æˆ‘ä»¬å°†å­˜å‚¨æˆ‘ä»¬åšå‡ºçš„é€‰æ‹©ï¼Œå­˜å‚¨å½“å‰çŠ¶æ€ï¼Œå¹¶å°†å¥–åŠ±æ·»åŠ åˆ°æˆ‘ä»¬çš„åˆ†æ•°ä¸­ã€‚
8.  æˆ‘ä»¬å°†åœ¨å®Œæˆæ¸¸æˆåé‡ç½®ç¯å¢ƒä»¥ç©ä¸‹ä¸€ä¸ªæ¸¸æˆï¼Œå¹¶å­˜å‚¨æ¸¸æˆçš„å®Œæˆåˆ†æ•°ä»¥æ‰“å°ã€‚

æˆ‘ä»¬ä¼šå¾—åˆ°è¿™æ ·çš„è¾“å‡º

```
[500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 247.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 259.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 264.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 241.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 255.0, 500.0, 500.0, 500.0, 245.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0]
Average Score: 485.11
choice 1:0.5007936344334275  choice 0:0.49920636556657255
```

æœ€åï¼Œæˆ‘ä»¬çš„æœºå™¨äººè¢«è®­ç»ƒäº†ã€‚å®ƒç»ˆäºå¯ä»¥åƒä¸“ä¸šé€‰æ‰‹ä¸€æ ·æ‰“çƒäº†ã€‚

![](img/ab6407a76da8ec51bee0f2fc89cf819f.png)

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ° Jupyter ç¬”è®°æœ¬æ¥å®ç°ã€‚

å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç»™å®ƒä¸€äº›æŒå£°æ¥è¡¨è¾¾ä½ çš„çˆ±ğŸ‘ã€‚
å’Œå¹³ã€‚å¿«ä¹ç¼–ç ã€‚
[è¿™é‡Œçœ‹æˆ‘çš„åŸåˆ›æ–‡ç« ã€‚](https://blog.tanka.la/2018/10/19/build-your-first-ai-game-bot-using-openai-gym-keras-tensorflow-in-python/)

> åŠ å…¥ Coinmonks [ç”µæŠ¥é¢‘é“](https://t.me/coincodecap)å’Œ [Youtube é¢‘é“](https://www.youtube.com/c/coinmonks/videos)è·å–æ¯æ—¥[åŠ å¯†æ–°é—»](http://coincodecap.com/)

## å¦å¤–ï¼Œé˜…è¯»

*   [å¤åˆ¶äº¤æ˜“](/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c) | [åŠ å¯†ç¨åŠ¡è½¯ä»¶](/coinmonks/crypto-tax-software-ed4b4810e338)
*   [ç½‘æ ¼äº¤æ˜“](https://coincodecap.com/grid-trading) | [åŠ å¯†ç¡¬ä»¶é’±åŒ…](/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069)
*   [æœ€ä½³åŠ å¯†äº¤æ˜“æ‰€](/coinmonks/crypto-exchange-dd2f9d6f3769) | [å°åº¦æœ€ä½³åŠ å¯†äº¤æ˜“æ‰€](/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9)
*   [å¼€å‘äººå‘˜çš„æœ€ä½³åŠ å¯† API](/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f)
*   [å¯†ç ç”µæŠ¥ä¿¡å·](http://Top 4 Telegram Channels for Crypto Traders) | [å¯†ç äº¤æ˜“æœºå™¨äºº](/coinmonks/crypto-trading-bot-c2ffce8acb2a)
*   æœ€ä½³[å¯†ç å€Ÿè´·å¹³å°](/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa)
*   æ æ†ä»£å¸çš„ç»ˆææŒ‡å—
*   [åŠ å¯†äº¤æ˜“çš„æœ€ä½³ VPN](https://coincodecap.com/best-vpns-for-crypto-trading)
*   [ç”¨äº Huobi çš„åŠ å¯†äº¤æ˜“ä¿¡å·](https://coincodecap.com/huobi-crypto-trading-signals) | [HitBTC å®¡æŸ¥](/coinmonks/hitbtc-review-c5143c5d53c2)
*   [TraderWagon å›é¡¾](https://coincodecap.com/traderwagon-review) | [åŒ—æµ·å·¨å¦– vs åŒå­æ˜Ÿ vs BitYard](https://coincodecap.com/kraken-vs-gemini-vs-bityard)
*   [å¦‚ä½•åœ¨ FTX äº¤æ˜“æ‰€äº¤æ˜“æœŸè´§](https://coincodecap.com/ftx-futures-trading)
*   [OKEx vs KuCoin](https://coincodecap.com/okex-kucoin) | [æ‘„æ°æ›¿ä»£åº¦](https://coincodecap.com/celsius-alternatives) | [å¦‚ä½•è´­ä¹° VeChain](https://coincodecap.com/buy-vechain)
*   [3 commas vs . Pionex vs . crypto hopper](https://coincodecap.com/3commas-vs-pionex-vs-cryptohopper)
*   [å¦‚ä½•ä½¿ç”¨ Cornix äº¤æ˜“æœºå™¨äºº](https://coincodecap.com/cornix-trading-bot)
*   [Bitget å›é¡¾](https://coincodecap.com/bitget-review)|[Gemini vs block fi](https://coincodecap.com/gemini-vs-blockfi)cmd |[OKEx æœŸè´§äº¤æ˜“](https://coincodecap.com/okex-futures-trading)
*   [ç”¨ä¿¡ç”¨å¡è´­ä¹°å¯†ç çš„ 10 ä¸ªæœ€ä½³åœ°ç‚¹](https://coincodecap.com/buy-crypto-with-credit-card)