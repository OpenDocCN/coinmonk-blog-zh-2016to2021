# 编写、编译、部署 Solidity 2021。

> 原文：<https://medium.com/coinmonks/writing-compiling-deploying-solidity-2021-b9b915e8dd5f?source=collection_archive---------3----------------------->

![](img/1723dcc630f41da967ffddb828c4c11b.png)

Photo by [Lorenzo Herrera](https://unsplash.com/@lorenzoherrera?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

在区块链这种尖端技术中，即使是初学者也很容易感到迷失。以太坊领域的开发者工具包也在快速发展。因此，本教程将向您展示如何编写基本的 solidity 程序，在本地编译，并部署到一个测试网络，如 Rinkeby 的最新版本。

## 我们开始吧🌠

*   您将需要通过 npm 安装一些依赖项。所以让我们先抓住他们
*   创建一个新的目录并放入光盘。那就跑

```
npm init -y *//to start a new project*
npm i solc web3 @truffle/hdwallet-provider *//to install dependencies*
```

> ****合同****

## ****简要说明****

*   **使用 pragma 定义使用哪个版本的 solidity**
*   **契约定义了一个变量 x**
*   **在实例化协定时调用的构造函数，就像其他语言中的构造函数一样**
*   **函数来设置 x 的新值并获取 x 的值**

> ****编译脚本****

**让我们先运行这段代码，看看它做了什么**

```
node compile.js *//the compile file can be named anything*
```

## **简要说明**

*   **我们引入了 solc 编译器**
*   **然后是*路径*和 *fs* 模块。为什么这么问？path 模块获取合同文件的绝对路径(不考虑操作系统),而 *fs* 读取文件，这样我们可以将它存储在一个变量中，在本例中为 *source* 。**
*   **然后我们必须把它传递给编译器，但是等待，它期望一个特定的格式，所以我们为它创建了*输入*变量，并把*源*传递给它，如你所见**
*   **现在一切都完成了，我们通过*字符串化*它，把它提供给编译器。**
*   **慢慢查看控制台日志，如果愿意，甚至可以进一步展开它。**
*   **为什么要那样导出？问得好。请记住，我们仍然需要部署它，答案就在那里。**

> ****部署脚本****

**很好，我们将部署到测试网络 rinkeby，为了本教程的简单，我假设你已经安装了元掩码(如果没有，这很简单),你在 rinkeby 网络的元掩码中有一些测试以太网，或者你希望部署的测试网络(你可以从[https://faucet.rinkeby.io/](https://faucet.rinkeby.io/)或相应的水龙头中得到一些)**

***注意:这个脚本中有很多东西需要解开，我会尽量简短明了***

***注意:12 个单词的助记短语是保密的，泄露或丢失它意味着您的帐户可能会受到威胁***

## **简要说明**

***HDWalletProvider* —部署成本是以太的，因此该软件包使用**

*   **你的 12 个单词的助记符来获得账户和签署交易，这样你就不用手动操作了。**
*   **第二个参数是 [infura](https://infura.io/) api，什么是 infura？区块链网络由存储所有数据并不间断运行的节点[计算机]组成，因此要在其上部署，您需要自己拥有区块链的完整副本，这意味着设置您自己的节点，这不太实际，是吗？所以基本上 infura 给我们提供了他们的 api，直接连接到区块链。所以使用 infura 的 api 避免了很多麻烦。**

***Web3js* —这个库允许我们用 javascript 以一种简单的方式与节点交流。它需要一个我们传递给它的提供者。**

*   **记住库提供给我们一个构造函数，所以它的大写字母“W”web 3，然后我们用“W”web 3 实例化它**

***abi* ，*字节码*——这两样东西是我们部署所必需的，这是编译器吐出来的，abi 以 json 格式包含你的契约的功能，字节码是你的低级机器码的契约**

***deploy()函数* —这里没有太多解释，但是有一些需要注意的地方**

*   **我们传入 abi 和字节码**
*   **参数数组是为我们的构造函数准备的，记住它需要一个参数 *_x，*如果我们的构造函数不需要任何参数，我们就不会传递参数数组**
*   **部署后，控制台登录" *contract"* "包含像我们的契约方法这样的信息，重要的是它部署到的地址。**

**你会得到合同的地址，你可以在 https://rinkeby.etherscan.io/搜索**

**祝贺你，你在这篇文章中学到了很多，至少我希望如此。 *tada！！***