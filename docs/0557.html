<html>
<head>
<title>Ethernaut ‘Vault’ Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太网“保险库”问题</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethernaut-vault-problem-b2675393650b?source=collection_archive---------2-----------------------#2018-05-17">https://medium.com/coinmonks/ethernaut-vault-problem-b2675393650b?source=collection_archive---------2-----------------------#2018-05-17</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/6585915a205a4f23bffb75af0217e881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8as3MAB2JYV-sMP5q8fFxg.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">A soft touch… A quick glance</figcaption></figure><p id="a42d" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">这是我第四次在:<a class="ae kd" href="https://ethernaut.zeppelin.solutions/level/0x6b7b4a5260b67c1ee9196a42dd1ed8633231ba0a" rel="noopener ugc nofollow" target="_blank"> Ethernaut </a>上写一个可怕的以太坊安全问题，我在这方面已经变得非常有效率了！让我们开始吧。</p><figure class="kf kg kh ki fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ke"><img src="../Images/d63ba3f1cdd44120c2a35071393461a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R4sDBfFeL_1ehmXS2JBJGg.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">The “Vault” contract</figcaption></figure><blockquote class="kj kk kl"><p id="af66" class="jf jg km jh b ji jj jk jl jm jn jo jp kn jr js jt ko jv jw jx kp jz ka kb kc hm dt translated">解锁金库通过关卡！</p></blockquote><p id="eb21" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">与我们迄今为止面临的其他问题相比，这一个肯定有不同的味道。我们可能有两条路可以打开这个保险库:</p><ol class=""><li id="472c" class="kq kr ht jh b ji jj jm jn jq ks ju kt jy ku kc kv kw kx ky dt translated">蛮力它不知何故，通过一个漏洞解锁保险库，而不知道密码。</li><li id="6298" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc kv kw kx ky dt translated">用我们的诡计得到秘密密码。</li></ol><p id="7f07" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">老实说，1只是浪费时间，这个合同是如此简单，真的没有太多的空间来玩杂技，我们通过的唯一方法是如果我们知道密码。那么，在这个早期阶段，我们对密码了解多少呢？</p><h1 id="1dcd" class="le lf ht bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb dt translated"><strong class="ak">知道你的目标👀</strong></h1><pre class="kf kg kh ki fq mc md me mf aw mg dt"><span id="5441" class="mh lf ht md b fv mi mj l mk ml">bytes32 private password;</span></pre><p id="b572" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">密码是一个存储变量，类型为bytes32，具有私人访问权限。最后一点值得澄清，根据文档，以下是不同访问类型的含义:</p><ul class=""><li id="7344" class="kq kr ht jh b ji jj jm jn jq ks ju kt jy ku kc mm kw kx ky dt translated">外部:所有，仅外部</li><li id="f676" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc mm kw kx ky dt translated">public: all(这是默认值)，外部和内部</li><li id="92eb" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc mm kw kx ky dt translated">内部:仅限于本合同及其衍生合同，仅限于内部</li><li id="b789" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc mm kw kx ky dt translated"><strong class="jh hu">私人:只有这个合同，只有内部</strong></li></ul><p id="3231" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">基本上，这意味着我们不能只在控制台上运行contract.password()就结束工作。值得注意的是，如果password具有内部可见性，我们可以从这个契约中继承并通过son访问password变量！</p><figure class="kf kg kh ki fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mn"><img src="../Images/6a1d77be1d3054f900a0010df4c12b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qkAiVWLv32eeour0Am1X7w.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">This works</figcaption></figure><p id="3e53" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">但是对于私有可访问性，只有来自同一个契约的内部调用才能访问它们。在这一点上，你可以感到挫败，或者记住以太坊是一个公共账本，以完全透明的方式详细记录了数百万笔交易，供全世界的眼睛看到。这意味着我们可以查询合同的<strong class="jh hu">存储。无论你在合同中多么小心地封装微妙的变量，这一事实都不会改变。</strong></p><h1 id="0e9e" class="le lf ht bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb dt translated">洞穴存储🐚</h1><p id="0c52" class="pw-post-body-paragraph jf jg ht jh b ji mo jk jl jm mp jo jp jq mq js jt ju mr jw jx jy ms ka kb kc hm dt translated">那么，我们如何非正式地检查合同呢？(即通过公共分类账而不是合同本身的整洁实施)</p><p id="f4f2" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">进入<strong class="jh hu">web 3</strong>js库与以太坊区块链进行交互。</p><figure class="kf kg kh ki fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mt"><img src="../Images/fc3dbde15c82accdc838208752cf4be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hb_RRuAH4ZuMOgx_kHRe_A.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">It’s been available for Ethernauts all along…</figcaption></figure><p id="a2cc" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">我们感兴趣的方法名为<strong class="jh hu"> web3.eth.getStorage. </strong>接受一个契约地址，一个整数(index！)如果你使用元掩码，你也必须传递一个回调函数来避免不必要的错误。</p><p id="7433" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">等等，索引？是啊！我们不是查询整个存储，而是一点一点地获取，幸运的是，存储是以一种非常简单的方式组织的。</p><p id="6432" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated"><strong class="jh hu">每个存储元素</strong>按照它们被定义的顺序进行索引。在保险库契约的情况下，<em class="km">锁定的</em>存储变量的索引为0，而这个有趣的密码的索引为1。</p><p id="4d5b" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">将所有这些放在一起，然后:</p><pre class="kf kg kh ki fq mc md me mf aw mg dt"><span id="4fb3" class="mh lf ht md b fv mi mj l mk ml">let contractAddress = //contract Address<br/>password = web3.eth.getStorageAt(contractAddress, index))<br/>// For Metamask callback whining<br/>web3.eth.getStorageAt(contractAddress, 1, <br/>function(error, result) {password = result}))</span></pre><p id="b465" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">这里你将得到一个十六进制的字符串，所以如果你想确定你得到了正确的变量，为什么不试着把结果转换成Ascii呢？</p><h1 id="3dc5" class="le lf ht bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb dt translated">结论</h1><p id="9ba3" class="pw-post-body-paragraph jf jg ht jh b ji mo jk jl jm mp jo jp jq mq js jt ju mr jw jx jy ms ka kb kc hm dt translated">这个问题是为了钻透这个简单的事实:<strong class="jh hu">“在一个公共的区块链上，一切都是公开的”。</strong>在客户端/区块链环境中，不存在客户端/服务器应用程序的信息不对称。</p><p id="e8ea" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">在将你的DNA以“私人”可见的方式上传到区块链之前，想想这个问题。👩‍🔬</p><p id="bcc1" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">如果你想了解更多关于检查以太坊智能合约的信息，请查看著名TSM策划人<a class="mu mv gr" href="https://medium.com/u/6e8ea834f227?source=post_page-----b2675393650b--------------------------------" rel="noopener" target="_blank">大流士</a>撰写的这篇<a class="ae kd" rel="noopener" href="/aigang-network/how-to-read-ethereum-contract-storage-44252c8af925">精彩文章</a>！</p><blockquote class="mw"><p id="241b" class="mx my ht bd mz na nb nc nd ne nf kc ek translated">加入Coinmonks <a class="ae kd" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae kd" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae kd" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="mh lf ht bd lg ng nh ni lk nj nk nl lo jq nm nn ls ju no np lw jy nq nr ma ns dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="kq kr ht jh b ji mo jm mp jq nt ju nu jy nv kc mm kw kx ky dt translated"><a class="ae kd" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae kd" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc mm kw kx ky dt translated"><a class="ae kd" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae kd" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc mm kw kx ky dt translated"><a class="ae kd" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae kd" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="f33b" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc mm kw kx ky dt translated"><a class="ae kd" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae kd" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc mm kw kx ky dt translated">开发人员的最佳加密API</li><li id="b359" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc mm kw kx ky dt translated">最佳<a class="ae kd" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="kq kr ht jh b ji kz jm la jq lb ju lc jy ld kc mm kw kx ky dt translated"><a class="ae kd" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币</a>终极指南</li></ul></div></div>    
</body>
</html>