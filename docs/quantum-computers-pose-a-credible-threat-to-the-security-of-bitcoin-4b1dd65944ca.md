# 量子计算机对比特币的安全构成了可信的威胁

> 原文：<https://medium.com/coinmonks/quantum-computers-pose-a-credible-threat-to-the-security-of-bitcoin-4b1dd65944ca?source=collection_archive---------5----------------------->

“……为了避免神经衰弱——这是历史强加给我们的无情惩罚——我们必须有勇气遵循所有技术推断的逻辑结论。” —亚瑟·C·克拉克

**Tl；dr:** 人们大大低估了量子计算将为今天依赖 ECDSA 的加密货币带来的问题，并且可能高估了有用的量子计算机(QCs)需要多长时间才能到来。比特币和其他硬币不能轻易分叉到量子安全，避免这些问题。

围绕 QCs 及其与加密货币的关系存在大量困惑。这旨在成为想研究这个问题的人的资源和起点。我绝不是量子计算专家，但所有这些都可供任何人自行研究。不要相信我的话(如果你觉得我说错了什么，请告诉我)。

当谈到 QCs 和当今区块链系统的关系时，有两个方面经常被混淆:

*   质量控制对采矿/哈希法的影响(SHA-256)和区块链概念的基本可行性(不是一个大问题)
*   QCs 对当前区块链实施(如依赖 ECDSA 的 BTC)的钱包/地址安全的影响(一个非常严重的问题)

这些方面与讨论 QCs 时经常引用的两种算法直接相关: *Grover 的算法和 Shor 的算法*。人们常常对 QC 威胁不屑一顾，因为他们只考虑 Grover 的算法而完全忽略了【Shor 的算法将对加密货币私钥/钱包构成的威胁，他们常常不明白两者之间的区别。关于 Shor 和 Grover 算法背后的数学和相关的区块链机制的更多细节，可以在这里[和这里](https://eprint.iacr.org/2018/213.pdf)[进行探索。](https://nicacton.com/blog/quantum-blockchain/)

**为什么现在的钱包容易受到 QC 的攻击(QC 擅长什么样的问题)？**

如果让你找出数字 15 的两个质因数，你会告诉我它们是 5 和 3。

如果你被要求找出一个 1000 多位数的数字的两个质因数，你可能会有一些麻烦。即使是我们最快的超级计算机也无法在合理的时间框架内解决这类问题(这将需要数百万年的时间)，这一事实是当今互联网密码系统的基础。这种设置的不对称性是至关重要的部分:如果一个人声称知道这些数字，或者拥有*私钥*，那么验证这种说法是很容易的——但是从功能上讲，我们不可能从*公钥*中推导出它。这在一个方向上是容易/有效的，而在另一个方向上是难以计算的。

这种整数因式分解问题(以及相关的离散对数问题)的困难是公钥基础设施(PKI)安全性的基础，它允许我们在互联网上传输信用卡号码，并保证消息由给定公钥的持有者签名。利用这种假设并为大多数当代区块链钱包提供安全性的具体实现被称为椭圆曲线数字签名算法(ECDSA)。

量子计算摧毁了这个假设。使用 Shor 算法，足够强大的 QC 将把分解两个素数的乘积所需的时间从数百万年减少到几分钟/秒，并且允许 QC 从公钥导出私钥。任何广播交易的 BTC 地址都有暴露的公钥，**所有 Satoshi 的** [**一百万硬币**](https://bitslog.wordpress.com/2013/04/17/the-well-deserved-fortune-of-satoshi-nakamoto/) **，代表 65 亿美元和超过 5%的流通中的 BTC，都暴露于这种类型的攻击**(2012 年[之前，块奖励支付给 ECC 公钥](https://www.reddit.com/r/Bitcoin/comments/3wfmg2/satoshis_unmoved_coins_are_the_worlds_biggest/)，但现在支付给公钥的 SHA256 散列)。超过 40%的比特币余额由公开密钥的钱包持有(参见“地址重用”图表[此处](https://oxt.me/charts))。

目前依赖 ECDSA 的任何东西都将在未来的某个时候被迫尝试升级，但这种过渡存在重大问题，我从未见过这些问题得到充分解决。

**从《创世纪》来看，区块链的主要问题不是量子抵抗的:**

即使一个项目成功地将他们的区块链分叉为具有量子证明的加密签名方案(这是绝对可能的)，他们的旧硬币(以及推而广之，他们更新的“量子证明”区块链)仍然可以被攻击，就好像它们根本没有受到量子证明密码术的保护一样。

一个硬分叉可以产生两个独立的硬币(如 BTC 和 BCH 的情况)，或者它可以代表一种更新，其中一个硬币是更新的结果，另一个被放弃(如我们在 ETH 的常规硬分叉中看到的)。无论哪种方式，在叉子之后，你的新硬币将会在你有旧硬币的地方:在钱包里或在交易所里。这意味着新硬币仍然可以通过您的旧私钥获得。这个旧私钥是*而不是*量子证明，因为分叉不会也不可能使旧私钥消失。如果新硬币没有以某种方式与旧的私人钥匙相连，它怎么会出现在你的钱包/交易所里，并能被你拿到呢？

为了完成假设的量子证明更新，用户需要将他们的量子证明硬币移动到一个新的地址/钱包。这样，用户将把他们的旧私钥留在他们的旧钱包中，而发送到他们的新地址/钱包的新硬币将只能用新的量子验证私钥来访问。这看似相对简单，却隐藏着问题。除了人性问题(表明并非每个人都会及时参与突然出现的黑天鹅 QC 进展)之外，还有一个更紧迫的问题:

由于用户[丢失了他们的钥匙/密码](https://www.cnbc.com/2017/12/20/man-lost-127-million-worth-of-bitcoins-and-city-wont-let-him-look.html)或以其他方式被锁定，有许多硬币丢失或无法使用。对于那些存在时间最长的区块链来说尤其如此，比如 BTC 和 ETH(据[估计](http://fortune.com/2017/11/25/lost-bitcoins/)多达 20%的 BTC 永久消失)。对于几乎每一个区块链项目和平台来说，都有很多硬币，甚至没有人能把它们转移到一个新钱包里。即使在对给定的区块链进行“量子验证”之后，硬币的整个子集仍然可以通过其相关联的旧的/原始的/遗留的私钥来访问，并且因此对于它们的原始人类所有者来说*不*可以被访问以进行转移，但是如果所讨论的地址的公钥曾经被暴露，则*将*可以被 QC 访问。QC 攻击者可以访问这些旧硬币，并将它们迁移到新系统，这可能导致更新的“量子证明”区块链，其中 QC 攻击者拥有所有现存硬币的 10%以上，允许他们严重操纵价格。如果 NSA 突然拥有所有比特币的 10%,并希望压低价格，这可能是对突然放弃法定货币的回应，这难道不会引发对 BTC 体系作为价值储存手段的安全性的信心危机吗？

人们会说:*“我们可以简单地设定一个截止日期，任何没有及时迁移的硬币都将变得无法使用”*——的确，这可以通过软分叉实现。但是，当/如果 Satoshi 的硬币没有在截止日期前移动，如果新的“量子证明”比特币链切断了比特币发明者(以及任何其他错过截止日期的人，无论出于什么原因)移动 BTC 的能力，人们会接受它是合法的吗？充其量，这将比块大小的辩论更有争议，而且由于 BTC 可能只会在对一些量子计算机新闻做出反应时进行这样的过渡，组织这样一次过渡的时间框架可能会被严重压缩。设法让 50%的 BTC 人参与这样的迁移(特别是在时间压力下)将是一个巨大的壮举，即使有 50%的参与，也远远达不到解决合法性问题所需的多数。

**2)** 让我们假设上述问题已经解决， *deus ex machina，*并且我们获得了一个保证，即每一个地址都将在物理上可能的情况下尽快将其余额迁移到一个新的量子安全地址，另外还有一个额外的好处，即根本不用担心丢失硬币。

还有第二种类型的攻击，如果它等到 QC 成为威胁时才尝试转换，这种攻击会在尝试升级的过程中使区块链网络完全瘫痪。一旦试图迁移其硬币的用户向网络提交交易，充分武装的 QC 攻击者就可以获得私钥(在比特币系统中不暴露公钥就无法提交交易)，并以更高的费用提交第二次交易，从而在 QC 攻击者的控制下有效地将传输中的 BTC 重新路由到量子证明地址。除非你在网络中引入某种临时集中，否则没有办法发送任何交易而不被劫持(我已经找到了)。

**以下是我在谈到与当今加密货币相关的质量控制风险时经常看到的一些常见回答和误解**

***但是整个互联网不也是依靠 PKI 吗？如果存在足够强大的 QCs，我们会有更大的问题！***

这是对质量控制威胁的常见不回应。虽然迁移遗留系统肯定会很困难，但实际上，将集中式系统(银行、HTTPS、核武器系统等)升级到 XMSS 之类的东西要比去中心化的区块链容易得多。对于集中式系统来说，系统停机并不是什么大不了的事情——另一方面，区块链是建立在无停机和无中央权威的基础上的，中央权威可以规定临时暂停和随后重启的条件。

[后量子标准正在得到巩固](https://csrc.nist.gov/Projects/Post-Quantum-Cryptography/Round-1-Submissions)，由 [ISARA Corporation 等组织领导的将传统机构系统过渡到量子安全的努力已经在进行中。](https://www.isara.com/)

***挖掘:SHA256 是哈希函数，不是加密技术，不会被 QCs*** 破解

这是真的，这也是人们声称 QCs 不是威胁时经常引用的原因之一。当考虑挖掘时，Shor 的算法是不相关的。这就是格罗弗算法的用武之地，因为它为量子计算机在任意数据集中搜索提供了超越经典计算机的二次优势。比特币挖矿就属于这类搜索问题(2 个⁵⁶的难度会变成 2 个⁸).的难度这是质量控制威胁经常(错误地)被忽视的原因之一。

虽然它并不像 Shor 算法那样代表那么大的存在风险，但**即使是 mining / Grover 算法的威胁也可能比人们考虑的更加严重**。正如[的作者](https://arxiv.org/abs/1804.08118)在[的 reddit 帖子](https://www.reddit.com/r/Bitcoin/comments/8gh9ac/on_the_insecurity_of_quantum_bitcoin_mining/dyblgwm/) : *中解释的那样，“以前有人认为量子挖掘的唯一副作用是增加难度，因为这种二次加速可以应用于比特币挖掘。在这篇文章中，我们认为，当进行量子挖掘时，比特币安全性分析中的一个关键论点就失效了。传统上，当两个矿工几乎同时发现一个区块时，比特币分叉很少发生:由于传播时间效应，只有当两个矿工都不知道另一个的区块时。当量子矿工使用格罗弗的算法时，情况会有很大不同。”*

***QCs 只是理论上的***——***实际存在时叫醒我！***

另一个常见的误解是 QCs 仍然主要是理论性的。有人说，在许多技术的生命周期中，有一个时刻，一个想法从物理学家的梦想变成了工程师的噩梦。QCs 正处于这一阶段，它们已经存在，尽管还处于萌芽状态。

*   IBM 有一台[公开的 20 量子位量子计算机](https://quantumexperience.ng.bluemix.net/qx/experience)
*   麻省理工学院的研究人员实现了肖尔的算法，[因子 15](http://news.mit.edu/2016/quantum-computer-end-encryption-schemes-0303)
*   谷歌有一个 72 量子位的处理器，并打算用它来展示**量子优势**(当一个量子计算机第一次执行一个在经典计算机上不可能的计算)

***如果你不重复使用地址，你的 BTC 是安全的/永远不要暴露带有硬币的地址的公钥***

这关系到*本地与全球量子安全*。人们常说，如果你使用正确的钱包技术(不要使用一个钱包进行一次以上的交易)，个人钱包将不会受到 QC、**的攻击，这是真的**。尽管这是真的，但如果 Satoshi 的所有硬币被盗并出售，市场价格暴跌 90%，你的安全比特币仍将价值减少 90%，因为网络作为一个整体将没有足够的量子抗性来保持信心。

***分叉到新签名方案的其他问题***

量子证明签名比 ECDSA 签名大得多，如果在 BTC 实现，这将显著增加交易成本和时间。分叉会影响比特币系统的许多部分，与从一开始就设计为抗量子的系统相比，可能会导致不可避免的低效率。鉴于区块链开发的缓慢进展和争议性，快速完成这种类型的分叉以应对质量控制能力的不可预见的进步可能并不可行。

如果这是真的，为什么人们没有认真对待量子威胁？

依赖密码术的专业人士正在非常认真地对待量子计算带来的威胁。2015 年，[NSA 宣布](https://en.wikipedia.org/wiki/Elliptic-curve_cryptography#Quantum_computing_attacks)由于担心 QC 对当前加密标准的攻击，计划转向新的密码套件。

**针对当今的加密货币提出了哪些解决方案？**

[Andreas m . Antonopoulos](https://medium.com/u/898f59563d67?source=post_page-----4b1dd65944ca--------------------------------):[他的回应](https://www.youtube.com/watch?v=dkXKpMku5QY)基本上是*到时候我们会更新签名方案*，但是这并没有考虑到上面提到的关于过渡的困难。

[维塔利克·布特林](https://medium.com/u/587a00dbce51?source=post_page-----4b1dd65944ca--------------------------------):维塔利克自己在 2013 年给[写了一篇文章](https://bitcoinmagazine.com/articles/bitcoin-is-not-quantum-safe-and-how-we-can-fix-1375242150)，讲述了为什么比特币容易受到 QC 攻击以及如何修复它，并就同一主题给[做了一次演讲](https://www.youtube.com/watch?v=DkUpZkeqhF4)。目前，争论转移到以太坊，因为它使用相同的假设作为其安全性的基础。请注意，在他提出的解决方案中，Vitalik 做了两个主要假设:

*   将会有一个月的“警告期”,在此期间量子计算机被宣布但不用于攻击(例如，如果 NSA 在几年内拥有一台量子计算机，并决定破坏 BTC 的稳定以阻止放弃美元，将不会有警告期。任何一个拥有量子计算机的民族国家，如果对它们的拥有保密的话，其优势会大得多，因为它们可以实时破解其他国家的加密通信。
*   所有用户都将及时合作(**他的解决方案也依赖于临时集中化**，我怀疑能否在一个月内组织起来，即使那个月存在，因为区块链修改的争议/缓慢移动的本质)。也没有解决丢失的 BTC 或聪的硬币的问题。

一个[提交-延迟-披露协议](https://eprint.iacr.org/2018/213.pdf):这可能是迄今为止最好的提议，但强调“有必要有一个实质性的延迟阶段，以提供足够的保护，防止意外的，特别是敌对的链重组”，这可能会持续长达 6 个月，**在此期间，BTC 链将变得不可用**，并假设“比特币社区已经**同意并部署了**一个抗量子签名方案。”如上所述，改变签名方案不是一个小问题，尤其是考虑到时间限制，实现它是否可行是有疑问的。

如果我错过了任何考虑到上述困难的建议解决方案，请告诉我。

**区块链中真正量子安全所需的性质**

今天，大多数关于量子安全的主张都是误导或者完全错误的。为了完全量子安全，区块链:

*   不能依赖 ECDSA
*   从创世纪开始一定是量子安全的

**一场 QC 军备竞赛正在进行**

不应该忽视最近民族国家对量子技术投资的增加。中国已经宣布打算投资 100 亿美元建立量子信息科学国家实验室，计划于 2020 年开放。美国国防部[已经在 2019 财年预算中要求 1 . 05 亿美元](https://gcn.com/articles/2018/02/20/doe-budget-cyber-exascale-quantum.aspx)专门用于提高其量子能力，参议员卡玛拉·哈里斯[最近提出了](https://timesofsandiego.com/tech/2018/06/07/california-sen-kamala-harris-seeks-to-spur-quantum-computing-research/)一项美国量子倡议。加拿大和澳大利亚是在这一研究领域投入巨资的其他政府。

量子计算机是政府可能拥有的最有价值的优势之一，情报机构很可能正在储存其他国家的加密通信，最终将变得可破译。

**警告和结论**

量子计算技术非常复杂，尽管剩余的障碍可能会比专家预期的更早被克服(就像人工智能专家在 2015 年预测人工智能技术在十年内无法击败人类围棋冠军一样，然后第二年就发生了)，但这也可能需要比预期更长的时间。

一个关键的区别是“量子位”和“逻辑量子位”，这是对一个已经模糊的概念的复杂描述。有人[估计](https://arxiv.org/abs/1706.06752)一台量子计算机最多需要 2330 个量子位和 1290 亿个门才能破解比特币的 secp256k1 椭圆曲线实现。正如 reddit 评论者[恰如其分地](https://www.reddit.com/r/Bitcoin/comments/6is19z/new_estimate_quantum_computers_require_at_most/dj8mlnm/) , **所说，为了在智力上诚实，我们必须承认，2330 个量子位指的是理想的、容错的、逻辑的量子位，而 2017 年由** [**IBM 的量子处理器**](https://www.research.ibm.com/ibm-q/) **实现的 17 个量子位是原始的、不完美的量子位，可以用来编码**[](https://arxiv.org/abs/1705.02329)****。单个容错量子位的量子纠错尚未在实验中实现。****

**不应低估纠错、噪声和缩放的困难。它们可能是人类面临的最艰巨的工程任务之一。也就是说，有多种途径的研究正在进行，进入完全独立的量子位架构，都有不同的属性和权衡，其中一些更容易扩展。例如，微软正在研究高度可扩展的拓扑量子位，而[的目标是](https://www.microsoft.com/en-us/research/blog/future-is-quantum-with-dr-krysta-svore/)“扩展到几千、一万、几十万甚至更多。”**

**质量控制进展的消息迅速堆积，基本发现被频繁报道。最近的新闻包括研究[，例如量子计算机可以在室温下运行](https://phys.org/news/2018-05-semiconductor-million-faster-quantum.html#jCp)。**

**量子计算机可以让世界变得更好**

**QCs 的承诺几乎是无限的，将有助于加速几乎所有其他科学领域的进步。最直接的好处将是材料设计、药物开发、人工智能研究以及应对气候变化。总有一天，我们将能够用今天最好的超级计算机进行比宇宙年龄还要长的计算，而时间只需泡一杯咖啡。**

*****Edit 8/24/2019:** 超导体 UTe2 中[新特性的发现正是那种可能催生黑天鹅进展/重大突破和量子计算机时间线重新调整的事情。](https://www.sciencedaily.com/releases/2019/08/190815140843.htm)**

**自本文撰写以来，美国政府[已经通过了一项 12 亿美元的量子计算法案](https://www.technologyreview.com/f/612679/president-trump-has-signed-a-12-billon-law-to-boost-us-quantum-tech/)来推进研究。**