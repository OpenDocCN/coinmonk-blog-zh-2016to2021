<html>
<head>
<title>Blockchain : Day 1 — Environment Setup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">区块链:第一天——环境设置</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/blockchain-day-1-environment-setup-4b2ed581cc99?source=collection_archive---------0-----------------------#2021-12-30">https://medium.com/coinmonks/blockchain-day-1-environment-setup-4b2ed581cc99?source=collection_archive---------0-----------------------#2021-12-30</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/></div><div class="ab cl iq ir hb is" role="separator"><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv iw"/><span class="it bw bk iu iv"/></div><div class="hm hn ho hp hq"><figure class="iy iz ja jb fq jc fe ff paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="fe ff ix"><img src="../Images/48a6cc62fa08ac5bf397fcf67bc9891d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*njSltCVxlp6fSn6ZSy0uug.png"/></div></div></figure><h1 id="b746" class="jj jk ht bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">概观</h1><p id="3937" class="pw-post-body-paragraph kh ki ht kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le hm dt translated">在研究区块链技术及其应用的过程中，我决定将我的日常经验记录下来，与其他像我一样的开发人员分享，这是开发一个分散式应用的第一步。在本系列中，我不深入研究构建区块链的概念，这是非常困难的，我宁愿只分享有用的开发经验。既然我们步调一致，就让我们开始吧。</p><h1 id="24d7" class="jj jk ht bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">设置开发环境</h1><p id="54c4" class="pw-post-body-paragraph kh ki ht kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le hm dt translated">正如您已经知道的，我们的区块链应用程序将由一组智能合同组成。要编写智能合约，我们当然需要学习智能合约编程语言，但谈论它们的细节不在本文的范围内，所以让我分享一些关键词，你可以从它们开始:</p><ul class=""><li id="96ae" class="lf lg ht kj b kk lh ko li ks lj kw lk la ll le lm ln lo lp dt translated"><a class="ae lq" href="https://docs.soliditylang.org/en/v0.5.13/index.html" rel="noopener ugc nofollow" target="_blank">坚固度</a></li><li id="ec1b" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated"><a class="ae lq" href="https://vyper.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">威普</a></li><li id="c579" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated">锈</li><li id="6a59" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated">java描述语言</li><li id="8d2d" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated"><a class="ae lq" href="https://docs.soliditylang.org/en/v0.8.11/yul.html" rel="noopener ugc nofollow" target="_blank">游</a></li></ul><p id="326b" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">其中，Solidity似乎是最广为人知的一个，我们将在整个系列中使用Solidity作为编程语言来构建我们的智能合约。</p><blockquote class="lz ma mb"><p id="5e81" class="kh ki mc kj b kk lh km kn ko li kq kr md lw ku kv me lx ky kz mf ly lc ld le hm dt translated">Solidity是一种面向对象的高级语言，用于实现智能合约。它受C++、Python和JavaScript的影响，设计目标是以太坊虚拟机(EVM)。</p></blockquote><h2 id="9eb2" class="mg jk ht bd jl mh mi mj jp mk ml mm jt ks mn mo jx kw mp mq kb la mr ms kf mt dt translated">开发环境</h2><p id="d9de" class="pw-post-body-paragraph kh ki ht kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le hm dt translated">对于开发环境，我们有一些令人惊奇的选项值得一试:</p><ul class=""><li id="fb2c" class="lf lg ht kj b kk lh ko li ks lj kw lk la ll le lm ln lo lp dt translated"><a class="ae lq" href="https://trufflesuite.com/index.html" rel="noopener ugc nofollow" target="_blank">松露</a></li><li id="1ba2" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated"><a class="ae lq" href="https://hardhat.org" rel="noopener ugc nofollow" target="_blank">安全帽</a></li><li id="8230" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated"><a class="ae lq" href="https://eth-brownie.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">布朗尼</a></li><li id="bc77" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated"><a class="ae lq" href="https://remix.ethereum.org/" rel="noopener ugc nofollow" target="_blank">混音</a></li></ul><blockquote class="lz ma mb"><p id="dfd3" class="kh ki mc kj b kk lh km kn ko li kq kr md lw ku kv me lx ky kz mf ly lc ld le hm dt translated">需要注意的是，Remix是一个带有直观图形用户界面的IDE，而其他的则没有。它加快了开发周期，并拥有丰富的插件。这是一个开始我们整个合同开发之旅的好地方，也是一个学习和教授以太坊的游乐场。</p></blockquote><p id="a7ec" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">我尝试了松露和安全帽(不是布朗尼，因为我不熟悉Python)，但在这篇文章中，我将与你分享安全帽的设置步骤。块菌的设置开发环境将在另一篇文章中讨论。</p><h2 id="0d8b" class="mg jk ht bd jl mh mi mj jp mk ml mm jt ks mn mo jx kw mp mq kb la mr ms kf mt dt translated"><strong class="ak">安全帽介绍</strong></h2><p id="e2c1" class="pw-post-body-paragraph kh ki ht kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le hm dt translated">Hardhat是一个编译、部署、测试和调试以太坊软件的开发环境。它帮助开发人员管理和自动化构建智能合约和dApps过程中固有的重复性任务，并围绕该工作流轻松引入更多功能。这意味着在核心处编译、运行和测试智能合约。</p><p id="90c0" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">智能合同在最大程度上可以被认为是“后端”,它将处理某种业务逻辑，当然我们需要一个前端应用程序来帮助我们与智能合同进行交互。对于前端，我将使用以下代码</p><ul class=""><li id="78ac" class="lf lg ht kj b kk lh ko li ks lj kw lk la ll le lm ln lo lp dt translated">VueJS</li><li id="cab8" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated">web3.js</li></ul><p id="5d3c" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated"><strong class="kj hu">节点安装</strong></p><p id="0a16" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">因为我们所有的工具都基于NodeJS，所以我们需要在本地安装NodeJS。我更喜欢使用<code class="eh mu mv mw mx b"><a class="ae lq" href="https://github.com/nvm-sh/nvm" rel="noopener ugc nofollow" target="_blank">nvm</a></code>,因为它帮助我非常容易地管理和切换节点版本。由于使用MacOS，安装nvm非常简单</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="cdae" class="mg jk ht mx b fv nc nd l ne nf">$brew update<br/>$brew upgrade<br/>$brew install nvm</span></pre><p id="630c" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">我们的一些工具在最新版本的Node上不能很好地工作，所以我建议您应该从使用Node v14.18.2 (lts/fermium)开始:</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="e82b" class="mg jk ht mx b fv nc nd l ne nf">$nvm install lts/fermium<br/>$nvm alias default lts/fermium<br/>$nvm use default </span></pre><blockquote class="lz ma mb"><p id="11df" class="kh ki mc kj b kk lh km kn ko li kq kr md lw ku kv me lx ky kz mf ly lc ld le hm dt translated">使用前记得检查节点版本:<code class="eh mu mv mw mx b">node --version</code></p></blockquote><p id="5c8f" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated"><strong class="kj hu"> vue-cli安装</strong></p><p id="a13a" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">安装vue-cli是可选的，但我也建议，因为我们在许多其他项目中使用vue，vue-cli将提供一个问候帮助</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="a384" class="mg jk ht mx b fv nc nd l ne nf">npm install -g @vue/cli<br/># OR<br/>yarn global add @vue/cli</span></pre><p id="3208" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated"><strong class="kj hu">初始化我们的项目:</strong></p><p id="e28c" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">让我们从创建第一个项目开始:</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="7c95" class="mg jk ht mx b fv nc nd l ne nf">$vue create hello-blockchain <br/>$cd hello-blockchain <br/>$mkdir blockchain <br/>$cd blockchain <br/>$npm init</span></pre><p id="bea4" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">我们首先使用vue-cli创建一个Vue项目。Vue CLI将询问我们几个问题，以便它可以为我们配置前端项目。然后我们创建一个名为<code class="eh mu mv mw mx b">blockchain</code>的子文件夹，并使用<code class="eh mu mv mw mx b">npm</code>初始化它。<code class="eh mu mv mw mx b">blockchain</code>文件夹将是存放我们所有智能合同开发的地方。由于我们要将hardhat作为构建智能合同的开发环境，我们需要安装hardhat:</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="5fdc" class="mg jk ht mx b fv nc nd l ne nf">$npm install --save-dev hardhat<br/>OR<br/>$yarn add --dev hardhat</span></pre><p id="c94c" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">在安装Hardhat run的同一目录中:</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="66b8" class="mg jk ht mx b fv nc nd l ne nf">$npx hardhat<br/>888    888                      888 888               888<br/>888    888                      888 888               888<br/>888    888                      888 888               888<br/>8888888888  8888b.  888d888 .d88888 88888b.   8888b.  888888<br/>888    888     "88b 888P"  d88" 888 888 "88b     "88b 888<br/>888    888 .d888888 888    888  888 888  888 .d888888 888<br/>888    888 888  888 888    Y88b 888 888  888 888  888 Y88b.<br/>888    888 "Y888888 888     "Y88888 888  888 "Y888888  "Y888<br/><br/>Welcome to Hardhat v2.8.0<br/><br/>? What do you want to do? …<br/>  Create a sample project<br/>  Create an advanced sample project<br/>❯ Create an advanced sample project that use TypeScript<br/>  Quit</span></pre><p id="ff96" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">我建议从一个<code class="eh mu mv mw mx b">advanced sample project that use TypeScript</code>开始。Hardhat也会问我们一些简单的问题来帮助我们初始化我们的第一个项目。当初始化过程完成后，我们可以快速了解什么是可用的以及正在发生什么，在我们的项目文件夹<code class="eh mu mv mw mx b">blockchain</code>中运行<code class="eh mu mv mw mx b">npx hardhat</code>:</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="3b68" class="mg jk ht mx b fv nc nd l ne nf">❯ npx hardhat<br/>Hardhat version 2.8.0</span><span id="1da6" class="mg jk ht mx b fv ng nd l ne nf">Usage: hardhat [GLOBAL OPTIONS] &lt;TASK&gt; [TASK OPTIONS]</span><span id="57d6" class="mg jk ht mx b fv ng nd l ne nf">GLOBAL OPTIONS:</span><span id="7932" class="mg jk ht mx b fv ng nd l ne nf">--config            A Hardhat config file.<br/>  --emoji             Use emoji in messages.<br/>  --help              Shows this message, or a task's help if its name is provided<br/>  --max-memory        The maximum amount of memory that Hardhat can use.<br/>  --network           The network to connect to.<br/>  --show-stack-traces Show stack traces.<br/>  --tsconfig          A TypeScript config file.<br/>  --verbose           Enables Hardhat verbose logging<br/>  --version           Shows hardhat's version.</span><span id="a81e" class="mg jk ht mx b fv ng nd l ne nf">AVAILABLE TASKS:</span><span id="916c" class="mg jk ht mx b fv ng nd l ne nf">accounts           Prints the list of accounts<br/>  check              Check whatever you need<br/>  clean              Clears the cache and deletes all artifacts<br/>  compile            Compiles the entire project, building all artifacts<br/>  console            Opens a hardhat console<br/>  coverage           Generates a code coverage report for tests<br/>  flatten            Flattens and prints contracts and their dependencies<br/>  gas-reporter:merge<br/>  help               Prints this message<br/>  node               Starts a JSON-RPC server on top of Hardhat Network<br/>  run                Runs a user-defined script after compiling the project<br/>  test               Runs mocha tests<br/>  typechain          Generate Typechain typings for compiled contracts<br/>  verify             Verifies contract on Etherscan</span><span id="e234" class="mg jk ht mx b fv ng nd l ne nf">To get help for a specific task run: npx hardhat help [task]</span></pre><p id="19c5" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated"><strong class="kj hu">当地区块链网络</strong></p><p id="1e50" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">当我们完成智能合约的开发后，我们将在真实网络中部署它们，但从现在到这一步还有很长的路要走。我们首先需要开发我们的智能合同，并在以下方面非常仔细地测试其功能:</p><ul class=""><li id="2463" class="lf lg ht kj b kk lh ko li ks lj kw lk la ll le lm ln lo lp dt translated">本地区块链网络</li><li id="7dd2" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated">测试目的网络(又名TestNet，如Ropsten、Rinkeby或Kovan)</li></ul><p id="9d80" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">这两种网络的不同之处在于，前者存在于我们的个人电脑中，而后者实际上是分散的，这形成了一个<code class="eh mu mv mw mx b">staging environment.</code>多么幸运的是，hardhat内置了Hardhat Network，这是一个为开发而设计的本地以太网节点。选择Hardhat时，默认使用Hardhat网络，它也可以独立运行，以便外部客户端可以连接到它。这可能是元掩码、您的Dapp前端或脚本。要以这种方式运行Hardhat Network，请运行:</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="b57f" class="mg jk ht mx b fv nc nd l ne nf">$npx hardhat node</span></pre><p id="5fa2" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">因为某些原因，我把心交给了<a class="ae lq" href="https://trufflesuite.com/ganache/" rel="noopener ugc nofollow" target="_blank"> Ganache </a>。<a class="ae lq" href="https://trufflesuite.com/ganache" rel="noopener ugc nofollow" target="_blank"> Ganache </a>是一款用于快速以太坊和Corda分布式应用开发的个人区块链。您可以在整个开发周期中使用Ganache使您能够在安全确定的环境中开发、部署和测试dApps。</p><p id="26b3" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">Ganache有两种风格:UI和CLI。Ganache UI是一个桌面应用程序，支持以太坊和Corda技术。作为一名鲜肉区块链开发者，我更喜欢使用Ganache UI，可以从其官网:<a class="ae lq" href="https://trufflesuite.com/ganache/" rel="noopener ugc nofollow" target="_blank">https://trufflesuite.com/ganache/</a>下载并轻松运行</p><figure class="iy iz ja jb fq jc fe ff paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="fe ff nh"><img src="../Images/ece16b3534ed70dfa5556c27afe3e61a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kJMhZfnDJf068M6Lvt6Iew.png"/></div></div><figcaption class="ni nj fg fe ff nk nl bd b be z ek">Truffle Ganache</figcaption></figure><p id="dc6f" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">默认情况下，如果您正在使用Hardhat，那么您已经在使用Hardhat Network。当Hardhat执行您的测试、脚本或任务时，会自动启动一个进程内Hardhat网络节点，并且Hardhat的所有插件(ethers.js、web3.js、Waffle、Truffle等)将直接连接到该节点的提供者。如果我们想让hardhat与ganache一起工作(或者将来可能是一个测试网或真实网)，我们需要对<code class="eh mu mv mw mx b">hardhat.config.ts</code>做一些修改:</p><figure class="iy iz ja jb fq jc fe ff paragraph-image"><div class="fe ff nm"><img src="../Images/e71671582ab9e19d7b825436031b1139.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*Z3EFJIAuuZ8t8a1GfCuuEw.png"/></div></figure><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="b824" class="mg jk ht mx b fv nc nd l ne nf">defaultNetwork: process.env.DEFAULT_NETWORK!==undefined?process.env.DEFAULT_NETWORK:'ropsten',</span><span id="6034" class="mg jk ht mx b fv ng nd l ne nf">networks: { </span><span id="6cba" class="mg jk ht mx b fv ng nd l ne nf">    ganache: { <br/>        url: process.env.GANACHE_URL || "", <br/>        accounts: process.env.GANACHE_PRIVATE_KEY !== undefined ?                 <br/>          [process.env.GANACHE_PRIVATE_KEY] : [], <br/>    }, <br/>},</span></pre><p id="ab74" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">请注意，我们需要添加3个环境变量到我们的<code class="eh mu mv mw mx b">.env</code>来使它工作(强烈建议您保留您的私钥。env，而不是出于安全原因将其包含在it配置文件中) :</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="066a" class="mg jk ht mx b fv nc nd l ne nf">GANACHE_URL=HTTP://127.0.0.1:7545</span><span id="9b6c" class="mg jk ht mx b fv ng nd l ne nf">GANACHE_PRIVATE_KEY=0x4c2eb32e17d13f17b288b75efdacc105c3ae3f623210306f6551068052b0dcd7</span><span id="4bac" class="mg jk ht mx b fv ng nd l ne nf">DEFAULT_NETWORK=ganache</span></pre><p id="85cb" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">问题是我们怎样才能找到这些信息？答案是我们可以在Ganache UI上找到它们</p><ul class=""><li id="6338" class="lf lg ht kj b kk lh ko li ks lj kw lk la ll le lm ln lo lp dt translated">url : RCP服务器url</li><li id="1d94" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated">默认网络:在我们没有指定<code class="eh mu mv mw mx b">--network</code>命令参数的情况下用作默认网络的名称(在这种情况下，我们使用<code class="eh mu mv mw mx b">ganache</code>作为名称)</li><li id="f049" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated">私钥:帐户的私钥，我们将使用它在ganache上部署合同。在Ganache UI中，点击你想要使用的账号的钥匙图标，你会发现如下图。抓取私钥并将其插入配置就像吃蛋糕一样简单。</li></ul><figure class="iy iz ja jb fq jc fe ff paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="fe ff nn"><img src="../Images/779afe526a3f7ce0553ec6089ede89d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pz4rb-C01tGle3iYPLOktA.png"/></div></div></figure><p id="66c2" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated"><strong class="kj hu">编制合同</strong></p><p id="407b" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">样本项目带有样本合同<code class="eh mu mv mw mx b">Greeting.sol</code>。我们将写一个新的后，但现在只是使用问候样本合同进行测试。可以使用以下命令来编译该契约</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="a047" class="mg jk ht mx b fv nc nd l ne nf">$npx hardhat compile </span></pre><p id="c8d0" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated"><strong class="kj hu">部署合同</strong></p><p id="ee19" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">如果编译进展顺利，那么我们准备将我们的契约部署到Ganache上。</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="93dd" class="mg jk ht mx b fv nc nd l ne nf">$npx hardhat run scripts/deploy.ts</span></pre><p id="bbe5" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">请注意，由于我们指定我们的默认网络将是ganache，这是我们的Ganache UI的配置点，所以这里没有必要使用<code class="eh mu mv mw mx b">--network ganache</code>。如果你不想使用<code class="eh mu mv mw mx b">ganache</code>作为默认网络，那么有必要告诉hardhat在哪里部署你的合同</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="bf9f" class="mg jk ht mx b fv nc nd l ne nf">$npx hardhat run scripts/deploy.ts --network ropsten</span></pre><figure class="iy iz ja jb fq jc fe ff paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="fe ff no"><img src="../Images/9f7081bf71d29425f39939a83778f276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lMLNxyspXgX4RTrA1VkItA.png"/></div></div></figure><p id="c1e2" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">如果一切顺利，我们可以通过检查Ganache的事务历史来验证我们的契约已经成功部署</p><ul class=""><li id="376a" class="lf lg ht kj b kk lh ko li ks lj kw lk la ll le lm ln lo lp dt translated">标签:合同创建</li><li id="827a" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated">合同地址:创建合同地址</li><li id="ebc0" class="lf lg ht kj b kk lr ko ls ks lt kw lu la lv le lm ln lo lp dt translated">发件人地址:我们选择进行部署的帐户</li></ul><p id="01af" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated"><strong class="kj hu">与您的合同互动</strong></p><p id="771a" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">所以你的合同部署很顺利。但是我们如何与我们的合同互动呢？当然，我们可以等待我们的VueJS+Web3JS被开发出来，但这需要相当长的时间。多么幸运，安全帽给我们提供了一个有用的工具叫安全帽控制台:</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="dd3a" class="mg jk ht mx b fv nc nd l ne nf">$npx hardhat console --network ganache</span></pre><figure class="iy iz ja jb fq jc fe ff paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="fe ff np"><img src="../Images/da9a07c44a334adf0db8e7d2b070afad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sSZQTTMTuMXIhwiDfSJLZw.png"/></div></div><figcaption class="ni nj fg fe ff nk nl bd b be z ek">Hardhat console</figcaption></figure><p id="f2ac" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">我们可以使用这个工具与区块链网络互动。但是首先，要使用合同，我们需要下面的一个插件:</p><ul class=""><li id="4f41" class="lf lg ht kj b kk lh ko li ks lj kw lk la ll le lm ln lo lp dt translated">安全帽web3插件:<a class="ae lq" href="https://hardhat.org/plugins/nomiclabs-hardhat-web3.html" rel="noopener ugc nofollow" target="_blank">https://hardhat.org/plugins/nomiclabs-hardhat-web3.html</a></li></ul><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="134a" class="mg jk ht mx b fv nc nd l ne nf">$npm install --save-dev @nomiclabs/hardhat-web3 web3</span><span id="6418" class="mg jk ht mx b fv ng nd l ne nf">hardhat.config.ts </span><span id="7c94" class="mg jk ht mx b fv ng nd l ne nf">ADD : import "@nomiclabs/hardhat-web3";</span></pre><ul class=""><li id="4624" class="lf lg ht kj b kk lh ko li ks lj kw lk la ll le lm ln lo lp dt translated">安全帽醚插件:<a class="ae lq" href="https://hardhat.org/plugins/nomiclabs-hardhat-ethers.html" rel="noopener ugc nofollow" target="_blank">https://hardhat.org/plugins/nomiclabs-hardhat-ethers.html</a></li></ul><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="37e6" class="mg jk ht mx b fv nc nd l ne nf">$npm install @nomiclabs/hardhat-ethers</span><span id="f29a" class="mg jk ht mx b fv ng nd l ne nf">hardhat.config.ts</span><span id="a654" class="mg jk ht mx b fv ng nd l ne nf">ADD : import "@nomiclabs/hardhat-ethers";</span></pre><p id="2254" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">现在再次运行控制台并检查可用帐户</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="d781" class="mg jk ht mx b fv nc nd l ne nf">$npx hardhat console --network ganache<br/>&gt; let accounts = await web3.eth.getAccounts();<br/>undefined<br/>&gt; accounts<br/>[ '0x06cb429Ff34D8364fcD89D8f661084662D7Db890' ]<br/>&gt;</span></pre><p id="6073" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">要与我们的合同互动:</p><pre class="iy iz ja jb fq my mx mz na aw nb dt"><span id="02d5" class="mg jk ht mx b fv nc nd l ne nf">$npx hardhat console <br/>&gt; let contract = await ethers.getContractFactory('Greeter'); <br/>&gt; const instance = await contract.attach('&lt;contract_address&gt;'); <br/>&gt; let result = instance.greet(); <br/>&gt; result<br/>&gt; "Hello Hardhat"</span><span id="65fb" class="mg jk ht mx b fv ng nd l ne nf">&gt; await instance.setGreeting("Hi Dude"); <br/>&gt; let new_result = instance.greet(); <br/>&gt; "Hi Dude"</span></pre><p id="585d" class="pw-post-body-paragraph kh ki ht kj b kk lh km kn ko li kq kr ks lw ku kv kw lx ky kz la ly lc ld le hm dt translated">请注意，您需要使用我们在上面的Ganache交易历史中找到的地址来更改<contract_address>以创建合同地址。</contract_address></p><h1 id="c312" class="jj jk ht bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg dt translated">结束</h1><p id="296e" class="pw-post-body-paragraph kh ki ht kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le hm dt translated">因此，我们完成了创建和初始化hardhat项目的第一步。我们在Ganache上部署了示例问候契约，并通过hardhat提供的插件与之交互。在下一篇文章中，我将分享如何使用VueJS和Web3JS构建一个前端应用程序。再见！</p></div></div>    
</body>
</html>