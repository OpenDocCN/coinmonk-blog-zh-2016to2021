<html>
<head>
<title>Hyperledger Fabric — Seashell Supplychain System II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Hyperledger Fabric —贝壳供应链系统II</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/hyperledger-fabric-seashell-supplychain-system-ii-3622ccefd11d?source=collection_archive---------1-----------------------#2020-07-03">https://medium.com/coinmonks/hyperledger-fabric-seashell-supplychain-system-ii-3622ccefd11d?source=collection_archive---------1-----------------------#2020-07-03</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/4298edd81d0330a36da95ce5058e35de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YE-X53Ns6UYh3c3CrLRF2w.jpeg"/></div></div></figure><p id="f3c8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，我们已经了解了区块链的基本原理和Hyperledger的高级结构，让我们利用这些知识来处理一个真实的场景。</p><p id="6d7b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">问题背景:</strong></p><p id="7bcd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们的目标是消除非法的、未报告的和不受管制的贝壳开采。我们将使用Hyperledger Fabric为一个真实世界的例子带来透明度和清晰度:<strong class="jd hu">海贝开采的供应链。</strong></p><p id="30ad" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将描述如何改进海贝开采，从源头开始，工人山姆，以及他的海贝最终到达米拉商店的过程。在此期间，我们将让其他各方参与进来，比如负责核实数据有效性和贝壳捕捞可持续性的监管机构。</p><p id="1ed1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将使用Hyperledger Fabric的框架来跟踪这一过程的每个部分。</p><p id="af95" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">要记住两件事:</p><ol class=""><li id="284c" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">网络中有许多参与者，您将看到这些参与者如何互动，以及交易是如何进行的。</li><li id="9ac6" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">私人渠道允许Sam和Mira私下商定他们互动的条款，同时仍然保持透明度，因此其他行为者可以确证和确认他们的交易。</li></ol><p id="07d7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">通过私人渠道，监管者和店主可以确认某一批贝壳的来源是否是可持续和合法的，而不需要查看整个旅程的细节。</p></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><h1 id="6436" class="ku kv ht bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr dt translated">利益相关者</h1><ul class=""><li id="5ae5" class="jz ka ht jd b je ls ji lt jm lu jq lv ju lw jy lx kf kg kh dt translated"><strong class="jd hu">山姆</strong>是一名可持续且合法获取贝壳的工人。</li><li id="c4b9" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated">监管者核实这些贝壳是合法且可持续捕捞的。</li><li id="cc43" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated"><strong class="jd hu"> Mira </strong>是一名店主，在这种情况下，他将充当最终用户。</li><li id="da95" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated"><strong class="jd hu">卡尔</strong>是另一家商店的店主，工人山姆可以卖贝壳给。</li></ul><h1 id="e78f" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">问题架构概述:</h1><p id="8d8f" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">下面是本节介绍的贝壳获取场景的摘要:</p><ol class=""><li id="0698" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">Sam取出一个贝壳，并使用供应链应用程序的用户界面将有关取出的所有细节记录到分类账中。在到达分类帐之前，交易被传递到网络上的背书对等点，然后在那里被背书。被认可的交易被发送到订购服务，被订购到一个块中。然后，该数据块被发送到网络中的提交对等方，在那里经过验证后被提交。</li><li id="0c82" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">当贝壳沿着供应链传递时，监管者可以使用他们自己的应用程序<strong class="jd hu">查询分类账</strong>以获得关于具体捕获量的详细信息(不包括价格，因为他们无法访问与价格相关的链码)</li><li id="c80c" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">山姆可以与店主卡尔达成协议，并同意每磅80美元的价格。他们使用蓝色通道的链码合同规定80美元/磅。<strong class="jd hu">蓝色通道的分类账</strong>用包含该交易的块更新。</li><li id="cea0" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">在另一份商业协议中，Sam和Mira商定了每磅50美元的特价。他们使用红色通道的链码合同，规定50美元/磅。<strong class="jd hu">红色通道的分类账</strong>用包含该交易的块更新。</li></ol><p id="3b9a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">实施修复贝壳供应链<a class="ae mg" rel="noopener" href="/swlh/hyperledger-chapter-5-tuna-fishing-supplychain-context-f593b03e2cf0">解决方案的第一步是建立技术环境，这是第一步。安装Hyperledger Fabric并确保网络正常运行。</a></p><h1 id="3c52" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">安装Hyperledger结构</h1><p id="73ec" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">确定您的计算机上要放置Hyperledger Fabric示例应用程序存储库的位置，并在终端窗口中打开它。然后，执行以下命令:</p><blockquote class="mh mi mj"><p id="fbc2" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">git克隆<strong class="jd hu"> - </strong> b主<a class="ae mg" href="https://github.com/sakshm-aurora/fabric-samples.git" rel="noopener ugc nofollow" target="_blank">https://github.com/sakshm-aurora/fabric-samples.git</a></p><p id="5d2e" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">cd面料<strong class="jd hu"> - </strong>样品</p><p id="a25c" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">git checkout {TAG}</p></blockquote><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mo"><img src="../Images/e4b31514abb6d6c41ea6ff798f039aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZfxSDiFEOTuHbrEuJBM_Gg.png"/></div></div></figure><p id="730a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">注意-为确保示例与您下载的以下Fabric二进制文件版本兼容，请检查与您的Fabric版本匹配的示例<code class="eh mt mu mv mw b">{TAG}</code>,例如v1.1.0。要查看所有fabric-samples标签的列表，请使用命令“git tag”。</p><h1 id="2f4a" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">下载特定于平台的二进制文件</h1><p id="25cb" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">接下来，我们将安装特定于Hyperledger Fabric平台的二进制文件。这一过程旨在补充上述Hyperledger织物样本，但可以独立使用。如果您没有安装上面的示例，那么只需创建并输入一个目录，将特定于平台的二进制文件的内容提取到该目录中。</p><p id="3870" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">请在要将特定于平台的二进制文件解压缩到的目录中执行以下命令:</p><blockquote class="mh mi mj"><p id="2208" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">https://goo.gl/6wtTN5 | bash-1 . 1 . 0</p></blockquote><p id="bb23" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">上面的命令下载并执行一个bash脚本，该脚本将下载并提取设置网络所需的所有特定于平台的二进制文件，并将它们放入上面创建的克隆repo中。它检索四个特定于平台的二进制文件:</p><ul class=""><li id="925f" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy lx kf kg kh dt translated"><code class="eh mt mu mv mw b">cryptogen</code>，</li><li id="435b" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated"><code class="eh mt mu mv mw b">configtxgen</code>，</li><li id="f23b" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated"><code class="eh mt mu mv mw b">configtxlator</code>，</li><li id="d9f7" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated"><code class="eh mt mu mv mw b">peer</code></li><li id="c204" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated"><code class="eh mt mu mv mw b">orderer</code>和</li><li id="2ce1" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated"><code class="eh mt mu mv mw b">fabric-ca-client</code></li></ul><p id="dffa" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">并将它们放在当前工作目录的<code class="eh mt mu mv mw b">bin</code>子目录中。</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mx"><img src="../Images/e118fd8d98e28a336e77ade5a1f000c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I7M0A1SSkVzB1B1V_ladVA.png"/></div></div></figure><p id="50a0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">您可能希望将它添加到PATH环境变量中，这样就可以在不完全限定每个二进制文件的路径的情况下选择这些变量。例如:</p><blockquote class="mh mi mj"><p id="e8de" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">导出路径= <path to="" download="" location=""> /bin:$PATH</path></p></blockquote><p id="f10c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">测试:</p><blockquote class="mh mi mj"><p id="2749" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">docker图像</p></blockquote><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff my"><img src="../Images/10b0d6b9484502c2b7f09a6789fd9597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FsJdgIC8S5DyAhsxDxJATg.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Expected Output</figcaption></figure><h1 id="96af" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">启动测试Hyperledger结构网络</h1><p id="55e8" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">现在我们已经成功安装了Hyperledger Fabric，我们可以逐步建立一个有两个成员的简单网络。回到我们演示的场景，该网络包括在工人Sam和餐馆老板Mira之间验证、转移和购买的每个贝壳的资产管理。我们将创建一个简单的双成员网络，由两个组织(实际上是Sam和Mira)组成，每个组织维护两个对等点和一个订购服务。</p><p id="5bdd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将使用Docker映像来引导我们的第一个Hyperledger结构网络。它还将启动一个容器来运行脚本化执行，该脚本化执行将对等体加入到通道中，部署和实例化链代码，并针对链代码执行事务。</p><blockquote class="mh mi mj"><p id="38de" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">cd优先-网络</p><p id="a3e9" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">。/byfn.sh -m生成</p></blockquote><p id="8cb6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">将会出现一个简短的描述，以及一个<strong class="jd hu"> Y/N </strong>命令行提示。回复一个<strong class="jd hu"> Y &lt;回车&gt;T3继续。</strong></p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nd"><img src="../Images/cd9b61d5d85c82e42eb4d09aada86f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0AOr_Hll7i2Cj7Myq4V9A.png"/></div></div></figure><p id="021f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">该步骤为我们的各种网络实体生成所有证书和密钥，包括用于引导订购服务的genesis块和创建通道所需的配置事务集合。</p><p id="c799" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">接下来，您可以使用以下命令启动网络:</p><blockquote class="mh mi mj"><p id="6ce6" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">。/byfn.sh -m up</p></blockquote><p id="0982" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">另一个命令行会出现，回复用<strong class="jd hu"> Y &lt;回车&gt;T5】继续。最后，让我们测试一下如何关闭这个网络。在同一终端内，do <strong class="jd hu"> Control+C </strong>退出当前执行。然后，运行以下命令:</strong></p><blockquote class="mh mi mj"><p id="310e" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">。/byfn.sh -m向下</p></blockquote><p id="50f8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">另一个命令行会出现，回复<strong class="jd hu"> Y &lt;回车&gt;T9】继续。这个命令将杀死你的容器，删除加密材料和四个工件，并从你的Docker注册表中删除链码图像。</strong></p><p id="ce47" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">上面的过程在下面的GIF中有说明:</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ne"><img src="../Images/4008b8fd670dc71db98ef27e99b4490e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BLikUoenGb13v4ZImghWZA.gif"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">byfn.sh</figcaption></figure><h1 id="b319" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">链码</h1><p id="dfab" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">在Hyperledger Fabric中，<strong class="jd hu"> chaincode </strong>是在对等体上运行并创建交易的“智能合约”。更广泛地说，它使用户能够在Hyperledger Fabric网络的共享分类帐中创建交易，并更新资产的世界状态。</p><p id="8389" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">使用Hyperledger Fabric开发智能合同有两种方法:</p><ul class=""><li id="bbb4" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy lx kf kg kh dt translated">将单个契约编码到链代码的独立实例中</li><li id="264a" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated">使用chaincode创建管理一种或多种业务合同的生命周期的分散应用程序，并让最终用户在这些应用程序中实例化合同实例。[效率更高]</li></ul><p id="da37" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">链码程序概述</strong></p><p id="f605" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">创建链码时，需要实现两种方法:</p><ul class=""><li id="6e26" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy lx kf kg kh dt translated">当chaincode接收到一个<strong class="jd hu"> <em class="mk">实例化</em> </strong>或<strong class="jd hu"> <em class="mk">升级</em> </strong>事务时，调用<strong class="jd hu"> Init </strong> <br/>。这是初始化任何应用程序状态的地方。</li><li id="3224" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy lx kf kg kh dt translated"><strong class="jd hu"> Invoke </strong> <br/>当<strong class="jd hu"> <em class="mk"> invoke </em> </strong>交易收到时调用，处理任何交易建议。</li></ul><p id="7571" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">作为开发人员，必须在链代码中创建一个<strong class="jd hu"> Init </strong>和一个<strong class="jd hu"> Invoke </strong>方法。必须使用<strong class="jd hu">对等链码安装</strong>命令安装链码，并在调用链码之前使用<strong class="jd hu">对等链码实例化</strong>命令实例化链码。然后，可以使用<strong class="jd hu">对等链代码调用</strong>或<strong class="jd hu">对等链代码查询</strong>命令创建事务。</p><h1 id="ba44" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">如何查看链码日志？</h1><p id="a398" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">您可以检查单个的chaincode容器，查看针对每个容器执行的独立事务。使用以下命令查找正在运行的容器列表，以找到您的链码容器:</p><blockquote class="mh mi mj"><p id="4620" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">$ docker ps -a</p></blockquote><h1 id="1714" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">了解Docker组合拓扑</h1><p id="1b1c" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated"><strong class="jd hu"> BYFN </strong>示例为我们提供了两种风格的Docker Compose文件，它们都是从<strong class="jd hu"><em class="mk">Docker-Compose-base . YAML</em></strong>(位于base文件夹中)扩展而来的。我们的第一个风格，<strong class="jd hu"><em class="mk">docker-compose-cli . YAML</em></strong>，为我们提供了一个CLI容器，以及一个订购者，四个对等者。我们使用这个文件来完成本页的全部说明。</p><p id="bbf2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第二种风格是<strong class="jd hu"><em class="mk">【docker-compose-e2e . YAML</em></strong>，它被构造成使用Node.js SDK运行端到端测试。除了与SDK一起工作之外，它的主要区别是有用于fabric-ca服务器的容器。因此，我们能够将<strong class="jd hu"> REST调用</strong>发送到组织CAs进行用户注册和登记。</p><h1 id="5ff2" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">为什么选择CouchDB</h1><p id="c0a3" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">CouchDB是一种NoSQL解决方案。这是一个面向文档的数据库，文档字段存储为键值映射。字段可以是简单的键值对、列表或映射。除了LevelDB支持的键/组合键/键范围查询之外，CouchDB还支持完整的富数据查询功能，例如针对整个<a class="ae mg" href="https://blog.coincodecap.com/what-is-blockchain-a-simple-guide-for-dummies/" rel="noopener ugc nofollow" target="_blank">区块链</a>数据的非键查询，因为其数据内容以JSON格式存储，并且完全可查询。因此，CouchDB可以满足LevelDB不支持的许多用例的链代码、审计和报告需求。</p></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><p id="6950" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将在金枪鱼渔业供应链系统的基础上构建我们的贝壳供应链系统，下面是相同的代码。</p><p id="7be2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae mg" href="https://github.com/hyperledger/education/blob/master/LFS171x/fabric-material/chaincode/tuna-app/tuna-chaincode.go" rel="noopener ugc nofollow" target="_blank"><em class="mk">https://github . com/hyperledger/education/blob/master/lfs 171 x/fabric-material/chain code/tuna-app/tuna-chain code . go</em>T3】</a></p><h1 id="b5f4" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">Fabric Node.js SDK</h1><p id="d70c" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">现在，我们将使用node . js SDK(【https://fabric-sdk-node.github.io/】)来与网络交互，因此也与总账交互。Hyperledger Fabric客户端SDK使得使用API与Hyperledger Fabric区块链进行交互变得非常容易。本节将帮助您编写第一个应用程序，从测试Hyperledger Fabric网络开始，然后学习示例智能合同的参数，最后开发查询和更新分类帐记录的应用程序。</p><p id="5fed" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">有关其他信息，请访问Hyperledger Fabric Node SDK文档:<a class="ae mg" href="https://fabric-sdk-node.github.io/tutorial-app-dev-env-setup.html" rel="noopener ugc nofollow" target="_blank">https://Fabric-SDK-Node . github . io/tutorial-app-dev-env-setup . html</a>。</p><h1 id="6032" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated"><strong class="ak">区块链应用</strong></h1><p id="e415" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">在尝试运行这个区块链应用程序之前，请确保您已经解决了技术依赖问题。</p><div class="nf ng fm fo nh ni"><a rel="noopener follow" target="_blank" href="/@saksham.aurora/this-will-be-a-two-part-series-on-hyperledger-the-framework-to-create-deploy-and-maintain-936ac2236c2f"><div class="nj ab ej"><div class="nk ab nl cl cj nm"><h2 class="bd hu fv z el nn eo ep no er et hs dt translated">这将是一个关于hyperledger的两部分系列，hyperledger是创建、部署和维护…</h2><div class="np l"><h3 class="bd b fv z el nn eo ep no er et ek translated">超级分类帐</h3></div><div class="nq l"><p class="bd b gc z el nn eo ep no er et ek translated">medium.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw iz ni"/></div></div></a></div><p id="9a59" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">第一步:克隆回购</strong></p><blockquote class="mh mi mj"><p id="4c87" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">git克隆<a class="ae mg" href="https://github.com/sakshm-aurora/education.git" rel="noopener ugc nofollow" target="_blank">https://github.com/sakshm-aurora/education.git</a></p><p id="6e6a" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">cd教育/lfs 171 x/织物材料/金枪鱼应用程序</p></blockquote><p id="9fa8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在运行下一个命令之前，确保您的机器上运行了Docker。此外，请确保您已完成安装Hyperledger Fabric。</p><p id="4997" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">首先，删除任何预先存在的容器，因为它可能与本教程中的命令冲突:</p><blockquote class="mh mi mj"><p id="f304" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">文档rm -f $(文档ps -aq)</p></blockquote><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nx"><img src="../Images/efdccdd530a34d95609cd213d829fa4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EH731k7axBYrDRtQ2I8JTg.png"/></div></div></figure><h1 id="bcc0" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">步骤2:启动结构网络</h1><p id="73f2" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">接下来，让我们使用以下命令启动Hyperledger结构网络:</p><blockquote class="mh mi mj"><p id="7444" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">。/startFabric.sh</p></blockquote><p id="eb2f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们来分析一下当您在终端中运行这个命令时会发生什么。</p><ol class=""><li id="8c1e" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">从Docker中删除了现有的网络工件，只创建了一个具有对等体的组织&amp; couch DB和一个订购者。</li></ol><p id="c6e7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">正如您在代码中看到的，startfabric。Sh内部调用basic-network文件夹中的start.sh。</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ny"><img src="../Images/bb7180e6215f609338e47f5ba1885add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VC2RNOSpLoWnhUCL.png"/></div></div></figure><p id="04a5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，如果您遍历start.sh，您可以看到docker容器是如何被清除和重新填充的。此外，还创建了一个通道并添加了一个对等体。</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nz"><img src="../Images/b8c93164163224c7abb4c44935397832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3Y95qMGvO6A0hDHN.png"/></div></div></figure><h1 id="76f0" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">第三步:注册管理员</h1><p id="02ba" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">酷毙了。现在网络已经开通。让我们注册管理员。</p><blockquote class="mh mi mj"><p id="9305" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated">节点注册Admin.js</p></blockquote><p id="9d65" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">您应该得到这个输出，基本上是用所需的键创建了一个管理员。您可以打开registerAdmin.js来查看代码。基本上，对于结构CA客户端，我们检查管理员是否已经注册，如果没有，则向CA客户端注册。设置基本参数，如enrollmentID、Secret。然后，使用成员ID为的FabricClient以及公钥/私钥对创建用户。</p><h1 id="e1b6" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">第四步:注册用户</h1><p id="597d" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">既然已经设置了网络和管理员，让我们注册一个用户。</p><blockquote class="mh mi mj"><p id="77df" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated"><strong class="jd hu">节点注册用户. js </strong></p></blockquote><p id="e1b5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果你打开<strong class="jd hu"> registerUser.js </strong>，你可以看到我们用CA服务器注册用户，然后注册。</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff oa"><img src="../Images/78f67a14117ef4bd92b0f6290711637b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vtSTn_VIBcza0GMN.png"/></div></div></figure><h1 id="f719" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">步骤5:运行服务器</h1><p id="2c20" class="pw-post-body-paragraph jb jc ht jd b je ls jg jh ji lt jk jl jm md jo jp jq me js jt ju mf jw jx jy hm dt translated">这一步是运行应用程序的最后一步。为此，我们需要设置nodejs服务器，调用所需的包，实例化应用程序并监听特定端口。</p><blockquote class="mh mi mj"><p id="d053" class="jb jc mk jd b je jf jg jh ji jj jk jl ml jn jo jp mm jr js jt mn jv jw jx jy hm dt translated"><strong class="jd hu"> <em class="ht">节点server.js </em> </strong></p></blockquote><p id="9a38" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">繁荣..我们的应用程序在端口8000上运行</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ob"><img src="../Images/2cd3608d29b85ca91715b8f57d7d5523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZ76ZcOhm-lAwYuTkmGmZg.png"/></div></div></figure><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff oc"><img src="../Images/fcee2eea112d8ee4b5026e3caab49ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rFsvt2ffaydeQjIk_Z8fIg.png"/></div></div></figure><p id="16c9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">用户界面在4个标题下有一个按钮。</p><p id="6bcf" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">查询所有贝壳渔获—触发器—<strong class="jd hu"><em class="mk">query alltuna . js</em></strong></p><p id="701c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">查询特定贝壳—触发器—<strong class="jd hu"><em class="mk">query tuna . js</em></strong></p><p id="f8cf" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">创建贝壳记录—触发器—<strong class="jd hu"><em class="mk">Record tuna . js</em></strong></p><p id="12e9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">更换贝壳固定器—触发器—<strong class="jd hu"><em class="mk">changetunaholder . js</em></strong></p><p id="18a4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">所有这些js文件都在链码<strong class="jd hu"><em class="mk">tuna-chain code . go</em></strong>中定义</p><p id="8063" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">注意— </strong>如前所述，贝壳应用程序是基于金枪鱼捕捞应用程序构建的，因此使用相同的脚本。</p><h1 id="f1b1" class="ku kv ht bd kw kx ly kz la lb lz ld le lf ma lh li lj mb ll lm ln mc lp lq lr dt translated">输出</h1><ol class=""><li id="32dc" class="jz ka ht jd b je ls ji lt jm lu jq lv ju lw jy ke kf kg kh dt translated"><strong class="jd hu">查询所有贝壳— </strong>我们在initLedger的chaincode中使用的所有数据都被提取并显示在这里。</li></ol><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff od"><img src="../Images/23da3b3e973c7a6787c71a64ad5c1637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2lsunuMzVr0eiX9Ef1YVhg.png"/></div></div></figure><p id="08d3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">2.<strong class="jd hu">查询贝壳— </strong>这里我们发送一个查询来查找渔获号为6的记录。</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff oe"><img src="../Images/5b7df3aa59d649a9a5c7230c08b48816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X-1l95vOc3b_8f9-N0FFkQ.png"/></div></div></figure><p id="09d4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">3.记录一个贝壳——我们正在创造一个新的记录。</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div class="fe ff of"><img src="../Images/300e78d75f4f3fb740596e451ca44235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*rkv0NDT6skBVIKcQPloW6w.png"/></div></figure><p id="3c15" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">4.<strong class="jd hu">更改贝壳的所有者</strong> —这里我们发送一个POST请求来查询渔获ID为12的记录，并将持有者的名称修改为“Saksham”。</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div class="fe ff of"><img src="../Images/0f95f98cb9a8a9df39406728b468920c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*E9SNVcp_MfUdU-3x6-PfIA.png"/></div></figure><p id="d89e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因此，我们来到了我们的两部分系列的结尾。</p><figure class="mp mq mr ms fq iu fe ff paragraph-image"><div class="fe ff og"><img src="../Images/5bbb010fc9e1c25207cb3a15125996d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/1*8DnKuYZrgiRSrHy1S1L6cQ.gif"/></div></figure><p id="9eb4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">阅读第1部分:</strong></p><p id="232d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae mg" rel="noopener" href="/@saksham.aurora/this-will-be-a-two-part-series-on-hyperledger-the-framework-to-create-deploy-and-maintain-936ac2236c2f">https://medium . com/@ saksham . aurora/this-will-be-a-two-part-series-on-hyperledger-the-framework-to-create-deploy-and-maintain-936 AC 2236 c2f</a></p><p id="85ee" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">参考文献:</strong></p><p id="1930" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">许多插图和内容取自以下博客，所有的荣誉都属于它们:</p><div class="nf ng fm fo nh ni"><a rel="noopener follow" target="_blank" href="/swlh/hyperledger-chapter-1-foundation-7ad5bd94d452"><div class="nj ab ej"><div class="nk ab nl cl cj nm"><h2 class="bd hu fv z el nn eo ep no er et hs dt translated">Hyperledger —第1章|区块链基金会</h2><div class="np l"><h3 class="bd b fv z el nn eo ep no er et ek translated">这是我学习Hyperledger的日志，Hyperledger是为企业创建、部署和维护区块链的框架…</h3></div><div class="nq l"><p class="bd b gc z el nn eo ep no er et ek translated">medium.com</p></div></div><div class="nr l"><div class="oh l nt nu nv nr nw iz ni"/></div></div></a></div><div class="nf ng fm fo nh ni"><a rel="noopener follow" target="_blank" href="/coinmonks/demystifying-hyperledger-fabric-1-3-fabric-architecture-a2fdb587f6cb"><div class="nj ab ej"><div class="nk ab nl cl cj nm"><h2 class="bd hu fv z el nn eo ep no er et hs dt translated">揭开Hyperledger结构的神秘面纱(1/3):结构架构</h2><div class="np l"><h3 class="bd b fv z el nn eo ep no er et ek translated">最初在www.serial-coder.com出版。</h3></div><div class="nq l"><p class="bd b gc z el nn eo ep no er et ek translated">medium.com</p></div></div><div class="nr l"><div class="oi l nt nu nv nr nw iz ni"/></div></div></a></div><div class="nf ng fm fo nh ni"><a href="https://hyperledger-fabric.readthedocs.io/en/release-2.0/" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab ej"><div class="nk ab nl cl cj nm"><h2 class="bd hu fv z el nn eo ep no er et hs dt translated">面向企业的区块链平台——hyperledger-fabric docs主文档</h2><div class="np l"><h3 class="bd b fv z el nn eo ep no er et ek translated">请确保您正在查看的文档与您正在使用的软件版本相匹配。请参见…</h3></div><div class="nq l"><p class="bd b gc z el nn eo ep no er et ek translated">hyperledger-fabric . readthedocs . io</p></div></div><div class="nr l"><div class="oj l nt nu nv nr nw iz ni"/></div></div></a></div><blockquote class="ok"><p id="66ef" class="ol om ht bd on oo op oq or os ot jy ek translated"><a class="ae mg" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="ov ow ox oy oz iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff ou"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>