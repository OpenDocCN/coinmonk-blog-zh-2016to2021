<html>
<head>
<title>Generate Ethereum Wallet &amp; Key Pairs using PHP — Ethereum Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PHP生成以太坊钱包和密钥对——以太坊教程</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/generate-ethereum-wallet-key-pairs-using-php-ethereum-tutorial-c1cc75f0d64f?source=collection_archive---------1-----------------------#2018-10-17">https://medium.com/coinmonks/generate-ethereum-wallet-key-pairs-using-php-ethereum-tutorial-c1cc75f0d64f?source=collection_archive---------1-----------------------#2018-10-17</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/b5055ecfc1cbef98bc2f5991e216ef42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*Yvf4kSkQPNngB2tt4zPsxw.png"/></div></figure><p id="5f04" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这篇文章提供了一个关于如何使用PHP 7.0++生成ECDSA私钥，然后导出到以太坊钱包地址的指南。</p><blockquote class="jv"><p id="0a9f" class="jw jx ht bd jy jz ka kb kc kd ke ju ek translated">另请阅读:<a class="ae kf" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">最佳硬件钱包</a></p></blockquote><blockquote class="kg kh ki"><p id="4c29" class="ix iy kj iz b ja kk jc jd je kl jg jh km kn jk jl ko kp jo jp kq kr js jt ju hm dt translated">您可以找到如下工作实现:</p></blockquote><figure class="ks kt ku kv fq iu"><div class="bz el l di"><div class="kw kx l"/></div></figure><h1 id="a5b8" class="ky kz ht bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv dt translated">先决条件</h1><p id="af45" class="pw-post-body-paragraph ix iy ht iz b ja lw jc jd je lx jg jh ji ly jk jl jm lz jo jp jq ma js jt ju hm dt translated">该代码需要PHP 7.0++与OpenSSL扩展和PHP Composer。您需要使用PHP Composer来安装第三方软件包</p><pre class="ks kt ku kv fq mb mc md me aw mf dt"><span id="1b46" class="mg kz ht mc b fv mh mi l mj mk">$ composer install</span></pre><h1 id="7d20" class="ky kz ht bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv dt translated">生成私钥</h1><p id="c25e" class="pw-post-body-paragraph ix iy ht iz b ja lw jc jd je lx jg jh ji ly jk jl jm lz jo jp jq ma js jt ju hm dt translated">以太坊标准是使用secp256k1曲线来生成私钥。在我的教程中，我使用OpenSSL函数生成PEM格式的椭圆曲线私钥，如下所示:</p><pre class="ks kt ku kv fq mb mc md me aw mf dt"><span id="7376" class="mg kz ht mc b fv mh mi l mj mk">$config = [<br/>    'private_key_type' =&gt; OPENSSL_KEYTYPE_EC,<br/>    'curve_name' =&gt; 'secp256k1'<br/>];</span><span id="4db5" class="mg kz ht mc b fv ml mi l mj mk">$res = openssl_pkey_new($config);<br/>if (!$res) {</span><span id="7b3b" class="mg kz ht mc b fv ml mi l mj mk">    echo 'ERROR: Fail to generate private key. -&gt; ' . openssl_error_string();</span><span id="2cc6" class="mg kz ht mc b fv ml mi l mj mk">    exit;<br/>}</span><span id="4c3e" class="mg kz ht mc b fv ml mi l mj mk">// Generate Private Key<br/>openssl_pkey_export($res, $priv_key);</span><span id="3cdf" class="mg kz ht mc b fv ml mi l mj mk">// PEM Format<br/>$priv_pem = <em class="kj">PEM</em>::fromString($priv_key);</span></pre><p id="6592" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">之后我需要将私钥转换成ASN1序列，下面是ANS1序列的结构。</p><pre class="ks kt ku kv fq mb mc md me aw mf dt"><span id="17d0" class="mg kz ht mc b fv mh mi l mj mk">ECPrivateKey ::= SEQUENCE {<br/>    version        INTEGER { ecPrivkeyVer1(1) } (ecPrivkeyVer1),<br/>    privateKey     OCTET STRING,<br/>    parameters [0] ECParameters {{ NamedCurve }} OPTIONAL,<br/>    publicKey  [1] BIT STRING OPTIONAL<br/>}</span></pre><p id="2d91" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">下面的代码是我如何从ANS1序列结构中检索十六进制字符串的公钥和私钥。</p><pre class="ks kt ku kv fq mb mc md me aw mf dt"><span id="16dc" class="mg kz ht mc b fv mh mi l mj mk">// Then convert it to ASN1 Structure<br/>$ec_priv_seq = $ec_priv_key-&gt;toASN1();</span><span id="b0d7" class="mg kz ht mc b fv ml mi l mj mk">// Private Key &amp; Public Key in HEX<br/>$priv_key_hex = bin2hex($ec_priv_seq-&gt;at(1)-&gt;asOctetString()-&gt;string());</span><span id="32be" class="mg kz ht mc b fv ml mi l mj mk">$priv_key_len = strlen($priv_key_hex) / 2;</span><span id="049e" class="mg kz ht mc b fv ml mi l mj mk">$pub_key_hex = bin2hex($ec_priv_seq-&gt;at(3)-&gt;asTagged()-&gt;asExplicit()-&gt;asBitString()-&gt;string());</span><span id="618f" class="mg kz ht mc b fv ml mi l mj mk">$pub_key_len = strlen($pub_key_hex) / 2;</span></pre><h1 id="c510" class="ky kz ht bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv dt translated">导出以太坊钱包地址</h1><p id="c960" class="pw-post-body-paragraph ix iy ht iz b ja lw jc jd je lx jg jh ji ly jk jl jm lz jo jp jq ma js jt ju hm dt translated">以太坊钱包地址来源于公钥。每个EC公钥总是以0x04开始。为了获得以太坊钱包地址的正确散列，我们需要删除前导0x04。</p><pre class="ks kt ku kv fq mb mc md me aw mf dt"><span id="e5f1" class="mg kz ht mc b fv mh mi l mj mk">$pub_key_hex_2 = substr($pub_key_hex, 2);<br/>$pub_key_len_2 = strlen($pub_key_hex_2) / 2;</span></pre><p id="160c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们继续使用EC公钥的Keccak256散列。以太坊钱包地址是20字节长，即40个字符长，所以我们只需要散列数据的最后20个字节。</p><pre class="ks kt ku kv fq mb mc md me aw mf dt"><span id="e0cf" class="mg kz ht mc b fv mh mi l mj mk">$hash = <em class="kj">Keccak</em>::hash(hex2bin($pub_key_hex_2), 256);<br/>$wallet_address = '0x' . substr($hash, -40);<br/>$wallet_private_key = '0x' . $priv_key_hex;</span></pre><p id="60f7" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在你有了<strong class="iz hu"> $wallter_address </strong>，它存储了你新生成的以太坊钱包地址，<strong class="iz hu"> $wallet_private_key </strong>是你以太坊钱包地址的私钥。</p><h1 id="b4e4" class="ky kz ht bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv dt translated">如何运行代码</h1><pre class="ks kt ku kv fq mb mc md me aw mf dt"><span id="ced0" class="mg kz ht mc b fv mh mi l mj mk">$ php GenerateEthereumWallet.php</span></pre><p id="36ed" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">它将输出以太坊钱包地址及其私钥，如下所示:</p><pre class="ks kt ku kv fq mb mc md me aw mf dt"><span id="1eab" class="mg kz ht mc b fv mh mi l mj mk">ETH Wallet Address: 0xb2...<br/>Private Key: 0x73...</span></pre><blockquote class="jv"><p id="46f7" class="jw jx ht bd jy jz mm mn mo mp mq ju ek translated"><a class="ae kf" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="ms mt mu mv mw iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff mr"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>