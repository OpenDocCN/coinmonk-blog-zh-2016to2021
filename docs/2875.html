<html>
<head>
<title>Access External Data from Bitcoin Smart Contracts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从比特币智能合约访问外部数据</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/access-external-data-from-bitcoin-smart-contracts-2ecdc7448c43?source=collection_archive---------1-----------------------#2020-03-27">https://medium.com/coinmonks/access-external-data-from-bitcoin-smart-contracts-2ecdc7448c43?source=collection_archive---------1-----------------------#2020-03-27</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="fd29" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">比特币上的预言</h2></div><h1 id="c0d5" class="ji jj ht bd jk jl jm jn jo jp jq jr js iz jt ja ju jc jv jd jw jf jx jg jy jz dt translated">神谕</h1><p id="4ab5" class="pw-post-body-paragraph ka kb ht kc b kd ke iu kf kg kh ix ki kj kk kl km kn ko kp kq kr ks kt ku kv hm dt translated">对于比特币或其他区块链上的智能合约来说，为了实用，它们通常需要访问区块链以外的数据，例如保险合同的天气或博彩合同的体育结果。出于安全考虑，智能合约运行在隔离的沙箱中，禁止启动外部数据的检索。他们依靠名为<a class="ae kw" href="https://en.bitcoin.it/wiki/Oracle" rel="noopener ugc nofollow" target="_blank"> <strong class="kc hu">甲骨文</strong> </a>的第三方数据提供商来提供这些数据。这就产生了一个被称为<a class="ae kw" href="https://blog.coincodecap.com/ethereum-smart-contracts-and-the-oracle-problem/" rel="noopener ugc nofollow" target="_blank">甲骨文问题</a>的完整性问题。需要数字签名来验证已知oracles提供的数据的真实性和完整性。</p><p id="ce47" class="pw-post-body-paragraph ka kb ht kc b kd kx iu kf kg ky ix ki kj kz kl km kn la kp kq kr lb kt ku kv hm dt translated">我们引入了一种有效的方法来验证和访问任何由oracle inside比特币智能合约签署的链上或链下的任意数据。</p><h1 id="2091" class="ji jj ht bd jk jl jm jn jo jp jq jr js iz jt ja ju jc jv jd jw jf jx jg jy jz dt translated">拉宾签名</h1><p id="4706" class="pw-post-body-paragraph ka kb ht kc b kd ke iu kf kg kh ix ki kj kk kl km kn ko kp kq kr ks kt ku kv hm dt translated"><a class="ae kw" href="https://nchain.com/app/uploads/2018/09/Rabin-Signatures-in-Bitcoin-Cash.pdf" rel="noopener ugc nofollow" target="_blank"> Rabin signature </a>是比特币使用的<a class="ae kw" href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" rel="noopener ugc nofollow" target="_blank"> ECDSA </a>的替代数字签名算法(<a class="ae kw" href="https://en.wikipedia.org/wiki/Digital_Signature_Algorithm" rel="noopener ugc nofollow" target="_blank"> DSA </a>)。Rabin签名的安全性依赖于计算模平方根和整数分解一样困难。</p><h2 id="d132" class="lc jj ht bd jk ld le lf jo lg lh li js kj lj lk ju kn ll lm jw kr ln lo jy lp dt translated">密钥生成</h2><p id="f2cc" class="pw-post-body-paragraph ka kb ht kc b kd ke iu kf kg kh ix ki kj kk kl km kn ko kp kq kr ks kt ku kv hm dt translated">与<a class="ae kw" href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" rel="noopener ugc nofollow" target="_blank"> RSA </a>类似，通过识别两个大素数<strong class="kc hu"> <em class="lq"> p </em> </strong>和<strong class="kc hu"> <em class="lq"> q </em> </strong>来生成密钥。私钥是<strong class="kc hu"> <em class="lq"> (p，q) </em> </strong>与对应的公钥<strong class="kc hu"> <em class="lq"> n = p * q </em> </strong>的组合。</p><h2 id="1f29" class="lc jj ht bd jk ld le lf jo lg lh li js kj lj lk ju kn ll lm jw kr ln lo jy lp dt translated">签署</h2><figure class="ls lt lu lv fq lw fe ff paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="fe ff lr"><img src="../Images/5c6266c9dfbaa70b98593eb2f5f2f6fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vgnT7a_mtRdKMKdCG5ljCw.png"/></div></div><figcaption class="md me fg fe ff mf mg bd b be z ek">Signing equation²</figcaption></figure><p id="6865" class="pw-post-body-paragraph ka kb ht kc b kd kx iu kf kg ky ix ki kj kz kl km kn la kp kq kr lb kt ku kv hm dt translated">将填充符<strong class="kc hu"><em class="lq"/></strong>附加到要签名的消息<strong class="kc hu"> <em class="lq"> m </em> </strong>中，使得散列值<strong class="kc hu"><em class="lq">【h(m | | U)</em></strong>是模<strong class="kc hu"> <em class="lq"> n </em> </strong>的二次剩余。签名是组合<strong class="kc hu"><em class="lq">【S，U】</em></strong>。</p><h2 id="1c19" class="lc jj ht bd jk ld le lf jo lg lh li js kj lj lk ju kn ll lm jw kr ln lo jy lp dt translated">确认</h2><figure class="ls lt lu lv fq lw fe ff paragraph-image"><div class="fe ff mh"><img src="../Images/8899a4b947199f8165c6f3e1a5dc4862.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*Fzt35pCYwRLZ7Q69LVA83Q.png"/></div><figcaption class="md me fg fe ff mf mg bd b be z ek">Signature verification</figcaption></figure><p id="4686" class="pw-post-body-paragraph ka kb ht kc b kd kx iu kf kg ky ix ki kj kz kl km kn la kp kq kr lb kt ku kv hm dt translated">有了签名<strong class="kc hu"> <em class="lq"> (S，U) </em> </strong>，消息<strong class="kc hu"> <em class="lq"> m </em> </strong>，公钥<strong class="kc hu"> <em class="lq"> n </em> </strong>，我们可以通过检查上面的等式是否成立来验证签名。</p><p id="013f" class="pw-post-body-paragraph ka kb ht kc b kd kx iu kf kg ky ix ki kj kz kl km kn la kp kq kr lb kt ku kv hm dt translated">可以看出，Rabin签名具有漂亮的<strong class="kc hu">不对称</strong>，即<strong class="kc hu">签名生成在计算上是昂贵的，但是签名验证在计算上是便宜的</strong>。这个属性使它非常适合onchain实现，在onchain实现中只需要签名验证。原则上，我们可以使用ECDSA来<a class="ae kw" href="https://www.yours.org/content/op_datasigverify-in-bitcoin-01-b6e44e91e7de" rel="noopener ugc nofollow" target="_blank">验证签名</a>，但是它要贵很多个数量级。</p><h1 id="ad45" class="ji jj ht bd jk jl jm jn jo jp jq jr js iz jt ja ju jc jv jd jw jf jx jg jy jz dt translated">履行</h1><p id="a3f8" class="pw-post-body-paragraph ka kb ht kc b kd ke iu kf kg kh ix ki kj kk kl km kn ko kp kq kr ks kt ku kv hm dt translated"><a class="ae kw" href="https://github.com/scrypt-sv/rabin" rel="noopener ugc nofollow" target="_blank">这里的</a>是Rabin签名的代码，包括密钥生成、签名生成和签名验证。我们也在<a class="ae kw" href="https://github.com/scrypt-sv/boilerplate/blob/master/tests/js/rabin.scrypttest.js" rel="noopener ugc nofollow" target="_blank">脚本</a>中实现了它。<a class="ae kw" href="https://github.com/scrypt-sv/boilerplate/blob/master/contracts/rabin.scrypt" rel="noopener ugc nofollow" target="_blank">代码</a>如下所示。注意，核心部分只有大约10行代码，并且只涉及基本的代数和散列运算。我们只需要实现签名验证，因为这是链上唯一要做的部分。我们还演示了一种通用技术，通过重新散列SHA256散列并连接它们来生成更长的散列，在本例中为512位。</p><figure class="ls lt lu lv fq lw fe ff paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="fe ff mi"><img src="../Images/3eb8f3d326bd75f3956ae3ed7202ae14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_p0FOMEn775v33CQAiy0g.png"/></div></div><figcaption class="md me fg fe ff mf mg bd b be z ek"><a class="ae kw" href="https://github.com/sCrypt-Inc/boilerplate/blob/master/contracts/rabin.scrypt" rel="noopener ugc nofollow" target="_blank">Rabin signature contract</a></figcaption></figure><h1 id="2631" class="ji jj ht bd jk jl jm jn jo jp jq jr js iz jt ja ju jc jv jd jw jf jx jg jy jz dt translated">结论</h1><p id="80fe" class="pw-post-body-paragraph ka kb ht kc b kd ke iu kf kg kh ix ki kj kk kl km kn ko kp kq kr ks kt ku kv hm dt translated">由于Rabin签名，我们可以在比特币交易中嵌入任意签名数据，并使用现有的比特币脚本在链上有效地验证它。此外，复杂性和成本可以根据应用程序的安全要求进行定制，这比在共识层硬编码特定DSA更加灵活。如果需要更强的安全性，可以简单地使用更长的密钥和散列。通过允许智能合约访问外部数据，它们变得更加强大。</p><h1 id="d5c1" class="ji jj ht bd jk jl jm jn jo jp jq jr js iz jt ja ju jc jv jd jw jf jx jg jy jz dt translated">感谢</h1><p id="5f3e" class="pw-post-body-paragraph ka kb ht kc b kd ke iu kf kg kh ix ki kj kk kl km kn ko kp kq kr ks kt ku kv hm dt translated">感谢欧文·沃恩和nChain的克雷格·赖特博士发现了拉宾签名在比特币中的用法。</p></div><div class="ab cl mj mk hb ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hm hn ho hp hq"><p id="b0ad" class="pw-post-body-paragraph ka kb ht kc b kd kx iu kf kg ky ix ki kj kz kl km kn la kp kq kr lb kt ku kv hm dt translated">[1]:如何最小化Oracle中所需的信任，例如，通过利用多个独立的Oracle，超出了本文的范围。</p><p id="6269" class="pw-post-body-paragraph ka kb ht kc b kd kx iu kf kg ky ix ki kj kz kl km kn la kp kq kr lb kt ku kv hm dt translated">【2】:<strong class="kc hu"><em class="lq">|</em>|</strong>是串联。</p><p id="598f" class="pw-post-body-paragraph ka kb ht kc b kd kx iu kf kg ky ix ki kj kz kl km kn la kp kq kr lb kt ku kv hm dt translated">[3]:实际上我们已经在<em class="lq"> sCrypt </em>中实现了ECDSA签名验证，我们的测量显示确实是在<a class="ae kw" href="https://www.yours.org/content/how-to-implement-ecdsa-signature-verification-in-script-and-why-datasi-9f113344542f" rel="noopener ugc nofollow" target="_blank">百万倍补贴</a>的量级。</p><blockquote class="mq"><p id="ee73" class="mr ms ht bd mt mu mv mw mx my mz kv ek translated"><a class="ae kw" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="nb nc nd ne nf lw fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff na"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>