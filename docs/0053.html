<html>
<head>
<title>Writing Software Contracts for Ethereum — Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为以太坊写软件合同—第3部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/writing-software-contracts-for-ethereum-part-3-5bd83c528c58?source=collection_archive---------0-----------------------#2017-12-25">https://medium.com/coinmonks/writing-software-contracts-for-ethereum-part-3-5bd83c528c58?source=collection_archive---------0-----------------------#2017-12-25</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="7e05" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">更新</strong>:2018年1月29日—(使用<strong class="is hu"> geth </strong>设置我们的私人区块链)</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/fdcf5a24a65f650ca7aea3974f358343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldFhKR7Llf8xVliycLo1jw.jpeg"/></div></div></figure><ul class=""><li id="238d" class="ka kb ht is b it iu ix iy jb kc jf kd jj ke jn kf kg kh ki dt translated">在<a class="ae kj" rel="noopener" href="/@IndianGuru/writing-software-contracts-for-ethereum-part-1-a9c2eb1bd27"> <strong class="is hu"> Part 1 </strong> </a>中我们谈到了区块链的基础知识。</li><li id="d1a0" class="ka kb ht is b it kk ix kl jb km jf kn jj ko jn kf kg kh ki dt translated">在<a class="ae kj" rel="noopener" href="/@IndianGuru/writing-software-contracts-for-ethereum-part-2-cfcfae70a20c"> <strong class="is hu"> Part 2 </strong> </a>中，我们了解了Solidity语言的一些基础知识，并使用Remix编写了一个简单的以太坊软件合约。</li></ul><p id="abc8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要使用以太坊，你需要下载一个程序(通常是geth)并在你的电脑上运行。当你启动这个程序，它会伸出手，连接到以太坊网络中的其他计算机。就像你运行Chrome这样的浏览器来连接网络一样，你运行一个以太坊节点来连接以太坊网络。每个节点连接到许多已经在网络上的对等体。</p><p id="cf08" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当您的节点加入网络时，它将开始下载整个以太坊“数据库”到您的计算机上。这个数据库包含以太坊上所有活动程序的完整状态。完整的数据库将占用超过100GB的磁盘空间(因此您可能需要购买额外的硬盘)。你可以免费读取数据，因为你已经有了本地数据，但是当你想写入新数据时，你需要整个网络来接收、验证和存储数据。那项服务会让你付出代价。你机器上的以太坊“数据库”被称为区块链(或者说，它是你的区块链的副本)。</p><p id="60e2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">公共区块链的问题是下载需要几天时间，因此我们将创建我们自己的私人隔离测试网络或区块链，这有助于我们进行测试，它不会<em class="kp">花费你任何东西，而且你与公共区块链完全隔离。</em></p><h2 id="aadf" class="kq kr ht bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk dt translated">创造我们自己的私人区块链</h2><p id="fa28" class="pw-post-body-paragraph iq ir ht is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hm dt translated">我们现在将下载并安装软件，我们将需要我们的私人区块链。为了创建我们自己的专用隔离测试网络或区块链，我们需要:</p><h2 id="d1ce" class="kq kr ht bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk dt translated">geth</h2><p id="385c" class="pw-post-body-paragraph iq ir ht is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hm dt translated">以太坊是一个名为Geth的独立客户端，可以安装在几乎任何操作系统上。我们将首先<a class="ae kj" href="https://geth.ethereum.org/downloads/" rel="noopener ugc nofollow" target="_blank">下载</a>并安装用Go编程语言编写的以太坊客户端(<strong class="is hu"> geth </strong>)。我为我的64位Windows桌面计算机下载的版本是1.7.3。你应该为你自己的操作系统下载geth。我把geth和它的开发工具安装到了<em class="kp"> d:\Geth </em>。</p><p id="dfbf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">不时地在网站上查看Geth的最新版本，并在你的电脑上重新安装相同的版本。</p><h2 id="cda6" class="kq kr ht bd ks kt ku kv kw kx ky kz la jb lb lc ld jf le lf lg jj lh li lj lk dt translated">创世纪. json</h2><p id="0563" class="pw-post-body-paragraph iq ir ht is b it ll iv iw ix lm iz ja jb ln jd je jf lo jh ji jj lp jl jm jn hm dt translated">我们需要一个叫做创世块的东西。genesis.json是一个用来创建我们的私有区块链的文件。</p><p id="8f48" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">从<a class="ae kj" href="https://gist.github.com/smtalimett/c6d31dd423ff19c8cb97c68323f3d1d4" rel="noopener ugc nofollow" target="_blank">下载<strong class="is hu"> genesis.json </strong>文件https://gist . github . com/smtalimett/c 6d 31 DD 423 ff 19 c 8 CB 97 c 68323 F3 D1 d 4</a>并保存在一个文件夹中(你应该创建这个文件夹)。我在文件夹<em class="kp">d:\ ether eum-examples \ example _ 1</em>中创建并存储了相同的内容</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lq lr l"/></div></figure><p id="b379" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">简而言之，这个文件为我们的私有区块链定义了一些初始值。<strong class="is hu"> chainId </strong>可以是任意值<em class="kp">，但不能是</em> 1(用于MainNet)、2和3(用于TestNet)。<strong class="is hu">难度</strong>应为较低的数值，以加快采矿速度。<strong class="is hu"> gasLimit </strong>是在您的私人区块链上编译和运行合同所必需的。</p><p id="15c7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在文件夹<em class="kp">d:\ ether eum-examples \ example _ 1</em>中创建一个文件夹来保存您的chaindata。姑且称之为<em class="kp"> chaindata。</em>接下来打开一个新的命令窗口，进入文件夹<em class="kp">d:\ ether eum-examples \ example _ 1</em>，在这里运行以下命令:</p><p id="4b02" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">geth — datadir=。/chaindata init genesis.json </p><p id="8fb0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您应该会看到类似这样的内容:</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lq lr l"/></div></figure><p id="f78f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在<em class="kp">d:\ ether eum-examples \ example _ 1 \ chain data</em>文件夹中，创建了两个子文件夹<em class="kp"> geth </em>和<em class="kp"> keystore </em>。geth文件夹保存我们的区块链数据，keystore文件夹保存我们的帐户密钥。</p><p id="af6a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要启动我们的私有区块链，请键入:</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lq lr l"/></div></figure><p id="c21d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们的私人区块链已经开始运作了。</p><p id="afd0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在，打开另一个命令窗口，通过键入以下命令将其连接到正在运行的区块链:</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lq lr l"/></div></figure><p id="5c72" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在Linux和Mac上，连接到正在运行的区块链的方法是键入:</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lq lr l"/></div></figure><p id="78f6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">有关可用方法的列表，请转到<a class="ae kj" href="https://github.com/ethereum/go-ethereum" rel="noopener ugc nofollow" target="_blank">https://github.com/ethereum/go-ethereum</a>并点击<em class="kp">维基</em>，然后点击<em class="kp">管理API </em>。如果一个来自管理API，那么也检查一下<em class="kp"> JSON-RPC server </em>选项。这将列出所有的<em class="kp"> eth </em>命令。</p><p id="3439" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们首先需要的是账户。让我们首先通过在刚刚打开的命令窗口中键入<strong class="is hu"> eth.accounts </strong>来检查我们是否有一个帐户，如下所示。你会发现我已经有了一些账户。你可能没有。我们现在将通过键入<strong class="is hu"> personal.newAccount()创建一个帐户；</strong>如下图所示:</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lq lr l"/></div></figure><p id="8689" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我给出的密码是<strong class="is hu">XYZ 123</strong>——你可以给出自己选择的密码。在公共区块链上处理资金时，请记住使用强密码。注意上面，它输出了一个由一系列字符组成的地址。这是一个接收地址，可以公开共享。如果您检查<em class="kp">密钥库</em>子文件夹，您应该在那里看到这个地址。</p><p id="8c21" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以太坊账号是由一个算法生成的，完全离线。你不需要点击远程服务器来生成一个账户。事实上，没有人知道你的账户地址的存在，直到它成为网络交易的一部分。当您创建一个全新的帐户时，您的余额从零开始。</p><p id="d455" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">首先你需要输入如下所示的<strong class="is hu"> <em class="kp"> eth.coinbase </em> </strong>来设置乙醚累积的账户。由于我有多个帐户，我可以通过键入<strong class="is hu"><em class="kp">miner . setetherbase(eth . accounts[1])来更改我希望累积乙醚的帐户；</em> </strong>如下所示。</p><p id="fcaf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我们的测试网络中，我们可以通过挖掘来创建一些醚。键入<strong class="is hu"><em class="kp">miner . start(1)；</em> </strong>其中1为线程数。这将返回null，因为我们不知道所有线程在内部将做什么。如果你看到主命令窗口，它已经开始挖掘。在我们赚到乙醚之前给它点时间。在您看到类似“成功地密封了新块”的语句后，您可以通过键入<strong class="is hu"> <em class="kp"> miner.stop() </em> </strong>来停止挖掘。输入<strong class="is hu"> <em class="kp">查看你赚了多少乙醚。你可以看到一个非常大的数字，它实际上是你赢得的<strong class="is hu">魏</strong> s(参见本系列的<a class="ae kj" rel="noopener" href="/@IndianGuru/writing-software-contracts-for-ethereum-part-1-a9c2eb1bd27">第一部分</a>)的数量。请注意，1乙醚= 10提高到18魏。如果我们可以看到我们已经获得的醚的数量，那就更好了，如果我们使用<em class="kp"> web3 </em>库中可用的<em class="kp"> fromWei </em>方法，例如:<strong class="is hu"><em class="kp">web 3 . from Wei(eth . get balance(eth . accounts[1])，“eth”)</em></strong></em></strong></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lq lr l"/></div></figure><p id="36ec" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们可以在一个窗口中完成所有的工作，而不是打开两个命令窗口。键入以下内容:</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lq lr l"/></div></figure><p id="f241" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">其中<strong class="is hu"> <em class="kp">解锁6 </em> </strong>是开我的第6个账号<strong class="is hu"> <em class="kp">挖矿1 </em> </strong>是用1个线程开始挖矿。很快，你会发现滚动停止了，因为它要求你输入密码。键入您的密码并按回车键。我输入了我的密码短语<strong class="is hu"> xyz123 </strong>。您现在可以最小化命令窗口。</p><blockquote class="ls"><p id="2b0f" class="lt lu ht bd lv lw lx ly lz ma mb jn ek translated"><a class="ae kj" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="md me mf mg mh jt fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff mc"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>