<html>
<head>
<title>How To Get Global Crypto Market Data and Approximate Price Info</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何获得全球加密市场数据和大概的价格信息</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-get-global-crypto-market-data-and-approximate-price-info-4dea89a795e1?source=collection_archive---------5-----------------------#2018-07-09">https://medium.com/coinmonks/how-to-get-global-crypto-market-data-and-approximate-price-info-4dea89a795e1?source=collection_archive---------5-----------------------#2018-07-09</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="ddef" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">使用<a class="ae ji" href="http://coinmarketcap.com" rel="noopener ugc nofollow" target="_blank">coin market cap</a>API # how to guidl(6/n)</h2></div><p id="c7ff" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">获取加密货币和代币信息的方式有很多种。如果你对探索感兴趣，这里有一些想法，可以帮助你开始用价格、交易量或排名数据建立自己的网站。请注意，这不是一个全面的可用资源套件，但我会不时更新这个博客，用各种方法获取市场数据。</p><p id="e43b" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated"><a class="ae ji" href="http://coinmarketcap.com" rel="noopener ugc nofollow" target="_blank"> CoinMarketCap </a>是一个包含一系列基本加密市场事实和数据的网站。你会看到加密货币、市场、市值、24H量和BTC优势的总数。然后出现所有可用的加密货币和代币的列表，按照它们的顺序列出——你猜对了——硬币市值，这只是流通中的数字乘以当前价格的任意数字。它被用作比较硬币的一种方法。我们可以在代码中获得与网站上看到的相同的信息。</p><p id="b69b" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">让我们首先安装用于CMC的开源javascript RESTful API包装器。<br/>我使用的是<a class="ae ji" href="https://github.com/tiaanduplessis/coinmarketcap-api" rel="noopener ugc nofollow" target="_blank">tiaanduplessis/coinmarketcap-API</a>的<a class="ae ji" href="https://github.com/emmonspired/coinmarketcap-api-1" rel="noopener ugc nofollow" target="_blank">分叉版本</a>。<br/>完整的API文档可以在这里<a class="ae ji" href="https://coinmarketcap.com/api/" rel="noopener ugc nofollow" target="_blank">阅读。</a></p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="aa04" class="ko kp ht kk b fv kq kr l ks kt">npm install coinmarketcap-api`</span></pre><p id="0dfa" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">现在它已经在我们的项目中可用了，获取对库的引用，并实例化API对象的一个实例。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="c140" class="ko kp ht kk b fv kq kr l ks kt">CMC = require("coinmarketcap-api")<br/>cmc = new CMC();</span></pre><figure class="kf kg kh ki fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff ku"><img src="../Images/12cf26ff967140d44e2180aee5ba7f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hyx1myXV3wHhgwN1gfUScw.png"/></div></div></figure><p id="2e72" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">使用<code class="eh lc ld le kk b">cmc.getGlobal()</code>异步函数获得相同的信息。</p><figure class="kf kg kh ki fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff lf"><img src="../Images/4b915ab07982fe32df66ab30bb5a7f05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7QATI21MLx7kQd6AFJZY1A.png"/></div></div></figure><p id="97fd" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">响应返回的是用<code class="eh lc ld le kk b">active_cryptocurrencies</code>、<code class="eh lc ld le kk b">active_markets</code>、<code class="eh lc ld le kk b">bitcoin_percentage_of_market_cap</code>填充的<code class="eh lc ld le kk b">data</code>属性，以及用<code class="eh lc ld le kk b">total_market_cap</code>和<code class="eh lc ld le kk b">total_volume_24h</code>填充的<code class="eh lc ld le kk b">quotes.USD</code>属性。如果您愿意，您可以使用相同的数据创建一个网站，但以不同的方式进行设计。</p><p id="8c0e" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">接下来，让我们研究如何获取所有可用的不同货币的信息。也许你对找出某个硬币的id感兴趣，比如Monero。</p><p id="d02c" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated"><code class="eh lc ld le kk b">cmc.getListings()</code>异步函数将返回全套硬币:</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="b45c" class="ko kp ht kk b fv kq kr l ks kt">{ data: [  <br/>{ id: 1, name: 'Bitcoin',  symbol: 'BTC', website_slug: 'bitcoin'},<br/>{ id: 2, name: 'Litecoin', symbol: 'LTC',website_slug: 'litecoin'},<br/>{ id: 3, name: 'Namecoin', symbol: 'NMC',website_slug: 'namecoin' },<br/>// ... more items ],<br/>  metadata: { timestamp: 1531157458, num_cryptocurrencies: 1619,  error: <strong class="kk hu">null</strong> } }</span></pre><p id="4deb" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">注意每枚硬币都有一个<code class="eh lc ld le kk b">id</code> <code class="eh lc ld le kk b">name</code> <code class="eh lc ld le kk b">symbol</code>和<code class="eh lc ld le kk b">website_slug</code>。<br/> <code class="eh lc ld le kk b">listings.data.length</code>是与<code class="eh lc ld le kk b">active_cryptocurrencies</code>相匹配的<code class="eh lc ld le kk b">1619</code>。</p><p id="d721" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">现在让我们搜索第一个名为“Monero”的列表。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="ff34" class="ko kp ht kk b fv kq kr l ks kt">xmr = listings.data.filter(l =&gt; l.name === 'Monero' )[0];<br/>{ id: 328, name: 'Monero', symbol: 'XMR', website_slug: 'monero' }</span></pre><p id="1552" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">我们将使用它来查找关于该货币的一些细节，因为API的另一部分需要它。用我们的变量属性来引用它:<code class="eh lc ld le kk b">xmr.id</code>。</p><p id="e659" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">让我们对另一个符号为<code class="eh lc ld le kk b">WAX</code>的密码做同样的事情。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="271b" class="ko kp ht kk b fv kq kr l ks kt">wax = listings.data.filter(l =&gt; l.symbol === 'WAX' )[0];<br/>{ id: 2300, name: 'WAX', symbol: 'WAX', website_slug: 'wax' }</span></pre><p id="0197" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">太好了。我们现在可以向API请求关于<code class="eh lc ld le kk b">xmr</code>和<code class="eh lc ld le kk b">wax</code>的股票信息。</p><p id="93f6" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">有一个带可选参数的异步函数<code class="eh lc ld le kk b">getTicker</code>:</p><p id="94a3" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated"><code class="eh lc ld le kk b">cmc.getTicker({id:wax.id})</code></p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="a1a2" class="ko kp ht kk b fv kq kr l ks kt">{ data: { id: 2300, name: 'WAX', symbol: 'WAX', website_slug: 'wax', rank: 96, circulating_supply: 828063006, total_supply: 1850000000, max_supply: <strong class="kk hu">null</strong>, quotes: { USD: { price: <strong class="kk hu">0.123043</strong>, volume_24h: 941801, market_cap: 101887356, percent_change_1h: 0.21, percent_change_24h: -4.22, percent_change_7d: -6.92 } }, last_updated: 1531158940 }, metadata: { timestamp: 1531158616, error: <strong class="kk hu">null</strong> } }</span><span id="db4d" class="ko kp ht kk b fv lg kr l ks kt">wax_ticker = _;</span></pre><figure class="kf kg kh ki fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff lh"><img src="../Images/298b4dac5315645f1a7dadbe2a2ba009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQuo0PLqn5ue6NQ8CUI9wg.png"/></div></div></figure><p id="e740" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">同样，您会注意到<code class="eh lc ld le kk b">data.quotes.USD.price</code>与您在网站上看到的值相同(截至这个日期和时间:$0.123043)。</p><p id="7b13" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">让我们对<code class="eh lc ld le kk b">xmr</code>做同样的事情:</p><p id="6255" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated"><code class="eh lc ld le kk b">cmc.getTicker({id:xmr.id})</code></p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="637f" class="ko kp ht kk b fv kq kr l ks kt">{ data: { id: 328, name: 'Monero', symbol: 'XMR', website_slug: 'monero', rank: 13, circulating_supply: 16209366, total_supply: 16209366, max_supply: <strong class="kk hu">null</strong>, quotes: { USD: { price: <strong class="kk hu">138.291</strong>, volume_24h: 32556600, market_cap: 2241609385, percent_change_1h: 0.56, percent_change_24h: -0.59, percent_change_7d: -0.16 } }, last_updated: 1531159466 }, metadata: { timestamp: 1531159117, error: <strong class="kk hu">null</strong> } }</span><span id="ad6c" class="ko kp ht kk b fv lg kr l ks kt">xmr_ticker = _;</span></pre><p id="4b94" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">我们再次看到API返回的价格信息与站点匹配。</p><figure class="kf kg kh ki fq kv fe ff paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="fe ff li"><img src="../Images/e75aed0f231124cf07dbda7ce6830b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1VLyHYOoCVpQcEEAZWwmQ.png"/></div></div></figure><p id="f01e" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">现在我们已经在<code class="eh lc ld le kk b">wax_ticker</code>和<code class="eh lc ld le kk b">xmr_ticker</code>中存储了两个不同的报价，我们可以做一些快速的数学计算来近似WAX和XMR之间的转换率。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="ae9a" class="ko kp ht kk b fv kq kr l ks kt">xmr_price = xmr_ticker.data.quotes.USD.price; // 138.291<br/>wax_price = wax_ticker.data.quotes.USD.price; // 0.123043<br/>xmrwax = xmr_price / wax_price; // 1123.9241565956618</span></pre><p id="2ff8" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">我们可以从该信息中得出，大约需要1124个<code class="eh lc ld le kk b">wax</code>代币才能在单个<code class="eh lc ld le kk b">xmr</code>代币中获得相同数量的美元价值。或者你可以这样想:1个Monero代币可以买你~1124个蜡代币。</p><p id="1054" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">大多数交易所使用常见的碱基对，如BTC/美元或瑞士联邦理工学院/BTC，或XMR/BTC，但通常不会发现列出的不常见的碱基对。既然你现在知道了如何获得给定股票的价格信息，你就可以使用<code class="eh lc ld le kk b">coinmarketcap-api</code>为自己获得一个好的估价，也许还可以在你的网站上构建一个定制股票。</p><p id="157d" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">请记住，CoinMarketCap上的价格信息可能会延迟，并且不会准确反映给定货币的买卖价差。因此，这些数据只能用于提供信息，而不能用于交易或风险管理决策。如果没有别的，我希望它能引发你对其他东西的好奇心，甚至是一种更方便用户的方式来比较完全不相关的货币。</p><p id="476c" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">在上面的例子中，我们在<code class="eh lc ld le kk b">truffle console</code>中运行函数，但是如果你需要等待一个函数的结果，你会想要利用便利的<code class="eh lc ld le kk b">async/await</code>库。我在这里提供了一个简短的例子供您参考。<code class="eh lc ld le kk b">get_cmc_price_in_usd</code>是一个<code class="eh lc ld le kk b">async</code>函数，它接受一个<code class="eh lc ld le kk b">id</code>并返回一个<code class="eh lc ld le kk b">Promise</code>，当<code class="eh lc ld le kk b">getTicker</code>结果可用时，该函数将被解析。可以为任何其他API数据编写类似的函数。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="8468" class="ko kp ht kk b fv kq kr l ks kt">const async = require('asyncawait/async');<br/>const await = require('asyncawait/await');</span><span id="5792" class="ko kp ht kk b fv lg kr l ks kt">async function get_cmc_price_in_usd(cmc_id) {</span><span id="fdc7" class="ko kp ht kk b fv lg kr l ks kt">    return new Promise(function(res, rej) {<br/>          <br/>          cmc.getTicker({id:cmc_id}).then( function(t) {<br/>            res(t.data.quotes.USD.price);<br/>          } );</span><span id="2c2e" class="ko kp ht kk b fv lg kr l ks kt">    });<br/>};</span><span id="a272" class="ko kp ht kk b fv lg kr l ks kt">let xmr_price = await get_cmc_price_in_usd(xmr.id);</span></pre><p id="583e" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">在下一篇文章中，我们将看看如何从Kucoin这样的交易所获得更准确和最新的价格信息。CoinMarketCap可以用于一次性探索，并为您提供更长时间的价格参考点，但交易决策应基于实时价格数据。</p><p id="4141" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated"><em class="lj"> Dan Emmons是区块链开发者，</em><a class="ae ji" href="http://www.emmonspired.com/" rel="noopener ugc nofollow" target="_blank"><em class="lj">Emmonspired LLC</em></a><em class="lj">所有者，a </em> <a class="ae ji" href="http://cryptoconsortium.org/lookup/6f0d14" rel="noopener ugc nofollow" target="_blank"> <em class="lj">认证比特币专业人士</em> </a> <em class="lj">，认证以太坊开发者，全栈开发者，加密货币项目顾问。他还是一个名为</em><a class="ae ji" href="https://www.youtube.com/watch?v=SVBZ7mdgGcA" rel="noopener ugc nofollow" target="_blank"><em class="lj"># ByteSizeBlockchain</em></a><em class="lj">的Youtube频道和iTunes播客的创造者。</em></p></div></div>    
</body>
</html>