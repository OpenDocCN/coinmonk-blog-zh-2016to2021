<html>
<head>
<title>Start Developing Hyperledger Fabric Chaincode in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Node.js中开始开发Hyperledger结构链代码</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/start-developing-hyperledger-fabric-chaincode-in-node-js-e63b655d98db?source=collection_archive---------0-----------------------#2019-09-24">https://medium.com/coinmonks/start-developing-hyperledger-fabric-chaincode-in-node-js-e63b655d98db?source=collection_archive---------0-----------------------#2019-09-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/6eb8f5a356d854972381f0892b6c40be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hYM9I9B6TWmZ3C9XMExgcw.jpeg"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">Photo by <a class="ae jf" href="https://www.pexels.com/@negativespace" rel="noopener ugc nofollow" target="_blank">Negative space</a> at <a class="ae jf" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">pexels.com</a></figcaption></figure><p id="5ee5" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">什么是Hyperledger结构术语中的链码？？</strong></p><p id="6d81" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在Hyperledger Fabric中，Chaincode是运行在网络对等体之上的一段代码，用于实现应用程序如何与分类帐交互的业务逻辑。当一个交易被提议时，它触发决定什么状态改变应该被应用到分类帐的链码。因此，为了在Hyperledger Fabric上开发分散式应用程序，必须编写名为Chaincode的应用程序逻辑。</p><p id="2989" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">Chaincode可以用Go，Nodejs，Java写。与其他两种语言相比，Node.js是一种更多人理解并更容易使用的语言，包括我在内。但是，仍然编写和部署Node.js链代码有点棘手，因为其文档中可用的信息非常少。因此，我决定编写Node.js链码的一些概念，并逐步编写和部署简单的链码。</p><h2 id="e164" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated"><strong class="ak">总账结构数据库</strong></h2><p id="5399" class="pw-post-body-paragraph jg jh ht ji b jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">在深入到Chaincode之前，首先我们来看看数据在Hyperledger Fabric Network中存储在哪里。Hyperledger Fabric使用键值数据库来存储其状态。默认情况下，fabric使用LevelDB。这个数据库保存特定对象的二进制数据，可以使用它的键进行查询。与传统的数据库集中不同，<a class="ae jf" href="https://blog.coincodecap.com/tag/blockchain/" rel="noopener ugc nofollow" target="_blank">区块链</a>数据库在网络的每一个节点上。因此，它被称为分散网络。</p><p id="d19f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">除了LevelDB，还有另一个用于Hyperledger Fabric的数据库，名为CouchDB。CouchDB是一个可选的外部可插拔状态数据库。像LevelDB键值存储一样，CouchDB可以存储任何用chaincode建模的二进制数据。但是作为一个JSON文档存储，CouchDB还支持针对链码数据的丰富查询，当链码值(例如资产)被建模为JSON数据时。</p><h2 id="99c5" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated"><strong class="ak">链码组件</strong></h2><p id="f09d" class="pw-post-body-paragraph jg jh ht ji b jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">1.fabric-contract-api :</p><p id="a613" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">用于实现智能合约的高级合约API(作为npm模块提供)</p><p id="d879" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">织物垫片:</p><p id="c180" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">用于实现智能合约的低级合约API(作为npm模块提供)</p><p id="95fe" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们可以把<strong class="ji hu"> fabric-shim </strong>看作是<strong class="ji hu"> fabric-contract-api </strong>的缩减版本。对新版本的fabric使用高级API是一个很好的做法。但是，<strong class="ji hu"> fabric-contract-api </strong>可以做shim能做的一切。当然不止这些。</p><p id="1ab1" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">3 .存根:</p><p id="d0e0" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">它是<strong class="ji hu"> fabric-contract-api </strong>中的一个接口，用于访问和修改账本(数据库状态)。因此，它是读写分类帐数据的主要链码接口。怎样才能读写数据？？让我们来看看存根接口中的一些常用方法</p><h2 id="c652" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated"><strong class="ak">存根接口常用方法</strong></h2><p id="adc2" class="pw-post-body-paragraph jg jh ht ji b jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">1.<strong class="ji hu"> getState(k): </strong></p><p id="e268" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">众所周知，Hyperledger Fabric数据库以键值对的形式存储数据。此方法从分类帐中读取数据。它将输入“k”作为键，并返回与键“k”相关联的二进制值。</p><p id="ecca" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu"> 2.putState(k，v): </strong></p><p id="773c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">此方法将数据写入分类帐。它以“k”为键，以“v”为值。为了清楚起见，假设我们想要将Alice的年龄存储到分类帐中，我们可以将<strong class="ji hu"> Alice </strong>作为键，将<strong class="ji hu"> age </strong>作为值。</p><p id="7ce0" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">3 .删除状态(k): </p><p id="86f7" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">此方法从分类帐中删除相关键“k”的值。</p><p id="793e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu"> 4.getStateByRange(k1，k9): </strong></p><p id="a9e5" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">该方法返回分类帐中一组键的范围迭代器。它将遍历startKey( k1)和endKey(k9)并返回这两个键之间的所有键值。假设我们已经按照键k1，k2，k3…k99的顺序存储了一些用户数据，我们可以用这个方法简单地得到所有这些值的状态。</p><p id="c9be" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">5.getTxID() :</p><p id="a1ab" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">此方法返回被调用事务的事务Id。交易Id对于链上的每个交易都是唯一的。因此，事务Id在跟踪事务中起着至关重要的作用。</p><p id="4e76" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu"> 6.getTxTimestamp(): </strong></p><p id="42df" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">该方法返回创建事务时的时间戳。这是从交易通道头中提取的，因此它将指示客户端的时间戳，并且在所有背书者中具有相同的值。</p><h2 id="721d" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated"><strong class="ak">编写你的第一个链码</strong></h2><p id="510e" class="pw-post-body-paragraph jg jh ht ji b jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">您已经学习了在node.js中编写链代码的一些先决条件。因此，现在，您可能会非常兴奋地编写您的第一个链代码，或者至少当我学习这些时是如此。</p><p id="d79f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">既然我们要在Nodejs中编写链码，我们首先需要创建传统的npm东西，比如<strong class="ji hu"> package.json </strong>和<strong class="ji hu"> index.js. </strong>如果<strong class="ji hu"> </strong>你不知道这个package.json的话</p><p id="ba7f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">a package.json</p><ul class=""><li id="749e" class="le lf ht ji b jj jk jn jo jr lg jv lh jz li kd lj lk ll lm dt translated">列出项目所依赖的包</li><li id="ab33" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated">使用<a class="ae jf" href="https://docs.npmjs.com/about-semantic-versioning" rel="noopener ugc nofollow" target="_blank">语义版本规则</a>指定您的项目可以使用的包版本</li><li id="25c0" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated">使您的构建可重复，因此更容易与其他开发人员共享</li></ul><p id="e8e9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">简而言之，我们的链代码依赖于<strong class="ji hu"> fabric-contract-api </strong>和<strong class="ji hu"> fabric-shim </strong>模块。我们在package.json中提到了这些包和版本。</p><p id="58be" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们还添加了<strong class="ji hu">fabric-chaincode-node start</strong>作为在对等体上安装chain code所需的启动脚本。</p><p id="4d10" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这是我们的package.json:</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="e5ac" class="ke kf ht lx b fv mb mc l md me"><br/>{<br/>    "name": "Test-Chaincode",<br/>    "version": "1.0.0",<br/>    "description": "my first exciting node.js chaincode on Hyperledger-fabric",<br/>   <strong class="lx hu"> "main": "index.js",</strong><br/>    "engines": {<br/>        "node": "&gt;=8",<br/>        "npm": "&gt;=5"<br/>    },<br/>    "scripts": {<br/>        "lint": "eslint .",<br/>        "pretest": "npm run lint",<br/>        "test": "nyc mocha --recursive",<br/>        <strong class="lx hu">"start": "fabric-chaincode-node start"</strong><br/>    },<br/>    "engineStrict": true,<br/>    "author": "Hyperledger",<br/>    "license": "Apache-2.0",<br/>    <strong class="lx hu">"dependencies": {<br/>        "fabric-contract-api": "~1.4.0",<br/>        "fabric-shim": "~1.4.0"<br/>    },</strong><br/>    "devDependencies": {<br/>        "chai": "^4.1.2",<br/>        "eslint": "^4.19.1",<br/>        "mocha": "^5.2.0",<br/>        "nyc": "^12.0.2",<br/>        "sinon": "^6.0.0",<br/>        "sinon-chai": "^3.2.0"<br/>    },<br/>    "nyc": {<br/>        "exclude": [<br/>            "coverage/**",<br/>            "test/**"<br/>        ],<br/>        "reporter": [<br/>            "text-summary",<br/>            "html"<br/>        ],<br/>        "all": true,<br/>        "check-coverage": true,<br/>        "statements": 100,<br/>        "branches": 100,<br/>        "functions": 100,<br/>        "lines": 100<br/>    }<br/>}</span></pre><p id="c296" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">如果你能仔细观察代码，有一行<strong class="ji hu">“main”:“index . js”。</strong>这是什么意思——在启动时(在安装链码期间), npm模块用于检查index.js并在对等体上安装提到的契约。“所以我们的index.js包含作为模块导出的契约。</p><p id="ffbc" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这是我们的index.js文件:</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="da4a" class="ke kf ht lx b fv mb mc l md me">'use strict';<br/>const testContract = require(’./logic’);<br/>module.exports.contracts = [ testContract ];</span></pre><p id="4881" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">合同:</strong></p><p id="a009" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mf">我们的商业逻辑是什么？？</em></p><blockquote class="mg mh mi"><p id="35bb" class="jg jh mf ji b jj jk jl jm jn jo jp jq mj js jt ju mk jw jx jy ml ka kb kc kd hm dt translated">添加、检索和删除学生成绩。</p></blockquote><p id="7879" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">1.添加标记包括将数据写入分类帐。所以我们将从chaincode存根接口使用putState(k，v)方法。</p><p id="e73a" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">2.检索标记包括从分类帐中读取数据。所以我们需要使用getState(k)方法。</p><p id="2fb9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">3.删除标记涉及删除数据。所以我们需要使用deleteState(k)方法。</p><p id="ce8c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">chaincode从从<strong class="ji hu"> fabric-contract-api </strong>模块引入范围键类<strong class="ji hu"> Contract </strong>开始。这个类将用于编写逻辑。所有的链码函数都应该使用这个库类。</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="2ab3" class="ke kf ht lx b fv mb mc l md me">const { Contract}=require(’fabric-contract-api’);<br/> class testContract extends Contract {</span><span id="b4a5" class="ke kf ht lx b fv mm mc l md me"><strong class="lx hu">//Functions go here</strong></span><span id="a556" class="ke kf ht lx b fv mm mc l md me">}</span></pre><p id="4d0f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">添加标记</strong>:</p><p id="7a8d" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们将创建一个JavaScript对象来存储学生在每个科目中的分数，并将该对象存储为值，将<strong class="ji hu"> studentId </strong>存储为键。当通过服务器向数据库发送数据时，数据必须是字符串。因此，首先我们需要使用<strong class="ji hu"> JSON.stringify() </strong>方法将这个marks对象转换成字符串，并应用<strong class="ji hu"> buffer </strong>以二进制数据的形式发送到数据库。在这里，</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="ee98" class="ke kf ht lx b fv mb mc l md me">async addMarks(ctx,studentId,subject1,subject2,subject3) { </span><span id="5869" class="ke kf ht lx b fv mm mc l md me">    let marks={<br/>     subj1:subject1, <br/>     subj2:subject2,<br/>     subj3:subject3 <br/>     }; <br/>await  ctx.stub.putState(studentId,Buffer.from(JSON.stringify(marks))); </span><span id="2e82" class="ke kf ht lx b fv mm mc l md me">console.log(’Student Marks added To the ledger Succesfully..’); <br/>}</span></pre><p id="be03" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">删除标记</strong></p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="aeeb" class="ke kf ht lx b fv mb mc l md me">async deleteMarks(ctx,studentId) {<br/>  <br/> await ctx.stub.deleteState(studentId); <br/>   <br/>console.log(’Student Marks deleted from the ledger Succesfully..’);<br/>    <br/>    }</span></pre><p id="65f9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">查询学生成绩:</strong></p><p id="c41b" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">因为，我们把值以缓冲区的形式放在前面的<strong class="ji hu"> addMarks() </strong>函数中。一旦被查询，它将返回缓冲区。因此，我们需要将buffer转换成string，并解析成一个原始的javascript对象。在这里，</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="e0f6" class="ke kf ht lx b fv mb mc l md me">async queryMarks(ctx,studentId){<br/> <br/>     let marksAsBytes = await ctx.stub.getState(studentId); <br/>     if (!marksAsBytes || marksAsBytes.toString().length &lt;= 0) { <br/>       throw new Error(’Student with this Id does not exist: '); <br/>         } <br/>    let marks=JSON.parse(marksAsBytes.toString()); <br/>    return JSON.stringify(marks); <br/>   }</span></pre><h2 id="216b" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated">最终合同</h2><p id="a565" class="pw-post-body-paragraph jg jh ht ji b jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">你可以在这里找到完整的合同。</p><figure class="ls lt lu lv fq iu"><div class="bz el l di"><div class="mn mo l"/></div></figure><p id="a996" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了安装和测试这个契约，我将使用包含单个对等体的基本网络。在这个网络上，我们将在<strong class="ji hu">peer0.org1.example.com</strong>上安装一个名为<strong class="ji hu"> mycc </strong>的Node.js链码，并在通道<strong class="ji hu"> mychannel </strong>上实例化它。然后我们能够调用这些链码函数。确保docker安装在您的系统中。为了简单起见，我已经在<strong class="ji hu"> chaincode/newcc </strong>目录中挂载了我们的chaincode文件(logic.js，index.js，package.json)。完整的代码可以在<a class="ae jf" href="https://github.com/Salmandabbakuti/chaincode-essentials.git" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p><p id="5a65" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">首先，我们需要启动网络，创建一个渠道。</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="49c4" class="ke kf ht lx b fv mb mc l md me">git clone https://github.com/Salmandabbakuti/chaincode-essentials.git</span><span id="0750" class="ke kf ht lx b fv mm mc l md me">cd chaincode-essentials/basic-network</span><span id="008f" class="ke kf ht lx b fv mm mc l md me">./start.sh</span></pre><p id="aa12" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">请稍等片刻。建立网络需要一些时间。如果您遇到任何权限错误，只需在root用户权限下运行即可。一旦我们的单对等网络建立并运行，我们就可以安装chaincode了。</p><p id="9c4e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了安装和调用链接代码，我们可以使用对等体的CLI容器。进入CLI容器</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="c831" class="ke kf ht lx b fv mb mc l md me">docker exec -it cli bash</span></pre><p id="e52e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">安装并实例化链码</strong></p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="8e00" class="ke kf ht lx b fv mb mc l md me">peer chaincode install -n mycc -v 1.0 -p "/opt/gopath/src/github.com/newcc" -l "node"</span><span id="f7bd" class="ke kf ht lx b fv mm mc l md me">peer chaincode instantiate -o orderer.example.com:7050 -C mychannel -n mycc -l "node" -v 1.0 -c '{"Args":[]}'</span></pre><p id="12e5" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">添加学生分数</strong></p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="4e8a" class="ke kf ht lx b fv mb mc l md me">peer chaincode invoke -o orderer.example.com:7050 -C mychannel -n mycc -c '{"function":"addMarks","Args":["Alice","68","84","89"]}'</span></pre><p id="4cbc" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">查询学生“爱丽丝”的成绩</strong></p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="9e85" class="ke kf ht lx b fv mb mc l md me">peer chaincode query -o orderer.example.com:7050 -C mychannel -n mycc -c '{"function":"queryMarks","Args":["Alice"]}'</span></pre><p id="5647" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">从分类账中删除“爱丽丝”的标记</strong></p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="befd" class="ke kf ht lx b fv mb mc l md me">peer chaincode invoke -o orderer.example.com:7050 -C mychannel -n mycc -c '{"function":"deleteMarks","Args":["Alice"]}'</span></pre><p id="f47e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">上述脚本将从分类帐中删除关键字“Alice”和相关数据。如果您再次查询Alice的标记，您会得到一个错误消息，说“studentId不存在”</p><p id="e9f3" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我还制作了一个自动化脚本，用于在客户端目录中安装和测试这个链代码。按照以下步骤进行快速演示</p><p id="ceaf" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">首先，退出CLI容器，并在客户端目录中运行脚本</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="b647" class="ke kf ht lx b fv mb mc l md me"><br/>exit # exits from CLI docker container if you're in<br/>cd ..<br/>cd client  #change your directory to client</span><span id="27b7" class="ke kf ht lx b fv mm mc l md me">chmod a+x start.sh</span><span id="2cef" class="ke kf ht lx b fv mm mc l md me">./start.sh  #Automated script for testing</span></pre><p id="ea67" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">您也可以使用<strong class="ji hu"> client/start.sh </strong>文件中定义的脚本手动调用链码函数。</p><h1 id="6cd0" class="mp kf ht bd kg mq mr ms kk mt mu mv ko mw mx my kr mz na nb ku nc nd ne kx nf dt translated">结论</h1><p id="b3ff" class="pw-post-body-paragraph jg jh ht ji b jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">我们在这里演示了什么是链码，链码<strong class="ji hu">存根</strong>接口中的方法，链码的部署结构，以及编写链码和在网络上部署有多容易。我希望这篇文章能够帮助您开始编写链代码并在网络上部署。</p><p id="bc38" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">想知道我们如何在Hyperldger Fabric上构建最终用户应用吗？查看此处:</strong><a class="ae jf" rel="noopener" href="/@Salmandabbakuti/walkthrough-of-hyperledger-fabric-client-application-aae5222bdfd3"><strong class="ji hu">Hyperledger Fabric Node SDK和客户端应用程序的演练</strong> </a></p><h2 id="5f11" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated">参考资料:</h2><ol class=""><li id="108c" class="le lf ht ji b jj kz jn la jr ng jv nh jz ni kd nj lk ll lm dt translated">Hyperledger结构垫片API:</li></ol><p id="d268" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><a class="ae jf" href="https://fabric-shim.github.io/release-1.4/index.html" rel="noopener ugc nofollow" target="_blank">https://fabric-shim.github.io/release-1.4/index.html</a></p><p id="cf9b" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">2.Hyperledger结构节点SDK:</p><p id="47d2" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><a class="ae jf" href="https://fabric-sdk-node.github.io/master/index.html" rel="noopener ugc nofollow" target="_blank">https://fabric-sdk-node.github.io/master/index.html</a></p><p id="2794" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">3.链码教程</p><p id="6237" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><a class="ae jf" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/chaincode.html" rel="noopener ugc nofollow" target="_blank">https://hyperledger-fabric . readthedocs . io/en/release-1.4/chain code . html</a></p><blockquote class="nk"><p id="a998" class="nl nm ht bd nn no np nq nr ns nt kd ek translated">加入Coinmonks <a class="ae jf" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jf" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jf" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="ke kf ht bd kg kh nu kj kk kl nv kn ko jr nw kq kr jv nx kt ku jz ny kw kx ky dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="le lf ht ji b jj kz jn la jr ng jv nh jz ni kd lj lk ll lm dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae jf" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae jf" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae jf" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="f33b" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae jf" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">开发人员的最佳加密API</a></li><li id="6f41" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" href="https://coincodecap.com/nft-marketplaces" rel="noopener ugc nofollow" target="_blank">NFT十大市场造币集锦</a></li><li id="f72f" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" href="https://coincodecap.com/ascendex-staking" rel="noopener ugc nofollow" target="_blank">AscendEx Staking</a>|<a class="ae jf" href="https://coincodecap.com/bot-ocean-review" rel="noopener ugc nofollow" target="_blank">Bot Ocean Review</a>|<a class="ae jf" href="https://coincodecap.com/bitcoin-wallets-india" rel="noopener ugc nofollow" target="_blank">最佳比特币钱包</a></li><li id="15e5" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" href="https://coincodecap.com/bitget-review" rel="noopener ugc nofollow" target="_blank"> Bitget回顾</a>|<a class="ae jf" href="https://coincodecap.com/gemini-vs-blockfi" rel="noopener ugc nofollow" target="_blank">Gemini vs BlockFi</a>|<a class="ae jf" href="https://coincodecap.com/okex-futures-trading" rel="noopener ugc nofollow" target="_blank">OKEx期货交易</a></li><li id="c009" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" href="https://coincodecap.com/crypto-trading-bots-in-the-us" rel="noopener ugc nofollow" target="_blank">美国最佳加密交易机器人</a> | <a class="ae jf" href="https://coincodecap.com/changelly-review" rel="noopener ugc nofollow" target="_blank">经常性评论</a></li><li id="7716" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" href="https://coincodecap.com/crypto-arbitrage-in-india" rel="noopener ugc nofollow" target="_blank">在印度利用加密套利赚取被动收入</a></li><li id="b359" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated">最佳<a class="ae jf" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="3c98" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/free-crypto-signals-48b25e61a8da">免费加密信号</a> | <a class="ae jf" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a></li><li id="9487" class="le lf ht ji b jj ln jn lo jr lp jv lq jz lr kd lj lk ll lm dt translated">杠杆代币的终极指南</li></ul></div></div>    
</body>
</html>