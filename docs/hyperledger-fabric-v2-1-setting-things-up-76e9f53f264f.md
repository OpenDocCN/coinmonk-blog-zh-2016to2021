# Hyperledger Fabric v2.1:è®¾ç½®

> åŽŸæ–‡ï¼š<https://medium.com/coinmonks/hyperledger-fabric-v2-1-setting-things-up-76e9f53f264f?source=collection_archive---------0----------------------->

![](img/43d284f5c259d8f287110b6afa5deac1.png)![](img/a53626c0f7ca924435d86575b3afda30.png)

æœ¬æ–‡å°†å¸¦æ‚¨äº†è§£è®¾ç½® Hyperledger Fabric v 2.1 çš„ç®€å•æ­¥éª¤ã€‚å®ƒå°†å‚è€ƒ Hyperledger Fabric å®˜æ–¹æ–‡æ¡£ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½æœ‰ç®€çŸ­çš„è§£é‡Šï¼Œä»¥èŠ‚çœæ‚¨çš„æ—¶é—´ã€‚æˆ‘å·²ç»çœ‹åˆ°ï¼Œåœ¨å»ºç«‹ç»“æž„ç½‘ç»œæ—¶ï¼Œäººä»¬é€šå¸¸ä¼šå¿½ç•¥ä¸€äº›å°äº‹æƒ…ï¼Œå¹¶ä¸”ç”±äºŽé€‰æ‹©äº†é”™è¯¯çš„ä¾èµ–ç‰ˆæœ¬ã€å¯¼å‡ºäº†é”™è¯¯çš„è·¯å¾„ä»¥åŠè®¸å¤šå…¶ä»–äº‹æƒ…è€Œé¢ä¸´è®¸å¤šå›°éš¾ã€‚æ‰€ä»¥ï¼Œæˆ‘å†™è¿™ç¯‡åšå®¢çš„ä¸»è¦åŠ¨æœºæ˜¯æƒ³çœ‹åˆ°ä½ è¿è¡Œæµ‹è¯•ç½‘ç»œï¼Œä¸é—æ¼ä»»ä½•ä¸œè¥¿ã€‚

æˆ‘å°†åœ¨ GCP ä½¿ç”¨ Ubuntu 18.04 è™šæ‹Ÿæœºæ¥å»ºç«‹æµ‹è¯•ç½‘ç»œã€‚

éµå‘½èˆ¹é•¿ã€‚ï¼ðŸš¢ï¼Œæˆ‘ä»¬å¼€èˆ¹å§â€¦

# å®‰è£…å…ˆå†³æ¡ä»¶å¹¶èŽ·å– fabric äºŒè¿›åˆ¶æ–‡ä»¶:

è·Ÿæˆ‘ä¸€èµ·è·Ÿç€æ­¥éª¤èµ°ðŸ˜‰ï¼š

1.  **å®‰è£… curlï¼Œdockerï¼Œdocker-composeï¼Œnodejs & npmã€‚**

> å¿…é¡»å®‰è£… curl docker docker-compose èŠ‚ç‚¹ npm

2.**å®‰è£… golang**

ä¸è¦ç”¨ apt å®‰è£… golangï¼Œå› ä¸º ubuntu ä¸€èˆ¬ä¼šç»´æŠ¤ golang çš„è€ç‰ˆæœ¬ðŸ˜•ã€‚ç”¨ golang å®˜ç½‘ä¸‹è½½ï¼Œå…³æ³¨æˆ‘:

a)ä½¿ç”¨ curl æˆ– wget ä»Žå®˜æ–¹[ä¸‹è½½é¡µé¢](https://golang.org/dl/)ä¸‹è½½ Go çš„å½“å‰äºŒè¿›åˆ¶æ–‡ä»¶:

> https://dl.google.com/go/go1.14.2.linux-amd64.tar.gz

b)æå– tarball

> å¡”å°”-xvf go1.14.2.linux-amd64.tar.gz

c)è°ƒæ•´æƒé™å¹¶å°† go ç›®å½•ç§»åŠ¨åˆ°/usr/local:

> sudo chown -R root:rootã€‚/go
> sudo mv go /usr/local

d)è°ƒæ•´ä¸­çš„è·¯å¾„å˜é‡ã€‚bashrc

> å¯¼å‡º GOPATH=$HOME/go
> å¯¼å‡ºè·¯å¾„= $ PATH:/usr/local/go/bin:$ GOPATH/bin

e)å°†æ–‡ä»¶å‘½ä»¤åŠ è½½åˆ°å½“å‰ shell å®žä¾‹ä¸­

> æ¥æº~/ã€‚bashrc

**æ³¨æ„**:å§‹ç»ˆæ£€æŸ¥ä»»ä½•å…ˆå†³æ¡ä»¶çš„æœ€ä½Žç‰ˆæœ¬ï¼Œä»¥é¿å…æ··ä¹±ã€‚

3.**å¯ç”¨ docker è¿è¡ŒäºŽ**

> sudo ç³»ç»Ÿå¯ç”¨ docker

4.**å°†æ‚¨ï¼Œç”¨æˆ·ï¼Œæ·»åŠ åˆ° docker ç»„**

> sudo usermod -a -G docker<username></username>

5.**å®‰è£… Fabric äºŒè¿›åˆ¶æ–‡ä»¶**

> https://bit.ly/2ysbOFE çš„ curl -sSL

6.**å¯¼å‡ºè·¯å¾„åˆ°ä½ çš„é¢æ–™æ ·æœ¬ä¸‹è½½ä½ç½®**

> å¯¼å‡ºè·¯å¾„= <path to="" download="" location="">/bin:$PATH</path>

çŽ°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼Œåœ¨æ‚¨çš„ç³»ç»Ÿä¸­çœ‹åˆ°ä»¥ä¸‹ docker æ˜ åƒ

> docker å›¾åƒ

![](img/1c979675641b1900bcfe09744a049778.png)

å¥½äº†ï¼Œåšå®Œè¿™ä¸€åˆ‡åŽï¼Œä½ çŽ°åœ¨å¯ä»¥æµ‹è¯• hyperledger fabric æä¾›çš„ç¬¬ä¸€ä¸ªç½‘ç»œç¤ºä¾‹äº†ã€‚

![](img/ebeaf96129ea2d92565b25b1b12b9c48.png)

# çŽ©ç»‡ç‰©æµ‹è¯•ç½‘ç»œåºŠ:

é¦–å…ˆï¼Œå°†å½“å‰ç›®å½•æ›´æ”¹ä¸º test-network æ–‡ä»¶å¤¹ï¼Œè®©æˆ‘ä»¬ç»§ç»­ã€‚

åœ¨ç»§ç»­ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ²¡æœ‰ä¸Žæ­£åœ¨è¿è¡Œçš„ Hyperledger ç»“æž„ç›¸å…³çš„å®¹å™¨ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœæ­¢å®ƒä»¬:

> ã€‚/network.sh å‘ä¸‹

æˆ–è€…

> docker rm $(docker ps -aq)

**æµ‹è¯•ç½‘ç»œæž¶æž„:**

Fabric v2.1 é™„å¸¦çš„æµ‹è¯•ç½‘ç»œåŒ…å«ä¸¤ä¸ªå„æœ‰ä¸€ä¸ªå¯¹ç­‰ç‚¹çš„ç»„ç»‡å’Œä¸€ä¸ªæœ‰ä¸€ä¸ªå¯¹ç­‰ç‚¹çš„è®¢è´­è€…ç»„ç»‡ã€‚

æ‚¨å¯ä»¥æŸ¥çœ‹ ccp-generate.sh æ¥äº†è§£ä¸Žç»„ç»‡ç›¸å…³çš„é…ç½®ã€‚

![](img/1de7eb8fbcc9e84bf55ac9009919efb9.png)

å¦å¤–ï¼Œä¸ºå¯¹ç­‰ç‚¹å’Œè®¢å•ç”ŸæˆåŠ å¯†ææ–™æ‰€éœ€çš„é…ç½®å­˜åœ¨äºŽ cryptogen æ–‡ä»¶å¤¹ä¸­çš„ yaml æ–‡ä»¶ä¸­ã€‚

çœ‹çœ‹è¿™äº›ç…§ç‰‡ðŸ“·æ¥è‡ª cryptogen æ–‡ä»¶å¤¹ä¸­çš„ crypto-config-org1.yaml æ–‡ä»¶:

![](img/c9bcaa6bea78822bbf677e195e3b635a.png)![](img/e1df7d42be5b900b028ea20ca4a69c53.png)

æ‚¨å¯ä»¥çœ‹åˆ°**æ¨¡æ¿è®¡æ•°è®¾ç½®ä¸º 1** ã€‚å®ƒå¯¹åº”äºŽåªä¸º org åˆ›å»ºä¸€ä¸ªå¯¹ç­‰ä½“çš„äº‹å®žï¼Œå¹¶ä¸”åªä¸ºè¯¥å¯¹ç­‰ä½“ç”ŸæˆåŠ å¯†ææ–™ã€‚

è®©æˆ‘ä»¬é€šè¿‡ä¸‰ä¸ªæ­¥éª¤å¼€å§‹æ¼”ç¤º:

**ç¬¬ä¸€æ­¥:è°ƒå‡ºæµ‹è¯•ç½‘ç»œ**

> ã€‚/network.sh up

å¦‚æžœä¸€åˆ‡é¡ºåˆ©å®Œæˆï¼Œé‚£ä¹ˆæ‚¨å°†èƒ½å¤Ÿçœ‹åˆ°ä»¥ä¸‹ä¸‰ä¸ªå®¹å™¨â€”â€”ä¸¤ä¸ªå¯¹ç­‰ç‚¹å’Œä¸€ä¸ªè®¢è´­ç‚¹ã€‚

![](img/7c7191bdd6a7b0a4276673c32713a70f.png)

é‚£ä¹ˆå‰é¢çš„å‘½ä»¤åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Œç­”æ¡ˆå°±åœ¨ network.sh ä¸­ã€‚

![](img/f989821469acff4043f10629457d2025.png)

å‘½ä»¤**ã€‚/network.sh up** æœ¬èº«è°ƒç”¨ä¸¤ä¸ªå‡½æ•°åˆ›å»º orgs å’Œåˆ›å»º consortiumã€‚

![](img/20e6a63812a8ff05bb148b4236c339c5.png)

Snapshot when cryptogen is selected.

æ‚¨å¯ä»¥çœ‹åˆ° cryptogen æ­£åœ¨ä½¿ç”¨ organisations æ–‡ä»¶å¤¹ä¸­çš„é…ç½®æ–‡ä»¶ã€‚

**æ³¨æ„**:åœ¨ 2.1 ç‰ˆä¸­ï¼Œtest-network çš„ä¸€ä¸ªå¾ˆå¥½çš„å¢žå¼ºæ˜¯ï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªä½¿ç”¨ fabric-ca åˆ›å»ºèº«ä»½çš„é€‰é¡¹ã€‚æ—©æœŸç‰ˆæœ¬ä½¿ç”¨åŠ å¯†å·¥å…·åˆ›å»ºèº«ä»½å’ŒåŠ å¯†ææ–™ã€‚æ‰€ä»¥çŽ°åœ¨ä½ å¯ä»¥é€‰æ‹©ç”¨ ca è¿˜æ˜¯ cryptogen æ¥ä¸ºç»„ç»‡ç”ŸæˆåŠ å¯†ææ–™ã€‚äº‹å®žä¸Šï¼ŒFabric æ ¹æœ¬ä¸å…³å¿ƒèº«ä»½/è¯ä¹¦æ¥è‡ªå“ªé‡Œã€‚å®ƒåªæ˜¯ä½¿ç”¨å®ƒä»¬è¿›è¡ŒéªŒè¯å’Œç­¾åã€‚

ç±»ä¼¼åœ°ï¼Œä½¿ç”¨ organisation æ–‡ä»¶å¤¹ä¸­çš„é…ç½®æ–‡ä»¶åˆ›å»º org2 å’Œ orderer çš„ä»£ç ä¹Ÿå‡ºçŽ°åœ¨åŒä¸€ä¸ªå‡½æ•°ä¸­ã€‚

ä¸‹ä¸€æ­¥ï¼ŒcreateConsortium å‡½æ•°å°†åœ¨è®¢è´­æ–¹ç³»ç»Ÿé€šé“ä¸­åˆ›å»ºä¸€ä¸ª genesis å—ã€‚

![](img/161a7c9b00b2704c3035b81ee0642b70.png)

è¿™å°±æ˜¯æˆ‘ä»¬åœ¨æ­¤é˜¶æ®µæ‰€éœ€è¦çš„æ‰€æœ‰å®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿›å…¥ä¸‹ä¸€æ­¥ï¼Œä¸º Org1 å’Œ Org2 ä¹‹é—´çš„äº‹åŠ¡åˆ›å»ºä¸€ä¸ªé€šé“ã€‚

**æ­¥éª¤ 2:åˆ›å»ºé¢‘é“**

network.sh ä¸­çš„ createChannel()å‡½æ•°å°†ä½¿ç”¨ä½äºŽ scripts æ–‡ä»¶å¤¹ä¸­çš„ createChannel.sh è„šæœ¬ã€‚

çœ‹çœ‹è¿™ä¸ªè„šæœ¬ï¼Œä½ ä¼šå‘çŽ°ï¼Œå®ƒæ‰§è¡Œå¿…è¦çš„ä»»åŠ¡ï¼Œæ¯”å¦‚æ›´æ–°é”šèŠ‚ç‚¹ï¼Œåˆ›å»ºé€šé“ï¼Œè®©èŠ‚ç‚¹åŠ å…¥é€šé“ã€‚

å› æ­¤ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å¯åŠ¨è¯¥å‡½æ•°:

> ã€‚/network.sh åˆ›å»ºé¢‘é“

å‘œå‘œï¼Œä½ ç¦»è€ƒç½‘ç»œåˆè¿‘äº†ä¸€æ­¥ã€‚

å¥½äº†ï¼Œæœ€åŽä¸€æ­¥æ˜¯åœ¨å¯¹åº”äºŽæ‚¨åˆšåˆšåˆ›å»ºçš„é€šé“çš„å¯¹ç­‰ä½“ä¸Šéƒ¨ç½²é“¾ç ã€‚

**ç¬¬ä¸‰æ­¥:éƒ¨ç½²é“¾ç **

> ã€‚/network.sh deployCC

æŸ¥çœ‹è„šæœ¬ deployCC.shï¼Œå®ƒåœ¨å¯¹ç­‰ä½“ä¸Šæ‰“åŒ…ã€å®‰è£…å’Œå®žä¾‹åŒ–é“¾ä»£ç ã€‚

æˆ‘ä»¬å°†åœ¨å•ç‹¬çš„åšå®¢ä¸­è®¨è®ºé“¾ç ç»“æž„ã€‚å¸Œæœ›æˆ‘èƒ½å°½å¿«å†™å‡ºæ¥ðŸ‘¯ã€‚

çŽ°åœ¨ï¼Œæ‚¨å¯ä»¥è‡ªç”±åœ°ä¸Žé“¾ç è¿›è¡Œäº¤äº’ã€‚ä½†æ˜¯â€¦

![](img/db6328d23d382e735b6fa93d2a680ddd.png)

ä»Ž Fabric v2.0 å¼€å§‹ï¼ŒDocker å®ˆæŠ¤ç¨‹åºä¾èµ–æ€§å·²ç»æ¶ˆé™¤ã€‚çŽ°åœ¨ï¼Œæ‚¨å¯ä»¥ç›´æŽ¥ä½¿ç”¨å¯¹ç­‰ CLI ä¸Žæ‚¨çš„ç½‘ç»œè¿›è¡Œäº¤äº’ã€‚

è¦é¦–å…ˆä¸Žå¯¹ç­‰ CLI äº¤äº’ï¼Œè¯·ç¡®ä¿:

1.  æ‚¨å·²ç»å¯¼å‡ºäº†åˆ° fabric äºŒè¿›åˆ¶æ–‡ä»¶çš„**è·¯å¾„ï¼Œæˆ‘æƒ³æˆ‘ä»¬å·²ç»åœ¨é¢„å¤‡æ­¥éª¤ä¸­ä»‹ç»è¿‡äº†ã€‚**
2.  å°†**è·¯å¾„å¯¼å‡ºåˆ° fabric-samples ä¸­çš„é…ç½®æ–‡ä»¶å¤¹**ã€‚

> å¯¼å‡º FABRIC _ CFG _ PATH = $ HOME/FABRIC-samples/config/

ä¹‹åŽï¼Œæ‚¨å°±å¯ä»¥å¼€å§‹äº†ï¼Œæ‚¨åªéœ€è¦å¯¼å‡º Org1 çš„çŽ¯å¢ƒå˜é‡ï¼Œå¦‚æžœæ‚¨æƒ³ä½¿ç”¨å®ƒçš„è¯ã€‚

> export CORE _ PEER _ TLS _ ENABLED = true
> export CORE _ PEER _ LOCALMSPID = " org 1 MSP "
> export CORE _ PEER _ TLS _ root cert _ FILE =ï¼„{ PWD }/organizations/PEER organizations/org 1 . example . com/peers/PEER 0 . org 1 . example . com/TLS/ca . CRT
> export[CORE _ PEER _ MSPCONFIGPATH =ï¼„{ PWD }/organizations/PEER organizations/org 1 . example . com/users/Admin @ org 1 . example](mailto:CORE_PEER_MSPCONFIGPATH=${PWD}/organizations/peerOrganizations/org1.example.com/users/Admin@org1.example.com)

ä¹‹åŽï¼Œæ‚¨å°±å¯ä»¥ä¸Žå®‰è£…åœ¨å¯¹ç­‰ä½“ä¸Šçš„é“¾ç è¿›è¡Œäº¤äº’äº†ã€‚

æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬è¯•è¯•**æŸ¥è¯¢å‘½ä»¤**:

> å¯¹ç­‰é“¾ä»£ç æŸ¥è¯¢-C my channel-n fab car-C ' { " Args ":[" query allcars "]} '

ç±»ä¼¼åœ°ï¼Œæ‚¨å¯ä»¥è°ƒç”¨ chaincode çš„å…¶ä»–æ–¹æ³•ã€‚

æ‚¨è¿˜å¯ä»¥é€šè¿‡ä¿®æ”¹ deployCC è„šæœ¬æ¥ä½¿ç”¨ fabric-samples çš„ chaincode æ–‡ä»¶å¤¹ä¸­çš„ä¸€äº›å…¶ä»– chaincodeï¼Œç”šè‡³å¯ä»¥åœ¨æµ‹è¯•ç½‘ç»œä¸Šæµ‹è¯•æ‚¨è‡ªå·±çš„ chaincodeã€‚

åº†ç¥ä¸€ä¸‹ï¼Œä½ çŽ°åœ¨æ„è¯†åˆ°ç®¡ç†ä¸€ä¸ª Hyperledger Fabric ç®€å•ç½‘ç»œï¼Œå¹¶å‚è€ƒè¿™ä¸ªæµ‹è¯•ç½‘ç»œï¼Œä½ å¯ä»¥è®¾è®¡è‡ªå·±çš„ç½‘ç»œï¼Œæ„Ÿè§‰è‡ªå·±åƒä¸€ä¸ªåŒºå—é“¾æž¶æž„å¸ˆã€‚

æ¬¢è¿Žåœ¨è¯„è®ºä¸­è®¨è®ºä½ åœ¨è®¾ç½®ç½‘ç»œæ—¶å¯èƒ½é‡åˆ°çš„ä¸€äº›é”™è¯¯ã€‚

æˆ‘è¦ç¦»å¼€æˆ‘çš„ bash.rc é‡è¦å¯¼å‡ºä»¥é˜²ä½ é”™è¿‡äº†ä»€ä¹ˆ:

> å¯¼å‡º GOPATH=$HOME/go
> å¯¼å‡ºè·¯å¾„= $ PATH:/usr/local/go/bin:$ GOPATH/bin
> å¯¼å‡ºè·¯å¾„= $ HOME/FABRIC-samples/bin:$ PATH
> å¯¼å‡ºè·¯å¾„=$PATH:$GOPATH/bin
> å¯¼å‡º FABRIC _ CFG _ PATH = $ HOME/FABRIC-samples/config/

å¦‚æžœè¿™ä¸ªåšå®¢èŠ‚çœäº†ä½ çš„æ—¶é—´ï¼Œåˆ«å¿˜äº†é¼“æŽŒðŸ‘ ðŸ‘ ðŸ‘

![](img/e7c148192ffcd68a14036b655eb90126.png)

å‚è€ƒèµ„æ–™:

[](https://hyperledger-fabric.readthedocs.io/en/release-2.1/) [## ç”¨äºŽä¼ä¸šçš„åŒºå—é“¾å¹³å°- hyperledger-fabricdocs ä¸»æ–‡æ¡£

### è¯·ç¡®ä¿æ‚¨æ­£åœ¨æŸ¥çœ‹çš„æ–‡æ¡£ä¸Žæ‚¨æ­£åœ¨ä½¿ç”¨çš„è½¯ä»¶ç‰ˆæœ¬ç›¸åŒ¹é…ã€‚è¯·å‚è§â€¦

hyperledger-fabric . readthedocs . io](https://hyperledger-fabric.readthedocs.io/en/release-2.1/) 

> [ç›´æŽ¥åœ¨æ‚¨çš„æ”¶ä»¶ç®±ä¸­èŽ·å¾—æœ€ä½³è½¯ä»¶äº¤æ˜“](https://coincodecap.com?utm_source=coinmonks)

[![](img/160ce73bd06d46c2250251e7d5969f9d.png)](https://coincodecap.com?utm_source=coinmonks)