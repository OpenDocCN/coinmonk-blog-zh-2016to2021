<html>
<head>
<title>Generating Certificates (Crypto Materials)using Certificate Authority in Hyperledger Fabric</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Hyperledger结构中的证书颁发机构生成证书(加密材料)</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/generating-certificates-crypto-materials-using-certificate-authority-in-hyperledger-fabric-b6ed8e82fe81?source=collection_archive---------0-----------------------#2020-01-11">https://medium.com/coinmonks/generating-certificates-crypto-materials-using-certificate-authority-in-hyperledger-fabric-b6ed8e82fe81?source=collection_archive---------0-----------------------#2020-01-11</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="ee3f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在这个故事中，我们将使用certificate authority为Hyperledger结构网络创建所有必要的证书。</p><p id="dc3c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">git Repo:<a class="ae jo" href="https://github.com/adhavpavan/GenerateCertificateUsingCA-HyperledgerFabric.git" rel="noopener ugc nofollow" target="_blank">https://github . com/adhavpavan/generate certificate using ca-hyperledger fabric . git</a></p><p id="26c8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用以下配置创建<code class="eh jp jq jr js b">docker-compose-ca.yaml</code>文件。</p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="fe ff jt"><img src="../Images/de1bff747edfc2ce4d12166a07860057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*duJxDK6OuOT1MrQQ_ZHkDg.png"/></div></div></figure><p id="4c49" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">创建一个文件夹结构如下，目前，我们没有任何组织文件夹内。</p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div class="fe ff kf"><img src="../Images/3b79f489438cc00e4759afb045fd1b10.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*2aRqxCVYPDNui1trI42DJg.png"/></div></figure><p id="38bb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们需要为每个组织创建一个如下所示的文件夹结构。</p><blockquote class="kg"><p id="7700" class="kh ki ht bd kj kk kl km kn ko kp jn ek translated"><a class="ae jo" href="https://coincodecap.com" rel="noopener ugc nofollow" target="_blank">发现并回顾最佳区块链软件</a></p></blockquote><p id="e5a9" class="pw-post-body-paragraph iq ir ht is b it kq iv iw ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn hm dt translated"><strong class="is hu">组织层级结构<br/> 1)同级组织</strong></p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div class="fe ff kv"><img src="../Images/a1df2b2522805991034938092f56be9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*cKn4nvAVU3csb1TGQveEug.png"/></div></figure><p id="8518" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2) <strong class="is hu">订购者组织</strong></p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div class="fe ff kw"><img src="../Images/31ae9a241b328ab6727e996f6af345b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*5LYVTPjN_am9fAwHNoEBNg.png"/></div></figure><p id="2d7a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">3) <strong class="is hu">用户结构</strong></p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div class="fe ff kx"><img src="../Images/29a5c0562b9c42434c3a83f0513826f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*CZs7fobNIIORF5EYTeHEng.png"/></div></figure><p id="56d7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> 4) MSP结构</strong></p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div class="fe ff ky"><img src="../Images/0e2570d6b08c766805f84996e90ff8a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*0iyNEeXMSOixdzXPfEykgw.png"/></div></figure><p id="0e7f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">通常，创建证书的过程是<br/> 1)注册<br/> 2)注册</p><p id="8be9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">注册是用户从给定的CA请求并获得数字证书的过程。注册通常由注册员完成，告诉CA发行数字证书。</p><ul class=""><li id="cad3" class="kz la ht is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh dt translated">一名<strong class="is hu">管理员</strong>(注册员)在CA中注册。然后<strong class="is hu">管理员</strong>接收该<strong class="is hu">管理员</strong>的签名密钥和证书。</li><li id="25da" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh dt translated">管理员然后用正确的信息将用户1注册到CA中。CA返回一个<strong class="is hu">秘密</strong>。</li><li id="6f5d" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh dt translated">然后，该密码用于将用户1注册到CA。结果是<strong class="is hu">用户1 </strong>的签名密钥和证书。</li></ul><p id="7e5e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们启动一个证书颁发机构服务。因为我们已经创造了<code class="eh jp jq jr js b">docker-compose-ca.yaml</code>。我们已经在<code class="eh jp jq jr js b">docker-compose</code>文件中绘制了卷。</p><p id="503b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">volumes:<br/> - ./organizations/fabric-ca/org1:/etc/hyperledger/fabric-ca-server</code></p><p id="d8e1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">提供了四个env变量。请确保您已经提供了所有这些信息。<br/> <code class="eh jp jq jr js b">- FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server<br/> - FABRIC_CA_SERVER_CA_NAME=ca-org1<br/> - FABRIC_CA_SERVER_TLS_ENABLED=true<br/> - FABRIC_CA_SERVER_PORT=7054</code></p><p id="7b56" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">运行以下命令</p><p id="8bda" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">docker compose -f docker-compose-cli up</code></p><p id="4f38" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当我们启动CA容器时，我们可以看到下面的详细日志。更多详情，请查看下面的日志。</p><figure class="ju jv jw jx fq jy"><div class="bz el l di"><div class="ln lo l"/></div></figure><p id="e7a0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">请通过运行<code class="eh jp jq jr js b">docker ps</code>确保ca容器正在运行，您可以看到ca服务的以下输出</p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="fe ff lp"><img src="../Images/91c423110870a7d7f317f4968d26b44c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2G70BCdHHRB-W7NmFtSt_w.png"/></div></div></figure><p id="95e4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当CA服务启动并运行时，我们可以在organization文件夹中看到下面的文件夹结构，我们已经在<code class="eh jp jq jr js b">docker-compose-ca.yaml</code>文件中映射了该结构</p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div class="fe ff lq"><img src="../Images/af6fdae78ae82719fe35e3718dbcd2c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*GWk6BwRIc1Ki9sQEoSbKhw.png"/></div></figure><p id="0e80" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">步骤1 </strong>:注册CA管理员<br/>运行下面的命令<br/> <code class="eh jp jq jr js b">mkdir -p organizations/peerOrganizations/org1.example.com/</code>创建目录</p><p id="a692" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">fabric-ca-client enroll -u <a class="ae jo" href="https://admin:adminpw@localhost:7054" rel="noopener ugc nofollow" target="_blank">https://admin:adminpw@localhost:7054</a> — caname ca-org1 — tls.certfiles ${PWD}/organizations/fabric-ca/org1/tls-cert.pem</code></p><p id="c4e2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">一旦我们注册了Admin，我们将获得以下管理MPS。请转到特定文件夹进行交叉检查。(在我的例子中，它是:/home/pavan/。结构-ca-客户端/msp)</p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="fe ff lr"><img src="../Images/eb7a16cc5e73b24d4ca43ebed2c7f90f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UuVXlJRw-cec9UGv6lXvBw.png"/></div></div></figure><h1 id="c279" class="ls lt ht bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp dt translated">组织单位</h1><p id="1389" class="pw-post-body-paragraph iq ir ht is b it mq iv iw ix mr iz ja jb ms jd je jf mt jh ji jj mu jl jm jn hm dt translated">为了配置该MSP的有效成员应该在其X.509证书中包含的组织单元列表，<code class="eh jp jq jr js b">config.yaml</code>文件需要指定组织单元(简称OU)标识符。你可以在下面找到一个例子:</p><pre class="ju jv jw jx fq mv js mw mx aw my dt"><span id="6969" class="mz lt ht js b fv na nb l nc nd">OrganizationalUnitIdentifiers:<br/>  <strong class="js hu">-</strong> Certificate: "cacerts/cacert1.pem"<br/>    OrganizationalUnitIdentifier: "commercial"<br/>  <strong class="js hu">-</strong> Certificate: "cacerts/cacert2.pem"<br/>    OrganizationalUnitIdentifier: "administrators"</span></pre><p id="01d2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">上面的例子声明了两个组织单位标识符:<strong class="is hu">商业</strong>和<strong class="is hu">管理员</strong>。如果MSP标识至少带有这些组织单位标识符中的一个，则它是有效的。<code class="eh jp jq jr js b">Certificate</code>字段指的是CA或中间CA证书路径，在该路径下，应该验证具有特定OU的身份。该路径相对于MSP根文件夹，不能为空。</p><h1 id="03eb" class="ls lt ht bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp dt translated">身份分类</h1><p id="1190" class="pw-post-body-paragraph iq ir ht is b it mq iv iw ix mr iz ja jb ms jd je jf mt jh ji jj mu jl jm jn hm dt translated">默认的MSP实现允许组织根据x509证书的ou将身份进一步分类为客户端、管理员、对等用户和订购者。</p><ul class=""><li id="b8d8" class="kz la ht is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh dt translated">如果一个身份在网络上进行交易，它应该被归类为<strong class="is hu">客户端</strong>。</li><li id="66f2" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh dt translated">如果某个身份处理管理任务，如将对等体加入通道或签署通道配置更新事务，则该身份应归类为<strong class="is hu">管理员</strong>。</li><li id="b69d" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh dt translated">如果一个身份签署或提交事务，它应该被分类为<strong class="is hu">对等体</strong>。</li><li id="85bc" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh dt translated">如果一个身份属于一个排序节点，它应该被分类为一个<strong class="is hu">排序者</strong>。</li></ul><p id="852e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了定义给定MSP的客户机、管理员、对等机和订购者，需要适当地设置文件的<code class="eh jp jq jr js b">config.yaml</code>。您可以在下面的<code class="eh jp jq jr js b">config.yaml</code>文件中找到一个示例NodeOU部分:</p><pre class="ju jv jw jx fq mv js mw mx aw my dt"><span id="1a17" class="mz lt ht js b fv na nb l nc nd">NodeOUs:<br/>  Enable: true<br/>  ClientOUIdentifier:<br/>    Certificate: "cacerts/cacert.pem"<br/>    OrganizationalUnitIdentifier: "client"<br/>  AdminOUIdentifier:<br/>    Certificate: "cacerts/cacert.pem"<br/>    OrganizationalUnitIdentifier: "admin"<br/>  PeerOUIdentifier:<br/>    Certificate: "cacerts/cacert.pem"<br/>    OrganizationalUnitIdentifier: "peer"<br/>  OrdererOUIdentifier:<br/>    Certificate: "cacerts/cacert.pem"<br/>    OrganizationalUnitIdentifier: "orderer"</span></pre><p id="b135" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当<code class="eh jp jq jr js b">NodeOUs.Enable</code>设置为<code class="eh jp jq jr js b">true</code>时，身份分类启用。然后，通过设置<code class="eh jp jq jr js b">NodeOUs.ClientOUIdentifier</code> ( <code class="eh jp jq jr js b">NodeOUs.AdminOUIdentifier</code>、<code class="eh jp jq jr js b">NodeOUs.PeerOUIdentifier</code>、<code class="eh jp jq jr js b">NodeOUs.OrdererOUIdentifier</code>)键的属性来定义客户端(管理、对等、订购方)组织单位标识符:</p><ol class=""><li id="0cdf" class="kz la ht is b it iu ix iy jb lb jf lc jj ld jn ne lf lg lh dt translated"><code class="eh jp jq jr js b">OrganizationalUnitIdentifier</code>:x509证书需要包含的OU值，它被认为是一个客户端(分别为admin、peer、orderer)。如果此字段为空，则分类不适用。</li><li id="339e" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn ne lf lg lh dt translated"><code class="eh jp jq jr js b">Certificate</code>:将此设置为CA或中间CA证书的路径，在该路径下应验证客户端(对等、管理员或订购者)身份。该字段相对于MSP根文件夹。该字段是可选的。您可以将此字段留空，并允许在MSP配置中定义的任何CA下验证证书。</li></ol><p id="fd6f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">注意，如果<code class="eh jp jq jr js b">NodeOUs.ClientOUIdentifier</code>部分(<code class="eh jp jq jr js b">NodeOUs.AdminOUIdentifier</code>、<code class="eh jp jq jr js b">NodeOUs.PeerOUIdentifier</code>、<code class="eh jp jq jr js b">NodeOUs.OrdererOUIdentifier</code>)缺失，则分类不适用。如果<code class="eh jp jq jr js b">NodeOUs.Enable</code>设置为<code class="eh jp jq jr js b">true</code>并且没有定义分类关键字，则认为身份分类被禁用。</p><p id="70b3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">身份可以使用组织单位来分类为客户、管理员、同事或订购者。这四种分类是相互排斥的。在将身份分类为客户端或对等体之前，需要启用1.1通道功能。要将身份分类为管理员或订购者，需要启用1.4.3通道功能。</p><p id="e9da" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">分类允许将身份归类为管理员(并执行管理员操作)，而无需将证书存储在MSP的<code class="eh jp jq jr js b">admincerts</code>文件夹中。相反，<code class="eh jp jq jr js b">admincerts</code>文件夹可以保持为空，可以通过向管理员OU注册身份来创建管理员。文件夹<code class="eh jp jq jr js b">admincerts</code>中的证书仍然将管理员的角色授予其持有者，只要他们拥有客户端或管理员OU。</p><p id="36ef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">注:以上部分摘自官方文件，以了解更多详情。</p><p id="ebce" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们必须在<code class="eh jp jq jr js b">organizations/peerOrganizations/org1.example.com/msp/config.yaml</code>创建config.yaml文件，并删除下面的代码。</p><pre class="ju jv jw jx fq mv js mw mx aw my dt"><span id="6557" class="mz lt ht js b fv na nb l nc nd">NodeOUs:<br/>  Enable: true<br/>  ClientOUIdentifier:<br/>    Certificate: "cacerts/cacert.pem"<br/>    OrganizationalUnitIdentifier: "client"<br/>  AdminOUIdentifier:<br/>    Certificate: "cacerts/cacert.pem"<br/>    OrganizationalUnitIdentifier: "admin"<br/>  PeerOUIdentifier:<br/>    Certificate: "cacerts/cacert.pem"<br/>    OrganizationalUnitIdentifier: "peer"<br/>  OrdererOUIdentifier:<br/>    Certificate: "cacerts/cacert.pem"<br/>    OrganizationalUnitIdentifier: "orderer" </span></pre><p id="db56" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤2:注册peer0</p><p id="172d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">fabric-ca-client register — caname ca-org1 — id.name peer0 — id.secret peer0pw — id.type peer — id.attrs ‘“hf.Registrar.Roles=peer”’ — tls.certfiles ${PWD}/organizations/fabric-ca/org1/tls-cert.pem</code></p><p id="6bc6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在每个步骤中，请确保生成必要的证书。当我们运行这些命令时，我们可以在terminal/shell/cmd行看到生成的文件位置。</p><p id="fc10" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤3:注册用户</p><p id="e214" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">fabric-ca-client register — caname ca-org1 — id.name user1 — id.secret user1pw — id.type client — id.attrs ‘“hf.Registrar.Roles=client”’ — tls.certfiles ${PWD}/organizations/fabric-ca/org1/tls-cert.pem</code></p><p id="d004" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤3:注册组织管理员</p><p id="b7a6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">fabric-ca-client register — caname ca-org1 — id.name org1admin — id.secret org1adminpw — id.type admin — id.attrs ‘“hf.Registrar.Roles=admin”’ — tls.certfiles ${PWD}/organizations/fabric-ca/org1/tls-cert.pem</code></p><p id="d578" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤4:创建以下目录</p><p id="e000" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">mkdir -p organizations/peerOrganizations/org1.example.com/peers</code></p><p id="8a7e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">mkdir -p organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com</code></p><p id="5a21" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤5:生成peer0 MSP</p><p id="2334" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">fabric-ca-client enroll -u <a class="ae jo" href="https://peer0:peer0pw@localhost:7054" rel="noopener ugc nofollow" target="_blank">https://peer0:peer0pw@localhost:7054</a> — caname ca-org1 -M ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/msp — csr.hosts peer0.org1.example.com — tls.certfiles ${PWD}/organizations/fabric-ca/org1/tls-cert.pem</code></p><p id="4352" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤6:将配置文件复制到新生成的对等MSP文件夹中</p><p id="6036" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">cp ${PWD}/organizations/peerOrganizations/org1.example.com/msp/config.yaml ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/msp/config.yaml</code></p><p id="47dc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤7:生成peer0-tls证书</p><p id="3581" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">fabric-ca-client enroll -u <a class="ae jo" href="https://peer0:peer0pw@localhost:7054" rel="noopener ugc nofollow" target="_blank">https://peer0:peer0pw@localhost:7054</a> — caname ca-org1 -M ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls — enrollment.profile tls — csr.hosts peer0.org1.example.com — csr.hosts localhost — tls.certfiles ${PWD}/organizations/fabric-ca/org1/tls-cert.pem</code></p><p id="f4d2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">无论<code class="eh jp jq jr js b">tlscerts, signcerts,keystore </code>创造了什么，我们都必须像下面这样移动tls</p><p id="e743" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">cp ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/tlscacerts/* ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt</code></p><p id="7144" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">cp ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/signcerts/* ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/server.crt</code></p><p id="a40f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">cp ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/keystore/* ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/server.key</code></p><p id="0b75" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">mkdir ${PWD}/organizations/peerOrganizations/org1.example.com/msp/tlscacerts</code></p><p id="b949" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">cp ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/tlscacerts/* ${PWD}/organizations/peerOrganizations/org1.example.com/msp/tlscacerts/ca.crt</code></p><p id="b848" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">mkdir ${PWD}/organizations/peerOrganizations/org1.example.com/tlsca</code></p><p id="0bb8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">cp ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/tlscacerts/* ${PWD}/organizations/peerOrganizations/org1.example.com/tlsca/tlsca.org1.example.com-cert.pem</code></p><p id="9994" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">mkdir ${PWD}/organizations/peerOrganizations/org1.example.com/ca</code></p><p id="7f1c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">cp ${PWD}/organizations/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/msp/cacerts/* ${PWD}/organizations/peerOrganizations/org1.example.com/ca/ca.org1.example.com-cert.pem</code></p><p id="00d4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤8:生成用户证书</p><p id="6ba6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">创建以下目录。</p><p id="f36f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">mkdir -p organizations/peerOrganizations/org1.example.com/users</code></p><p id="af07" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">mkdir -p organizations/peerOrganizations/org1.example.com/users/User1@org1.example.com</code></p><p id="3f9e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤9:生成用户MSP</p><p id="6c23" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">fabric-ca-client enroll -u <a class="ae jo" href="https://user1:user1pw@localhost:7054" rel="noopener ugc nofollow" target="_blank">https://user1:user1pw@localhost:7054</a> — caname ca-org1 -M ${PWD}/organizations/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp — tls.certfiles ${PWD}/organizations/fabric-ca/org1/tls-cert.pem</code></p><p id="ebc3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">第10步:管理员用户</p><p id="194d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">mkdir -p organizations/peerOrganizations/org1.example.com/users/Admin@org1.example.com</code></p><p id="932c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤11:生成组织管理MSP</p><p id="1751" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">fabric-ca-client enroll -u <a class="ae jo" href="https://org1admin:org1adminpw@localhost:7054" rel="noopener ugc nofollow" target="_blank">https://org1admin:org1adminpw@localhost:7054</a> — caname ca-org1 -M ${PWD}/organizations/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp — tls.certfiles ${PWD}/organizations/fabric-ca/org1/tls-cert.pem</code></p><p id="55f6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">步骤12:将<code class="eh jp jq jr js b">config.yaml</code>文件复制到新创建的MSP文件夹中</p><p id="97fe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh jp jq jr js b">cp ${PWD}/organizations/peerOrganizations/org1.example.com/msp/config.yaml ${PWD}/organizations/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp/config.yaml</code></p><p id="7e42" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是为org1创建加密材料的过程，您也可以为Org2和订购者遵循相同的过程。</p><blockquote class="kg"><p id="d3b7" class="kh ki ht bd kj kk kl km kn ko kp jn ek translated"><a class="ae jo" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="ng nh ni nj nk jy fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nf"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>