<html>
<head>
<title>DApp’s pipeline (IPFS + ENS)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DApp的管道(IPFS + ENS)</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/dapps-pipeline-ipfs-ens-cbb4f2de15c2?source=collection_archive---------3-----------------------#2020-03-10">https://medium.com/coinmonks/dapps-pipeline-ipfs-ens-cbb4f2de15c2?source=collection_archive---------3-----------------------#2020-03-10</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/7428067ebae947d75ffb23b16b9c934c.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/format:webp/1*PVNziI1vKjIvWUrfXoge8A.png"/></div></figure><p id="db98" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">很多<a class="ae jv" href="https://en.wikipedia.org/wiki/Decentralized_application" rel="noopener ugc nofollow" target="_blank">dapp</a>都是开源的，大部分托管在GitHub(我的假设)。这就是为什么拥有合适的工具来交付<a class="ae jv" href="https://blog.coincodecap.com/tag/dapps/" rel="noopener ugc nofollow" target="_blank">dapp</a>是很重要的。</p><p id="4559" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在这篇文章中，我将介绍当您需要将一个<a class="ae jv" href="https://blog.coincodecap.com/tag/dapps/" rel="noopener ugc nofollow" target="_blank"> DApp </a>部署到IPFS并更新DApp的ENS名称时的设置。</p><figure class="jx jy jz ka fq iu fe ff paragraph-image"><div class="fe ff jw"><img src="../Images/68883e038a991f2c57a733c59b0430ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*BOuyaNmdJWIEsCuxtUlk3w.png"/></div></figure><h1 id="3ea2" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">工具</h1><ol class=""><li id="c9e0" class="kz la ht iz b ja lb je lc ji ld jm le jq lf ju lg lh li lj dt translated"><a class="ae jv" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hu"> GitHub动作</strong> </a> <strong class="iz hu">。</strong>因为GitHub引入了动作，所以只需要一次提交就可以为DApp创建一个管道。您不再需要为此使用第三方服务。</li><li id="419c" class="kz la ht iz b ja lk je ll ji lm jm ln jq lo ju lg lh li lj dt translated"><a class="ae jv" href="https://en.wikipedia.org/wiki/InterPlanetary_File_System" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hu">星际文件系统</strong> ( <strong class="iz hu"> IPFS </strong> ) </a>是在分布式文件系统中存储和共享数据的协议和对等网络。IPFS使用内容寻址来唯一标识连接所有计算设备的全局命名空间中的每个文件。</li><li id="50d0" class="kz la ht iz b ja lk je ll ji lm jm ln jq lo ju lg lh li lj dt translated"><a class="ae jv" href="https://docs.ens.domains/" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hu">以太坊名称服务(ENS) </strong> </a>，基于<a class="ae jv" href="https://blog.coincodecap.com/tag/ethereum/" rel="noopener ugc nofollow" target="_blank">以太坊</a> <a class="ae jv" href="https://blog.coincodecap.com/tag/blockchain/" rel="noopener ugc nofollow" target="_blank">区块链</a>的分布式、开放、可扩展的命名系统。它将人类可读的名称如<code class="eh lp lq lr ls b">alice.eth</code>映射到机器可读的标识符，如以太坊地址、内容散列和元数据。</li></ol><h1 id="43f2" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">预备</h1><ol class=""><li id="d23c" class="kz la ht iz b ja lb je lc ji ld jm le jq lf ju lg lh li lj dt translated">GitHub仓库中有一个<a class="ae jv" href="https://blog.coincodecap.com/tag/dapps/" rel="noopener ugc nofollow" target="_blank"> DApp </a>。</li><li id="54ac" class="kz la ht iz b ja lk je ll ji lm jm ln jq lo ju lg lh li lj dt translated">ENS名称。看看这个<a class="ae jv" rel="noopener" href="/the-ethereum-name-service/step-by-step-guide-to-registering-a-eth-name-on-the-new-ens-registrar-c07d3ab9d6a6">一步一步的教程</a>就知道了。<strong class="iz hu">注</strong>:ENS名称应该被配置，它应该有一个解析器。</li></ol><h1 id="8406" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">设置</h1><ul class=""><li id="08ec" class="kz la ht iz b ja lb je lc ji ld jm le jq lf ju lt lh li lj dt translated">打开GitHub资源库-&gt;操作-&gt; T2<code class="eh lp lq lr ls b">New Workflow</code>-&gt;</li></ul><figure class="jx jy jz ka fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff lu"><img src="../Images/c0c49c0dd6aa8e297655456c72e09e51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HEbT4J2cRpdYRVrI2pvqZQ.png"/></div></div></figure><ul class=""><li id="3a02" class="kz la ht iz b ja jb je jf ji lz jm ma jq mb ju lt lh li lj dt translated">修改<code class="eh lp lq lr ls b">main.yml</code>文件:</li></ul><p id="7cdb" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">定义管道的触发器(例如，仅在<code class="eh lp lq lr ls b">master</code>分支上)</p><pre class="jx jy jz ka fq mc ls md me aw mf dt"><span id="9841" class="mg kc ht ls b fv mh mi l mj mk">on:<br/>  push:<br/>    branches:<br/>    - master</span></pre><p id="cbd5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">离开作业和运行环境的定义:</p><pre class="jx jy jz ka fq mc ls md me aw mf dt"><span id="d010" class="mg kc ht ls b fv mh mi l mj mk">jobs:<br/>  build:<br/>    runs-on: ubuntu-latest</span></pre><p id="4e5e" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">定义准备步骤:</p><pre class="jx jy jz ka fq mc ls md me aw mf dt"><span id="57de" class="mg kc ht ls b fv mh mi l mj mk">steps:<br/>  - uses: actions/checkout@v2</span><span id="301f" class="mg kc ht ls b fv ml mi l mj mk">- name: Setup Node<br/>    uses: actions/setup-node@v1<br/>    with:<br/>      node-version: '10.x'</span><span id="d4cf" class="mg kc ht ls b fv ml mi l mj mk">  - run: npm ci</span><span id="7103" class="mg kc ht ls b fv ml mi l mj mk">- run: npm run build</span></pre><p id="fe0c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在这些步骤之后，在一个运行器上将会有一个构建工件(通常在目录<code class="eh lp lq lr ls b">build</code>或者<code class="eh lp lq lr ls b">dist</code>中)。现在，您可以定义上传到IPFS的步骤。</p><p id="1ae1" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">市场<a class="ae jv" href="https://github.com/marketplace/actions/upload-to-ipfs" rel="noopener ugc nofollow" target="_blank">https://github.com/marketplace/actions/upload-to-ipfs</a>上有一个自定义的上传到IPFS的操作</p><p id="6657" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">为了使用它，你需要添加步骤到<code class="eh lp lq lr ls b">main.yml</code></p><pre class="jx jy jz ka fq mc ls md me aw mf dt"><span id="a8b8" class="mg kc ht ls b fv mh mi l mj mk">- uses: aquiladev/ipfs-action@v0.1.1<br/>  id: upload<br/>  with:<br/>    path: ./build</span></pre><p id="e298" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">该步骤将有输出<code class="eh lp lq lr ls b">hash</code>——这是以后需要使用的。为了使用它，您需要添加一个令牌<code class="eh lp lq lr ls b">${{ steps.upload.outputs.hash }}</code>，其中<code class="eh lp lq lr ls b">upload</code>是步骤的id。</p><p id="60be" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">最后一步是ENS更新。在市场<a class="ae jv" href="https://github.com/marketplace/actions/update-ddns" rel="noopener ugc nofollow" target="_blank">https://github.com/marketplace/actions/upload-to-ipfs</a>上有一个自定义操作</p><pre class="jx jy jz ka fq mc ls md me aw mf dt"><span id="aa41" class="mg kc ht ls b fv mh mi l mj mk">- uses: aquiladev/ddns-action@v0.1.1<br/>  with:<br/>    mnemonic: ${{ secrets.MNEMONIC }}<br/>    rpc: ${{ secrets.RPC }}<br/>    name: ddns-action.eth<br/>    contentHash: ${{ steps.upload.outputs.hash }}</span></pre><p id="fbf5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">在<strong class="iz hu">名称</strong>参数中拥有ENS名称的账户的钱包恢复需要助记符</strong>短语。它也可以是帐户的私钥。<strong class="iz hu"> Rpc </strong>是<a class="ae jv" href="https://blog.coincodecap.com/tag/ethereum/" rel="noopener ugc nofollow" target="_blank">以太坊</a> Mainnet节点的URL。</p><p id="7df1" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这一步需要助记符<strong class="iz hu"> </strong>和RPC秘笈。您需要将秘密添加到您的存储库中。为此，打开设置- &gt;秘密，然后添加那些。</p><figure class="jx jy jz ka fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mm"><img src="../Images/3bf8ea6f3f8713645ab5e08eb606963c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SzzoeRke5n1aOTn6iQjvdw.png"/></div></div></figure><p id="3ae9" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">你的<code class="eh lp lq lr ls b">main.yml</code>准备好了。它应该看起来像:</p><pre class="jx jy jz ka fq mc ls md me aw mf dt"><span id="85b9" class="mg kc ht ls b fv mh mi l mj mk">name: CI</span><span id="1a1f" class="mg kc ht ls b fv ml mi l mj mk">on:<br/>  push:<br/>    branches:<br/>    - master</span><span id="cb4a" class="mg kc ht ls b fv ml mi l mj mk">jobs:<br/>  build:</span><span id="b728" class="mg kc ht ls b fv ml mi l mj mk">runs-on: ubuntu-latest</span><span id="5190" class="mg kc ht ls b fv ml mi l mj mk">steps:<br/>    - uses: actions/checkout@v2<br/>  <br/>    - name: Setup Node<br/>      uses: actions/setup-node@v1<br/>      with:<br/>        node-version: '10.x'</span><span id="2d67" class="mg kc ht ls b fv ml mi l mj mk">- run: npm ci</span><span id="4b6e" class="mg kc ht ls b fv ml mi l mj mk">- run: npm run build<br/>    <br/>    - name: Upload to IPFS<br/>      uses: aquiladev/ipfs-action@v0.1.2-alpha<br/>      id: upload<br/>      with:<br/>        path: ./build<br/>    <br/>    - name: Update ENS<br/>      uses: aquiladev/ddns-action@v0.1.1<br/>      with:<br/>        mnemonic: ${{ secrets.MNEMONIC }}<br/>        rpc: ${{ secrets.RPC }}<br/>        name: ddns-action.eth<br/>        contentHash: ${{ steps.upload.outputs.hash }}</span></pre><p id="743c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">然后你需要按下<code class="eh lp lq lr ls b">Start commit</code>按钮提交你的<code class="eh lp lq lr ls b">main.yml</code>。</p><p id="e172" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">管道将立即运行(如果您提交到主分支)</p><figure class="jx jy jz ka fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mn"><img src="../Images/841bc2f9d82f8b5e6c9e456f9c9cf46f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VUV3o8XQE5CAgYiUbSLhkA.png"/></div></div></figure><p id="6196" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">您可以打开所有管线并检查输出</p><figure class="jx jy jz ka fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mm"><img src="../Images/9833e325d3774b69caea71ef616fdd52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WoDesBy04WXR9BNe_Dtncw.png"/></div></div></figure><p id="ef43" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">也可以生成badge并将其放入README中</p><figure class="jx jy jz ka fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mo"><img src="../Images/505f08e96a492b923b8951b299c96e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OFDyOMFruqc1hD6xlT28Gw.png"/></div></div></figure><h1 id="b465" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">检查结果</h1><p id="445b" class="pw-post-body-paragraph ix iy ht iz b ja lb jc jd je lc jg jh ji mp jk jl jm mq jo jp jq mr js jt ju hm dt translated">成功运行后，您将能够访问更新后的DApp，但IPFS方面需要一些时间来解析新上传的内容。</p><p id="7c55" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">为了在ENS中检查更新IPFS哈希，你可以打开<a class="ae jv" href="https://app.ens.domains/" rel="noopener ugc nofollow" target="_blank">https://app . ENS . domains</a></p><figure class="jx jy jz ka fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff ms"><img src="../Images/49e6e3dfa52685f421829c998b1fff95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2VMwiKuKGCv_gmNuqSiDvQ.png"/></div></div></figure><p id="d266" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">最后，用<a class="ae jv" href="http://eth.link/" rel="noopener ugc nofollow" target="_blank"> http://eth.link </a>访问你的DApp</p><figure class="jx jy jz ka fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="fe ff mt"><img src="../Images/5a0f4fe2f60111857336ec83faf5fb14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WIO1N_rycP1e58vWCET4Zw.png"/></div></div></figure><blockquote class="mu"><p id="32ba" class="mv mw ht bd mx my mz na nb nc nd ju ek translated"><a class="ae jv" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="nf ng nh ni nj iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff ne"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>