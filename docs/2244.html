<html>
<head>
<title>Demystifying Hyperledger Fabric (3/3): Network Traffic Handling, Service Discovery, and Operations Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">揭开Hyperledger结构的神秘面纱(3/3):网络流量处理、服务发现和运营服务</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/demystifying-hyperledger-fabric-3-3-network-traffic-handling-service-discovery-and-operations-f9a2046b4067?source=collection_archive---------0-----------------------#2019-06-04">https://medium.com/coinmonks/demystifying-hyperledger-fabric-3-3-network-traffic-handling-service-discovery-and-operations-f9a2046b4067?source=collection_archive---------0-----------------------#2019-06-04</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/a987cba6934a320f70c732e9712643ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aQZbuJ-OGIjfKsX8vzZatQ.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek"><a class="ae jf" href="https://www.hyperledger.org/projects/fabric" rel="noopener ugc nofollow" target="_blank">www.hyperledger.org/projects/fabric</a></figcaption></figure><p id="5782" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="ke">最初发表于</em><a class="ae jf" href="https://www.serial-coder.com/post/demystifying-hyperledger-fabric-network-traffic-handling-service-discovery-and-operations-service/" rel="noopener ugc nofollow" target="_blank"><em class="ke">【www.serial-coder.com】</em></a><em class="ke">。</em></p><p id="083b" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">欢迎来到第三篇文章，这是<strong class="ji hu"> <em class="ke">揭开Hyperledger织物系列</em> </strong>的最后一篇文章。在<a class="ae jf" rel="noopener" href="/p/a2fdb587f6cb">第一篇文章</a>中，已经解释了<em class="ke">Hyperledger Fabric</em>的底层架构。第二篇文章描述了名为<em class="ke">私有数据收集</em>的Fabric的一个重要特性。</p><p id="6968" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我想用这篇文章来讨论Hyperledger结构中的一些辅助服务，包括以下主题:<strong class="ji hu"><em class="ke"/></strong><strong class="ji hu"><em class="ke">服务发现</em></strong><strong class="ji hu"><em class="ke">运营服务</em> </strong>。</p><p id="4c98" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">本文的其余部分组织如下:</p><ul class=""><li id="0ff9" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/p/f9a2046b4067#31bb">网络流量处理</a></li><li id="b739" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/p/f9a2046b4067#1714">服务发现</a></li><li id="9541" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/p/f9a2046b4067#a74f">运营服务</a></li><li id="ddf0" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/p/f9a2046b4067#05db">运营指标:基于普罗米修斯的拉动式模型</a></li><li id="5dab" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/p/f9a2046b4067#ef55">运营指标:基于StatsD的推送模型</a></li><li id="84e4" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/p/f9a2046b4067#1491">关闭系列电源</a></li></ul></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><p id="31bb" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">网络流量处理</strong></p><p id="9936" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">网络流量拥塞可能是结构信道上最潜在的问题之一，因为有多个参与组织加入该信道。此外，每个组织可以拥有多个对等体。让我们想象一下，如果参与组织和相关对等体的数量随着时间的推移而增加，那么<strong class="ji hu"> <em class="ke">订购者</em> </strong>将会不堪重负地向每个通道上的每个对等体分发事务块。因此，<strong class="ji hu"> <em class="ke">订购方</em> </strong>很容易出现单点故障。</p><p id="09f1" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了提供<em class="ke">崩溃容错(CFT) </em>到<strong class="ji hu"> <em class="ke">订购者</em> </strong>，Hyperledger Fabric目前支持<em class="ke"> CFT订购服务</em>的两个实现，即<strong class="ji hu"> <em class="ke"> Kafka </em> </strong>和<strong class="ji hu"> <em class="ke"> Raft </em> </strong>。此外，几种类型的<em class="ke">拜占庭容错(BFT)订购服务</em>也正在开发中<em class="ke">。</em>更多信息请参考<a class="ae jf" rel="noopener" href="/p/a2fdb587f6cb#208b">此链接</a>。</p><p id="071f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">除了减轻<strong class="ji hu"> <em class="ke">排序者</em></strong><strong class="ji hu"><em class="ke">的块分配开销外，还向所有参与组织介绍了</em> </strong>的领先同行。每个组织可以选择性地授权哪些对等体为<strong class="ji hu"> <em class="ke">领导对等体</em> </strong>。如下图1所示，<strong class="ji hu"> <em class="ke"> Org1 </em> </strong>的<em class="ke">同行2号</em>和<strong class="ji hu"> <em class="ke"> Org2 </em> </strong>的<em class="ke">同行2号</em>被指定为<strong class="ji hu"> <em class="ke">领导同行</em> </strong>。</p><figure class="lb lc ld le fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff la"><img src="../Images/8f145b6a2cff05391204ee4d0132847f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppqzMLJ3_tD1WjFtObdTyQ.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek"><strong class="bd lf">Figure 1. Fabric block dissemination scheme using Leading Peers</strong></figcaption></figure><p id="d6f5" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">使用<strong class="ji hu"> <em class="ke">领先对等</em> </strong>的Fabric block分发方案的分步工作流程如图1所示:</p><ol class=""><li id="1308" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke">客户端</em> </strong>向所选择的<strong class="ji hu"> <em class="ke">背书对等体</em> </strong>发送交易提议。</li><li id="b7f3" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated">每个<strong class="ji hu"> <em class="ke">背书对等体</em> </strong>生成交易响应，并将背书响应发送回<strong class="ji hu"> <em class="ke">客户端</em> </strong>。</li><li id="675e" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke">客户</em> </strong>向<strong class="ji hu"> <em class="ke">订单方</em> </strong>提交附有背书回复的交易。</li><li id="8f77" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke">排序器</em> </strong>创建一个有序事务块，并依次将所创建的块分发给与组织相关联的每个<strong class="ji hu"><em class="ke"/></strong>。</li><li id="efe1" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated">每个<strong class="ji hu"> <em class="ke">领导对等体</em> </strong>通过<em class="ke">八卦数据传播协议</em>将接收到的块传播给属于同一组织的<strong class="ji hu"> <em class="ke">其他对等体</em> </strong>。</li></ol><p id="6a0e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">之前讨论的<em class="ke"> Fabric block分发方案</em>可以显著降低<strong class="ji hu"> <em class="ke">订购方</em> </strong>的开销。因此，该方案对于Hyperledger Fabric是必要的。每个组织可以静态地定义哪些对等体是<strong class="ji hu"> <em class="ke">领导对等体</em> </strong>。然而，在没有静态指定的对等体的情况下，Fabric系统还具有自动运行的动态主导对等体选择算法。</p></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><p id="1714" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">服务发现</strong></p><p id="1b7d" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了调用一个事务来改变分类帐的状态，一个<strong class="ji hu"> <em class="ke">客户应用</em> </strong>必须知道一组<strong class="ji hu"> <em class="ke">签署对等体</em> </strong>需要签署一个事务提议。在Fabric 1.2版之前，此信息被静态编码到特定通道的Fabric系统链码中。</p><p id="f06c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">然而，这种静态配置不能适应网络变化。例如，当一个新的组织加入一个渠道或当一个链码认可政策发生变化。而且静态配置也不灵活，万一有<strong class="ji hu"> <em class="ke">背书的同行</em> </strong>暂时下线。</p><p id="2ee9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在Fabric版本1.2中，引入了<strong class="ji hu"> <em class="ke">发现服务</em> </strong>，以便于<strong class="ji hu"> <em class="ke">客户端应用</em> </strong>发现成员资格和认可配置、所有活动对等体以及其他可用服务。请参考<a class="ae jf" href="https://hyperledger-fabric.readthedocs.io/en/latest/discovery-overview.html#capabilities-of-the-discovery-service" rel="noopener ugc nofollow" target="_blank">此链接</a>以了解<strong class="ji hu"> <em class="ke">发现服务</em> </strong>的功能。<strong class="ji hu"> <em class="ke">发现服务</em> </strong>以<strong class="ji hu"> <em class="ke"> Fabric SDK </em> </strong>的形式提供API接口，供客户端向属于同一组织的对等体查询所需的信息(例如，列出一个通道上所有活动的对等体)。反过来，被查询的对等体动态地计算所需的信息，并将可消费的信息返回给客户端。</p><figure class="lb lc ld le fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lh"><img src="../Images/7b9609ef24ccd23a4cc8240c6733451d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l3-KfQ6gv6YV8SSxx3jPoA.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek"><strong class="bd lf">Figure 2. Peer discovery with the support of Anchor Peers</strong></figcaption></figure><p id="ac20" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了让<strong class="ji hu"> <em class="ke">发现服务</em> </strong>高效工作，必须为每个组织配置一种特殊类型的结构对等点<strong class="ji hu"> <em class="ke">锚对等点</em> </strong>。<strong class="ji hu"> <em class="ke">主播对等点</em> </strong>的主要作用之一就是对等点发现。更具体地说，所有<strong class="ji hu"> <em class="ke">对等体</em> </strong>都可以查询属于同一组织的<strong class="ji hu"> <em class="ke">锚对等体</em> </strong>来动态发现一个频道上属于其他组织的所有<strong class="ji hu"> <em class="ke">其他对等体</em> </strong>。为了防止单点故障，一个组织可以有多个<strong class="ji hu"> <em class="ke">锚定对等</em> </strong>。如图2所示，<strong class="ji hu"> <em class="ke"> Org1 </em> </strong>的<em class="ke">同行2号</em>和<strong class="ji hu"> <em class="ke"> Org2 </em> </strong>的<em class="ke">同行2号</em>配置为<strong class="ji hu"> <em class="ke">锚同行</em> </strong>。</p><p id="ed20" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在<strong class="ji hu"> <em class="ke">锚对等体</em> </strong>的支持下，对等体发现的逐步工作流程如图2所示:</p><ol class=""><li id="c69d" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke">普通对等体</em> </strong>通过<em class="ke">八卦协议</em>与属于同一组织的<strong class="ji hu"> <em class="ke">锚对等体</em> </strong>保持周期性同步。</li><li id="a88b" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"><em class="ke">Org1</em></strong><strong class="ji hu"><em class="ke">锚定对等体</em> </strong>使用<em class="ke">八卦协议</em>定期更新org 1的活动对等体到<strong class="ji hu"> <em class="ke"> Org2 </em> </strong>的<strong class="ji hu"> <em class="ke">锚定对等体</em> </strong>的<em class="ke">列表。</em></li><li id="a21e" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke"> Org2 </em> </strong>的<strong class="ji hu"> <em class="ke">锚定对等体</em> </strong>还通过<em class="ke">八卦协议</em>定期更新Org2的活动对等体到<strong class="ji hu"> <em class="ke"> Org1 </em> </strong>的<strong class="ji hu"> <em class="ke">锚定对等体</em> </strong>的<em class="ke">列表。</em></li><li id="30ad" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated">一旦<strong class="ji hu"> <em class="ke">客户端</em> </strong>需要知道信道上所有活动对等体的<em class="ke">列表，<strong class="ji hu"> <em class="ke">客户端</em> </strong>使用<strong class="ji hu"><em class="ke">Fabric SDK</em></strong>发出查询请求，并将该请求发送给属于同一组织的<strong class="ji hu"> <em class="ke">对等体</em> </strong>中的一个。</em></li><li id="3a72" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke">被查询的对等体</em> </strong>响应<strong class="ji hu"> <em class="ke">客户端</em> </strong>所有活动对等体的<em class="ke">列表</em>。</li></ol></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><p id="a74f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">运营服务</strong></p><p id="1605" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在1.4版本的发布中，Hyperledger Fabric主要致力于完善其稳定性和生产运营。<strong class="ji hu"> <em class="ke">运营服务</em> </strong>是<strong class="ji hu"> <em class="ke"> </em> </strong>的重大更新之一。<strong class="ji hu"> <em class="ke">操作服务</em> </strong>可以帮助系统操作员确定<strong class="ji hu"> <em class="ke">订购方节点</em> </strong>、<strong class="ji hu"> <em class="ke">对等方</em> </strong>和<strong class="ji hu"> <em class="ke"> Fabric CAs </em> </strong>的活性和健康状况。这种<strong class="ji hu"> <em class="ke">服务</em> </strong>也有助于操作员更好地了解织物系统如何随着时间的推移而运行。</p><p id="cb96" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">每个节点(包括<strong class="ji hu"> <em class="ke">订购者节点</em> </strong>、<strong class="ji hu"> <em class="ke">对等者</em> </strong>、<strong class="ji hu"> <em class="ke"> Fabric CAs </em> </strong>)通过向系统操作者公开<em class="ke"> HTTP RESTful API </em>来提供<strong class="ji hu"> <em class="ke">操作服务</em> </strong>。为了限制对任何敏感信息的访问，<em class="ke"> API </em>与光纤区块链服务隔离，并且<em class="ke">该API </em>旨在仅由操作员用于操作和监控光纤系统组件的健康状况。</p><p id="ea6f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">该API公开了以下功能:</p><ul class=""><li id="ada9" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd kk kl km kn dt translated"><a class="ae jf" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/operations_service.html#log-level-management" rel="noopener ugc nofollow" target="_blank">日志级别管理</a></li><li id="8b33" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/operations_service.html#health-checks" rel="noopener ugc nofollow" target="_blank">健康检查</a></li><li id="0c08" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/operations_service.html#metrics" rel="noopener ugc nofollow" target="_blank">运营指标</a></li></ul><p id="8abf" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在这一部分，我将重点介绍<em class="ke">运营指标</em>。Hyperledger Fabric提供了两种公开运营指标的模型，即基于Prometheus 的<em class="ke"> pull模型和基于StatsD </em>的<em class="ke"> push模型。</em></p></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><p id="05db" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">运营指标:基于普罗米修斯的拉动式模型</strong></p><p id="aadb" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们可以设置<a class="ae jf" href="https://prometheus.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ji hu"> <em class="ke">【普罗米修斯】</em> </strong> </a>，通过连接到被检测的目标节点所公开的<strong class="ji hu"> <em class="ke"> /metrics </em> </strong> API端点，来周期性地从节点，包括<strong class="ji hu"><em class="ke">订购方节点</em> </strong>和<strong class="ji hu"> <em class="ke">对等方节点</em> </strong>中获取可操作的度量。Prometheus  通常配备WebUI，用于指标可视化以及警报和通知服务。</p><p id="f907" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">要使Fabric节点支持<strong class="ji hu"> <em class="ke"> Prometheus </em> </strong>，请查看<a class="ae jf" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/operations_service.html#prometheus" rel="noopener ugc nofollow" target="_blank">本文档</a>。这里是<a class="ae jf" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/metrics_reference.html#prometheus-metrics" rel="noopener ugc nofollow" target="_blank">当前导出供<strong class="ji hu"> <em class="ke">普罗米修斯</em> </strong>使用的指标</a>列表。</p><figure class="lb lc ld le fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff li"><img src="../Images/4cd9bbc0cf7281c4dc4138ff3fcca51d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mnHByyWzlHstS46bGsMtYw.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek"><strong class="bd lf">Figure 3. Utilizing Prometheus to pull operational metrics from nodes</strong></figcaption></figure><p id="097c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">图3描述了利用<strong class="ji hu"> <em class="ke"> Prometheus </em> </strong>从不同种类的节点提取操作指标的逐步工作流程:</p><ol class=""><li id="2b10" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke">普罗米修斯</em> </strong>周期性的向<strong class="ji hu"> <em class="ke"> Fabric目标节点</em> </strong>发出抓取指标的拉取请求。</li><li id="65ad" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated">每个<strong class="ji hu"> <em class="ke"> Fabric目标节点</em> </strong>将其相关度量响应给<strong class="ji hu"> <em class="ke"> Prometheus </em> </strong>。</li><li id="392b" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke">系统操作员</em> </strong>通过<strong class="ji hu"> <em class="ke">普罗米修斯</em> </strong> ' <strong class="ji hu"> </strong> <em class="ke"> WebUI监控汇总指标。</em></li><li id="339a" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke"> Prometheus </em> </strong>根据<strong class="ji hu"> <em class="ke">操作员</em></strong>设定的条件，向<strong class="ji hu"> <em class="ke">系统操作员</em> </strong>发送<strong class="ji hu">警报和通知。</strong></li></ol></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><p id="ef55" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">运营指标:基于StatsD的推送模型</strong></p><p id="5552" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">除了利用<strong class="ji hu"> <em class="ke">普罗米修斯</em> </strong>作为拉动运营指标的引擎，Hyperledger Fabric还支持基于<a class="ae jf" href="https://github.com/statsd/statsd" rel="noopener ugc nofollow" target="_blank"> <strong class="ji hu"> <em class="ke"> StatsD </em> </strong> </a>的推送模型。我们可以配置Fabric节点(包括<strong class="ji hu"> <em class="ke">订购方节点</em></strong><strong class="ji hu"><em class="ke">对等方</em></strong><strong class="ji hu"><em class="ke">Fabric CAs</em></strong>)定期向<strong class="ji hu"> <em class="ke"> StatsD守护进程</em> </strong>提交运营指标。然后，由<strong class="ji hu"><em class="ke"/></strong>StatsD聚合的指标可以被推送到一个或多个可插入的后端服务，例如<a class="ae jf" href="https://graphiteapp.org/" rel="noopener ugc nofollow" target="_blank"><em class="ke">【Graphite】</em></a><em class="ke"/>，用于指标可视化和警报。</p><p id="40b6" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">要配置结构节点向<strong class="ji hu"> <em class="ke"> StatsD </em> </strong>提交指标，请遵循本文档<a class="ae jf" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/operations_service.html#statsd" rel="noopener ugc nofollow" target="_blank"/>。这里是<a class="ae jf" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/metrics_reference.html#statsd-metrics" rel="noopener ugc nofollow" target="_blank">目前发布的<strong class="ji hu"> <em class="ke"> StatsD </em> </strong>消费的指标</a>列表。</p><figure class="lb lc ld le fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lj"><img src="../Images/ee9789740143b2c275ee4ad8d52a366c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*utzk7M-LblPTyXOF9dguxg.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek"><strong class="bd lf">Figure 4. Pushing operational metrics from nodes to StatsD</strong></figcaption></figure><p id="0591" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">将运营指标从不同类型的节点推送到<strong class="ji hu"> <em class="ke"> StatsD </em> </strong>的逐步工作流程如图4所示:</p><ol class=""><li id="552b" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd lg kl km kn dt translated">每个<strong class="ji hu"> <em class="ke">结构节点</em> </strong>定期向<strong class="ji hu"> <em class="ke"> StatsD </em> </strong>提交其相关度量。</li><li id="26aa" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke"> StatsD </em> </strong>将汇总的指标提交给<strong class="ji hu"> <em class="ke">后端服务</em> </strong>，如<em class="ke"> Graphite </em>进行<em class="ke"> </em>指标可视化和预警。</li><li id="9412" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke">系统操作员</em> </strong>通过<strong class="ji hu"> <em class="ke">后端服务</em> </strong>的<em class="ke"> WebUI </em>监控汇总的指标。</li><li id="a195" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd lg kl km kn dt translated"><strong class="ji hu"> <em class="ke">后端服务</em> </strong>根据<strong class="ji hu"> <em class="ke">操作员</em> </strong>设置的条件，向<strong class="ji hu"> <em class="ke">系统操作员</em> </strong>发送<strong class="ji hu"> <em class="ke"> </em> </strong>警报和通知。</li></ol></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><p id="1491" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">关闭系列电源</strong></p><p id="4e27" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这是<strong class="ji hu"> <em class="ke">揭秘总账面料系列</em> </strong>的最后一篇文章。你已经学习了<em class="ke">Hyperledger Fabric中的几个辅助服务</em>，它们为区块链开发者、区块链架构师和系统操作员提供便利。</p><p id="6793" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">实际上，这一系列文章中还有几个有趣的话题需要讨论，包括:</p><ul class=""><li id="a823" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd kk kl km kn dt translated">超分类帐结构中的多版本并发控制</li><li id="6737" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">Hyperledger结构中的身份、验证和授权</li><li id="d9af" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">通道级访问控制和策略</li><li id="1c22" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">高级链码开发</li><li id="547c" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">链码级基于属性的访问控制</li><li id="df3f" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">链码级加密</li><li id="8c83" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">织物订购服务在发挥作用</li><li id="cde3" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">超分类帐结构中的零知识证明</li><li id="6a0b" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">高级结构性能优化和高可用性</li></ul><p id="3eea" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">希望有一天我会有机会写关于这些话题的文章。如果您有任何问题或建议，请不吝留下您的宝贵意见。直到下次:)</p></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><p id="b387" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">本系列文章组织如下:</p><ul class=""><li id="9281" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/p/a2fdb587f6cb">揭秘Hyperledger Fabric (1/3): Fabric架构</a></li><li id="610d" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/p/164220ecafa5">揭开Hyperledger结构的神秘面纱(2/3):私人数据收集</a></li><li id="efca" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/p/f9a2046b4067">揭开Hyperledger结构(3/3)的神秘面纱:网络流量处理、服务发现和运营服务</a></li></ul></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><p id="cda9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="ke">原载于</em><a class="ae jf" href="https://www.serial-coder.com/post/demystifying-hyperledger-fabric-network-traffic-handling-service-discovery-and-operations-service/" rel="noopener ugc nofollow" target="_blank"><em class="ke">www.serial-coder.com</em></a><em class="ke">。</em></p><figure class="lb lc ld le fq iu fe ff paragraph-image"><a href="https://cryptofi.co"><div class="fe ff lk"><img src="../Images/e7b1dbc6a532a697c6844fdf0f0bbd30.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*HrFLDXz92JavTZXjhmvU7g.png"/></div></a></figure></div></div>    
</body>
</html>