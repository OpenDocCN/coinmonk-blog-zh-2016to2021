<html>
<head>
<title>Setup guide: Automate DCA and plan for liquidation wicks with gcp-cryptobot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设置指南:使用gcp-cryptobot自动执行DCA和清算wicks计划</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/setup-guide-automate-dca-and-plan-for-liquidation-wicks-with-gcp-cryptobot-32414ef72251?source=collection_archive---------2-----------------------#2021-06-01">https://medium.com/coinmonks/setup-guide-automate-dca-and-plan-for-liquidation-wicks-with-gcp-cryptobot-32414ef72251?source=collection_archive---------2-----------------------#2021-06-01</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/f4e382b8ef30c45f14cca679eccdde51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*65aJWEqYoBdw4V82"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Photo by <a class="ae ig" href="https://unsplash.com/@alschim?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alexander Schimmeck</a> on <a class="ae ig" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="e252" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt ke translated">这篇文章延续了我之前的博文，讲述了<a class="ae ig" rel="noopener" href="/coinmonks/i-wrote-a-serverless-app-to-automate-my-cryptocurrency-purchases-17c9a869d0c7">我如何编写一个无服务器应用程序来自动化我的加密货币购买。</a>如果您还没有通读这篇文章，我建议您快速阅读一下，以了解架构和设计决策。</p><p id="db01" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这一次我们将更深入地解释在GCP(谷歌云平台)上将应用程序设置为美元平均成本的步骤，并计划在加密货币交易所如<a class="ae ig" href="https://bitflyer .com/invitation?id=4cjf5hxe&amp;lang=en-JP" rel="noopener ugc nofollow" target="_blank"> Bitflyer </a>上购买(如果你住在日本)。你需要一些编程和使用docker的背景知识才能继续。</p><blockquote class="kn"><p id="27eb" class="ko kp ij bd kq kr ks kt ku kv kw kd ek translated">请仔细查看<a class="ae ig" href="https://github.com/kalanyuz/gcp-cryptobot" rel="noopener ugc nofollow" target="_blank">源代码</a>以了解它在任何服务上运行之前是如何工作的。</p></blockquote><p id="84c9" class="pw-post-body-paragraph jg jh ij ji b jj kx jl jm jn ky jp jq jr kz jt ju jv la jx jy jz lb kb kc kd hm dt translated">首先，我们需要一个GCP项目。如果你还没有，你可以试用3个月<a class="ae ig" href="https://cloud.google.com/free/?utm_source=google&amp;utm_medium=cpc&amp;utm_campaign=japac-AU-all-en-dr-bkws-all-all-trial-b-dr-1009882&amp;utm_content=text-ad-none-none-DEV_c-CRE_498553313004-ADGP_Hybrid%20%7C%20BKWS%20-%20BMM%20%7C%20Txt%20~%20GCP%20~%20Trial%20_%20Free%20Tier-KWID_43700060832204675-kwd-1180531753169&amp;userloc_1009343-network_g&amp;utm_term=KW_%2Bgcp%20%2B300%20%2Bfree&amp;gclid=Cj0KCQjwktKFBhCkARIsAJeDT0i02OTjHziPZO5q5MyzAXMJ0AL3qX5siFh6Q8DvQFjBN_7einTODgAaAvI3EALw_wcB&amp;gclsrc=aw.ds" rel="noopener ugc nofollow" target="_blank">这里</a>。因为云运行比例为零。谷歌提供的300美元信用对于这个应用程序来说绰绰有余，并允许您探索其他GCP服务。</p><figure class="ld le lf lg fq hv fe ff paragraph-image"><div class="fe ff lc"><img src="../Images/42d23f739f0b656f2ffc7707651061ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*nNF0wpWvnmO1JWJDkbW4xA.png"/></div><figcaption class="ic id fg fe ff ie if bd b be z ek">We’ll be covering the stacking / DCA setup part today and you won’t be needing any 3rd party indicator alert subscription.</figcaption></figure><h1 id="89dc" class="lh li ij bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me dt translated">先决条件</h1><ul class=""><li id="3362" class="mf mg ij ji b jj mh jn mi jr mj jv mk jz ml kd mm mn mo mp dt translated"><a class="ae ig" href="https://docs.docker.com/get-docker/" rel="noopener ugc nofollow" target="_blank">码头工人</a></li><li id="bca4" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated"><a class="ae ig" href="https://cloud.google.com/sdk/gcloud" rel="noopener ugc nofollow" target="_blank"> gcloud命令行工具</a></li></ul><p id="469c" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">然后确保您已经在GCP启用了这些服务。(我有帮助解释每个产品的链接，如果你想了解更多的话。)</p><ul class=""><li id="1064" class="mf mg ij ji b jj jk jn jo jr mv jv mw jz mx kd mm mn mo mp dt translated"><a class="ae ig" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwjx37HA-fPwAhWu3mEKHZdcBJUQFjABegQICRAE&amp;url=https%3A%2F%2Fcloud.google.com%2Fscheduler%2F%3Fhl%3Dja&amp;usg=AOvVaw30C0x53bpeF0oWpZZfgh_l" rel="noopener ugc nofollow" target="_blank">云调度器</a></li><li id="2b56" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated"><a class="ae ig" href="https://cloud.google.com/secret-manager" rel="noopener ugc nofollow" target="_blank">秘密经理</a></li><li id="a22f" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated"><a class="ae ig" href="https://cloud.google.com/container-registry" rel="noopener ugc nofollow" target="_blank">云容器注册表</a></li><li id="f4bf" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated"><a class="ae ig" href="https://cloud.google.com/run" rel="noopener ugc nofollow" target="_blank">云运行</a></li></ul><p id="8acb" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为此，请使用侧边菜单或顶部的搜索栏从Google Cloud控制台访问API &amp; Services菜单。寻找显示“启用API和服务”的按钮</p><figure class="ld le lf lg fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff my"><img src="../Images/0c1e6c4ee60886892cfa69bc5783800d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y_z0podBHfkfB2zyaf60kQ.png"/></div></div></figure><p id="8b57" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">然后使用上面列出的名称搜索服务并启用它们。一旦启用，您将会看到这样的屏幕。</p><figure class="ld le lf lg fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff mz"><img src="../Images/278069baf2766494d929d882386c8dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*os66m4MqVUGig14vQ4Jthw.png"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Once you see the green checkmark for all the services above, you are almost good to go!</figcaption></figure><p id="0dbf" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">接下来，我们将需要两个服务帐户:<br/> -云运行:w/role<em class="na">Secret Manager Secret Accessor</em><br/>-云调度器w/ role <em class="na">云运行调用者</em></p><figure class="ld le lf lg fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff nb"><img src="../Images/8200f8ff6053d5388c02f728602112a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K25vkluJoFMeDR1-mz5bkA.png"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">What you’ll see in your IAM &amp; Admin page after you have created both service accounts.</figcaption></figure><p id="05f3" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">也可以用你的电子邮件作为服务帐户做任何事情，因为它拥有“<em class="na">所有者</em>”角色，允许你访问每一个资源，这不是一个好的安全实践。</p><h1 id="bfe4" class="lh li ij bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me dt translated">将您的API密钥放入Secret Manager</h1><p id="1a72" class="pw-post-body-paragraph jg jh ij ji b jj mh jl jm jn mi jp jq jr nc jt ju jv nd jx jy jz ne kb kc kd hm dt translated">您将把来自<a class="ae ig" href="https://bitflyer .com/invitation?id=4cjf5hxe&amp;lang=en-JP" rel="noopener ugc nofollow" target="_blank"> bitflyer </a>的API密钥和秘密放在这里，并相应地命名它们。这些键名稍后将在应用程序'<code class="eh nf ng nh ni b">s config.bitflyer.sample.yaml</code>配置文件中使用。我们把它们分别命名为<code class="eh nf ng nh ni b">BITFLYER_APIKEY</code>和<code class="eh nf ng nh ni b">BITFLYER_SECRET</code>。</p><figure class="ld le lf lg fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff nj"><img src="../Images/dbb8dd213ccc1bcff4b3151f3ef6c4c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-yFS8BBkp2QAenJAJJ4yhw.png"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">These names will be referred to by our app code. Remember to not give these keys more rights than necessary.</figcaption></figure><h1 id="2c4a" class="lh li ij bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me dt translated">创建应用程序的容器映像</h1><p id="0eba" class="pw-post-body-paragraph jg jh ij ji b jj mh jl jm jn mi jp jq jr nc jt ju jv nd jx jy jz ne kb kc kd hm dt translated">假设您已经克隆了存储库，并确认测试运行正常，现在我们将应用程序放在云上运行。既然我们讨论的是Bitflyer，那么在部署之前让我们先来看看<code class="eh nf ng nh ni b">config.bitflyer.sample.yaml</code>。</p><figure class="ld le lf lg fq hv fe ff paragraph-image"><div class="fe ff nk"><img src="../Images/08e49e43b0b52a87f7eca880df39386d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*jSDwZIlKvk59KyXiG28VEw.png"/></div><figcaption class="ic id fg fe ff ie if bd b be z ek">What my config file looks like.</figcaption></figure><p id="7f1e" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">下面是对配置文件功能的简要描述:</p><ul class=""><li id="4448" class="mf mg ij ji b jj jk jn jo jr mv jv mw jz mx kd mm mn mo mp dt translated">secret_keyname:您在GCP的秘密管理器中使用的密钥名称。</li><li id="b60e" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">api_keyname:你在GCP的秘密管理器中使用的密钥名。</li><li id="e7be" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">trade_with:应用程序将交易的货币。如果你住在日本，并且正在使用Bitflyer，那么只能使用JPY。</li><li id="0258" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">再平衡:用于活跃交易中的资产再平衡，本次不需要<strong class="ji ik">。</strong></li><li id="0028" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">trading_pairs:收到指标调用时允许交易的资产。<strong class="ji ik">如果您使用此处未指定的货币提出请求，将会被拒绝。</strong></li></ul><p id="9563" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">一旦您确认您已经在配置文件设置中正确地获得了秘密名称，让我们构建docker映像并把它放到云映像注册表中。</p><pre class="ld le lf lg fq nl ni nm nn aw no dt"><span id="9905" class="np li ij ni b fv nq nr l ns nt"># if this is your first time pushing a docker image to GCP<br/># additional steps with <br/># auth login / auth application-default login may be neccessary</span><span id="918e" class="np li ij ni b fv nu nr l ns nt">gcloud auth configure-docker<br/>gcloud set project [YOUR_GCP_PROJECT_NAME]</span><span id="3b19" class="np li ij ni b fv nu nr l ns nt"># in the app directory<br/>docker build . -t gcr.io/[YOUR_GCP_PROJECT_NAME]/[YOUR_IMAGE_NAME]:latest</span><span id="8e3e" class="np li ij ni b fv nu nr l ns nt">docker push gcr.io/[YOUR_GCP_PROJECT_NAME]/[YOUR_IMAGE_NAME] --all-tags</span></pre></div><div class="ab cl nv nw hb nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="hm hn ho hp hq"><h1 id="fefa" class="lh li ij bd lj lk oc lm ln lo od lq lr ls oe lu lv lw of ly lz ma og mc md me dt translated">将应用程序放在云上运行</h1><p id="60c4" class="pw-post-body-paragraph jg jh ij ji b jj mh jl jm jn mi jp jq jr nc jt ju jv nd jx jy jz ne kb kc kd hm dt translated">完成上述步骤后，应用程序的容器图像将被上传到Google的云图像注册表，您可以使用可配置的风格进行部署。</p><p id="0046" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">部署应用程序时，目前有3个环境变量需要配置:</p><pre class="ld le lf lg fq nl ni nm nn aw no dt"><span id="4c78" class="np li ij ni b fv nq nr l ns nt"># if the app should intercept and reject requests from unknown source<br/>- GUARD<br/># the exchange the app will be connecting to<br/>- EXCHANGE<br/># name of the config file to load in src/services/config/<br/>- CONFIGFILE</span></pre><p id="9186" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">由于我们没有从交易视图接收到任何交易信号，并且将专门从Cloud Scheduler调用该应用程序，因此我们将使用以下<a class="ae ig" href="https://cloud.google.com/sdk/gcloud/reference/run/deploy" rel="noopener ugc nofollow" target="_blank">命令</a>部署该应用程序:</p><pre class="ld le lf lg fq nl ni nm nn aw no dt"><span id="cee7" class="np li ij ni b fv nq nr l ns nt">gcloud run deploy [SERVICE_NAME] \<br/>--image=gcr.io/[YOUR_GCP_PROJECT_NAME]/[YOUR_IMAGE_NAME]:latest \<br/>--concurrency=1 --max-instances=2 --timeout=60 --region=[REGION] \ --memory=128Mi --port=8080 \  <br/>--set-env-vars=GUARD=none,EXCHANGE=bitflyer,\<br/>CONFIGFILE=[CONFIG_FILE] \ --no-allow-unauthenticated --<a class="ae ig" href="mailto:service-account=gcp-cryptobot@winston-ai.iam.gserviceaccount.com" rel="noopener ugc nofollow" target="_blank">service-account=</a>[SERVICE_ACCOUNT_EMAIL_ADDRESS] --platform=managed</span></pre><p id="0762" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这将应用程序部署到最低层实例类型的云运行(以节省成本)，不使用任何拦截器，并连接到Bitflyer exchange。</p><p id="a87e" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">如果部署命令通过，那么恭喜你！您的第一个加密货币机器人安全地运行在Cloud Run上。要检查您的部署状态，包括您可以访问服务的URL，请访问云运行菜单并选择您的服务。我们将需要URL来设置自动购买的云调度程序。</p><p id="eb12" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji ik">不要将此URL分享给任何人。</strong></p><figure class="ld le lf lg fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff oh"><img src="../Images/c47fb683dd31e41ca820102c68fd4e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ajzWq513SkK351N3UnXmQ.png"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Note the URL right next to your service name. We’ll be needing that in the next step.</figcaption></figure><p id="1482" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">现在，你们中的一些人可能想直接发送请求来测试应用程序是否正常工作，结果却收到了错误代码。这是因为我们在部署应用程序时使用的<code class="eh nf ng nh ni b">--no-allow-unauthenticated</code>将阻止所有传入的连接，只要它们不是由您的<code class="eh nf ng nh ni b">SERVICE_ACCOUNT_EMAIL_ADDRESS</code>调用的。如果向它发出请求的实体也在你的GCP项目中(例如云调度器)。</p><h1 id="2b06" class="lh li ij bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me dt translated">使用云调度程序自动购买</h1><p id="ac41" class="pw-post-body-paragraph jg jh ij ji b jj mh jl jm jn mi jp jq jr nc jt ju jv nd jx jy jz ne kb kc kd hm dt translated">现在到了点睛之笔！让我们转到云调度页面，实现购买自动化。我将演示两个场景，但是您可以修改它来制定您自己的策略！</p><h2 id="e65f" class="np li ij bd lj oi oj ok ln ol om on lr jr oo op lv jv oq or lz jz os ot md ou dt translated"><strong class="ak">每周0.001比特币周一早上7点买DCA。</strong></h2><p id="6b53" class="pw-post-body-paragraph jg jh ij ji b jj mh jl jm jn mi jp jq jr nc jt ju jv nd jx jy jz ne kb kc kd hm dt translated">在“云调度程序”页面中，单击“创建作业”并填写这些字段</p><ul class=""><li id="cc50" class="mf mg ij ji b jj jk jn jo jr mv jv mw jz mx kd mm mn mo mp dt translated">姓名:你的工作名称(例如。cryptobot-dca)</li><li id="ea47" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">频率:0 7 * * 1(如果您是crons新手，请访问<a class="ae ig" href="http://crontab.guru/" rel="noopener ugc nofollow" target="_blank"> crontab.guru </a>以获得帮助)</li><li id="c268" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">时区:您所在的时区，以匹配上面的cron</li><li id="b87f" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">目标类型:HTTP</li><li id="91d5" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">网址:你的云跑app的网址，带<code class="eh nf ng nh ni b">/exchange/buy</code>路径</li><li id="607a" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">HTTP方法:POST</li><li id="8549" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">HTTP头:<code class="eh nf ng nh ni b">Content-Type: application/json</code></li><li id="a68d" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">认证头:OIDC令牌</li><li id="2c82" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">服务账户:您拥有<em class="na">云运行调用者</em>角色的服务账户</li><li id="5e49" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">受众:您的云跑应用的URL</li><li id="536c" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">正文:<code class="eh nf ng nh ni b">{"asset":"BTC","denominator":"JPY","amount":0.001}</code></li></ul><h2 id="1300" class="np li ij bd lj oi oj ok ln ol om on lr jr oo op lv jv oq or lz jz os ot md ou dt translated"><strong class="ak"> Grid bids每天下午1点重新计算，为甜蜜的闪电暴跌买入做计划。</strong></h2><ul class=""><li id="1ac5" class="mf mg ij ji b jj mh jn mi jr mj jv mk jz ml kd mm mn mo mp dt translated">姓名:你的工作名称(例如。cryptobot-dip)</li><li id="f448" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">频率:0 13 * * *</li><li id="d86e" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">时区:您所在的时区，以匹配上面的cron</li><li id="090d" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">目标类型:HTTP</li><li id="4b3b" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">URL:您的云跑app的URL，带<code class="eh nf ng nh ni b">/exchange/buythedip</code>路径</li><li id="9cf7" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">HTTP方法:POST</li><li id="131f" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">HTTP头:<code class="eh nf ng nh ni b">Content-Type: application/json</code></li><li id="97f9" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">认证头:OIDC令牌</li><li id="46b0" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">服务账号:您的<em class="na">云运行调用者</em>角色的服务账号</li><li id="286e" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">受众:您的云跑应用的URL</li><li id="e8f0" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated">正文:<code class="eh nf ng nh ni b">{"asset":"BTC","denominator":"JPY","dip":[{"percent":20,"allocation":"20"},{"percent":30,"allocation":40}]}</code></li></ul><p id="a950" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这将产生2个买入订单:第一个订单将在比特币价格下跌20%时，用你可用的20%的法定货币买入比特币。第二个会在比特币价格下跌30%时，用40%的可用法定货币购买比特币。这将每天重新计算，旧的购买订单将在下新订单之前清除。</p><p id="817d" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">你可能会注意到没有自动销售的例子？那是因为…</p><figure class="ld le lf lg fq hv fe ff paragraph-image"><div class="fe ff ov"><img src="../Images/2c3f1feca3aa4396aa26d85e455fce88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*bN6DChIcYDH2cysi.jpg"/></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Insert diamond hands meme here.</figcaption></figure><p id="5311" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">如果您想创建一个退出市场的DCA计划，请参考源代码中的<code class="eh nf ng nh ni b">/sell</code>端点，了解如何创建销售请求。</p><figure class="ld le lf lg fq hv fe ff paragraph-image"><div class="fe ff ow"><img src="../Images/3bd2020406d5fae25b40111f15b305a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*F64xmkqPxmcCMRFjB2ea-Q.png"/></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Click “RUN NOW” to test your scheduler</figcaption></figure><p id="3435" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">创建两个调度器后，您可以通过按下“<strong class="ji ik"> RUN NOW </strong>”按钮来测试它是否正常工作，并查看您的云运行实例日志或<a class="ae ig" href="https://bitflyer .com/invitation?id=4cjf5hxe&amp;lang=en-JP" rel="noopener ugc nofollow" target="_blank"> Bitflyer </a>本身。例如，如果对<code class="eh nf ng nh ni b">/buythedip</code>的请求成功，您应该会看到在您的Bitflyer帐户上创建了两个购买订单。</p></div><div class="ab cl nv nw hb nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="hm hn ho hp hq"><h1 id="5e95" class="lh li ij bd lj lk oc lm ln lo od lq lr ls oe lu lv lw of ly lz ma og mc md me dt translated">享受堆叠的时间到了！</h1><p id="982c" class="pw-post-body-paragraph jg jh ij ji b jj mh jl jm jn mi jp jq jr nc jt ju jv nd jx jy jz ne kb kc kd hm dt translated">这就是自动化DCA的教程。下一次，我们将讨论如何设置gcp-cryptobot根据交易视图中的指标信号对币安采取买入和卖出行动。</p><p id="cb10" class="pw-post-body-paragraph jg jh ij ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">同样，如果你喜欢机器人的想法，并愿意做出贡献，请随时创建一个问题或提交一份公关！</p><h2 id="e0fb" class="np li ij bd lj oi oj ok ln ol om on lr jr oo op lv jv oq or lz jz os ot md ou dt translated">也阅读</h2><ul class=""><li id="8e1e" class="mf mg ij ji b jj mh jn mi jr mj jv mk jz ml kd mm mn mo mp dt translated"><a class="ae ig" href="https://blog.coincodecap.com/margin-trading" rel="noopener ugc nofollow" target="_blank">什么是融资融券交易</a> | <a class="ae ig" href="https://blog.coincodecap.com/dca" rel="noopener ugc nofollow" target="_blank">成本平均法</a></li><li id="5241" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated"><a class="ae ig" rel="noopener" href="/coinmonks/3commas-review-an-excellent-crypto-trading-bot-2020-1313a58bec92">3商业评论</a> | <a class="ae ig" rel="noopener" href="/coinmonks/pionex-review-exchange-with-crypto-trading-bot-1e459d0191ea"> Pionex评论</a> | <a class="ae ig" rel="noopener" href="/coinmonks/coinrule-review-2021-a-beginner-friendly-crypto-trading-bot-daf0504848ba"> Coinrule评论</a></li><li id="4023" class="mf mg ij ji b jj mq jn mr jr ms jv mt jz mu kd mm mn mo mp dt translated"><a class="ae ig" rel="noopener" href="/coinmonks/ledger-vs-ngrave-zero-7e40f0c1d694">莱杰vs n格拉夫</a> | <a class="ae ig" rel="noopener" href="/coinmonks/ledger-nano-s-vs-x-battery-hardware-price-storage-59a6663fe3b0">莱杰纳诺s vs x </a> | <a class="ae ig" rel="noopener" href="/coinmonks/binance-review-ee10d3bf3b6e">币安评论</a></li></ul></div></div>    
</body>
</html>