<html>
<head>
<title>How to use different algorithms using Caret package in R.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在r中使用Caret包使用不同的算法？</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-use-different-algorithms-using-caret-package-in-r-for-house-price-dataset-fcd177b08c3c?source=collection_archive---------2-----------------------#2018-07-10">https://medium.com/coinmonks/how-to-use-different-algorithms-using-caret-package-in-r-for-house-price-dataset-fcd177b08c3c?source=collection_archive---------2-----------------------#2018-07-10</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><h1 id="ed02" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">入门简介:</strong></h1><p id="0fe7" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">亲爱的读者们，这是我的第一篇文章，请多包涵。将有语法错误(不是代码)，所以提前道歉。因此，我将在<a class="ae km" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques" rel="noopener ugc nofollow" target="_blank">房价数据集</a>上工作，这是kaggle中的一个竞赛，并在R中应用caret包以应用不同的算法而不是不同的包，同时应用超参数调整。</p><h1 id="40c8" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">比赛描述:</strong></h1><p id="d7ff" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">数据集上的kaggle描述如下:</p><blockquote class="kn ko kp"><p id="67ed" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">请购房者描述他们梦想中的房子，他们可能不会从地下室天花板的高度或靠近东西向铁路开始。但是这个游乐场竞赛的数据集证明，影响价格谈判的远不止卧室的数量或白色尖桩栅栏。有79个解释变量描述了(几乎)爱荷华州埃姆斯住宅的每个方面，这个比赛挑战你预测每个家庭的最终价格。</p></blockquote><h1 id="7c5b" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">问题介绍:</strong></h1><p id="fcd9" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">因此，本次比赛的数据集有大约76列，分别有缺失值，因为让我们面对它，没有缺失值的数据集就像没有灵魂的生命。我们要解决的问题是预测爱荷华州艾姆斯的住宅销售价格。我们必须使用回归技术来预测房产的销售价格。这是一个<a class="ae km" href="https://machinelearningmastery.com/supervised-and-unsupervised-machine-learning-algorithms/" rel="noopener ugc nofollow" target="_blank">监督回归机器学习问题</a>。它是受监督的，因为我们有我们想要预测的特征(房价数据)和目标(销售价格)。<br/>现在，对于回归问题，我们可以使用各种算法，如线性回归、随机森林、kNN等。在R中，我们为所有这些算法提供了不同的包。<br/>这篇文章的大意是“当你有一个通用的包时，为什么要为不同的算法使用不同的包？”。包中包含了超过175种算法。现在，caret允许你使用一个简单的函数来创建所有的算法，而不是试图记住不同算法的不同包。听起来很简单，是吧？没那么简单。但是我们以后会调查的。</p><h1 id="fa64" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">路线图:</strong></h1><p id="cce6" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">在直接进入编码之前。让我们就如何处理问题陈述保留一些指导原则。<br/> 1。陈述问题陈述。<br/> 2。获取可访问状态的数据。<br/> 3。识别缺失值和异常。<br/> 4。为机器学习算法准备数据。<br/> 5。在caret中为不同的算法训练模型。<br/> 6。用各自的模型预测产量。<br/> 7。在kaggle中提交输出。；p <br/>第一步打勾。我们有一个问题“根据给定的数据预测房产的销售价格”。</p><h1 id="f182" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">数据采集:</strong></h1><p id="1423" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">从这个问题开始，我们确实需要数据。一般来说，大部分时间花在清理数据和探索数据上，以获得列之间的关系，以及我们是否需要从现有的列中创建新的列。<br/>我们将<strong class="jq hu"> <em class="kq">而不是</em> </strong>深入探索部分，因为这篇文章的主题是关于如何实现caret包。但是如果你们需要如何探索数据集的基础，我会发表一篇新文章。有需要就评论。<br/>回到正题。数据是<a class="ae km" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hu">可用</strong> </a> <strong class="jq hu"> </strong>在kaggle下载。文件格式为csv(逗号分隔值)。这是处理数据时的常规文件格式。<br/>以下代码加载RStudio中的数据，并显示数据的结构。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="202e" class="li ir ht le b fv lj lk l ll lm"># Set the working directory (where you have saved the file)<br/>setwd("E:/Kaggle/Housing Price/")</span><span id="7cdb" class="li ir ht le b fv ln lk l ll lm"># Read the train and test data<br/>train &lt;- read.csv("train.csv")<br/>test &lt;- read.csv("test.csv")</span></pre><h1 id="4423" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">数据描述:</strong></h1><p id="b413" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">以下是您将在数据描述文件中找到的内容的简要版本。</p><ul class=""><li id="7419" class="lo lp ht jq b jr kr jv ks jz lq kd lr kh ls kl lt lu lv lw dt translated">销售价格——以美元为单位的房产销售价格。这是你试图预测的目标变量。</li><li id="2392" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">ms subclass:building类</li><li id="8021" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">MSZoning:一般分区分类</li><li id="d5ce" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">地段临街面:与物业相连的街道的直线英尺数</li><li id="6e37" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">LotArea:以平方英尺为单位的批量</li><li id="1b65" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">街道:道路通道的类型</li><li id="97b8" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">小巷:小巷通道的类型</li><li id="86fd" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">LotShape:属性的一般形状</li><li id="9b7f" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">土地等高线:地产的平整度</li><li id="a1ad" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">实用程序:可用的实用程序类型</li><li id="dc59" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">批次配置:批次配置</li><li id="a708" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">土地坡度:地产的坡度</li><li id="708d" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">邻近地区:埃姆斯市范围内的物理位置</li><li id="34be" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">条件1:靠近主干道或铁路</li><li id="70d4" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">条件2:靠近主干道或铁路(如果有第二条)</li><li id="b6c0" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">建筑类型:住宅的类型</li><li id="4836" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">家居风格:居住的风格</li><li id="b52e" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">总体质量:整体材料和表面质量</li><li id="473b" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">OverallCond:整体条件评级</li><li id="2c5c" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">年份:原始建造日期</li><li id="511c" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">YearRemodAdd:改造日期</li><li id="6617" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">屋顶样式:屋顶的类型</li><li id="7a34" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">屋顶材料:屋顶材料</li><li id="a36b" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">外部1:房屋的外部覆盖物</li><li id="ad5a" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">外部2:房屋的外部覆盖物(如果不止一种材料)</li><li id="e3f1" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">MasVnrType:砖石饰面类型</li><li id="5a94" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">MasVnrArea:以平方英尺为单位的砌体饰面面积</li><li id="8fd5" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">外部质量:外部材料质量</li><li id="db89" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">外部:外部材料的现状</li><li id="4a99" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">基础:基础的类型</li><li id="e492" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">BsmtQual:地下室的高度</li><li id="0882" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">第二:地下室的一般情况</li><li id="8553" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">bsmt暴露:步行区或花园层地下室墙</li><li id="427b" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">BsmtFinType1:地下室完工面积质量</li><li id="9f9a" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">BsmtFinSF1:类型1完工平方英尺</li><li id="e4f2" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">BsmtFinType2:第二个完工区域的质量(如果存在)</li><li id="7243" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">BsmtFinSF2:类型2完工平方英尺</li><li id="9186" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">BsmtUnfSF:未完工的地下室面积平方英尺</li><li id="5cb6" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">TotalBsmtSF:地下室面积的总平方英尺</li><li id="fe49" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">加热:加热类型</li><li id="423d" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">加热质量控制:加热质量和条件</li><li id="6674" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">中央空调</li><li id="c8d2" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">电气:电气系统</li><li id="9a20" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">1stFlrSF:一楼平方英尺</li><li id="9453" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">2ndFlrSF:二楼平方英尺</li><li id="c45f" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">低质量成品平方英尺(所有楼层)</li><li id="316c" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">GrLivArea:地面以上居住面积平方英尺</li><li id="c6f4" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">BsmtFullBath:地下室全浴室</li><li id="2f99" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">半浴室:地下室半浴室</li><li id="924d" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">全浴室:地面以上的全浴室</li><li id="636f" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">半浴室:地面以上的半浴室</li><li id="c86b" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">卧室:地下室标高以上的卧室数量</li><li id="3c9f" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">厨房:厨房数量</li><li id="9608" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">厨房质量</li><li id="f13e" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">TotRmsAbvGrd:地上客房总数(不包括浴室)</li><li id="5a4b" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">功能:家庭功能评级</li><li id="f119" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">壁炉:壁炉的数量</li><li id="2285" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">壁炉质量</li><li id="f27f" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">车库类型:车库位置</li><li id="cb8a" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">车库建造年份</li><li id="b2f2" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">车库饰面:车库的内部饰面</li><li id="2219" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">车库汽车:车库在汽车容量中的大小</li><li id="21e6" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">车库面积:车库的面积，以平方英尺为单位</li><li id="0739" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">GarageQual:车库质量</li><li id="c84c" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">车库状况</li><li id="16e2" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">铺面车道:铺面车道</li><li id="a26f" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">木板面积:以平方英尺为单位的木板面积</li><li id="95a7" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">OpenPorchSF:以平方英尺为单位的开放式门廊面积</li><li id="6334" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">封闭门廊:以平方英尺为单位的封闭门廊面积</li><li id="d88a" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">3三季门廊面积(平方英尺)</li><li id="2c45" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">纱窗门廊:以平方英尺为单位的纱窗门廊面积</li><li id="ad45" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">游泳池面积:以平方英尺为单位的游泳池面积</li><li id="f505" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">泳池质量控制:泳池质量</li><li id="da5f" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">围栏:围栏质量</li><li id="7feb" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">杂项功能:其他类别中不包含的杂项功能</li><li id="9b6f" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">误算:$杂项特征的值</li><li id="3ec7" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">销售月</li><li id="c865" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">售出年份:售出年份</li><li id="e108" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">销售类型:销售的类型</li><li id="9327" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">销售条件:销售的条件</li></ul><p id="0146" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">是的，我知道这是一个很长的名单。但是别担心，我告诉过你我们不会做数据探索。实际上我们不会做任何形式的探索。我们将简单地让PCA处理困难的工作。</p><p id="c6d1" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">PCA？阅读马特·布雷姆斯的这篇 文章。它涵盖了PCA的理论方面。我来做编码部分。</p><h1 id="220f" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">识别异常/缺失数据:</strong></h1><p id="c9ce" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">训练数据的尺寸是1460x81，测试数据的尺寸是1459x80。在浏览房价数据时(我没有仔细浏览数据，只是写了一堆无聊的代码)，我意识到几乎没有丢失的数据，这很好地提醒了我们这个世界上没有什么是完美的。<br/>缺失的数据会极大地影响你的分析和机器学习模型。关于如何处理缺失值的介绍，请阅读这篇<a class="ae km" href="https://www.r-bloggers.com/missing-value-treatment/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hu">文章</strong> </a>。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="4873" class="li ir ht le b fv lj lk l ll lm"># Getting the columns with more than 20% of missing values.<br/>miss &lt;- colSums(is.na(train))<br/>miss_prec &lt;- miss/nrow(train)*100<br/>print(miss_prec[miss_prec &gt; 20])</span><span id="67ee" class="li ir ht le b fv ln lk l ll lm">col_miss &lt;- names(miss_prec[miss_prec&gt;20])</span></pre><p id="9500" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">我们看到有5列:“Alley”、“FireplaceQu”、“PoolQC”、“Fence”、“MiscFeature”有超过20%的缺失数据。<br/>现在，缺失值的问题是，用合理的值估算它们是一种好的做法，但如果我们明确估算我们选择的值，我们可能会根据我们的偏好操纵数据，并且必然会得到错误的模型。我们应该采取删除包含超过某个阈值的丢失值的列的方法。我留到20%。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="3aba" class="li ir ht le b fv lj lk l ll lm"># Removing the columns with more than 20% missing value in both train and test data.<br/>train[,c(col_miss)] &lt;- NULL<br/>test[,c(col_miss)] &lt;- NULL</span></pre><p id="2e0e" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">现在我们已经删除了包含超过20%缺失值的列，是时候为其他列估算值了。</p><p id="a151" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">还注意到训练和测试数据集中的实用程序有一个非常独特的特征。显然，火车数据集中的效用有两个值:AllPub和NoSeWa。但是当我们在测试数据中寻找实用程序的独特性时，我们发现:AllPub。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="e8d6" class="li ir ht le b fv lj lk l ll lm">sd &lt;- names(which(sapply(test,is.factor)))<br/>f &lt;- c()<br/>for(i in sd){<br/>  f &lt;- c(f, length(levels(test[,i])))<br/>}<br/>print(sd[which(f == 1)])</span><span id="cd51" class="li ir ht le b fv ln lk l ll lm">train$Utilities &lt;- NULL<br/>test$Utilities &lt;- NULL</span></pre><p id="83ab" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">我将在<a class="ae km" href="https://cran.r-project.org/web/packages/mice/mice.pdf" rel="noopener ugc nofollow" target="_blank"> mice </a>包的帮助下使用<a class="ae km" href="https://towardsdatascience.com/the-random-forest-algorithm-d457d499ffcd" rel="noopener" target="_blank">随机森林</a>方法估算缺失值。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="9ae8" class="li ir ht le b fv lj lk l ll lm"># Importing the library<br/>library(mice)</span><span id="e151" class="li ir ht le b fv ln lk l ll lm">temptrain &lt;- mice(train, m = 5, method = "rf", maxit = 10)<br/>trainnew &lt;- complete(temptrain, 1)</span><span id="96a1" class="li ir ht le b fv ln lk l ll lm">temptest &lt;- mice(test, m = 5, method = "rf", maxit = 10)<br/>testnew &lt;- complete(temptest, 1)</span></pre><h1 id="0f01" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">数据准备:</strong></h1><p id="75ec" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated"><strong class="jq hu">一个热编码:</strong></p><p id="8cfb" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">既然我们已经处理了缺失值，我们将合并两个数据集以创建<a class="ae km" href="https://socialresearchmethods.net/kb/dummyvar.php" rel="noopener ugc nofollow" target="_blank">虚拟变量</a>。<br/>为什么这么说？你看，这毕竟是一个回归问题，如果我们的数据集中没有连续或离散的值，就会产生一点问题。我们不需要把事情复杂化，不是吗？</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="e964" class="li ir ht le b fv lj lk l ll lm">housedum &lt;- rbind(trainnew %&gt;% select(-SalePrice), testnew)</span></pre><p id="b00c" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">现在数据集已经合并，让我们创建虚拟变量。在r中并没有那么难。我们将使用插入符号包的<a class="ae km" href="https://www.rdocumentation.org/packages/caret/versions/6.0-80/topics/dummyVars" rel="noopener ugc nofollow" target="_blank"> dummyVars </a>方法。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="f384" class="li ir ht le b fv lj lk l ll lm">library(caret)</span><span id="d59c" class="li ir ht le b fv ln lk l ll lm">housedumnew &lt;-  dummyVars(~., data = housedum)<br/>housedumpred &lt;- predict(housedumnew,housedum)</span></pre><p id="a607" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">现在，在创建虚拟变量之后，分离训练和测试数据集。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="8b6f" class="li ir ht le b fv lj lk l ll lm">trainnewpred &lt;- housedumpred[1:nrow(trainnew),]<br/>testnewpred &lt;- housedumpred[-(1:nrow(trainnew)),]</span></pre><p id="3ac8" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated"><strong class="jq hu"> PCA: </strong></p><p id="fbb1" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">希望你对PCA的工作原理有一个大致的了解。即使你不知道，也可以在这里查找PCA的理论方面。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="84a9" class="li ir ht le b fv lj lk l ll lm">prin_train &lt;- prcomp(trainnewpred, scale. = T)<br/>std_dev &lt;- prin_train$sdev<br/>pr_var &lt;- std_dev^2</span><span id="5429" class="li ir ht le b fv ln lk l ll lm">prop_varex &lt;- pr_var/sum(pr_var)</span></pre><p id="6cf4" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">让我们画出图来理解我们应该为模型的创建取多少变量。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="166c" class="li ir ht le b fv lj lk l ll lm"># Simple plot b/w Principal Components and Variance.<br/>plot(prop_varex, xlab = "Principal Component", ylab = "Proportion of Variance Explained",<br/>     type = "b")</span></pre><figure class="kz la lb lc fq md fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/f1e4957af059eb20d6211ddc1286ccae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*7Mbk7zPDLjE_EUfrsUnUug.png"/></div></figure><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="ce5a" class="li ir ht le b fv lj lk l ll lm">plot(cumsum(prop_varex), xlab = "Principal Component", <br/>     ylab = "Cumulative Proportion of Variance Explained", type = "b")</span></pre><figure class="kz la lb lc fq md fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/69d417ef708d423fdd0c48fc6945266f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*NplGtXR2_6lBF-CAHhMhmg.png"/></div></figure><p id="4ba2" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">我们看到前150个主成分占方差的80%以上。<br/>对数据帧中的前150个变量进行子集化。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="5b2d" class="li ir ht le b fv lj lk l ll lm"># Train data set<br/>housetrain &lt;- data.frame(SalePrice = train$SalePrice, prin_train$x)<br/>housetrain &lt;- housetrain[,1:151]</span><span id="f3b5" class="li ir ht le b fv ln lk l ll lm"># Test data set<br/>housetest &lt;- predict(prin_train, newdata = testnewpred)<br/>housetest &lt;- as.data.frame(housetest)<br/>housetest &lt;- housetest[,1:150]</span></pre><h1 id="8c90" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">脱字包概述:</strong></h1><p id="650a" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">机器学习初学者面临的最大挑战之一是学习和专注于哪些算法。在R的情况下，由于各种算法将具有不同的语法、不同的要调整的参数以及对数据格式的不同要求，这个问题变得更加突出。这对初学者来说可能太难了。</p><p id="ea5c" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">那么，你如何从一个初学者转变为一个数据科学家，构建数百个模型并将它们堆叠在一起呢？当然没有任何捷径，但我今天要告诉你的将使你能够应用数百个机器学习模型，而不必:</p><ul class=""><li id="aab7" class="lo lp ht jq b jr kr jv ks jz lq kd lr kh ls kl lt lu lv lw dt translated">记住每个算法不同的包名。</li><li id="670c" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">应用每种算法的语法。</li><li id="ae10" class="lo lp ht jq b jr lx jv ly jz lz kd ma kh mb kl lt lu lv lw dt translated">为每个算法调整的参数。</li></ul><p id="103d" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">所有这些都是经过多年的努力才成为可能的，这可能是r中最大的项目。这个包是你解决几乎任何监督机器学习问题所需要知道的全部。它为几种机器学习算法提供了统一的接口，并标准化了各种其他任务，如数据分割、预处理、特征选择、变量重要性估计等。</p><p id="4153" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">跟随<a class="ae km" href="https://www.machinelearningplus.com/machine-learning/caret-package/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hu">这篇</strong> </a>文章可以很好地了解caret包是如何工作的。</p><p id="3a1e" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">现在我们已经完成了数据处理部分，让我们将注意力集中在创建用于预测测试数据集的训练模型上。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="12b7" class="li ir ht le b fv lj lk l ll lm">library(caret)</span></pre><p id="b08f" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">caret包最大的优点是它允许我们在一个包中使用超过175种算法。我们来谈谈过度杀戮。<br/>点击<a class="ae km" href="http://topepo.github.io/caret/available-models.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hu">此处</strong> </a>了解脱字包遵循的算法。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="ca75" class="li ir ht le b fv lj lk l ll lm"># See available algorithms in caret<br/>modelnames &lt;- paste(names(getModelInfo()), collapse=',  ')<br/>modelnames</span></pre><p id="50a8" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">如果你想知道更多细节，比如超参数，如果它可以用于回归或分类问题，那么做一个</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="80b3" class="li ir ht le b fv lj lk l ll lm">modelLookup(algo)</span></pre><blockquote class="kn ko kp"><p id="f633" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated"><code class="eh mg mh mi le b"><strong class="jq hu">train()</strong></code>:该函数为多个分类和回归例程建立一个调整参数网格，拟合每个模型并计算基于重采样的性能测量。<br/>除了构建模型之外<code class="eh mg mh mi le b">train()</code>还做其他事情，如:</p><p id="979c" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">1.交叉验证模型</p><p id="fbe7" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">2.调整超级参数以获得最佳模型性能</p><p id="598b" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">3.根据给定的评估指标选择最佳模型</p><p id="ebf3" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">4.预处理预测器(我们目前使用<code class="eh mg mh mi le b">preProcess()</code>所做的)</p><p id="a19d" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated"><code class="eh mg mh mi le b">trainControl():</code><code class="eh mg mh mi le b">train()</code>函数采用接受<code class="eh mg mh mi le b">trainControl()</code>输出的<code class="eh mg mh mi le b">trControl</code>参数。</p><p id="acad" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">在<code class="eh mg mh mi le b">trainControl()</code>内部，你可以控制<code class="eh mg mh mi le b">train()</code>如何:</p><p id="4ff3" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">1.要使用的交叉验证方法。</p><p id="74ad" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">2.如何使用汇总函数对结果进行汇总</p><p id="0370" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">交叉验证<code class="eh mg mh mi le b">method</code>可以是以下之一:</p><p id="7a65" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">“引导”:引导取样</p><p id="cfa0" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">“boot632”:应用63.2%偏置校正的自举采样</p><p id="47c2" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">“乐观boot”:乐观自助估计量</p><p id="0780" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">' boot_all ':所有引导方法。</p><p id="72d4" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">cv': k重交叉验证</p><p id="f93f" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">“重复的cv”:重复的k重交叉验证</p><p id="08a4" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">oob ':袋外交叉验证</p><p id="843c" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">LOOCV:漏掉一个交叉验证</p><p id="2116" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">“LGOCV”:不进行组交叉验证</p><p id="7cf5" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">如果Y是二进制类，则<code class="eh mg mh mi le b">summaryFunction</code>可以是<code class="eh mg mh mi le b">twoClassSummary</code>，如果Y有两个以上的类别，则可以是<code class="eh mg mh mi le b">multiClassSummary</code>。</p><p id="c8c5" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hm dt translated">通过设置<code class="eh mg mh mi le b">classProbs=T</code>,生成概率分数，而不是基于0.5的预定截止值直接预测类别。</p></blockquote><h1 id="45ae" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">培训模式:</strong></h1><p id="2ec2" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">为我们的算法如何工作创建trControl参数。我们将使用repeatedCV。CV代表<a class="ae km" href="https://machinelearningmastery.com/k-fold-cross-validation/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hu">交叉验证技术</strong> </a>。<br/> RepeatedCV说明了我们将重复交叉验证的次数。为了更好地理解数据，可以把它看作一个for循环。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="83ee" class="li ir ht le b fv lj lk l ll lm">control &lt;- trainControl(method = "repeatedcv", repeats = 3)</span></pre><p id="1572" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">很简单，是吧？随着你对脱字符号包的深入研究，你将需要更多的参数来帮助你。但是现在我们将坚持最基本的。</p><p id="1ccb" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">让我们为不同的算法创建不同的模型:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="83e5" class="li ir ht le b fv lj lk l ll lm"># Decision Tree:<br/>model_dt &lt;- train(SalePrice~., data=housetrain, trControl = control, method = "rpart",tuneLength = 15)</span><span id="f847" class="li ir ht le b fv ln lk l ll lm"># Random Forest:<br/>model_rf &lt;- train(SalePrice~., data=housetrain, trControl = control, method = "rf", tuneLength = 15)</span><span id="3477" class="li ir ht le b fv ln lk l ll lm"># kNN<br/>model_knn &lt;- train(SalePrice~., housetrain, trControl = control, method = "knn", tuneLength = 15)</span></pre><p id="88be" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">请注意，这将需要大量的时间来计算。好像花了很多时间。尤其是随机森林。你会发现所有的算法都有几乎相同类型的语法。这就是caret套装的额外津贴。不需要记住不同包的所有参数。<br/>虽然这也是caret package的失败之处，因为为了根据您的特定需求调整模型，它并没有多大帮助，因为它没有考虑所有的参数。</p><h1 id="31dd" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">预测测试数据集:</strong></h1><p id="f9d9" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">我们的模型现在已经被训练来学习特征和目标之间的关系。下一步就是搞清楚模型有多好！为此，我们对测试特征进行预测(永远不允许模型看到测试答案)。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="b53b" class="li ir ht le b fv lj lk l ll lm"># Decision Tree<br/>pred_dt &lt;- predict(model_dt, housetest)</span><span id="05cd" class="li ir ht le b fv ln lk l ll lm"># Random Forest<br/>pred_rf &lt;- predict(model_rf, housetest)</span><span id="9d57" class="li ir ht le b fv ln lk l ll lm"># kNN<br/>pred_knn &lt;- predict(model_knn, housetest)</span></pre><p id="da0d" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">瞧啊。我们有测试数据集的输出。<br/>现在我们需要以一种有组织的形式保存这些预测数据，以便在kaggle中提交。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="87f2" class="li ir ht le b fv lj lk l ll lm"># Decision Tree<br/>dt_df &lt;- data.frame(ID = row.names(housetest), SalePrice = pred_dt)<br/>write.csv(dt_df, file = "DecisionTree.csv", row.names = F)</span><span id="cc69" class="li ir ht le b fv ln lk l ll lm"># Random Forest<br/>rf_df &lt;- data.frame(ID = row.names(housetest), SalePrice = pred_rf)<br/>write.csv(rf_df, file = "RandomForest.csv", row.names = F)</span><span id="bfdd" class="li ir ht le b fv ln lk l ll lm"># kNN<br/>knn_df &lt;- data.frame(ID = row.names(housetest), SalePrice = pred_knn)<br/>write.csv(knn_df, file = "kNN.csv", row.names = F)</span></pre><p id="dfc4" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">现在你要做的就是在这个<a class="ae km" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/submit" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hu">链接</strong> </a> <strong class="jq hu">中提交创建好的csv文件。</strong></p><h1 id="a230" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated"><strong class="ak">结论:</strong></h1><p id="315f" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">有了这些代码，我们来到了本文的结尾部分。此时，如果您想改进代码，我们可以尝试在不同的算法集上进行超参数调整。也许更多的是探索数据集以获得变量的一般概念。<br/>此外，可用数据越多，预测数据越好。如果有人能够不使用不同的算法，而是通过处理数据来提高模型的性能，那将是令人鼓舞的。<br/>对于那些真正有兴趣了解caret包的来龙去脉的人，我强烈推荐<a class="ae km" href="https://www.machinelearningplus.com/machine-learning/caret-package/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hu">这篇</strong> </a>文章，它是我偶然发现的，对我帮助很大。此外，我希望每一个通过考试的人都已经看到机器学习变得多么容易，并准备好加入欢迎和有益的机器学习社区。</p><p id="694a" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">一如既往，我欢迎反馈和建设性的批评！我的电子邮件是mervyn.akash10@gmail.com。</p><p id="7429" class="pw-post-body-paragraph jo jp ht jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hm dt translated">编码快乐！！</p></div></div>    
</body>
</html>