<html>
<head>
<title>Atomic tips</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">原子提示</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/atomic-tips-berlin-workshop-materials-c5c8ee3f46aa?source=collection_archive---------0-----------------------#2019-08-27">https://medium.com/coinmonks/atomic-tips-berlin-workshop-materials-c5c8ee3f46aa?source=collection_archive---------0-----------------------#2019-08-27</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="1b09" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">使用Python工具集编写Tezos应用程序</h2></div><p id="6f55" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">上周，我们在柏林奇妙的TQuorum活动上举办了一场研讨会。虽然并非一切都很顺利，但我们希望能够传达主要观点:使用我们的Python工具集与Tezos交互非常容易。</p><ul class=""><li id="edad" class="ke kf ht jk b jl jm jo jp jr kg jv kh jz ki kd kj kk kl km dt translated">设置环境没必要，用<a class="ae kn" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">云Jupyter笔记本</a>即可；</li><li id="4e33" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd kj kk kl km dt translated">需要最低限度的开发技能，交互式文档将支持你直到最后；</li><li id="bf05" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd kj kk kl km dt translated">预填充的凭据和密钥(仅用于演示目的)允许在几秒钟内启动。</li></ul><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff kt"><img src="../Images/ec57258684c6d64c22ad7522bfc0837c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J1PtNy-1Qfzp81L4wNXNAQ.png"/></div></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">PAIR %Python %Tezos ;</figcaption></figure><p id="1d00" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在这篇文章中，我们将回顾我们开发的应用程序的概念和范围。我们还附上了一个稍加修改的笔记本，以便您可以随时重现实验。</p><h1 id="199e" class="lj lk ht bd ll lm ln lo lp lq lr ls lt iz lu ja lv jc lw jd lx jf ly jg lz ma dt translated">原子交换基础</h1><p id="344b" class="pw-post-body-paragraph ji jj ht jk b jl mb iu jn jo mc ix jq jr md jt ju jv me jx jy jz mf kb kc kd hm dt translated">术语“原子互换”有一个相当一般的定义，在本研讨会中，我们将表示以下含义:双方交换两种不同类型的资产，这些交易必须要么成功，要么不成功。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff mg"><img src="../Images/3075200faa20947c8c104a56ec6c0432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_snQEcqROb-bjRQf"/></div></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">Atomic swap solves the trust issue</figcaption></figure><p id="4000" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">原子交换解决了各方之间的信任问题。在现实世界中，它是通过引入可信任的第三方来实现的，例如银行或政府。在区块链的世界里，我们可以用智能合约取代第三方，结果是，我们有了一种完全不可信的方式来交换资产。</p><p id="ff4c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">但和往常一样，事情并没有那么简单。交换协议是交互式的，这意味着仅仅正确地初始化和发送事务是不够的，还需要及时地执行一些操作。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff mh"><img src="../Images/43741cfc6e1b62449727dbacc26a97b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g7y-aZyqNNrDsLxmSoUZRA.png"/></div></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">Drastically simplified XTZ/ETH swap timeline</figcaption></figure><p id="c206" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">您可以在简化的时间线上看到，交换启动器(Michel)必须延迟两次执行操作。他还被限制在一个相对较短的时间间隔内，如果由于某种原因在那个时候无法进入区块链，他有非零的可能性失去他的资金。</p><p id="c096" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">好消息是，最后一个任务可以由第三方来完成，而协议仍然是安全的。匿名的英雄会得到一点小小的奖励，所以这是一种保护原子交换的经济激励，也是一种“谁更快”的挑战。</p><h1 id="e56e" class="lj lk ht bd ll lm ln lo lp lq lr ls lt iz lu ja lv jc lw jd lx jf ly jg lz ma dt translated">实施细节</h1><p id="e44b" class="pw-post-body-paragraph ji jj ht jk b jl mb iu jn jo mc ix jq jr md jt ju jv me jx jy jz mf kb kc kd hm dt translated">我们将使用由<a class="ae kn" href="https://atomix.me/" rel="noopener ugc nofollow" target="_blank"> Atomix.me </a>实现的原子交换。我们来看看他们在Tezos alphanet的<a class="ae kn" href="https://better-call.dev/alpha/KT1WhouvVKZFH94VXj9pa8v4szvfrBwXoBUj/operations" rel="noopener ugc nofollow" target="_blank">合约</a>。有三个主要的入口点可以改变当前的互换状态和转移资金。</p><ul class=""><li id="c5b8" class="ke kf ht jk b jl jm jo jp jr kg jv kh jz ki kd kj kk kl km dt translated"><em class="mi"> initiate </em>添加新的big_map条目，包含交换协议所需的所有数据，<code class="eh mj mk ml mm b">sha256(sha256(secret))</code>用作关键字；</li><li id="8109" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd kj kk kl km dt translated"><em class="mi">兑换</em>移除big_map条目，并向参与者转账(他需要知道<code class="eh mj mk ml mm b">secret</code>)；</li><li id="fbeb" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd kj kk kl km dt translated"><em class="mi">退款</em>如果出了问题可以回滚；</li></ul><p id="9501" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了简单起见，我们将代表两方，不要求其他区块链提供任何数据。这是我们将要做的计划:</p><ol class=""><li id="fb77" class="ke kf ht jk b jl jm jo jp jr kg jv kh jz ki kd mn kk kl km dt translated">生成一个<em class="mi">秘密</em>，使用<code class="eh mj mk ml mm b">initiate</code>条目创建一个新的交换(作为<em class="mi">发起者</em>)；</li><li id="519f" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd mn kk kl km dt translated">获取活动交换，即现有big_map条目(作为第三方<em class="mi"/>)</li><li id="b9b3" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd mn kk kl km dt translated">使用我们生成的秘密进行<em class="mi">赎回</em>，就好像我们是从另一个区块链那里提取的一样。</li></ol><h1 id="b5db" class="lj lk ht bd ll lm ln lo lp lq lr ls lt iz lu ja lv jc lw jd lx jf ly jg lz ma dt translated">实际工作</h1><p id="c79f" class="pw-post-body-paragraph ji jj ht jk b jl mb iu jn jo mc ix jq jr md jt ju jv me jx jy jz mf kb kc kd hm dt translated">我们现在准备进入实际部分，首先让我们安装所有必要的包:</p><pre class="ku kv kw kx fq mo mm mp mq aw mr dt"><span id="1dd4" class="ms lk ht mm b fv mt mu l mv mw"><strong class="mm hu">!</strong>apt-get install libsodium-dev libsecp256k1-dev libgmp-dev<br/><strong class="mm hu">!</strong>pip install pytezos conseil</span></pre><p id="61f8" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">然后我们使用PyTezos创建一个新的交换。</p><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="0290" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">下面是我们在<a class="ae kn" href="https://better-call.dev/alpha/KT1WhouvVKZFH94VXj9pa8v4szvfrBwXoBUj/operations" rel="noopener ugc nofollow" target="_blank">better-call . dev</a>explorer中的操作:</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff mz"><img src="../Images/a9a1c68b450a54c6d7873f167b526570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zLhXK_i2gue7IlG7dkbbrA.png"/></div></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">Swap initialization</figcaption></figure><p id="b705" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">接下来，我们需要获得所有最近的big_map条目。我们将使用ConseilPy来获取对<em class="mi"> (block_level，operation_group_hash) </em>，这样我们就可以随后使用PyTezos请求<em class="mi"> big_map_diff </em>。</p><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="3951" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">最后，我们可以进行兑换，但是我们应该使用另一个身份(密钥)来进行兑换。去<a class="ae kn" href="https://faucet.tzalpha.net/" rel="noopener ugc nofollow" target="_blank">https://faucet.tzalpha.net/</a>下载一个包含关键数据的json文件。</p><figure class="ku kv kw kx fq ky"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="b817" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">有用！请注意，有两个内部交易，其中之一是我们的小费:</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="fe ff na"><img src="../Images/5d8a779d5cc400f495f1a8c356857c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3FUJiVUz7SHwhzMe1pgPA.png"/></div></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">Successful redeem</figcaption></figure><h1 id="9944" class="lj lk ht bd ll lm ln lo lp lq lr ls lt iz lu ja lv jc lw jd lx jf ly jg lz ma dt translated">了解关于我们工具集的更多信息</h1><h2 id="1939" class="ms lk ht bd ll nb nc nd lp ne nf ng lt jr nh ni lv jv nj nk lx jz nl nm lz nn dt translated">派特佐斯</h2><p id="5f20" class="pw-post-body-paragraph ji jj ht jk b jl mb iu jn jo mc ix jq jr md jt ju jv me jx jy jz mf kb kc kd hm dt translated">Python SDK for Tezos，提供查询RPC端点、发送操作、与智能契约交互、使用密钥的功能。</p><ul class=""><li id="0198" class="ke kf ht jk b jl jm jo jp jr kg jv kh jz ki kd kj kk kl km dt translated"><a class="ae kn" rel="noopener" href="/coinmonks/high-level-interface-for-michelson-contracts-and-not-only-7264db76d7ae">介绍帖</a></li><li id="ed7b" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd kj kk kl km dt translated"><a class="ae kn" href="https://baking-bad.github.io/pytezos/" rel="noopener ugc nofollow" target="_blank">快速入门指南</a></li><li id="0b65" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd kj kk kl km dt translated"><a class="ae kn" href="https://github.com/baking-bad/pytezos" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a></li></ul><h2 id="e472" class="ms lk ht bd ll nb nc nd lp ne nf ng lt jr nh ni lv jv nj nk lx jz nl nm lz nn dt translated">顺从</h2><p id="d772" class="pw-post-body-paragraph ji jj ht jk b jl mb iu jn jo mc ix jq jr md jt ju jv me jx jy jz mf kb kc kd hm dt translated">由Cryptonomic为<a class="ae kn" href="https://cryptonomic.github.io/Conseil/#/" rel="noopener ugc nofollow" target="_blank"> Conseil </a>区块链索引器提供的Python包装器，提供对索引的Tezos区块链数据的访问。</p><ul class=""><li id="923d" class="ke kf ht jk b jl jm jo jp jr kg jv kh jz ki kd kj kk kl km dt translated"><a class="ae kn" rel="noopener" href="/coinmonks/digging-into-tezos-with-conseilpy-86e0564ffbd5">演示分析文章</a></li><li id="1932" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd kj kk kl km dt translated"><a class="ae kn" href="https://github.com/baking-bad/conseilpy" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a></li></ul><h2 id="ff5d" class="ms lk ht bd ll nb nc nd lp ne nf ng lt jr nh ni lv jv nj nk lx jz nl nm lz nn dt translated">最好打电话给戴夫</h2><p id="479c" class="pw-post-body-paragraph ji jj ht jk b jl mb iu jn jo mc ix jq jr md jt ju jv me jx jy jz mf kb kc kd hm dt translated">迈克尔逊合同浏览器以一种方便的格式显示交易参数、存储和big_map差异。</p><ul class=""><li id="5464" class="ke kf ht jk b jl jm jo jp jr kg jv kh jz ki kd kj kk kl km dt translated"><a class="ae kn" rel="noopener" href="/coinmonks/michelson-rocks-but-you-better-call-dev-e23cd32a299a">功能概述</a></li><li id="5c5f" class="ke kf ht jk b jl ko jo kp jr kq jv kr jz ks kd kj kk kl km dt translated"><a class="ae kn" href="https://better-call.dev/" rel="noopener ugc nofollow" target="_blank">挑选随机合同</a></li></ul><p id="53cc" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在<a class="ae kn" href="https://twitter.com/tezosbakingbad" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我们，加入我们舒适的<a class="ae kn" href="https://t.me/baking_bad_chat" rel="noopener ugc nofollow" target="_blank"> Telegram </a>聊天，在这里你可以问任何关于我们产品和服务的问题。</p></div><div class="ab cl no np hb nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="hm hn ho hp hq"><p id="23a9" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">加入第一届<a class="ae kn" href="https://eeth.one/en" rel="noopener ugc nofollow" target="_blank">东欧Tezos黑客马拉松</a>，致力于Tezos平台的不可替代令牌标准。这将是基辅Tezos社区难以置信的三天(9月6日至8日)。</p><p id="ef59" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">那里见！</p><p id="b264" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><em class="mi">最初发表于2019年8月27日</em><a class="ae kn" href="https://baking-bad.org/blog/2019/08/27/atomic-swap-tips-berlin-tezos-workshop-materials/" rel="noopener ugc nofollow" target="_blank"><em class="mi">https://baking-bad.org</em></a><em class="mi">，在那里你可以找到文章的完整版本。</em></p><blockquote class="nv"><p id="336d" class="nw nx ht bd ny nz oa ob oc od oe kd ek translated"><a class="ae kn" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="og oh oi oj ok ky fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff of"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>