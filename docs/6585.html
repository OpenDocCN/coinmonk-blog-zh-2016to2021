<html>
<head>
<title>Predict crypto market with NaiveBayes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用朴素贝叶斯预测密码市场</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/predict-crypto-market-with-naivebayes-49e8caa7d088?source=collection_archive---------1-----------------------#2021-12-24">https://medium.com/coinmonks/predict-crypto-market-with-naivebayes-49e8caa7d088?source=collection_archive---------1-----------------------#2021-12-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="c840" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">比特币的下一个价格会是多少？我真的不在乎:)任何算法也不在乎。更重要的是市场下一步会在哪里上涨、下跌还是保持中立？！</p><p id="e4b5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我测试的大多数算法都是根据过去的价格来预测未来的价格，作为一个长期交易者，我可以肯定这对一些交易者来说就像是眼里的沙子，给了他们一个不容易预测的东西的希望。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/50d9d5067a96f89a266ce347f641a340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9h6B8ZQ_LJRAfQ-A"/></div></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">Photo by <a class="ae ke" href="https://unsplash.com/@jeremybezanger?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jeremy Bezanger</a> on <a class="ae ke" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="63f6" class="kf kg ht bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">跳出框框思考！</h1><p id="3f24" class="pw-post-body-paragraph iq ir ht is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">如果我有不同的想法，愿意让未来的预测价格更像数字0，1，2呢？我知道这对你来说没什么好激动的。现在我可以说，0表示市场中性，1表示市场看涨，2表示市场看跌。</p><p id="291d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这篇文章是临时写的，我还不知道最后的结果会是什么。也许我找到了圣杯，或者只是在浪费时间。</p><h1 id="7581" class="kf kg ht bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">数据准备</h1><p id="994b" class="pw-post-body-paragraph iq ir ht is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">对于数据，我使用我自己的数据库，通过套接字从币安存储，因为我认为它更适合一些公共的。主要原因是我正在收集更详细的数据，这些数据应该是(我希望)做出预测的关键优势。</p><p id="5fe8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用websocket将数据记录到币安，并存储到MongoDB。这是我调用它的那部分代码:</p><pre class="jp jq jr js fq li lj lk ll aw lm dt"><span id="260f" class="ln kg ht lj b fv lo lp l lq lr">#Details to connect to DB - you can use mysql, csv, yfinance or any other I am using MongoDB<br/>from mongo.mongodb import DBConnection<br/>import pymongo<br/>import pandas as pd<br/>#Load dataset<br/><br/>login = DBConnection().login()<br/>db_login = login["binance_24hTicker"]["ADAUSDT"]<br/>the_list2 = []<br/>get_all_data_from_token2 = db_login.find().sort('_id', pymongo.DESCENDING).limit(400)<br/>for last_values_fromDb2 in get_all_data_from_token2:<br/>    the_list2.append(last_values_fromDb2)<br/><br/>df = pd.DataFrame(the_list2)<br/>print(df)</span></pre><div class="ls lt fm fo lu lv"><a href="https://tokensquant.medium.com/store-binance-socket-data-mongodb-450781809bac" rel="noopener follow" target="_blank"><div class="lw ab ej"><div class="lx ab ly cl cj lz"><h2 class="bd hu fv z el ma eo ep mb er et hs dt translated">将币安套接字数据存储到mongoDB</h2><div class="mc l"><h3 class="bd b fv z el ma eo ep mb er et ek translated">SQL很好，对于与db交互的较大群体来说，可能是Mongo的更好选择。就一次我去了…</h3></div><div class="md l"><p class="bd b gc z el ma eo ep mb er et ek translated">tokensquant.medium.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj jy lv"/></div></div></a></div><p id="c78a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">所有数据都更改为0，1，2值后，DF如下所示:</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff mk"><img src="../Images/556498fbf3819e1651a8c26b75faf4b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*L1bep97W034-rRnaX0cL6Q.png"/></div></figure><p id="329f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">除了标准的OHLC数据量，我还记录了一些额外的深度，更详细的数据量等。虽然我喜欢在这些阶段分享很多东西，但一些详细的数据和公式，我是如何计算的，将在下一篇文章中讨论。</p><p id="17db" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">经过几次测试、思考、奋斗、发展、教育……我的想法是DF中的每一行都应该是独立的值——意思是适合朴素贝叶斯。比如说。上午11:00:01的数据是一个无名氏，有参数。他最后一分钟的移动是0，1或2。意思是0 =不移动，1 =向下移动，2 =向上移动。在这些点上，算法不需要知道它移动了多少，只需要知道它确实移动了。朴素贝叶斯不是那种可以预测移动的算法。因此，数据的管理方式如下:</p><blockquote class="ml mm mn"><p id="d134" class="iq ir mo is b it iu iv iw ix iy iz ja mp jc jd je mq jg jh ji mr jk jl jm jn hm dt translated"><strong class="is hu"> <em class="ht">秒杀:</em>真为0，假为1 </strong></p><p id="3cdc" class="iq ir mo is b it iu iv iw ix iy iz ja mp jc jd je mq jg jh ji mr jk jl jm jn hm dt translated"><strong class="is hu"> <em class="ht">基于上次收盘移动:</em>0 =无，1 =向下，2 =向上</strong></p><p id="2366" class="iq ir mo is b it iu iv iw ix iy iz ja mp jc jd je mq jg jh ji mr jk jl jm jn hm dt translated"><strong class="is hu"> <em class="ht"> RSI: </em> 30 = 0，30–70 = 1，70+= 2 </strong></p><p id="5dde" class="iq ir mo is b it iu iv iw ix iy iz ja mp jc jd je mq jg jh ji mr jk jl jm jn hm dt translated"><strong class="is hu"> <em class="ht">音量:</em>0 =不变，1 =低，2 =高</strong></p><p id="51e9" class="iq ir mo is b it iu iv iw ix iy iz ja mp jc jd je mq jg jh ji mr jk jl jm jn hm dt translated"><strong class="is hu"> <em class="ht">选择的符号是:</em> ADAUSD </strong></p></blockquote><pre class="jp jq jr js fq li lj lk ll aw lm dt"><span id="8a94" class="ln kg ht lj b fv lo lp l lq lr">import talib<br/>def RSI(data, window=14, adjust=False):<br/>    delta = data['Close'].diff(1).dropna()<br/>    loss = delta.copy()<br/>    gains = delta.copy()<br/><br/>    gains[gains &lt; 0] = 0<br/>    loss[loss &gt; 0] = 0<br/><br/>    gain_ewm = gains.ewm(com=window - 1, adjust=adjust).mean()<br/>    loss_ewm = abs(loss.ewm(com=window - 1, adjust=adjust).mean())<br/><br/>    RS = gain_ewm / loss_ewm<br/>    RSI = 100 - 100 / (1 + RS)<br/><br/>    return RSI<br/><br/>reversed_df = df.iloc[::-1]<br/>df["RSI"] = talib.RSI(reversed_df["Close"], 14)<br/><br/><br/>import matplotlib.pyplot as plt<br/>ax1 = plt.subplot2grid((10, 1), (0, 0), rowspan=4, colspan=1)<br/>ax2 = plt.subplot2grid((10, 1), (5, 0), rowspan=4, colspan=1)<br/>ax1.plot(df['Close'], linewidth=2.5)<br/>ax1.set_title('ADAUSDT')<br/>ax2.plot(df['RSI'], color='red', linewidth=1.5)<br/>ax2.axhline(30, linestyle='--', linewidth=1.5, color='grey')<br/>ax2.axhline(70, linestyle='--', linewidth=1.5, color='grey')<br/>ax2.set_title('ADA RSI')<br/><br/>plt.show()</span></pre><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ms"><img src="../Images/af8643c2003f747d4454491b92793cea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*hHp4C8VhS5c2buYiAgylrA.png"/></div></figure><p id="7cfd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了使我的0，1，2点可视化，下面的图表将向你展示我是如何想象它们的。红色表示RSI高于70，在我的DF中记为1，绿色表示RSI低于30，在DF中记为2，所有其他值为0，表示RSI在30-70之间(不在图表上)。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff mt"><img src="../Images/fd52bed47006e7f4b18f0478c2133617.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RhUL25KIpZV_n9_VdFB_3w.png"/></div></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">RSI with marings of values above 70 and bellow 30</figcaption></figure><p id="1d44" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">好吧，我们要去一个地方。免责声明:在我的图表上，仅从低于30的绿点或RSI水平交易看起来是成功的，事实比这更复杂。</p><p id="8992" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们在图表上绘制一些额外的数据，就像体积一样。又是0正常，1低，2高。这个想法是计算平均值，从10%到90%都是0为正常，0-10为低，90-100为高。公式是这样的:</p><pre class="jp jq jr js fq li lj lk ll aw lm dt"><span id="b83f" class="ln kg ht lj b fv lo lp l lq lr">df["VolumePercent"] = (df["Volume"] / df["Volume"].sum()) * 100</span></pre><p id="f02e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我们计算出每一行的百分比后，是时候对它们进行正确排序，然后将前10%(红色)和后10%(紫色)相加:</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff mt"><img src="../Images/627ec367d47df5053d9e1b2ea8173288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qfhRCFxwPx7wAu8BaI9rEQ.png"/></div></div></figure><p id="31e9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">经过一些测试，挖掘，计算，一些有趣的东西出现了。在下面的第一张图中，蓝色散点图显示了成交量低于10%的区域，红色仍然显示了RSI突破70的位置。这两者的结合似乎是一个很好的切入点。意义。不要真的只是在相对强弱指标达到30就交易，而是等待合适的时机，也许合适的时机与交易量相结合(有待测试)。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff mt"><img src="../Images/a7ef1d5ecce9520c09b004fa1a2ec587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G0Ommv39OWcHrUk_OLziyw.png"/></div></div></figure><p id="2be4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我真的感到很兴奋，从这些图表中，我更接近结合两个指标预测进入。将它们更改为0、1、2级看起来效果不错。现在是测试NB和他的准确性的时候了。</p><pre class="jp jq jr js fq li lj lk ll aw lm dt"><span id="2a35" class="ln kg ht lj b fv lo lp l lq lr"># Split dataset into training set and test set<br/>x = df[["BuyCount012", "SellCount012", "test1"]].astype(int)<br/>y = df["RSI012"].astype(int)<br/><br/>X_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.2) # 70% training and 30% test<br/>print(X_train.shape, X_test.shape, y_train.shape, y_test.shape)<br/><br/>#Create a Gaussian Classifier<br/>gnb = GaussianNB()<br/><br/>#Train the model using the training sets<br/>model = gnb.fit(X_train, y_train)<br/><br/>#Predict the response for test dataset<br/>y_pred = gnb.predict(X_test)<br/><br/># Model Accuracy, how often is the classifier correct?<br/>print("Accuracy:",metrics.accuracy_score(y_test, y_pred))</span></pre><p id="6cb7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">初步数据的最终结果看起来很有希望，高达81%！</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff mu"><img src="../Images/71c114c144ce7273f554aa6d71566490.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*TVknuUSGzBASd6y4KjEqMQ.png"/></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">NaiveBayes</figcaption></figure><h1 id="9ca4" class="kf kg ht bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated"><strong class="ak">结论</strong></h1><p id="8483" class="pw-post-body-paragraph iq ir ht is b it ld iv iw ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">工作还没有完成，看起来只是一些有希望的结果的开始。下一个阶段是回溯测试，也就是动态测试，修改收集的数据并找出关键数据。</p><p id="c4a0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">请继续关注更新，如果你有什么想法/意见，请联系我！</p><blockquote class="ml mm mn"><p id="d772" class="iq ir mo is b it iu iv iw ix iy iz ja mp jc jd je mq jg jh ji mr jk jl jm jn hm dt translated">谢谢你没有保存我的上一个版本。给自己一个提示——总是在本地保存一份副本。由于文章是重做的，一些丢失的数据对不起读者！！</p></blockquote><p id="49e3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">鼓掌！</strong></p><p id="d8fb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">关注</strong>了解更多！</p><blockquote class="mv"><p id="cebf" class="mw mx ht bd my mz na nb nc nd ne jn ek translated">加入Coinmonks <a class="ae ke" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae ke" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h2 id="6048" class="ln kg ht bd kh nf ng nh kl ni nj nk kp jb nl nm kt jf nn no kx jj np nq lb nr dt translated">也阅读</h2><div class="ls lt fm fo lu lv"><a rel="noopener follow" target="_blank" href="/coinmonks/leveraged-token-3f5257808b22"><div class="lw ab ej"><div class="lx ab ly cl cj lz"><h2 class="bd hu fv z el ma eo ep mb er et hs dt translated">杠杆代币[多头代币]终极指南</h2><div class="mc l"><h3 class="bd b fv z el ma eo ep mb er et ek translated">杠杆化令牌是具有杠杆化风险敞口的ERC20令牌，不考虑保证金、要求、管理…</h3></div><div class="md l"><p class="bd b gc z el ma eo ep mb er et ek translated">medium.com</p></div></div><div class="me l"><div class="ns l mg mh mi me mj jy lv"/></div></div></a></div><div class="ls lt fm fo lu lv"><a href="https://blog.coincodecap.com/crypto-exchange" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab ej"><div class="lx ab ly cl cj lz"><h2 class="bd hu fv z el ma eo ep mb er et hs dt translated">最佳加密交易所| 2021年十大加密货币交易所</h2><div class="mc l"><h3 class="bd b fv z el ma eo ep mb er et ek translated">加密货币交易所的加密交易需要了解市场，这可以帮助你获得利润。之前…</h3></div><div class="md l"><p class="bd b gc z el ma eo ep mb er et ek translated">blog.coincodecap.com</p></div></div><div class="me l"><div class="nt l mg mh mi me mj jy lv"/></div></div></a></div><div class="ls lt fm fo lu lv"><a href="https://blog.coincodecap.com/best-swap-platforms" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab ej"><div class="lx ab ly cl cj lz"><h2 class="bd hu fv z el ma eo ep mb er et hs dt translated">2021年最佳加密交换平台| CoinCodeCap</h2><div class="mc l"><h3 class="bd b fv z el ma eo ep mb er et ek translated">编辑描述</h3></div><div class="md l"><p class="bd b gc z el ma eo ep mb er et ek translated">blog.coincodecap.com</p></div></div><div class="me l"><div class="nu l mg mh mi me mj jy lv"/></div></div></a></div><div class="ls lt fm fo lu lv"><a rel="noopener follow" target="_blank" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa"><div class="lw ab ej"><div class="lx ab ly cl cj lz"><h2 class="bd hu fv z el ma eo ep mb er et hs dt translated">2021年最佳加密借贷平台| 6大比特币借贷平台</h2><div class="mc l"><h3 class="bd b fv z el ma eo ep mb er et ek translated">获得比特币和其他加密货币的最佳贷款利率</h3></div><div class="md l"><p class="bd b gc z el ma eo ep mb er et ek translated">medium.com</p></div></div><div class="me l"><div class="nv l mg mh mi me mj jy lv"/></div></div></a></div><div class="ls lt fm fo lu lv"><a rel="noopener follow" target="_blank" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069"><div class="lw ab ej"><div class="lx ab ly cl cj lz"><h2 class="bd hu fv z el ma eo ep mb er et hs dt translated">2021年6大最佳硬件钱包|顶级加密硬件钱包[更新]</h2><div class="mc l"><h3 class="bd b fv z el ma eo ep mb er et ek translated">最好的加密货币硬件钱包是绝对必要的。我们将在NGRAVE、Ledger Nano X和…</h3></div><div class="md l"><p class="bd b gc z el ma eo ep mb er et ek translated">medium.com</p></div></div><div class="me l"><div class="nw l mg mh mi me mj jy lv"/></div></div></a></div><div class="ls lt fm fo lu lv"><a rel="noopener follow" target="_blank" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a"><div class="lw ab ej"><div class="lx ab ly cl cj lz"><h2 class="bd hu fv z el ma eo ep mb er et hs dt translated">2021年最佳免费加密交易机器人</h2><div class="mc l"><h3 class="bd b fv z el ma eo ep mb er et ek translated">2021年币安、比特币基地、库币和其他密码交易所的最佳密码交易机器人。四进制，位间隙…</h3></div><div class="md l"><p class="bd b gc z el ma eo ep mb er et ek translated">medium.com</p></div></div><div class="me l"><div class="nx l mg mh mi me mj jy lv"/></div></div></a></div><div class="ls lt fm fo lu lv"><a rel="noopener follow" target="_blank" href="/coinmonks/best-crypto-signals-telegram-5785cdbc4b2b"><div class="lw ab ej"><div class="lx ab ly cl cj lz"><h2 class="bd hu fv z el ma eo ep mb er et hs dt translated">最佳4个加密交易信号电报通道</h2><div class="mc l"><h3 class="bd b fv z el ma eo ep mb er et ek translated">这是乏味的找到正确的加密交易信号提供商。因此，在本文中，我们将讨论最好的…</h3></div><div class="md l"><p class="bd b gc z el ma eo ep mb er et ek translated">medium.com</p></div></div><div class="me l"><div class="ny l mg mh mi me mj jy lv"/></div></div></a></div><div class="ls lt fm fo lu lv"><a href="https://blog.coincodecap.com/bitsgap-review" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab ej"><div class="lx ab ly cl cj lz"><h2 class="bd hu fv z el ma eo ep mb er et hs dt translated">获取信号、交易机器人和套利</h2><div class="mc l"><h3 class="bd b fv z el ma eo ep mb er et ek translated">编辑描述</h3></div><div class="md l"><p class="bd b gc z el ma eo ep mb er et ek translated">blog.coincodecap.com</p></div></div><div class="me l"><div class="nz l mg mh mi me mj jy lv"/></div></div></a></div></div></div>    
</body>
</html>