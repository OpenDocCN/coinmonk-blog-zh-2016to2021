<html>
<head>
<title>The ERC-223 Evolution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ERC-223的演变</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/the-erc-223-evolution-eec0ef23e5cc?source=collection_archive---------2-----------------------#2018-08-08">https://medium.com/coinmonks/the-erc-223-evolution-eec0ef23e5cc?source=collection_archive---------2-----------------------#2018-08-08</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/485f8382848ffb9d244c569ec09869b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oHmD9fRx7U1KoEr3.jpg"/></div></div></figure><p id="6802" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">免责声明</strong> : <em class="jz">我很轻松地使用ERC-223这个术语。对于EIP是否会重见天日，社会上并无共识。</em> <em class="jz">话虽如此，但仔细思考它试图解决的问题并参与讨论是一种很好的练习。</em></p><p id="65b3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="jz">完整的项目源代码可用</em> — <a class="ae ka" href="https://github.com/cipherzzz/erc223" rel="noopener ugc nofollow" target="_blank">此处</a></p><p id="f465" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">以太坊也有令牌丢失的灾难，就像大多数区块链项目在加密领域一样。其中一些损失是对智能合约的复杂攻击，一些令牌持有者只是将令牌发送到了错误的地址。如果你错把你的ERC20代币送给了某人，而他们心情很好，你可以把它们拿回来。如果你把它们发送到智能合同地址，你就可以和它们说再见了。他们走了。以太坊团队目前正在审核ERC223 EIP请求，可在此处找到<a class="ae ka" href="https://github.com/ethereum/EIPs/issues/223" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="kf kg l"/></div></figure><h2 id="3b33" class="kh ki ht bd kj kk kl km kn ko kp kq kr jm ks kt ku jq kv kw kx ju ky kz la lb dt translated">本文的目的</h2><p id="50bd" class="pw-post-body-paragraph jb jc ht jd b je lc jg jh ji ld jk jl jm le jo jp jq lf js jt ju lg jw jx jy hm dt translated">本文将尝试使用ERC-20令牌的<a class="ae ka" href="https://github.com/OpenZeppelin/openzeppelin-solidity/tree/master/contracts/token/ERC721" rel="noopener ugc nofollow" target="_blank"> OpenZeppelin </a>实现并实现建议的ERC-223方法，以最简单有用的形式创建一个ERC-223。我们还将创建测试来说明ERC-223规范所依赖的“回退”方法的用法，以便充分说明它在实践中的用法。</p></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><h2 id="9c56" class="kh ki ht bd kj kk kl km kn ko kp kq kr jm ks kt ku jq kv kw kx ju ky kz la lb dt translated">设置项目</h2><p id="66d1" class="pw-post-body-paragraph jb jc ht jd b je lc jg jh ji ld jk jl jm le jo jp jq lf js jt ju lg jw jx jy hm dt translated">确保您已经安装了node、npm和truffle</p><pre class="kb kc kd ke fq lo lp lq lr aw ls dt"><span id="754d" class="kh ki ht lp b fv lt lu l lv lw">mkdir erc223 &amp;&amp; cd erc223 &amp;&amp; truffle init</span></pre><p id="d666" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">用以下内容替换<em class="jz"> truffle.js </em>内容:</p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div></figure><p id="f1cf" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">安装<a class="ae ka" href="http://truffleframework.com/ganache/" rel="noopener ugc nofollow" target="_blank"> Ganache </a>并确保它在8545上运行</p><p id="dd8a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">编译和迁移</p><pre class="kb kc kd ke fq lo lp lq lr aw ls dt"><span id="7170" class="kh ki ht lp b fv lt lu l lv lw">truffle compile<br/>truffle migrate</span></pre><p id="3724" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">将文件夹初始化为npm项目</p><pre class="kb kc kd ke fq lo lp lq lr aw ls dt"><span id="8d2c" class="kh ki ht lp b fv lt lu l lv lw">npm init</span></pre><p id="6155" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">安装zeppelin依赖项</p><pre class="kb kc kd ke fq lo lp lq lr aw ls dt"><span id="21bf" class="kh ki ht lp b fv lt lu l lv lw">npm install zeppelin-solidity</span></pre></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><h2 id="e11f" class="kh ki ht bd kj kk kl km kn ko kp kq kr jm ks kt ku jq kv kw kx ju ky kz la lb dt translated">代币</h2><p id="3354" class="pw-post-body-paragraph jb jc ht jd b je lc jg jh ji ld jk jl jm le jo jp jq lf js jt ju lg jw jx jy hm dt translated">将以下内容作为<em class="jz"> MyERC223.sol </em>添加到/contracts中</p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div></figure><p id="3fb1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">将以下内容添加到/contracts中作为<em class="jz">ERC 223 receiving contract . sol。</em>这是我们符合erc223的智能合约必须遵循的接口。</p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div><figcaption class="ly lz fg fe ff ma mb bd b be z ek">The interface an erc223-compliant smart contract must adhere to</figcaption></figure><p id="6376" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">将以下内容作为<em class="jz"> MyERC20.sol添加到/contracts中。</em>注意，这是为了我们测试zeppelin契约的ERC20令牌恢复功能，<em class="jz"> HasNoTokens.sol </em></p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div></figure><p id="9adf" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">将以下迁移添加到/migrations，作为<em class="jz"> 2_erc_migration.js </em></p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div></figure></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><h2 id="a165" class="kh ki ht bd kj kk kl km kn ko kp kq kr jm ks kt ku jq kv kw kx ju ky kz la lb dt translated">合同</h2><p id="4870" class="pw-post-body-paragraph jb jc ht jd b je lc jg jh ji ld jk jl jm le jo jp jq lf js jt ju lg jw jx jy hm dt translated">将以下内容添加到/contracts，作为<em class="jz"> BalanceContract.sol </em></p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div><figcaption class="ly lz fg fe ff ma mb bd b be z ek">This contract manually implements the erc223 fallback method</figcaption></figure><p id="f195" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">将以下内容添加到/contracts，作为<em class="jz"> SafeContract.sol </em></p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div><figcaption class="ly lz fg fe ff ma mb bd b be z ek">This contract implements the zeppelin HasNoTokens.sol contract that implements the erc223 fallback method</figcaption></figure><p id="6c21" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">将以下内容添加到/contracts中，作为<em class="jz"> UnsafeContract.sol </em></p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div><figcaption class="ly lz fg fe ff ma mb bd b be z ek">This contract is unsafe for erc20 but safe for erc223</figcaption></figure><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div></figure><p id="35c0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">将以下迁移添加到/migrations as 3<em class="jz">_ contract _ migration . js</em></p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div></figure></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><p id="6cec" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">编译和迁移</strong></p><p id="f236" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">运行编译脚本，并验证它是否编译无误</p><pre class="kb kc kd ke fq lo lp lq lr aw ls dt"><span id="9323" class="kh ki ht lp b fv lt lu l lv lw">Marks-MacBook-Pro:erc223 markmathis$ truffle compile</span></pre><p id="a876" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">运行迁移脚本，并验证其部署无误</p><pre class="kb kc kd ke fq lo lp lq lr aw ls dt"><span id="a8b7" class="kh ki ht lp b fv lt lu l lv lw">Marks-MacBook-Pro:erc223 markmathis$ truffle migrate</span></pre></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><h2 id="f34f" class="kh ki ht bd kj kk kl km kn ko kp kq kr jm ks kt ku jq kv kw kx ju ky kz la lb dt translated">测试一下</h2><p id="a2e3" class="pw-post-body-paragraph jb jc ht jd b je lc jg jh ji ld jk jl jm le jo jp jq lf js jt ju lg jw jx jy hm dt translated">安装测试库</p><pre class="kb kc kd ke fq lo lp lq lr aw ls dt"><span id="9f01" class="kh ki ht lp b fv lt lu l lv lw">npm install chai --save-dev<br/>npm install chai-as-promised --save-dev<br/>npm install babel-preset-es2015 --save-dev<br/>npm install babel-register --save-dev<br/>npm install babel-polyfill --save-dev</span></pre><p id="6b87" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">添加<em class="jz">。babelrc </em>到项目根</p><pre class="kb kc kd ke fq lo lp lq lr aw ls dt"><span id="85fc" class="kh ki ht lp b fv lt lu l lv lw">{<br/>  "presets": ["es2015"]<br/>}</span></pre><p id="abc0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">将<em class="jz"> erc223.spec.js </em>添加到/test</p><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="lx kg l"/></div></figure><p id="3058" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">从项目根目录运行测试</p><pre class="kb kc kd ke fq lo lp lq lr aw ls dt"><span id="9bc5" class="kh ki ht lp b fv lt lu l lv lw">truffle test</span></pre><figure class="kb kc kd ke fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mc"><img src="../Images/11fc0e889d4746c3551b8816a14a7f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C4CcFIO0ctlEJ5w6nmWIpg.png"/></div></div></figure><h1 id="40f7" class="md ki ht bd kj me mf mg kn mh mi mj kr mk ml mm ku mn mo mp kx mq mr ms la mt dt translated"><strong class="ak">发生了什么… </strong></h1><figure class="kb kc kd ke fq iu"><div class="bz el l di"><div class="mu kg l"/></div></figure><p id="2f55" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">上述测试确保以下内容:</p><ul class=""><li id="4c2c" class="mv mw ht jd b je jf ji jj jm mx jq my ju mz jy na nb nc nd dt translated">ERC223令牌不能转移到未实现<em class="jz">ERC 223 receiving contract . sol</em>中定义的回退方法的合同地址</li><li id="b579" class="mv mw ht jd b je ne ji nf jm ng jq nh ju ni jy na nb nc nd dt translated">ERC223令牌不能被转移到实现<em class="jz">hasnotokens . sol</em>zeppelin契约的契约地址</li><li id="9a3e" class="mv mw ht jd b je ne ji nf jm ng jq nh ju ni jy na nb nc nd dt translated">在合同实际上支持余额的情况下，ERC223令牌可以转移到正确实现<em class="jz">ERC 223 receiving contract . sol</em>中定义的回退方法的合同。</li><li id="5794" class="mv mw ht jd b je ne ji nf jm ng jq nh ju ni jy na nb nc nd dt translated">发送到实现<em class="jz">hasnotokens . sol</em>zeppelin合同的合同的ERC20令牌可以由合同的所有者检索。请注意，如果您将您的ERC20代币发送到这些合同中的一个，所有者可以请求取回代币到他们的帐户，然后如果您运气好的话，再分发给您。</li></ul></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><h2 id="7046" class="kh ki ht bd kj kk kl km kn ko kp kq kr jm ks kt ku jq kv kw kx ju ky kz la lb dt translated">额外资源</h2><div class="nj nk fm fo nl nm"><a href="https://github.com/Dexaran/ERC223-token-standard" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab ej"><div class="no ab np cl cj nq"><h2 class="bd hu fv z el nr eo ep ns er et hs dt translated">dex aran/ERC 223-令牌-标准</h2><div class="nt l"><h3 class="bd b fv z el nr eo ep ns er et ek translated">ERC 223-令牌-标准- ERC223令牌标准参考实现。</h3></div><div class="nu l"><p class="bd b gc z el nr eo ep ns er et ek translated">github.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa iz nm"/></div></div></a></div><div class="nj nk fm fo nl nm"><a rel="noopener follow" target="_blank" href="/@Nico_Vergauwen/create-your-own-ethereum-token-part-2-erc223-3076f764cf62"><div class="nn ab ej"><div class="no ab np cl cj nq"><h2 class="bd hu fv z el nr eo ep ns er et hs dt translated">创建自己的以太坊令牌(第2部分:ERC223)</h2><div class="nt l"><h3 class="bd b fv z el nr eo ep ns er et ek translated">第1部分:ERC20令牌</h3></div><div class="nu l"><p class="bd b gc z el nr eo ep ns er et ek translated">medium.com</p></div></div><div class="nv l"><div class="ob l nx ny nz nv oa iz nm"/></div></div></a></div></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><p id="84e2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="jz">完整的项目源可用</em> — <a class="ae ka" href="https://github.com/cipherzzz/erc223" rel="noopener ugc nofollow" target="_blank">此处</a></p></div></div>    
</body>
</html>