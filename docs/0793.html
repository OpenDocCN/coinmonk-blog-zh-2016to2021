<html>
<head>
<title>Single Host Multi-Node Testnet on EOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">EOS上的单主机多节点测试网</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/single-host-multi-node-testnet-on-eos-6d940811a03?source=collection_archive---------1-----------------------#2018-06-19">https://medium.com/coinmonks/single-host-multi-node-testnet-on-eos-6d940811a03?source=collection_archive---------1-----------------------#2018-06-19</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="eddd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">本教程描述了如何在EOS 上建立一个<em class="jo">单主机多节点测试网。我们将在您的本地计算机上设置两个节点，并让它们相互通信。本节中的例子依赖于三个命令行应用程序，<code class="eh jp jq jr js b">nodeos</code>、<code class="eh jp jq jr js b">keosd</code>和<code class="eh jp jq jr js b">cleos</code>。下图描述了所需的testnet配置。</em></p><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="fe ff jt"><img src="../Images/de5b975296e519e3cb32accada1e903e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I8rUluwTNkeBHDjeiI17Gg.png"/></div></div></figure><p id="a37e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">假设<code class="eh jp jq jr js b">keosd</code>、<code class="eh jp jq jr js b">cleos</code>和<code class="eh jp jq jr js b">nodeos</code>已经安装在您的路径中，或者您知道如何从文件系统中的位置启动这些应用程序。</p><p id="e415" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">打开<strong class="is hu"> 4 </strong>“终端”窗口，执行本教程中的步骤。</p><h2 id="9b62" class="kf kg ht bd kh ki kj kk kl km kn ko kp jb kq kr ks jf kt ku kv jj kw kx ky kz dt translated">1.启动钱包管理器</h2><p id="d1bc" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hm dt translated">在第<strong class="is hu">个</strong>终端窗口，启动<code class="eh jp jq jr js b">keosd</code>，钱包管理应用程序:</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="08aa" class="kf kg ht js b fv lj lk l ll lm">$ keosd --http-server-address 127.0.0.1:8899</span></pre><p id="f411" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果成功，<code class="eh jp jq jr js b">keosd</code>将显示一些信息，从:</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="f7ca" class="kf kg ht js b fv lj lk l ll lm">2493323ms thread-0   wallet_plugin.cpp:39          plugin_initialize    ] initializing wallet plugin<br/>2493323ms thread-0   http_plugin.cpp:141           plugin_initialize    ] host: 127.0.0.1 port: 8899<br/>2493323ms thread-0   http_plugin.cpp:144           plugin_initialize    ] configured http to listen on 127.0.0.1:8899<br/>2493323ms thread-0   http_plugin.cpp:213           plugin_startup       ] start listening for http requests<br/>2493324ms thread-0   wallet_api_plugin.cpp:70      plugin_startup       ] starting wallet_api_plugin</span></pre><p id="2565" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">寻找一条说钱包正在监听127.0.0.1:8899的线路。这将表明<code class="eh jp jq jr js b">keosd</code>已正确启动，并且正在正确的端口上监听。如果在“启动wallet_api_plugin”之前看到任何其他内容，或者看到一些错误报告，则需要诊断问题并重新启动。</p><p id="678a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当<code class="eh jp jq jr js b">keosd</code>正常运行时，让该窗口保持打开，同时运行钱包应用程序，并移至<strong class="is hu">第二个</strong>终端窗口。</p><h2 id="a7fb" class="kf kg ht bd kh ki kj kk kl km kn ko kp jb kq kr ks jf kt ku kv jj kw kx ky kz dt translated">2.创建默认钱包</h2><p id="62e3" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hm dt translated">在<strong class="is hu">第二个</strong>终端窗口中，使用命令行实用程序<code class="eh jp jq jr js b">cleos</code>创建默认钱包。</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="be44" class="kf kg ht js b fv lj lk l ll lm">$ cleos --wallet-url http://localhost:8899 wallet create<br/>Creating wallet: default<br/>Save password to use in the future to unlock this wallet.<br/>Without password imported keys will not be retrievable.<br/>"PW5Jn3GFZzerJTVz4XDN4W8QfGpvwiyLEucEvVxseKdbEZdSKV8bK"</span></pre><p id="dd01" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于后续的<code class="eh jp jq jr js b">cleos</code>命令，我们将继续使用这个<strong class="is hu">第二</strong>窗口。</p><h2 id="9e61" class="kf kg ht bd kh ki kj kk kl km kn ko kp jb kq kr ks jf kt ku kv jj kw kx ky kz dt translated">3.启动第一个生产者节点</h2><p id="30ea" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hm dt translated">我们现在可以启动第一个生产者节点。在<strong class="is hu">第三个</strong>终端窗口运行:</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="1e9a" class="kf kg ht js b fv lj lk l ll lm">$ nodeos --enable-stale-production --producer-name eosio --plugin eosio::chain_api_plugin --plugin eosio::net_api_plugin</span></pre><p id="8570" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这就产生了一个特殊的生产者，称为“bios”生产者。</p><h2 id="ac56" class="kf kg ht bd kh ki kj kk kl km kn ko kp jb kq kr ks jf kt ku kv jj kw kx ky kz dt translated">4.启动第二个生产者节点</h2><p id="19db" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hm dt translated">以下命令假设您正在从您运行<code class="eh jp jq jr js b">./eosio_build.sh</code>的<code class="eh jp jq jr js b">${EOSIO_SOURCE}</code>目录运行本教程</p><p id="a660" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要启动其他节点，您必须首先加载<code class="eh jp jq jr js b">eosio.bios</code>契约。该契约使您能够直接控制其他帐户的资源分配，并访问其他特权API调用。返回第二个终端窗口，运行以下命令来加载合同:</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="8aca" class="kf kg ht js b fv lj lk l ll lm">$ cleos --wallet-url http://localhost:8899 set contract eosio build/contracts/eosio.bios<br/>Reading WAST/WASM from build/contracts/eosio.bios/eosio.bios.wast...<br/>Assembling WASM...<br/>Publishing contract...<br/>executed transaction: 808599e85909b5793819a6f303c499d776fede9c9cc2cc1dc9776d3877c60e87  3280 bytes  2200576 cycles<br/>#         eosio &lt;= eosio::setcode               {"account":"eosio","vmtype":0,"vmversion":0,"code":"0061736d0100000001581060037f7e7f0060057f7e7e7e7e...<br/>#         eosio &lt;= eosio::setabi                {"account":"eosio","abi":{"types":[],"structs":[{"name":"set_account_limits","base":"","fields":[{"n...</span></pre><p id="3689" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将使用帐户名<code class="eh jp jq jr js b">inita</code>创建一个成为生产者的帐户。要创建帐户，我们需要生成与帐户相关联的密钥，并将其导入到我们的钱包中。</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="ec88" class="kf kg ht js b fv lj lk l ll lm">$ cleos create key<br/>Private key: 5HvbXnMVLLQEQRR3He7fu4rj7JziCiCcmWgAVkyhWbatBNFw8sw<br/>Public key: EOS7J9pSmsJLQuHwQ5NZAH1V3MKKGgZtwZ92GqmAfbJqdUXDehiCE</span></pre><p id="3f72" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在将私钥部分导入到您的钱包中。</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="1374" class="kf kg ht js b fv lj lk l ll lm">$ cleos --wallet-url http://localhost:8899 wallet import 5HvbXnMVLLQEQRR3He7fu4rj7JziCiCcmWgAVkyhWbatBNFw8sw<br/>imported private key for: EOS7J9pSmsJLQuHwQ5NZAH1V3MKKGgZtwZ92GqmAfbJqdUXDehiCE</span></pre><p id="15a1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">创建我们将用来成为生产者的<code class="eh jp jq jr js b">inita</code>账户。</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="eccc" class="kf kg ht js b fv lj lk l ll lm">$ cleos --wallet-url http://localhost:8899 create account eosio inita EOS7J9pSmsJLQuHwQ5NZAH1V3MKKGgZtwZ92GqmAfbJqdUXDehiCE EOS7J9pSmsJLQuHwQ5NZAH1V3MKKGgZtwZ92GqmAfbJqdUXDehiCE<br/>executed transaction: 03d801831dc30fe43a355b2a5e1ff553c5081f6fc8a89a93c86fdffcbb4c891c  352 bytes  102400 cycles<br/>#         eosio &lt;= eosio::newaccount            {"creator":"eosio","name":"inita","owner":{"threshold":1,"keys":[{"key":"EOS7J9pSmsJLQuHwQ5NZAH1V3MK...</span></pre><p id="75aa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在第四个终端窗口中，启动第二个nodeos实例。</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="f7fd" class="kf kg ht js b fv lj lk l ll lm">$ nodeos --producer-name inita --plugin eosio::chain_api_plugin --plugin eosio::net_api_plugin --http-server-address 127.0.0.1:8889 --p2p-listen-endpoint 127.0.0.1:9877 --p2p-peer-address 127.0.0.1:9876 --config-dir node2 --data-dir node2 --private-key [\"EOS7J9pSmsJLQuHwQ5NZAH1V3MKKGgZtwZ92GqmAfbJqdUXDehiCE\",\"5HvbXnMVLLQEQRR3He7fu4rj7JziCiCcmWgAVkyhWbatBNFw8sw\"]</span></pre><p id="cce8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">此时，第二个nodeos是一个空闲的生产者。要将其转变为活动生产者，<strong class="is hu"> inita </strong>需要向bios节点注册为生产者，bios节点需要执行一个操作来更新生产者时间表。</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="0054" class="kf kg ht js b fv lj lk l ll lm">$ cleos --wallet-url http://localhost:8899 push action eosio setprods "{ \"version\": 1, \"producers\": [{\"producer_name\": \"inita\",\"block_signing_key\": \"EOS7J9pSmsJLQuHwQ5NZAH1V3MKKGgZtwZ92GqmAfbJqdUXDehiCE\"}]}" -p eosio@active<br/>executed transaction: 95baf281e32f1e54686518c85a1317f4e387977b6f16d2b74061cec605f22238  272 bytes  105472 cycles<br/>#         eosio &lt;= eosio::setprods              {"version":1,"producers":[{"producer_name":"inita","block_signing_key":"EOS7J9pSmsJLQuHwQ5NZAH1V3MKK...</span></pre><p id="a765" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">恭喜，您现在已经配置了一个双节点testnet！您可以看到原始节点不再产生数据块，但它正在接收数据块。您可以通过对每个节点运行<code class="eh jp jq jr js b">get info</code>命令来验证这一点。</p><h2 id="5707" class="kf kg ht bd kh ki kj kk kl km kn ko kp jb kq kr ks jf kt ku kv jj kw kx ky kz dt translated">5.验证区块链</h2><p id="df57" class="pw-post-body-paragraph iq ir ht is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hm dt translated">获取第一个节点的信息:</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="8a50" class="kf kg ht js b fv lj lk l ll lm">$ cleos get info<br/>{<br/>  "server_version": "f537bc50",<br/>  "head_block_num": 28063,<br/>  "last_irreversible_block_num": 28062,<br/>  "head_block_id": "00006d9f87bcdee47f67eee56b861f118734794fed4a5ebeebb5c341ee1c3cd5",<br/>  "head_block_time": "2018-05-04T03:33:09",<br/>  "head_block_producer": "inita"<br/>}</span></pre><p id="8c17" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在是第二个节点:</p><pre class="ju jv jw jx fq lf js lg lh aw li dt"><span id="c1db" class="kf kg ht js b fv lj lk l ll lm">$ cleos --url <a class="ae ln" href="http://localhost:8889" rel="noopener ugc nofollow" target="_blank">http://localhost:8889</a> get info<br/>{<br/>  "server_version": "f537bc50",<br/>  "head_block_num": 28505,<br/>  "last_irreversible_block_num": 28504,<br/>  "head_block_id": "00006f596fdb9660854b61a99cbbcaf8bb21c112e983a36e041f6b50fe170b1a",<br/>  "head_block_time": "2018-05-04T03:36:50",<br/>  "head_block_producer": "inita"<br/>}</span></pre><figure class="ju jv jw jx fq jy fe ff paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="fe ff lo"><img src="../Images/7d913a6e02988c296f6c5ab7aee3d8b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b9awjSnEHNEmoEpX9Cdo3w.png"/></div></div></figure></div></div>    
</body>
</html>