<html>
<head>
<title>Python Tutorial: How to Use the BitMEX API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python教程:如何使用BitMEX API</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/pip-install-bitmex-calls-official-lib-code-89b08ceaabf9?source=collection_archive---------0-----------------------#2018-12-29">https://medium.com/coinmonks/pip-install-bitmex-calls-official-lib-code-89b08ceaabf9?source=collection_archive---------0-----------------------#2018-12-29</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/8114ebb40fb64a3e648e8768df8a5518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MStLhdjGXQxX-Qf2ARZ1xA.png"/></div></div></figure><h2 id="3653" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">TL；速度三角形定位法(dead reckoning)</h2><p id="4cad" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">了解如何使用Python代码从<a class="ae ku" href="https://coincodecap.com/use-bitmex-in-usa" rel="noopener ugc nofollow" target="_blank"> BITMEX </a> API下订单、取消订单以及获取报价。向下滚动到本文的底部，找到最简单文档的链接。</p><p id="6373" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">下单和所有其他功能都记录在那里，比普通的API文档更容易理解。</p><figure class="lb lc ld le fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff la"><img src="../Images/b790e5fe9724afdc9b418b2511802a73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ht9MqO3xAMgP69cN5JxbXA.png"/></div></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">This is a screenshot from the swagger.json file</figcaption></figure><h2 id="39d5" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">关于语法的重要说明</h2><p id="6333" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">当您在swagger.json文件中查找特定函数时，使用Cmd + F搜索您需要的函数(即order)。</p><p id="ad0c" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">找到operationId后，使用下面的代码将operationId转换为可操作的API调用。</p><p id="c5bb" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">总的来说:</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="5dbe" class="jb jc ht lk b fv lo lp l lq lr">parentOperation.childOperation</span></pre><p id="5b0d" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">变成了:</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="788f" class="jb jc ht lk b fv lo lp l lq lr">client.parentOperation.parentOperation_childOperation().result()</span></pre><p id="db22" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">让我们将上面的operationId 'Order.getOrders '转换成可行的调用。</p><p id="819f" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">` ` Order.getOrders `</p></div><div class="ab cl ls lt hb lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hm hn ho hp hq"><p id="b6e7" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">成为</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="5322" class="jb jc ht lk b fv lo lp l lq lr">client.Order.Order_getOrders().result()</span></pre><p id="2134" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">其中Order是parentOperation，getOrders是childOperation。</p><p id="4025" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">现在，例如，让我们说你希望一次下很多订单。在swagger.json文件中搜索“bulk ”,您将找到Order.newBulk</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="4680" class="jb jc ht lk b fv lo lp l lq lr">Order.newBulk</span></pre><p id="cfc4" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">变成了:</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="5b5b" class="jb jc ht lk b fv lo lp l lq lr">client.Order.Order_newBulk().result()</span></pre><p id="2ba2" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">这是一个奇怪的语法，所以只需复制/pasta。一定不要忘记。每次调用结束时的result()。</p><p id="e283" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">下面，我将通过几个例子来说明如何使用这个API。最后，我还将介绍错误和解决方法。</p><p id="2f12" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">一如既往地感谢“掌声”和任何反馈。</p><h1 id="3af9" class="lz jc ht bd jd ma mb mc jh md me mf jl mg mh mi jp mj mk ml jt mm mn mo jx mp dt translated">BitMEX模块安装</h1><p id="9265" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">假设你用的是python3。</p><h2 id="4ec5" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">第一步</h2><p id="7a59" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">安装bravado</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="792e" class="jb jc ht lk b fv lo lp l lq lr">sudo pip install bravado</span></pre><h2 id="a7a0" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">第二步</h2><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="50b2" class="jb jc ht lk b fv lo lp l lq lr">sudo pip install bitmex</span></pre><h1 id="9326" class="lz jc ht bd jd ma mb mc jh md me mf jl mg mh mi jp mj mk ml jt mm mn mo jx mp dt translated">Python客户端</h1><h2 id="26f0" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">Python客户端认证</h2><p id="1628" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">创建新的python文件。在文件顶部包含以下内容，以实例化客户端。</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="f6ce" class="jb jc ht lk b fv lo lp l lq lr">from bitmex import bitmex</span><span id="e55b" class="jb jc ht lk b fv mq lp l lq lr">api_key = ''<br/>api_secret = ''</span><span id="dc7c" class="jb jc ht lk b fv mq lp l lq lr">client = bitmex(test=False, api_key=api_key, api_secret=api_secret)</span></pre><p id="830c" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">一旦您在空白处填入了api键，您的客户端就通过了身份验证，您就可以进行真正的API调用了！</p><h2 id="4b39" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">API调用—下单、挂牌或取消订单</h2><h2 id="271e" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">下订单(operationId = Order.new)</h2><p id="60e1" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">每当我们想要进行API调用时，我们只需在<a class="ae ku" href="https://github.com/BitMEX/api-connectors/blob/master/swagger.json" rel="noopener ugc nofollow" target="_blank"> swagger.json文件</a>中寻找相应的操作来进行调用。在swagger.json文件中搜索所需的operationId，在本例中为Order.new. Then change</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="34a5" class="jb jc ht lk b fv lo lp l lq lr">Order.new</span></pre><p id="3b1f" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">到</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="b4a8" class="jb jc ht lk b fv lo lp l lq lr">client.Order.Order_new().result()</span></pre><p id="2a93" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">不要忘记在订单中添加一些参数:</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="5161" class="jb jc ht lk b fv lo lp l lq lr">client.Order.Order_new(symbol='ETHUSD', orderQty=10000, price=390).result()</span></pre><p id="791d" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">上面的代码将以390美元的价格做多10000份ETHUSD永久掉期合约。不要忘记。结果()。</p><h2 id="3d72" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">取消订单(订单取消)</h2><p id="68ac" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">如果您想要取消所有订单，操作id为Order.cancelAll。以下是正确的python语法:</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="ba1e" class="jb jc ht lk b fv lo lp l lq lr">client.Order.Order_cancelAll().result()</span></pre></div><div class="ab cl ls lt hb lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hm hn ho hp hq"><h1 id="1128" class="lz jc ht bd jd ma mr mc jh md ms mf jl mg mt mi jp mj mu ml jt mm mv mo jx mp dt translated">常见错误</h1><h2 id="5120" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">获取报价时出现禁止的403错误</h2><p id="917c" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">当试图使用bitmex <a class="ae ku" href="https://github.com/BitMEX/api-connectors/tree/master/official-http/python-swaggerpy" rel="noopener ugc nofollow" target="_blank">自述文件</a>中规定的报价端点时，您可能会得到一个禁止的403异常。以规定的方式获取报价可能会产生以下错误:</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="e9f7" class="jb jc ht lk b fv lo lp l lq lr">bravado.exception.HTTPForbidden: 403 Forbidden: &lt;html&gt;</span><span id="93d5" class="jb jc ht lk b fv mq lp l lq lr">&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;</span><span id="acfc" class="jb jc ht lk b fv mq lp l lq lr">&lt;body bgcolor="white"&gt;</span><span id="7e6e" class="jb jc ht lk b fv mq lp l lq lr">&lt;center&gt;&lt;h1&gt;403 Forbidden&lt;/h1&gt;&lt;/center&gt;</span><span id="a87f" class="jb jc ht lk b fv mq lp l lq lr">&lt;/body&gt;</span><span id="e2bd" class="jb jc ht lk b fv mq lp l lq lr">&lt;/html&gt;</span></pre><p id="6ce4" class="pw-post-body-paragraph jz ka ht kb b kc kv ke kf kg kw ki kj jm kx kl km jq ky ko kp ju kz kr ks kt hm dt translated">但是我们需要一些方法来得到价格。以下是获取ETHUSD价格的一种变通方法:</p><pre class="lb lc ld le fq lj lk ll lm aw ln dt"><span id="ce98" class="jb jc ht lk b fv lo lp l lq lr">import requests, json</span><span id="3a76" class="jb jc ht lk b fv mq lp l lq lr">response = requests.get("<a class="ae ku" href="https://www.bitmex.com/api/v1/orderBook/L2?symbol=eth&amp;depth=1" rel="noopener ugc nofollow" target="_blank">https://www.bitmex.com/api/v1/orderBook/L2?symbol=eth&amp;depth=1</a>").json()</span><span id="468b" class="jb jc ht lk b fv mq lp l lq lr">ether_ask_price = response[0]['price']</span><span id="5f72" class="jb jc ht lk b fv mq lp l lq lr">ether_bid_price = response[1]['price']</span><span id="ba6d" class="jb jc ht lk b fv mq lp l lq lr">print ether_ask_price<br/>print ether_bid_price</span></pre><blockquote class="mw"><p id="fcae" class="mx my ht bd mz na nb nc nd ne nf kt ek translated">加入Coinmonks <a class="ae ku" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae ku" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae ku" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="jb jc ht bd jd je ng jg jh ji nh jk jl jm ni jo jp jq nj js jt ju nk jw jx jy dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="nl nm ht kb b kc kd kg kh jm nn jq no ju np kt nq nr ns nt dt translated"><a class="ae ku" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae ku" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae ku" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" rel="noopener" href="/coinmonks/top-3-telegram-channels-for-crypto-traders-in-2021-8385f4411ff4">密码电报信号</a> | <a class="ae ku" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="885f" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" href="https://coincodecap.com/binance-vs-bitstamp" rel="noopener ugc nofollow" target="_blank">币安vs Bitstamp</a>|<a class="ae ku" href="https://coincodecap.com/bitpanda-coinbase-coinsbit" rel="noopener ugc nofollow" target="_blank">bit panda vs比特币基地vs Coinsbit </a></li><li id="5711" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" href="https://coincodecap.com/buy-ripple-india" rel="noopener ugc nofollow" target="_blank">如何购买Ripple (XRP) </a> | <a class="ae ku" href="https://coincodecap.com/crypto-exchange-africa" rel="noopener ugc nofollow" target="_blank">非洲最好的加密交易所</a></li><li id="861b" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" href="https://coincodecap.com/crypto-exchange-africa" rel="noopener ugc nofollow" target="_blank">非洲最佳密码交易所</a> | <a class="ae ku" href="https://coincodecap.com/hoo-exchange-review" rel="noopener ugc nofollow" target="_blank">晤交易所评论</a></li><li id="452c" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" href="https://coincodecap.com/etoro-robinhood" rel="noopener ugc nofollow" target="_blank">eToro vs robin hood</a>|<a class="ae ku" href="https://coincodecap.com/bybit-bityard-moonxbt" rel="noopener ugc nofollow" target="_blank">MoonXBT vs by bit vs Bityard</a></li><li id="52ca" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" href="https://coincodecap.com/trading-signal" rel="noopener ugc nofollow" target="_blank">有哪些交易信号？</a> | <a class="ae ku" href="https://coincodecap.com/bitstamp-coinbase" rel="noopener ugc nofollow" target="_blank">比特斯坦普vs比特币基地</a></li><li id="f33b" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae ku" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">开发者最佳加密API</a></li><li id="b359" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated">最佳<a class="ae ku" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="nl nm ht kb b kc nu kg nv jm nw jq nx ju ny kt nq nr ns nt dt translated"><a class="ae ku" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币终极指南</a></li></ul></div></div>    
</body>
</html>