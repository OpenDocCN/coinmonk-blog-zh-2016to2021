<html>
<head>
<title>Espressif ESP32 Tutorial — Part 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Espressif ESP32教程—第4部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/espressif-esp32-tutorial-programming-eclipse-daad7b220af0?source=collection_archive---------6-----------------------#2018-07-23">https://medium.com/coinmonks/espressif-esp32-tutorial-programming-eclipse-daad7b220af0?source=collection_archive---------6-----------------------#2018-07-23</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="7b73" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">使用Eclipse IDE编程</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff ji"><img src="../Images/201c3c8da238bc495e4196342a761d42.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/0*kiPgE9C9TOckETSu.jpeg"/></div></figure><p id="9568" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">Eclipse IDE是最流行的桌面开发环境之一。免费和开源有所帮助！</p><p id="9fbf" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">它还通过基于语言服务器的插件支持大多数通用编程语言。目前释放的称为光子。<br/><br/>C/C++开发工具包(CDT)是一个基于Eclipse的特性集合，它提供了创建、编辑、导航、构建和调试使用C和/或c++作为编程语言的项目的能力。<br/><br/>CDT不包括必要的编译器和调试器来将C/C++代码转换成可执行程序并调试这些程序，但它确实提供了允许这些工具以一致的方式集成的框架。我们将使用Eclipse的CDT版本对ESP-32进行编程。</p><h2 id="61f8" class="kn ko ht bd kp kq kr ks kt ku kv kw kx jz ky kz la kd lb lc ld kh le lf lg lh dt translated">安装Eclipse IDE</h2><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/879f0807989819f9c0658379b3031377.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*laCcZH7hjLWGwg5i.png"/></div><figcaption class="lj lk fg fe ff ll lm bd b be z ek">Eclipse IDE</figcaption></figure><p id="bbd8" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">Eclipse IDE为您提供了一个图形化的集成开发环境(IDE ),用于编写、编译和调试ESP-IDF项目。它比Espressif提供的命令行ESP-IDF更容易使用。它也比Arduino IDE更复杂，更适合大型项目。<br/> <br/>由于Eclipse不提供ESP-32编译器或刷新DevKit的能力，您需要已经为您的操作系统安装了ESP-IDF工具链。如果您还没有这样做，请参考我们之前关于ESP-IDF的教程。<br/> <br/>在Windows上结合Eclipse使用ESP-IDF需要不同的配置步骤。如果您使用的是Windows，请参见Windows上的Eclipse IDE指南。以下是Mac用户使用步骤的概述。此内容基于来自<a class="ae km" href="https://esp-idf.readthedocs.io/en/v3.1-beta1/get-started/eclipse-setup.html?highlight=eclipse" rel="noopener ugc nofollow" target="_blank"> Espressif ESP-IDF编程指南</a>的材料，但我已经指出了我遇到困难的地方，并附上了截图，以使一些解释更加清晰。</p><p id="9e41" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">1.从<a class="ae km" href="http://eclipse.org/" rel="noopener ugc nofollow" target="_blank">eclipse.org</a>下载适用于您平台的Eclipse安装程序。</p><p id="b16c" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">2.创建一个工作目录，解压缩下载并运行安装程序。</p><pre class="jj jk jl jm fq ln lo lp bn lq lr bi"><span id="b94e" class="ls ko ht lo b be lt lu l lv lw">mkdir -p ~/eclipse <br/>cd ~/eclipse <br/>tar -xzf ~/Downloads/eclipse-inst-mac64.tar.gz<br/>open -a 'Eclipse Installer.app'</span></pre><p id="4342" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">3.当运行Eclipse安装程序时，选择“Eclipse for C/C++ Development”(在文档中你会看到这被称为CDT。)</p><p id="ecf8" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">4.运行安装程序时，可能会出现以下错误。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/88081eb24d8bfcabc36f0713c6dcd1be.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*U796HVE3DiT7pnOe.png"/></div></figure><p id="6a06" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">请注意，这里的<strong class="js hu">不是</strong>指的是Java运行时环境，您可以通过系统首选项对其进行更新。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/161650fc91dcff61932d73a3bffb34d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*1Q1BSJy_2yHrDmNG.png"/></div></figure><p id="4b9a" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">如果得到JVM错误，需要更新<a class="ae km" href="http://www.oracle.com/technetwork/java/javase/downloads/jdk10-downloads-4416644.html" rel="noopener ugc nofollow" target="_blank"> Java开发包</a>。</p><p id="5f78" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">之后，当您运行提供的安装应用程序时，您应该会看到以下安装屏幕。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/aad70581e74165111260a4fdce592c50.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/0*iNsQq7aG6VvDiJU6.png"/></div></figure><h2 id="0db9" class="kn ko ht bd kp kq kr ks kt ku kv kw kx jz ky kz la kd lb lc ld kh le lf lg lh dt translated">设置Eclipse</h2><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/1ab93e5994682961d8fe2db7be150e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*QDwdvlHtTq9EB8oP.png"/></div></figure><p id="c60e" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">在新的Eclipse安装启动后，遵循以下步骤:<br/> <br/> <strong class="js hu"> 1 .导入新项目</strong></p><p id="f821" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">Eclipse使用ESP-IDF中的Makefile功能。这意味着您需要从创建一个ESP-IDF项目开始。您可以使用github中的框架项目或esp-idf examples子目录中的一个示例项目。我们将再次使用我们的老伙伴眨眼。如果您不知道如何复制示例项目，请参考我们之前的ESP-IDF教程。<br/> <br/>一旦Eclipse运行，在弹出的对话框中选择<code class="eh ly lz ma lo b">File -&gt; Import…</code> <br/> <br/>，选择<code class="eh ly lz ma lo b">“C/C++” -&gt; “Existing Code as Makefile Project”</code>，点击<code class="eh ly lz ma lo b">Next</code>。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/7ca6695f370e9b23f168a73dda8088ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*X_bvr9vLQgyLoK4n.png"/></div></figure><p id="c9cd" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">在下一页的“<code class="eh ly lz ma lo b">Existing Code Location</code>”字段中，使用您的IDF项目的目录。不要指定ESP-IDF目录本身的路径(我们将在项目属性中这样做)。您指定的目录应该包含一个名为“<code class="eh ly lz ma lo b">Makefile</code>”(项目Makefile)的文件。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/8e8aa26b64d8f9ba32465dbd3c21cb6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*oKlBvvmsTRcLEjJ1.png"/></div></figure><p id="7c17" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">在同一页面上，在<code class="eh ly lz ma lo b">Toolchain for Indexer Settings</code>下选择<code class="eh ly lz ma lo b">Cross GCC</code>。然后点击<code class="eh ly lz ma lo b">Finish</code>。<br/> <br/> <strong class="js hu"> 2。项目属性</strong></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/6075e6396f9291596c35a8b8c1dc9a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*_5pFJNK8gjmdgWYM.png"/></div></figure><p id="4289" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">新项目将出现在左侧的项目浏览器列中。右键单击项目，然后从上下文菜单中选择“属性”。<br/> <br/>点击<code class="eh ly lz ma lo b">Environment</code>属性页下的<code class="eh ly lz ma lo b">C/C++ Build</code>。点击<code class="eh ly lz ma lo b">Add…</code>，输入名称<code class="eh ly lz ma lo b">BATCH_BUILD</code>和值<code class="eh ly lz ma lo b">1</code>。<br/> <br/>再次点击<code class="eh ly lz ma lo b">Add…</code>，输入姓名<code class="eh ly lz ma lo b">IDF_PATH</code>。该值应该是安装ESP-IDF的完整路径。如果您已经完成了我们之前的ESP-IDF教程，则不必执行此步骤，因为路径已经从<code class="eh ly lz ma lo b">.profile</code>首选项文件中更新。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/974c1758dcec5234b78cc8e97a24cd8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*C0nRNcQcHtSvrSkw.png"/></div></figure><p id="f3ce" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">编辑PATH环境变量。保留当前值，并将路径附加到作为IDF安装的一部分安装的Xtensa工具链(如果该路径尚未列出)。<br/> <br/>工具链的典型路径看起来像<code class="eh ly lz ma lo b">/home/user-name/esp/xtensa-esp32-elf/bin</code>。请注意，您需要在附加的路径前添加一个冒号:。<br/> <br/>在macOS上，添加一个<code class="eh ly lz ma lo b">PYTHONPATH</code>环境变量，设置为:<br/> <br/> <code class="eh ly lz ma lo b">/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages</code>。这是为了让作为安装步骤的一部分安装了pyserial的系统Python覆盖任何内置的Eclipse Python。我不需要在我的Mac上这么做。<br/> <br/>导航到<code class="eh ly lz ma lo b">C/C++ General</code>-&gt;-<code class="eh ly lz ma lo b">Preprocessor Include Paths</code>属性页:<br/>-<br/>点击提供者列表中的<code class="eh ly lz ma lo b">Providers</code>-<br/>-<br/>标签，点击<code class="eh ly lz ma lo b">CDT Cross GCC Built-in Compiler Settings</code>-<code class="eh ly lz ma lo b">CDT Cross GCC Built-in Compiler Settings</code>-。在<code class="eh ly lz ma lo b">Command to get compiler specs</code>下，将该行开头的文本<code class="eh ly lz ma lo b">${COMMAND}</code>替换为<code class="eh ly lz ma lo b">xtensa-esp32-elf-gcc</code>。这意味着完整的“<code class="eh ly lz ma lo b">Command to get compiler specs</code>”应该是<code class="eh ly lz ma lo b">xtensa-esp32-elf-gcc ${FLAGS} -E -P -v -dD “${INPUTS}</code>。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/491e52bf0af7ae3de7f67cc2d7118255.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*u6EyNmTr_EpMXcJf.png"/></div></figure><p id="7fe4" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">在提供者列表中，单击“<code class="eh ly lz ma lo b">CDT GCC Build Output Parser</code>”并在编译器命令模式的开头键入<code class="eh ly lz ma lo b">xtensa-esp32-elf-</code>。这意味着完整的编译器命令模式应该是<code class="eh ly lz ma lo b">xtensa-esp32-elf-(g?cc)|([gc]\+\+)|(clang)</code></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/563742fa17a2a6987c0c9ea6cf68b17e.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*apJhGj36kpSHe8DZ.png"/></div></figure><p id="6c80" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">导航到<code class="eh ly lz ma lo b">C/C++ General</code>-&gt;-<code class="eh ly lz ma lo b">Indexer</code>属性页:<br/>-<br/>取消勾选<code class="eh ly lz ma lo b">Allow heuristic resolution of includes</code>。启用该选项时，Eclipse有时会找不到正确的头文件目录。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/7172a68292bdd1e683e4ae5466dea031.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*LivqqrmfaQbL-0oI.png"/></div></figure><p id="39e9" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated"><strong class="js hu"> 3。在首次构建项目之前，Eclipse可能会显示许多关于未定义值的错误和警告。这是因为有些源文件是在esp-idf构建过程中自动生成的。这些错误和警告将在您构建项目后消失。<br/> <br/>单击OK关闭Eclipse中的属性对话框。<br/> <br/>在Eclipse之外，打开命令行提示。导航到项目目录，运行make menuconfig来配置项目的esp-idf设置。这个步骤目前必须在Eclipse之外运行。<br/> <br/> <em class="mb">如果您试图在没有运行配置步骤的情况下进行构建，esp-idf将在命令行上提示进行配置——但是Eclipse无法处理这种情况，因此构建将会挂起或失败。</em> <br/> <br/>回到Eclipse中，选择<code class="eh ly lz ma lo b">Project -&gt; Build All</code>来构建您的项目。<br/> <br/> <strong class="js hu">提示:</strong>如果您的项目已经在Eclipse之外构建好了，您可能需要在选择<code class="eh ly lz ma lo b">Project -&gt; Build</code>之前做一个<code class="eh ly lz ma lo b">Project -&gt; Clean</code>。这是为了让Eclipse可以看到所有源文件的编译器参数。它使用这些来确定头包含路径。<br/> <br/> <strong class="js hu"> 4。从Eclipse中flash</strong><br/><br/>您可以将"<code class="eh ly lz ma lo b">make flash</code>"目标集成到您的Eclipse项目中，以便从Eclipse UI中使用esptool.py进行flash:<br/><br/>在项目浏览器中右键单击您的项目(重要的是确保您选择的是项目，而不是项目中的目录，否则Eclipse可能会找到错误的Makefile。)<br/> <br/>从上下文菜单中选择<code class="eh ly lz ma lo b">Build Targets -&gt; Create…</code>。<br/>输入“flash”作为目标名称。将其他选项保留为默认值。</strong></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/a55d68126c5c89ac33e62bfd1bbb672d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*eRbr_15Byi7yYDOM.png"/></div></figure><p id="a7ad" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">确保ESP-32已连接，并且使用menuconfig选择了正确的串行端口，然后使用<code class="eh ly lz ma lo b">Project -&gt; Build Target -&gt; Build</code> (Shift+F9)构建自定义闪存目标，该目标将编译并闪存项目。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/3422d14632e482a58bb3f30963db7659.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*DZrjqsA6yU8ZfL6p.png"/></div></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/f3f2b35e2ff3c51e08411fd3f4d1f2dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*L2s-WyZsscs0ff-L.png"/></div></figure><p id="4d72" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">您的程序将被编译并刷新到ESP-32，结果显示在CDT构建控制台中。<br/> <br/>注意，您需要使用<code class="eh ly lz ma lo b">make menuconfig</code>来设置串口和其他配置选项，以进行刷新。“<code class="eh ly lz ma lo b">make menuconfig</code>”仍然需要命令行终端(参见Espressif网站上针对您的平台的说明，或者参考我们的ESP-IDF教程。)</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff li"><img src="../Images/7f068a83691f98fa43afe714b9899a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*XAOcz8sisof9-qQh.png"/></div></figure><p id="6084" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">如有必要，按照相同的步骤添加bootloader和partition_table目标。</p><div class="mc md fm fo me mf"><a href="https://reefwing.medium.com/espressif-esp32-tutorial-ir-remote-control-using-microsoft-azure-ed768a5cea4d" rel="noopener follow" target="_blank"><div class="mg ab ej"><div class="mh ab mi cl cj mj"><h2 class="bd hu fv z el mk eo ep ml er et hs dt translated">Espressif ESP32教程—使用Microsoft Azure进行红外遥控</h2><div class="mm l"><h3 class="bd b fv z el mk eo ep ml er et ek translated">本教程将概述如何使用ESP32创建一个红外遥控器，然后从微软的物联网中心控制它…</h3></div><div class="mn l"><p class="bd b gc z el mk eo ep ml er et ek translated">reefwing.medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt jo mf"/></div></div></a></div></div><div class="ab cl mu mv hb mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="hm hn ho hp hq"><p id="661b" class="pw-post-body-paragraph jq jr ht js b jt ju iu jv jw jx ix jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated"><em class="mb">如果你喜欢这篇文章，并且愿意帮助支持我的写作，那么请</em> <a class="ae km" href="https://reefwing.medium.com/membership" rel="noopener"> <em class="mb">订阅成为媒介会员</em> </a> <em class="mb">。我会得到你的订阅费的一部分，你可以访问媒体上的每个故事。或者，你可以</em> <a class="ae km" href="https://ko-fi.com/davidsuch" rel="noopener ugc nofollow" target="_blank"> <em class="mb">给我买杯咖啡</em> </a> <em class="mb">！</em></p><div class="mc md fm fo me mf"><a href="https://reefwing.medium.com/membership" rel="noopener follow" target="_blank"><div class="mg ab ej"><div class="mh ab mi cl cj mj"><h2 class="bd hu fv z el mk eo ep ml er et hs dt translated">用我的推荐链接加入媒体-大卫这样</h2><div class="mm l"><h3 class="bd b fv z el mk eo ep ml er et ek translated">阅读大卫·瑟奇(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="mn l"><p class="bd b gc z el mk eo ep ml er et ek translated">reefwing.medium.com</p></div></div><div class="mo l"><div class="nb l mq mr ms mo mt jo mf"/></div></div></a></div></div></div>    
</body>
</html>