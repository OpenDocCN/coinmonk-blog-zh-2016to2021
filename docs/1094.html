<html>
<head>
<title>Distinguishing mutual and unilateral channel closing in the Bitcoin blockchain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">区分比特币区块链中的双向和单向通道关闭</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/distinguishing-mutual-and-unilateral-channel-closing-in-the-bitcoin-blockchain-ec2e0e7d71f4?source=collection_archive---------2-----------------------#2018-07-20">https://medium.com/coinmonks/distinguishing-mutual-and-unilateral-channel-closing-in-the-bitcoin-blockchain-ec2e0e7d71f4?source=collection_archive---------2-----------------------#2018-07-20</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="3691" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">有没有想过如何区分相互的和单方面的闪电网络通道关闭？</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/767c0fe8b49575d374b02c74f33e06c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKFy3LUTvNIJs53CWUOr-A.jpeg"/></div></div></figure><p id="2996" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">Gaurav AgrawalLightning通道有两种不同的结束方式:</p><ol class=""><li id="08da" class="kq kr ht jw b jx jy ka kb kd ks kh kt kl ku kp kv kw kx ky dt translated">一个相互合作的成交简称为<a class="ae kz" href="https://github.com/lightningnetwork/lightning-rfc/blob/master/03-transactions.md#closing-transaction" rel="noopener ugc nofollow" target="_blank">成交</a></li><li id="a048" class="kq kr ht jw b jx la ka lb kd lc kh ld kl le kp kv kw kx ky dt translated">称为<a class="ae kz" href="https://github.com/lightningnetwork/lightning-rfc/blob/master/03-transactions.md#commitment-transaction" rel="noopener ugc nofollow" target="_blank">承诺交易</a>的单边、不合作成交</li></ol><p id="ecb7" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">很容易有区别:<a class="ae kz" href="https://github.com/lightningnetwork/lightning-rfc/blob/master/03-transactions.md#closing-transaction" rel="noopener ugc nofollow" target="_blank">雷电网络规范说</a>相互闭合的<code class="eh lf lg lh li b">locktime</code>字段始终为0。让我们看看如何在实践中检查这一点！</p><p id="24fc" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">我们将使用闪电网络浏览器<a class="ae kz" href="https://1ml.com/" rel="noopener ugc nofollow" target="_blank">1ml.com</a>为一个渠道找到资金交易。然后我们使用比特币区块浏览器<a class="ae kz" href="https://btc.com/" rel="noopener ugc nofollow" target="_blank">btc.com</a>找到消费交易的哈希ID。然后，我们使用基于网络的比特币API接口:<a class="ae kz" href="http://chainquery.com/" rel="noopener ugc nofollow" target="_blank">chainquery.com</a>进行消费交易。我们将锁定时间与零进行比较。</p><h2 id="5386" class="lj lk ht bd ll lm ln lo lp lq lr ls lt kd lu lv lw kh lx ly lz kl ma mb mc md dt translated">共同结算是什么样的</h2><p id="dc46" class="pw-post-body-paragraph ju jv ht jw b jx me iu jz ka mf ix kc kd mg kf kg kh mh kj kk kl mi kn ko kp hm dt translated">我们在这里可以看到一些封闭的渠道:<a class="ae kz" href="https://1ml.com/channel?order=closedchannels" rel="noopener ugc nofollow" target="_blank">https://1ml.com/channel?order=closedchannels</a></p><p id="1440" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">举个例子:<a class="ae kz" href="https://1ml.com/channel/567676753988747264" rel="noopener ugc nofollow" target="_blank">https://1ml.com/channel/567676753988747264</a></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff mj"><img src="../Images/dbf72db73193d51122739561a3ca0942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R8-GQJ-AEhFVeUcIkfHOIw.png"/></div></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">Screenshot from <a class="ae kz" href="https://1ml.com/channel/567676753988747264" rel="noopener ugc nofollow" target="_blank">https://1ml.com/channel/567676753988747264</a></figcaption></figure><p id="089e" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">浏览器显示其通道点为:ea 6279771 eff 21 c 491 f 36512 be 9842 bfdc 9154 E8 b 1848 F4 be 2896 b 147d 49 da 70:0<br/>这其中的第一部分是资金交易的比特币交易ID，冒号后的第二部分是交易输出的零基索引。从零开始的索引意味着这里的0指向事务的第一个输出。</p><p id="c49a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">我们可以在比特币区块浏览器上找到资金交易:<a class="ae kz" href="https://btc.com/ea6279771eff21c491f36512be9842bfdc9154e8b1848f4be2896b147d49da70" rel="noopener ugc nofollow" target="_blank">https://BTC . com/ea 6279771 eff 21 c 491 f 36512 be 9842 bfdc 9154 E8 b 1848 F4 be 2896 b 147d 49 da 70</a></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff mo"><img src="../Images/ac162453252b25e7f011dad9313223c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2D4KaPPgzorn_JCcKaY1Uw.png"/></div></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">Screenshot from <a class="ae kz" href="https://btc.com/ea6279771eff21c491f36512be9842bfdc9154e8b1848f4be2896b147d49da70" rel="noopener ugc nofollow" target="_blank">https://btc.com/ea6279771eff21c491f36512be9842bfdc9154e8b1848f4be2896b147d49da70</a></figcaption></figure><p id="ffe4" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">交易的第一个输出是闪电通道关联的比特币地址:<br/>T3】BC 1 qfa 5 u 5 vplmn 3 tx 6 qvtgvc 5 ente 2hg 5 wfxa 7 VF 3 jaw5 xsr XML 2 kssujygpz</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff mp"><img src="../Images/60a9e6a93c2b320fa34a92be3390e113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c8VzCZuy0duX0Dha-2F8rQ.png"/></div></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">Screenshot from <a class="ae kz" href="https://btc.com/bc1qfa5u5vplmn3tx6qvtgvc5ente2hg5wfxa7vf3javw5xsrxml2kssujygpz" rel="noopener ugc nofollow" target="_blank">https://btc.com/bc1qfa5u5vplmn3tx6qvtgvc5ente2hg5wfxa7vf3javw5xsrxml2kssujygpz</a></figcaption></figure><p id="dc87" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">我们可以看到通道以这个事务ID结束:dab CFA 44 dcfc 7 beab 462757 B4 BBB 081 bb 992 e 339 ACC 1 cf 4c 395 D1 a 917 e 2d 1947</p><p id="5fe3" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">所以我们可以在比特币API 上用<a class="ae kz" href="http://chainquery.com/bitcoin-api/getrawtransaction/dabcfa44dcfc7beab462757b4bbb081bb992e339acc1cf4c395d1a917e2d1947/1" rel="noopener ugc nofollow" target="_blank"> getrawtransaction查询整个解码后的交易，仔细看看:</a></p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="mq mr l"/></div></figure><p id="42c3" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">重要的部分是<code class="eh lf lg lh li b">"locktime": 0</code> <br/>这是一个相互合作的渠道关闭。</p><h2 id="42f4" class="lj lk ht bd ll lm ln lo lp lq lr ls lt kd lu lv lw kh lx ly lz kl ma mb mc md dt translated">单边交易看起来像什么</h2><p id="8fa1" class="pw-post-body-paragraph ju jv ht jw b jx me iu jz ka mf ix kc kd mg kf kg kh mh kj kk kl mi kn ko kp hm dt translated">让我们看看另一个频道，比如这个:<a class="ae kz" href="https://1ml.com/channel/583074314791419905" rel="noopener ugc nofollow" target="_blank">https://1ml.com/channel/583074314791419905</a></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ms"><img src="../Images/bd388c7d010d277fae28fce902387ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7JyM6O8m0Qvvx4u-lUxS8A.png"/></div></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">Screenshot from <a class="ae kz" href="https://1ml.com/channel/583074314791419905" rel="noopener ugc nofollow" target="_blank">https://1ml.com/channel/583074314791419905</a></figcaption></figure><p id="5f52" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">它的通道点是:9 C4 f1 E1 f 06 a 786 cf 6712 C2 fc 119 ed 0584 fcfa 4 e 2 a3 d 637d 66 BD 89245d 9 ad 852d:1<br/>末尾的1表示我们在寻找事务的第二个输出。</p><p id="7d37" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">下面是比特币区块浏览器中的资金交易:<a class="ae kz" href="https://btc.com/9c4f1e1f06a786cf6712c2fc119ed0584fcfa4e2a3d637d66bd89245d9ad852d" rel="noopener ugc nofollow" target="_blank">https://BTC . com/9 C4 f1 E1 f 06 a 786 cf 6712 C2 fc 119 ed 0584 fcfa 4 e2a 3d 637d 66 BD 89245d 9 ad 852d</a></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff mt"><img src="../Images/ec206b9300e04f88c71a508a3fc74f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B-WI7wEKpH7EkLO6TGhsSg.png"/></div></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">Screenshot from <a class="ae kz" href="https://btc.com/9c4f1e1f06a786cf6712c2fc119ed0584fcfa4e2a3d637d66bd89245d9ad852d" rel="noopener ugc nofollow" target="_blank">https://btc.com/9c4f1e1f06a786cf6712c2fc119ed0584fcfa4e2a3d637d66bd89245d9ad852d</a></figcaption></figure><p id="2fbd" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">闪电通道关联的比特币地址为:<br/><a class="ae kz" href="https://btc.com/bc1q8w9jgsggg8pxy7ztwcdk8l4hnsrwrskp4hw8k4q82pmnjqpp305qjx4dkd" rel="noopener ugc nofollow" target="_blank">BC 1 q 8 w9 jgsggg 8 pxy 7 ztw CDK 8 l 4 hnsrwrskp 4 HW 8k 4 q 82 pmnjqpp 305 qjx 4d KD</a></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff mu"><img src="../Images/1eff11ab54f6aeedd0357fad57fd2d06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E5w497t52I2DBbj0IlBPJA.png"/></div></div><figcaption class="mk ml fg fe ff mm mn bd b be z ek">Screenshot from <a class="ae kz" href="https://btc.com/bc1q8w9jgsggg8pxy7ztwcdk8l4hnsrwrskp4hw8k4q82pmnjqpp305qjx4dkd" rel="noopener ugc nofollow" target="_blank">https://btc.com/bc1q8w9jgsggg8pxy7ztwcdk8l4hnsrwrskp4hw8k4q82pmnjqpp305qjx4dkd</a></figcaption></figure><p id="32f5" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">该通道以此交易ID结束:5e 504 e 75581 ff 501 a0c 852 b4a 3107 df 9 c 72 aed 17d 11 bded 784 adfa 6 CB 9 c 78074</p><p id="c38d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">因此我们可以像上面的一样查询<a class="ae kz" href="http://chainquery.com/bitcoin-api/getrawtransaction/5e504e75581ff501a0c852b4a3107df9c72aed17d11bded784adfa6cb9c78074/1" rel="noopener ugc nofollow" target="_blank">来查看解码的事务:</a></p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="mq mr l"/></div></figure><p id="4597" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">重要的是<code class="eh lf lg lh li b">"locktime": 543621745</code> <br/>这是一次单方面的、不合作的渠道关闭。</p><h2 id="2994" class="lj lk ht bd ll lm ln lo lp lq lr ls lt kd lu lv lw kh lx ly lz kl ma mb mc md dt translated">感谢</h2><p id="e1f1" class="pw-post-body-paragraph ju jv ht jw b jx me iu jz ka mf ix kc kd mg kf kg kh mh kj kk kl mi kn ko kp hm dt translated">感谢Mykola Sakhno和LightningPeach团队帮助我理解这些类型的交易。</p></div></div>    
</body>
</html>