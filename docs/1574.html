<html>
<head>
<title>Reducing EOS contract deployment RAM footprint</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">减少EOS合同部署RAM占用空间</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/reducing-eos-contract-deployment-ram-footprint-71463f45c43e?source=collection_archive---------2-----------------------#2018-09-30">https://medium.com/coinmonks/reducing-eos-contract-deployment-ram-footprint-71463f45c43e?source=collection_archive---------2-----------------------#2018-09-30</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/4c64df85637fda627fa759650a9c18d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*gOzpJHifFQrfmt3uIlnmvw.jpeg"/></div></figure><p id="0756" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">由于RAM价格的原因，在EOS上做智能合约工作目前有点贵。合同的状态以及代码和ABI都存储在基于内存的数据库中。你必须购买的内存，就像我写这篇文章时的价格，大约是0.7美元/千字节。</p><p id="d3b6" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">即使你写了一个合同，由用户支付所有数据存储的费用，你仍然需要支付合同的部署费用。</p><p id="37f9" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">假设你有一个基本契约，你用<a class="ae jv" href="https://github.com/EOSIO/eosio.cdt" rel="noopener ugc nofollow" target="_blank"> eosio.cdt </a>来构建，如下所示:</p><pre class="jw jx jy jz fq ka kb kc kd aw ke dt"><span id="e3a5" class="kf kg ht kb b fv kh ki l kj kk">eosio-cpp -o player/player.wasm player/player.cpp</span></pre><p id="ce94" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在本例中，这会产生一个大约42k字节的. wasm文件。因此，要部署它，您可能需要支付42 * $ 0.7 = $ 29.4</p><p id="0e33" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> <em class="kl">嗯，原来，EOS软件为了容纳VM等开销，它需要分配十倍的资源。因此，您应该预计需要大约420千字节的内存来部署42千字节的合同！你现在需要大约300美元来部署它。</em> </strong></p><p id="6042" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">因此，当大小的乘数为10时，一些大小优化可能会派上用场。我们可以通过在命令行中指定一些额外的参数来实现这一点:</p><pre class="jw jx jy jz fq ka kb kc kd aw ke dt"><span id="1686" class="kf kg ht kb b fv kh ki l kj kk">eosio-cpp -Os -finline-hint-functions -fno-elide-constructor -o player/player.wasm player/player.cpp</span></pre><p id="2622" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">通过这种方式，我们指示编译器针对可执行文件的大小进行优化，仅当程序员明确暗示时才内联函数，并禁用特定的复制构造函数优化。</p><p id="4528" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="kl">产生的wasm文件现在是37k字节，因此成本将是259美元。节省下来的41美元可以花在咖啡上来促进你的发展。</em>T13】</p><p id="8fd2" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们在这里看到的大约15%的收益当然会有所不同。你写的代码类型，你使用的库的数量，等等，都可能使这种情况大大增加或减少。我们还应该注意到，这些类型的优化将导致更慢的契约，但除非你做一些计算非常密集的事情，这将不会被注意到。</p><blockquote class="km"><p id="649c" class="kn ko ht bd kp kq kr ks kt ku kv ju ek translated"><a class="ae jv" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="kx ky kz la lb iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff kw"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>