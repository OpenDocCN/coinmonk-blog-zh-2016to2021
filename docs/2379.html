<html>
<head>
<title>Deploying a Hyperledger Composer blockchain business network to Hyperledger Fabric.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Hyperledger Composer区块链业务网络部署到Hyperledger结构。</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/deploying-a-hyperledger-composer-blockchain-business-network-to-hyperledger-fabric-c14a3b2bb746?source=collection_archive---------2-----------------------#2019-08-30">https://medium.com/coinmonks/deploying-a-hyperledger-composer-blockchain-business-network-to-hyperledger-fabric-c14a3b2bb746?source=collection_archive---------2-----------------------#2019-08-30</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="1123" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我开发了一个简单的区块链应用程序，作为2019年5月在班加罗尔举行的印度黑客马拉松Dapp会议的一部分。这个想法是设计一个私人区块链来分散航空公司的航班信息数据库。</p><p id="ad63" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">私人许可的区块链是一个新的时髦词，随着Linux基金会的Hyperledger项目的实施，今天的交易网络发生了彻底的变革，该项目创建了在网络上建立身份、执行交易和存储数据的标准方法。</p><p id="f25f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">所有代码都可以在我的Github <a class="ae jo" href="https://github.com/rietesh/Hyperledgerfabric-Airline-App" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">这里</strong> </a>找到</p><p id="ebba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> Hyperledger Composer </strong>是一套用于构建区块链商业网络的协作工具，使企业主和开发人员能够简单快速地创建智能合同和区块链应用程序来解决商业问题。Composer采用JavaScript构建，利用node.js、npm、CLI和流行编辑器等现代工具，提供以业务为中心的抽象以及带有易于测试的devops流程的示例应用，以创建强大的区块链解决方案，推动业务需求与技术开发保持一致。<a class="ae jo" href="https://www.hyperledger.org/projects/composer" rel="noopener ugc nofollow" target="_blank"> <em class="jp">来源</em> </a></p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/d8e09c74d410f2cbbf992c74aa36fabb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Xi4ZQnntSxa1vdp9.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">The Steps involved in making the App</figcaption></figure><p id="0af1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> Hyperledger Fabric </strong>是私有的并且是许可的。Hyperledger结构网络的成员通过可信成员服务提供商(MSP)注册，而不是允许未知身份加入网络的开放的无许可系统。</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff kg"><img src="../Images/83cf3db3e170f15d72733b01a8724280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*CRrwNu2BNaD13TiNQYEmZg.jpeg"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Simplified Hyperledger Fabric Architecture</figcaption></figure><p id="8e8d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">设置开发环境==&gt; <a class="ae jo" href="https://hyperledger.github.io/composer/latest/installing/development-tools.html" rel="noopener ugc nofollow" target="_blank"> <em class="jp">点击</em> </a></p><p id="f7ba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">定义模型</strong>:</p><p id="6dcf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Asset== &gt;航班详细信息，如航班号、位置、工作状态、航班类型、更新者的员工Id、描述。</p><p id="f83f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">参与者== &gt;负责更新信息的员工。</p><p id="6820" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Transaction== &gt;更新位置、更新者、工作状态和航班号。</p><p id="ebd5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要获得框架代码和正确的文件结构，请运行:</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="32e6" class="km kn ht ki b fv ko kp l kq kr">yo hyperledger-composer:businessnetwork</span></pre><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="ks kt l"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Model.cto</figcaption></figure><p id="5c73" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">事务逻辑非常简单，我们只是将旧值改为新值，并更新employeeId。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="ks kt l"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">logic.js</figcaption></figure><p id="1a55" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Permissions.acl是一个为参与者、对等者和管理员分配权利和义务的文件。为了简单起见，我给了管理员和系统的所有权利。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="ks kt l"/></div></figure><p id="436a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后我们创建香蕉文件(。bna)使用:</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="3492" class="km kn ht ki b fv ko kp l kq kr">composer archive create -t dir -n .</span></pre><p id="00f3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在与上述文件相同的目录中，我们将获得一个airline-network@0.0.1.bna文件，该文件用于在单个组织的hyperledger fabric的运行实例上部署模型。</p><h1 id="2fcb" class="ku kn ht bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated"><strong class="ak">展开</strong></h1><p id="0867" class="pw-post-body-paragraph iq ir ht is b it lr iv iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hm dt translated">在继续之前，请确保从您的钱包中取出所有以前的网卡运行:<a class="ae jo" href="https://hyperledger.github.io/composer/latest/tutorials/deploy-to-fabric-single-org.html" rel="noopener ugc nofollow" target="_blank">S<strong class="is hu"><em class="jp">source</em></strong></a></p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="4e62" class="km kn ht ki b fv ko kp l kq kr">rm -fr ~/.composer</span></pre><p id="1c4b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们需要建立一个连接配置文件，创建一个connection.json文件来定义和指定定位和连接到Hyperledger Fabric网络所需的所有信息，例如所有Hyperledger Fabric网络组件的主机名和端口。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="ks kt l"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">connection.json</figcaption></figure><p id="2e66" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我正在创建一个单个对等点(<strong class="is hu">peer0.org1.example.com</strong>)请求端口是7051，这里我们已经使用主机名localhost指定了我们的单个CA(<strong class="is hu">ca.org1.example.com</strong>)和CA端口7054，这里，我们的单个订购者节点(<strong class="is hu">orderer.example.com</strong>)使用主机名localhost和订购者端口7050，我们还将其标记为orderer.example.com。orderers对象可以包含多个order节点。</p><p id="c5a2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我还指定了整个组织、对等方、CA、订购方和渠道以及客户端部分，以及提交前等待的超时长度。</p><p id="77ed" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我们寻找运行后生成的管理员的私有和公共密钥。/startfabric.sh然后，我们将这些键复制到我们的项目目录中，现在我们准备为Hyperledger Fabric管理员创建我们的业务网络卡。</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="8860" class="km kn ht ki b fv ko kp l kq kr">composer card create -p connection.json -u PeerAdmin -c Admin@org1.example.com-cert.pem -k 114aab0e76bf0c78308f89efc4b8c9423e31568da0c340ca187a9b17aa9a4457_sk -r PeerAdmin -r ChannelAdmin</span></pre><ul class=""><li id="c4ab" class="lw lx ht is b it iu ix iy jb ly jf lz jj ma jn mb mc md me dt translated">-c这是用户<a class="ae jo" href="mailto:Admin@org1.example.com" rel="noopener ugc nofollow" target="_blank">Admin@org1.example.com</a>的证书文件路径</li><li id="b68e" class="lw lx ht is b it mf ix mg jb mh jf mi jj mj jn mb mc md me dt translated">-k这是用户<a class="ae jo" href="mailto:Admin@org1.example.com" rel="noopener ugc nofollow" target="_blank">Admin@org1.example.com</a>的私钥文件的路径</li><li id="9b8c" class="lw lx ht is b it mf ix mg jb mh jf mi jj mj jn mb mc md me dt translated">-r我们指定用户拥有哪些角色</li></ul><p id="03ed" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来，我们通过运行</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="65d9" class="km kn ht ki b fv ko kp l kq kr">composer card import -f PeerAdmin@Airline-network.card</span></pre><p id="0522" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将Hyperledger Composer业务网络安装到Hyperledger结构对等节点上</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="dca5" class="km kn ht ki b fv ko kp l kq kr">composer network install -c PeerAdmin@Airline-network -a airline-network@0.0.1.bna</span></pre><p id="5ff1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">启动区块链</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="0f21" class="km kn ht ki b fv ko kp l kq kr">composer network start --networkName airline-network --networkVersion 0.0.1 -A admin -S adminpw -c PeerAdmin@Airline-network</span></pre><p id="17d5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">部署区块链业务网络时，您必须创建至少一个参与者，该参与者将是区块链业务网络管理员。该参与者负责让其他参与者加入区块链业务网络。这里，我们指定要创建一个名为admin的区块链企业网络管理员。</p><p id="b27f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">-S指定我们的区块链企业网络管理员admin将使用adminpw的注册密码向CA(证书颁发机构)请求证书和私钥。当您指定此选项时，为企业网络管理员指定的名称必须是已向CA注册的用户的现有注册ID。</p><p id="3fab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为业务网络管理员导入业务网卡:</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="5603" class="km kn ht ki b fv ko kp l kq kr">composer card import -f admin@airline-network.card</span></pre><p id="91a9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">测试:</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="84d8" class="km kn ht ki b fv ko kp l kq kr">composer network ping -c admin@airline-network</span></pre><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mk"><img src="../Images/6174ab708ab36771932198f0f9872cca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jzNNYtfQUOBgfE-Ipf0HHA.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Results for Network Ping</figcaption></figure><p id="9092" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在，我们已经成功地将区块链业务网络部署到单个组织的Hyperledger Fabric实例中，包括生成必要的Hyperledger Composer配置。</p><p id="ced1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们生成一个REST服务器:</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="da85" class="km kn ht ki b fv ko kp l kq kr">composer-rest-server</span></pre><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff ml"><img src="../Images/58f296c67325416ff1b33a0397d9918c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48c3c1-bG-KqMy9U5TG5nA.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">REST Server configuration</figcaption></figure><p id="2dd8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">注意:</strong>指定是否要通过websockets启用事件发布=Yes</p><p id="1a14" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们可以生成一个骨架角4应用程序:</p><pre class="jr js jt ju fq kh ki kj kk aw kl dt"><span id="0e21" class="km kn ht ki b fv ko kp l kq kr">yo hyperledger-composer:angular</span></pre><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mm"><img src="../Images/9cf31c1d9d6d68816c22dc30c4dcbf48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dW-UL8FpDW-wY456-sWerg.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Angular 4 Application</figcaption></figure><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mn"><img src="../Images/eeeba89004cb677334c073231366855a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4S0bLM7ZrzRLCD0sAZNrVQ.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">REST server and npm start</figcaption></figure><p id="9cc1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这将创建一个REST服务器的代理和一个在该文件夹上运行npm start的app.js，并最终在<a class="ae jo" href="http://0.0.0.0:4500/" rel="noopener ugc nofollow" target="_blank"> http://0.0.0.0:4200/ </a>上服务Angular应用程序</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mn"><img src="../Images/182f08017f36dee37561e3d63623a642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gHyJmNq2cDL9uLfXJf_D5w.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Angular 4 Application</figcaption></figure><p id="2c5b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们可以从这个Angular 4应用程序中添加资产、参与者和调用事务，</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mn"><img src="../Images/6e4676de6a46039a9ad921f321f543d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8UmiSozbS10C_rSJAXPhgQ.png"/></div></div></figure><p id="9456" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">添加资产<strong class="is hu"> AI123 </strong>从<strong class="is hu"> Bengaluru </strong>出发，预计到达<strong class="is hu">德里</strong>。</p><p id="02a6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">由<strong class="is hu"> emp01 </strong>更新</p><p id="c4a5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">具有<strong class="is hu">功能的</strong>工作状态</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mn"><img src="../Images/b136a02f721571f7ac990d82a5b6b209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WH3P5L8isw2AO62je7K52g.png"/></div></div></figure><p id="c680" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">添加员工ID为<strong class="is hu"> emp01 </strong>的员工</p><p id="8dfe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我还添加了另一名员工，其EmployeeID为<strong class="is hu"> emp02 </strong></p><p id="afd0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">调用事务并将其提交到分类帐</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mn"><img src="../Images/7cbf669b5553f2ed5ae1282faafd08a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*prUSgF2pv3W8b5CUeYaI1w.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Invoking Transaction</figcaption></figure><p id="48b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">提交后，我们有航班号:<strong class="is hu"> AI456 </strong>，位置:<strong class="is hu">德里</strong>，工作状态:<strong class="is hu">非工作状态</strong>，更新者:<strong class="is hu"> emp02 </strong></p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff mn"><img src="../Images/1547aefe5f3dd24e6d2701c5fbacf587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dppPggKFlLq5Tg79Y-MzuQ.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Committed Transaction</figcaption></figure><p id="045b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你喜欢这个博客，请留下你的任何疑问和疑问，拍拍拍拍！</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><a href="https://coincodecap.com"><div class="fe ff mo"><img src="../Images/a06b758bdcc47dca7c2504f298674d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_s6JsD3P0hVj32E7t9EtGg.jpeg"/></div></a><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Coinmonks</figcaption></figure></div></div>    
</body>
</html>