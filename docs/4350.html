<html>
<head>
<title>Sourcing intra-day crypto data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">获取当天加密数据</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/sourcing-intra-day-crypto-data-c804ea199baf?source=collection_archive---------2-----------------------#2021-04-08">https://medium.com/coinmonks/sourcing-intra-day-crypto-data-c804ea199baf?source=collection_archive---------2-----------------------#2021-04-08</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/fa5274395acb588b21fc1a79309d8a46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MBbjFLncDkBmSQW-PzgF4w.jpeg"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">Photo by <a class="ae jf" href="https://unsplash.com/@silverhousehd?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">André François McKenzie</a> on <a class="ae jf" href="https://unsplash.com/s/photos/cryptocurrency?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="1c8e" class="jg jh ht bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated"><strong class="ak">简介</strong></h1><p id="8d93" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">我最近一直在做一个项目，为比特币定价建立一个日内预测模型(<a class="ae jf" href="https://aws.amazon.com/marketplace/pp/prodview-4upbyugt7qm62?qid=1617890746600&amp;sr=0-1&amp;ref_=srh_res_product_title" rel="noopener ugc nofollow" target="_blank"> bitcoinpredict10 </a>)。该模型建立在一个大型的一分钟历史价格数据集(来源于<a class="ae jf" href="https://www.kaggle.com/datasets?search=crypto" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>)上，这给了我们很大的灵活性，因此，这意味着最终的模型需要大约两周的一分钟价格点来进行预测。</p><p id="b120" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">我们认为在生产模型中获取数据会很容易，因为有许多供应商和交易所提供加密数据点。然而，我们在发布后发现，我们需要的生产数据集很难找到，或者对用户来说成本很高，因此，我们认为其他人可能会遇到相同的问题，找到稍长的最新免费数据集。</p><h1 id="a6e8" class="jg jh ht bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated">解决方案</h1><p id="0ae7" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">本文将讨论我们如何使用来自<a class="ae jf" href="https://www.bitstamp.net/api/" rel="noopener ugc nofollow" target="_blank"> Bitstamps公共API </a>(大多数加密货币交易所都提供类似的API)和网站C<a class="ae jf" href="https://www.cryptodatadownload.com/data/" rel="noopener ugc nofollow" target="_blank">ryptodadadownload</a>的免费交换数据来解决我们的问题。示例代码将用Python编写，可以在以下存储库中找到。为了连接到两个站点并操作/存储数据，我们将使用以下库:-</p><ul class=""><li id="2c18" class="li lj ht kg b kh lc kl ld kp lk kt ll kx lm lb ln lo lp lq dt translated">pandas——使用panda DataFrame存储和操作数据。</li><li id="711c" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated">json — Bitstamp在json文件中发送其数据。</li><li id="d5ed" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated">csv-来源于CryptoDataDownload的较大数据集将在CSV文件中返回。</li><li id="cab8" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated">ssl — CryptoDataDownload使用安全套接字，因此我们需要它来连接到站点。</li><li id="fd0f" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated">请求—向两个网站的API发送查询。</li></ul><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lw"><img src="../Images/6dd9522becf6769bcefbec256b26005b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0zyG_BCa3V2-g8JU6N6V-Q.png"/></div></div></figure><p id="9204" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">对于这个例子，我们将把货币对称为BTCUSD(比特币和美元)。在CryptoDataDownload网站上，我们将从BTCUSD对的Bitstamp exchange获取数据。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mb"><img src="../Images/2b5879d300a5a39a35019f8625d6aa7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W2hhqZaqa_xaEAl-LlPfmg.png"/></div></div></figure><p id="901e" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">第一部分指定数据位置。在第二步中，我们创建一个用于连接的安全套接字。在最后一步中，我们跳过第一行获取数据，因为这有网站地址。让我们来看看数据帧hist_data。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mc"><img src="../Images/2b7a08cd10e271457305ee85b648f860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I9S6-f9RPpCp3S0QbWuzsA.png"/></div></div></figure><p id="f06b" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">数据集包含Unix时间戳、日期、符号、该分钟的开盘价、最高价、最低价和收盘价，以及BTC交易量和美元交易量。这个数据集叫做开盘-盘高-盘低-收盘(OHLC)。</p><p id="26d5" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">接下来，我们通过调用链接到OHLC的API来获取位戳数据，获取1分钟的分笔成交点数据(步长参数)，并将数据集限制为1000个数据点(限制参数)，调用BTCUSD。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff md"><img src="../Images/a50d2a4d4bdd9a7c40a769a05ac75f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-GQ2cBNPritjYoG_wLNtrw.png"/></div></div></figure><p id="65c8" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">该代码指定网站位置和参数；我们使用request.get调用它，并使用json.loads加载JSON文件。然后将它加载到具有指定列的DataFrame中。我们可以看看最新数据是什么样的吗:</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff me"><img src="../Images/37089b0b440cab1fdc22c6a096e7af4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XY5O2GYBX1qs4KKxccHarg.png"/></div></div></figure><p id="3227" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">我们可以看到两个数据帧之间的一些数据差异，因此我们需要创建新列，重命名列名并移动列位置以匹配数据集。下面的代码执行这些步骤。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mf"><img src="../Images/91312e499de4a7be29eaf345627e5aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*erYH5uQZY1hriBIqAhxNJA.png"/></div></div></figure><p id="7c1d" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">代码步骤:-</p><ul class=""><li id="15a8" class="li lj ht kg b kh lc kl ld kp lk kt ll kx lm lb ln lo lp lq dt translated">在第一部分中，我们在latest_data中创建新列；</li><li id="0900" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated">然后我们重命名这个数据帧中的列；</li><li id="8ef8" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated">接下来，我们在hist_data中选择最新的20160 (2周)的数据点，并删除符号列；</li><li id="dc2a" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated">然后我们重命名列以匹配latest _ data(Bitstamp)；</li><li id="4667" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated">然后，我们在latest_data中获得最早的数据点，并从hist_data (CryptoDataDownload)中移除在此之后的所有数据点，并颠倒hist_data(现在称为dat)数据顺序，因为它最初是开始时的最新数据。相比之下，最新数据Bitstamp排在最后。</li></ul><p id="8bab" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">最后，我们需要将数据放在一起(也就是连接两个数据集)；这是使用append命令完成的。最后，我们使用tail命令为组合数据集选择最后两周的数据。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div class="fe ff mg"><img src="../Images/a24cea4718dfb342387e06e1aa5db8cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*MLjZojh9ZxCWdCNaUfTi2g.png"/></div></figure><p id="294a" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">最终输出如下所示:-</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mh"><img src="../Images/2348cd00d21ccf36c79b11ae284a8228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aR2SaXq9j4GeioaOAiMJdw.png"/></div></div></figure><h1 id="464d" class="jg jh ht bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated">结论</h1><p id="7c62" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">这到底是怎么回事？在这篇文章中，我们已经学会了如何从两个独立的网站获取OHLC数据，并将它们结合起来。组合数据集可用于生产模型中，用于可能的交易策略或应用，如加密货币的趋势分析。我们调用的最后一个函数是<a class="ae jf" href="https://github.com/llama-analytics/GetDataSmush/blob/main/GetData.py" rel="noopener ugc nofollow" target="_blank"> GetData_Smush </a>。</p><h2 id="73c2" class="mi jh ht bd ji mj mk ml jm mm mn mo jq kp mp mq ju kt mr ms jy kx mt mu kc mv dt translated">另外，阅读</h2><ul class=""><li id="b1b5" class="li lj ht kg b kh ki kl km kp mw kt mx kx my lb ln lo lp lq dt translated">最好的<a class="ae jf" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="14b5" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度比特币交易所</a></li><li id="1e00" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/bitcoin-savings-account-e65b13f92451">比特币储蓄账户</a></li><li id="149b" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated">最好的<a class="ae jf" rel="noopener" href="/coinmonks/best-crypto-tax-tool-for-my-money-72d4b430816b">加密税务软件</a></li><li id="09b6" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated"><a class="ae jf" href="https://blog.coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">电网交易</a> | <a class="ae jf" rel="noopener" href="/coinmonks/blockfi-review-53096053c097">区块链审核</a></li><li id="d29e" class="li lj ht kg b kh lr kl ls kp lt kt lu kx lv lb ln lo lp lq dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a></li></ul></div></div>    
</body>
</html>