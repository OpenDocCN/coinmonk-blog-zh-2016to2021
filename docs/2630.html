<html>
<head>
<title>Integrating physical devices with IOTA — Philips Hue edition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将物理设备与IOTA集成—飞利浦色调版</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/integrating-physical-devices-with-iota-philips-hue-edition-19eec4f28ef6?source=collection_archive---------0-----------------------#2020-01-05">https://medium.com/coinmonks/integrating-physical-devices-with-iota-philips-hue-edition-19eec4f28ef6?source=collection_archive---------0-----------------------#2020-01-05</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="3e2f" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">关于将物理设备与<a class="ae ji" rel="noopener" href="https://medium.com/coinmonks/iota/home"> IOTA </a>协议集成的初学者教程系列的第14部分</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/1e4e7bdd2b01892b2249196dab05a85d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oAvngElPe89aoL0DO9IZYQ.jpeg"/></div></div></figure></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="8d72" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">介绍</h1><p id="3474" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">这是初学者系列教程的第14部分，我们将探索如何将物理设备与<a class="ae ji" rel="noopener" href="https://medium.com/coinmonks/iota/home"> IOTA协议</a>集成。在本教程中，我们将重温本系列第一篇教程中的用例，在该教程中，我们构建了一个简单的电源电路，允许我们使用IOTA令牌从物理设备购买服务。在本教程中，我们将采用相同的想法，并将其应用于现有的硬件和软件生态系统之上，即<em class="lq">飞利浦Hue </em>。</p><p id="70fe" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">这将是一个由两部分组成的教程，在第一部分中，我们将重点关注IOTA与流行的<em class="lq"> Philips Hue </em>的集成。在第二篇教程中，我们将大致了解智能家居设备，以及我们如何将IOTA与开源的ZigBee协议集成。</p><p id="2d8d" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated"><em class="lq">注意！<br/>这可能是本系列中最容易完成的教程，因为它不涉及任何电子或微控制器。</em></p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="4764" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">使用案例</h1><p id="19c4" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">那么，为什么我们的酒店老板会选择在像<em class="lq"> Philips Hue </em>这样的现有生态系统上实施他的IOTA支付系统，而不是像我们在第一个教程中所做的那样从头开始构建它呢？嗯，简单的回答就是“即插即用”。不再需要处理大量的线路和微控制器，他现在只需去最近的电子商店，购买所有的智能设备(灯、灯泡、插头等)。)他需要在几个小时内安装并运行他的新支付系统。</p><p id="4a24" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated"><em class="lq">注意！<br/>飞利浦色调系统还提供了许多从头开始很难实现的功能。例如控制光的颜色、光的强度等。</em></p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="fe58" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">飞利浦色相是什么？</h1><p id="aacd" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated"><em class="lq">飞利浦Hue </em>是一个由变色灯、灯泡、LED灯条、开关、调光器、运动传感器、智能电源插头等组成的生态系统。这可以通过应用程序或Phillips Hue API进行无线控制。在生态系统的中心是菲利普斯顺化桥。<em class="lq">色相桥</em>作为整个系统的公共控制器。<em class="lq"> Hue Bridge </em>可以在网状无线网络中同时管理多达50台Hue设备。</p><p id="3576" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">你应该可以在离你最近的电器商店花不到100美元买到一个带电桥和几个智能灯泡的<em class="lq">飞利浦Hue </em>入门套件。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff lw"><img src="../Images/1fd4ff7325dffa3851fda4204667c147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PiMNKJoF9fdUqMc7"/></div></div></figure><p id="85c2" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated"><em class="lq">注意！<br/>当我开始学习本教程时，我没有飞利浦色相系统，所以我不得不出去买一个。那时，我还没有打算在家里永久安装它。然而，在熟悉了这个系统之后，我对硬件和软件的优雅、简单和质量留下了深刻的印象。重点是，如果你还没有一个色调系统，我强烈推荐你买一个，它很酷。</em></p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="d1f3" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">安装色调</h1><p id="30d1" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">首先，在我们继续之前，您必须根据系统附带的文档安装您的<em class="lq">飞利浦Hue </em>系统。这很简单，应该不会超过几分钟。</p><p id="c8be" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">在你的IOS或Android设备上安装了<a class="ae ji" href="https://www2.meethue.com/en-hk/philips-hue-app" rel="noopener ugc nofollow" target="_blank"> Hue app </a>并验证一切正常后，你需要获取你的Hue Bridge的IP地址。</p><p id="06c3" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">要获取您的网桥的IP地址，请打开飞利浦Hue应用程序，进入:<strong class="kw hu"> <em class="lq">设置- &gt; Hue Bridges </em> </strong>，选择您的网桥上的(I)图标。您现在将看到一些与您的桥相关的技术细节。记下<em class="lq"> IP地址</em>，因为我们稍后会在Python脚本中用到它。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="eba4" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">将IOTA地址分配给色调设备</h1><p id="bb18" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">我们需要做的下一件事是为每个单独的色调设备分配一个唯一的支付地址。创建新地址(包括二维码)的最简单方法是使用Trinity钱包。记下每个地址，因为我们稍后会在Python脚本中用到它们。</p><p id="a75a" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">接下来，在一张纸上打印每个地址的二维码，并将其贴在或放在各自的物理色调设备旁边。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="9a82" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">所需的软件和库</h1><p id="3f41" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">飞利浦Hue系统的一个很酷的功能是它有自己的应用编程接口(API ),允许像我们这样的开发人员在系统上接口和构建新的应用程序。更好的是，一个叫做self ' s<a class="ae ji" href="http://studioimaginaire.com/en" rel="noopener ugc nofollow" target="_blank"><strong class="kw hu">studio imaginare</strong></a>的开发团队已经围绕我们将在项目中使用的API<a class="ae ji" href="https://github.com/studioimaginaire/phue" rel="noopener ugc nofollow" target="_blank"><strong class="kw hu"><em class="lq">phue</em></strong></a>制作了一个简单的Python包装器。</p><p id="aae8" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">你可以在这里找到一个github库，里面有<em class="lq"> phue </em>库<a class="ae ji" href="https://github.com/studioimaginaire/phue" rel="noopener ugc nofollow" target="_blank">的文档和安装说明。</a></p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="072d" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">代码</h1><p id="bd24" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">现在我们已经做好了所有的准备，让我们来看看这个项目的Python代码。</p><p id="7d2a" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">我们在这个项目中使用的Python脚本与我们在第一个教程中使用的脚本基本相同，只是做了一些小的调整。请注意，这里不再有对Raspberry PI GPIO引脚或库的任何引用，这意味着我们现在可以从本地网络内的任何计算机上运行Python脚本。</p><p id="a85c" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">Python脚本基本上每10秒检查一次每个IOTA地址(在前面的步骤中创建)的余额。当新的资金被添加到一个地址时，该脚本只需使用Hue API调用打开与其相关联的Hue设备。久而久之，脚本不断地从本地设备余额中删除时间，当余额为空时关闭设备(再次使用API调用)。</p><p id="c77d" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated"><em class="lq">注意！<br/>注意，在phue</em><strong class="kw hu"><em class="lq">set _ light()</em></strong><em class="lq">函数中，第一个扩充是对作为目标的色调设备的id的引用。我不清楚设备id在Hue Bridge/API中是如何管理的，因为我在Hue应用程序中找不到对该id的引用，只有名称。我只能假设id必须与每个设备添加到网桥的顺序相关。</em></p><p id="5ff0" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated"><em class="lq">重要！<br/>在让Python代码与Hue桥交互之前，我们首先需要让您的计算机与桥对等。要做到这一点，您可以按下桥顶上的大按钮，然后在几秒钟内在您的计算机上运行以下Python代码:(这只需要做一次)</em></p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="8d9e" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">这是Python脚本:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="940a" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">你可以从<a class="ae ji" href="https://gist.github.com/huggre/a33df65c5461c4b8181701cdb0334057" rel="noopener ugc nofollow" target="_blank">这里</a>下载脚本</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="6d23" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">运行项目</h1><p id="82b9" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">要运行该项目，首先需要将上一节中的脚本作为文本文件保存在您的计算机上。</p><p id="d0f1" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">注意Python程序文件使用。py扩展名，所以让我们将文件保存为<strong class="kw hu"><em class="lq">pay _ the _ light _ hue _ dev 1 . py</em></strong><br/><em class="lq">(* _ dev 1 . py</em>引用由脚本控制的特定色调设备id)</p><p id="3172" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">接下来，我们需要对脚本做一些小的调整:</p><ol class=""><li id="3a85" class="lz ma ht kw b kx lr la ls ld mb lh mc ll md lp me mf mg mh dt translated">将<strong class="kw hu">b = Bridge(' 192 . 168 . 0 . 71 ')</strong>语句中的IP地址替换为您的Hue网桥的IP地址</li><li id="8aaa" class="lz ma ht kw b kx mi la mj ld mk lh ml ll mm lp me mf mg mh dt translated">将IOTA付款地址替换为您在本教程前面为该特定设备id创建的地址。</li><li id="3428" class="lz ma ht kw b kx mi la mj ld mk lh ml ll mm lp me mf mg mh dt translated">根据您所针对的特定色调设备更新device_id变量(除非id=1，否则无需更改)</li></ol><p id="be3c" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">要执行该脚本，只需启动一个新的终端窗口，导航到保存<em class="lq">pay _ the _ light _ hue _ de v1 . py</em>的文件夹，然后键入:</p><p id="fc36" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated"><strong class="kw hu">python pay _ the _ light _ hue _ dev 1 . py</strong></p><p id="8482" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">现在，您应该可以在您的终端窗口中看到正在执行的代码，显示设备1的当前余额，并每10秒钟检查一次设备的IOTA地址余额以获取新资金。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="de14" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">支付光</h1><p id="1bd2" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">要打开特定的Hue设备，只需拿起装有Trinity wallet的手机，扫描设备的相关QR码，并将一些IOTA转移到其IOTA地址。一旦IOTA tangle确认了交易，设备就会打开并保持打开状态，直到余额变空，这取决于您传输的IOTA的数量。在我的示例中，我将IOTA/设备时间比率设置为1秒服务1 IOTA。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="4235" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">管理多个色调设备</h1><p id="9182" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">如果你看一下本教程的Python脚本，你会注意到脚本本身并不是为同时管理多个色调设备而准备的。我想处理这个问题的适当方法是重新编写代码，以包含某种类型的设备列表或数组，从而允许我们并行管理多个设备。另一种选择当然是(正如我所做的)简单地让多个Python实例同时运行。每个实例使用其自己的设备id/IOTA地址运行其自己的脚本。</p><p id="b3ce" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">如果您想接受重新编写脚本以并行支持多个设备的挑战，请随时在下面的github资源库中提出pull请求。</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="b538" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">贡献</h1><p id="7de1" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">如果你想对本教程有所贡献，你可以在这里找到一个Github库</p></div><div class="ab cl jv jw hb jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hm hn ho hp hq"><h1 id="9eb1" class="kc kd ht bd ke kf kg kh ki kj kk kl km iz kn ja ko jc kp jd kq jf kr jg ks kt dt translated">捐款</h1><p id="e9d1" class="pw-post-body-paragraph ku kv ht kw b kx ky iu kz la lb ix lc ld le lf lg lh li lj lk ll lm ln lo lp hm dt translated">如果你喜欢这个教程，并希望我继续制作其他教程，请随时向下面的IOTA地址捐款。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div class="fe ff mn"><img src="../Images/f898855aa9f02c497078a9bdbee25534.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*j2ENIzmDzXcGSgAdY4w-Jw.png"/></div></figure><p id="d05a" class="pw-post-body-paragraph ku kv ht kw b kx lr iu kz la ls ix lc ld lt lf lg lh lu lj lk ll lv ln lo lp hm dt translated">nyzbhovsmdwabxsacajttwjoqrvvawlbsfqvsjswwbjjlsqknzfc 9 xcrpqsvfqzpbjcjrannpvmmezqjrqsvvgz</p><blockquote class="mo"><p id="92b6" class="mp mq ht bd mr ms mt mu mv mw mx lp ek translated"><a class="ae ji" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="mz na nb nc nd jo fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff my"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>