<html>
<head>
<title>Hyperledger Fabric in practice. Main components and running them locally</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实践中的超分类帐结构。主要组件并在本地运行它们</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/hyperledger-fabric-in-practice-part-1-main-components-and-running-them-locally-aa4b805465fa?source=collection_archive---------1-----------------------#2017-07-22">https://medium.com/coinmonks/hyperledger-fabric-in-practice-part-1-main-components-and-running-them-locally-aa4b805465fa?source=collection_archive---------1-----------------------#2017-07-22</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk iq ir is it fe ff paragraph-image"><div class="ab fr cl iu"><img src="../Images/cbde587a0c5808d222c67c308c9587b5.png" data-original-src="https://miro.medium.com/v2/format:webp/1*NWdPPj6NvicKqZUq9MMlmA.png"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">source</figcaption></figure><h1 id="fa02" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">动机</h1><p id="e3b1" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">如今，与机器学习/人工智能一起被炒作的技术之一是区块链。我们仍在探索加密货币世界之外的使用案例，但这项技术本身是有前途的，在我看来，了解它是如何工作的会很有帮助。</p><p id="cc96" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">你可以在网上找到很多关于区块链及其历史的资料，所以我不打算在这里给出解释，我假设你知道基本知识。相反，我想尝试一种技术上先进的区块链实现— <a class="ae lc" href="https://hyperledger-fabric.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Hyperledger Fabric </a>。</p><blockquote class="ld"><p id="93db" class="le lf ht bd lg lh li lj lk ll lm kw ek translated"><a class="ae lc" href="https://coincodecap.com" rel="noopener ugc nofollow" target="_blank">发现并回顾最佳区块链软件</a></p></blockquote><h1 id="5bb5" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm ln jo jp jq lo js jt ju lp jw jx jy dt translated">超级分类帐结构…</h1><p id="822c" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">Or just Fabric是Hyperledger blockhain框架的旗舰实现，是第一个将状态从<em class="lq">孵化</em>更改为<em class="lq">活动</em>的项目。这是一个开放源码的项目，正在积极开发中，并得到了很好的支持。Hyperledger Fabric的目标是企业，这已经不是什么秘密了，所以它实际上是由IBM这样的大玩家发起和贡献的。我鼓励您查看<a class="ae lc" href="https://hyperledger-fabric.readthedocs.io/en/latest/arch-deep-dive.html#" rel="noopener ugc nofollow" target="_blank"> Fabric architecture </a>文档——它们提供了非常好的概述。</p><h2 id="9a64" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">分布式分类帐</h2><p id="1c54" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">Fabric生活在<a class="ae lc" href="https://www.hyperledger.org/" rel="noopener ugc nofollow" target="_blank"> Hyperledger项目</a>的保护伞下，该项目支持<a class="ae lc" href="https://en.wikipedia.org/wiki/Distributed_ledger" rel="noopener ugc nofollow" target="_blank">分布式分类帐</a>的协同开发。</p><p id="d5d0" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">分布式分类帐是一个对等网络，其中每个节点维护一个分类帐状态的副本。分类帐状态是网络中发生的所有交易的存储。一笔交易不能在以后修改，因此我们经常谈到分布式分类账的不变性。</p><p id="31d5" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">为了支持一致性(网络中的每个节点必须以相同的顺序存储相同的事务)，我们需要一种特殊的机制，称为<strong class="kb hu">一致性</strong>。它使网络中的事务保持同步。</p><h2 id="7379" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">特种织物</h2><p id="4433" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">Hyperledeger Fabric是一个<strong class="kb hu">私有的</strong>和<strong class="kb hu">许可的</strong>区块链，没有加密货币，所以没有人为任何交易付费。在公共区块链，每个人都可以加入网络，在Fabric，在opposite，会员通过会员服务提供商<strong class="kb hu">注册。</strong></p><p id="b9c7" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">Fabric没有使用工作证明来确保一致性，而是提供了一个可插拔的架构，您可以在其中自己定义一致性算法。下面我们将使用最简单的实现——SOLO，其中我们只有一个用于接收交易、对交易进行排序并形成写入分类帐的块的链的consenter。</p><p id="c28c" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">在一个区块链网络中，你可以有几个<strong class="kb hu">通道</strong>，允许一组参与者创建一个独立的交易分类账，这个分类账对网络的其他成员是不可见的。</p><p id="12e1" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">为了更新分类帐，Hyperledger Fabric引入了<strong class="kb hu">智能合约</strong>。理论上，它们可以用任何语言编写，并允许根据我们的需要保持分类帐的一致状态。目前，只有<a class="ae lc" href="https://golang.org/" rel="noopener ugc nofollow" target="_blank"> Go </a>能很好地支持合同的编程。这样的程序叫做<strong class="kb hu">链码。</strong></p><p id="76d7" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated"><strong class="kb hu">注</strong>:hypelegger协会刚刚宣布正式发布了<a class="ae lc" href="https://www.hyperledger.org/hyperledger-fabric-1-0" rel="noopener ugc nofollow" target="_blank">Fabric 1.0版</a>，带来了显著的改进。</p><h2 id="196c" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">认可</h2><p id="5354" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">面料的一个特别之处在于代言过程。由客户应用程序发起的任何交易都必须经过<strong class="kb hu">背书</strong>。客户端应用程序生成交易建议<strong class="kb hu">并将其发送给其选择的背书对等方进行验证。</strong></p><p id="8176" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">批准对等体验证(1)交易提议是格式良好的，(2)它在过去没有被提交过，(3)签名是有效的，以及(4)提交者被适当授权在该通道上执行提议的操作(例如，写入通道)。批准对等体将交易提议输入作为被调用的链码函数的参数。针对当前分类帐状态执行链码，以产生包括响应值、读和写集合的交易结果。<em class="lq">此时没有对分类帐进行更新</em>。这些值的集合连同签署对等体的签名和是/否签署声明作为“提议响应”被传递回客户端应用程序。</p><p id="a272" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">客户端应用程序检查验证是否成功，检查签署对等方的签名，然后才执行交易。以下是该过程的图解说明(摘自IBM网站):</p><figure class="mg mh mi mj fq it fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff mf"><img src="../Images/48ba31c96715b96d21d09fb1ac0913eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pvajs2ZVga4z8N2ZLEOGkw.png"/></div></div></figure><p id="094a" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">你可以在这里找到交易流程的更多细节。</p><h1 id="66d6" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">我们需要的组件</h1><p id="d3e0" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">所以现在我们可以从理论走向实践了。在我们的实践实验中，我们需要以下面料成分:</p><ul class=""><li id="ad57" class="mo mp ht kb b kc kx kg ky kk mq ko mr ks ms kw mt mu mv mw dt translated">会员服务提供商(或认证机构)</li><li id="1cfe" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">订购者</li><li id="402f" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">同龄人</li><li id="81b1" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">组织</li></ul><h2 id="f424" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">会员服务提供商(MSP)</h2><p id="3d6a" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">我鼓励你查看关于MSP的<a class="ae lc" href="https://hyperledger-fabric.readthedocs.io/en/latest/msp.html" rel="noopener ugc nofollow" target="_blank"> Fabric文档</a>。长话短说——我们需要MSP来发布和验证证书以及用户身份验证。</p><p id="cb6f" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">MSP的配置必须在每个对等点和订购者处本地指定(以启用对等点和订购者签名),并在通信信道上指定，以启用参与者身份验证和成员各自的签名验证。对于MSP证书生成，我们将使用由Fabric提供的特殊工具<em class="lq"> cryptogen </em>。</p><p id="2340" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated"><strong class="kb hu">注意</strong>:在Fabric版本中，他们将MSP重命名为证书颁发机构(CA)，所以我将这两个术语互换使用。</p><h2 id="e077" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">订购者</h2><p id="4994" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">订购者(或订购服务)为客户端应用程序和对等方提供共享的通信通道，为包含事务的消息提供广播服务。排序器提供<em class="lq">原子</em>传递，意味着通信通道以相同的逻辑顺序向所有连接的对等体输出相同的消息。在分布式系统的上下文中，这种原子通信保证也被称为<strong class="kb hu">一致性</strong>。所传送的消息是包含在分类帐状态中的候选交易。</p><h2 id="4b66" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">同龄人</h2><p id="1d9f" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">对等方以<em class="lq">块</em>的形式从订购方接收订购的分类帐状态更新，并维护分类帐的状态。对等方还可以承担签署对等方的角色(参见上面的交易工作流程)。</p><h2 id="3273" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">组织</h2><p id="4a6b" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">组织在逻辑上将成员(同级)分开，他们可能共享也可能不共享MSP。建议每个组织都有一个MSP，我们遵循了这一建议。</p><h2 id="eb2c" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">在本地部署区块链光纤网络</h2><p id="ae08" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">让我们开始有趣的部分:-)我在Ubuntu 16.04下运行一切。我们需要:</p><ul class=""><li id="7019" class="mo mp ht kb b kc kx kg ky kk mq ko mr ks ms kw mt mu mv mw dt translated"><a class="ae lc" href="https://git-scm.com/" rel="noopener ugc nofollow" target="_blank"> Git </a></li><li id="af04" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" href="https://golang.org/dl/" rel="noopener ugc nofollow" target="_blank">开始</a></li><li id="02e7" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" href="https://store.docker.com/search?offering=community&amp;type=edition" rel="noopener ugc nofollow" target="_blank">码头工人</a></li><li id="1886" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" href="https://docs.docker.com/compose/install/" rel="noopener ugc nofollow" target="_blank"> Docker撰写</a></li></ul><p id="bdec" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated"><strong class="kb hu">提示</strong>:安装Go后，正确设置环境变量。对于Ubuntu，我有:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="7372" class="lr jc ht nd b fv nh ni l nj nk">export GOPATH=~/go<br/>export GOROOT=/usr/local/go<br/>export PATH=$PATH:/usr/local/go/bin<br/>export PATH=$PATH:$(go env GOPATH)/bin</span></pre><p id="4023" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">必须这样做，否则Fabric无法正常运行。</p><h2 id="d385" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">获取Hyperledger结构</h2><p id="74d5" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">首先我们必须克隆Fabric存储库。Fabric是在Go上编写的，所以我们需要遵循Go约定并在特定文件夹下克隆存储库。</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="0b96" class="lr jc ht nd b fv nh ni l nj nk">cd $GOPATH<br/>mkdir src<br/>cd src<br/>mkdir github.com<br/>cd github.com<br/>mkdir hyperledger<br/>cd hyperledger</span></pre><p id="2589" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">现在，我们准备克隆存储库:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="7aac" class="lr jc ht nd b fv nh ni l nj nk">git clone <a class="ae lc" href="https://github.com/hyperledger/fabric.git" rel="noopener ugc nofollow" target="_blank">https://github.com/hyperledger/fabric.git</a></span></pre><h2 id="891a" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">构建结构并创建Docker图像</h2><p id="e8b7" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">幸运的是，面料团队做了很好的工作，准备了很多材料。但是首先我们必须安装依赖项:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="3686" class="lr jc ht nd b fv nh ni l nj nk">sudo apt install libtool libltdl-dev</span></pre><p id="4781" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">现在我们准备构建Hyperledger Fabric:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="06dd" class="lr jc ht nd b fv nh ni l nj nk">cd fabric<br/>make release-all</span></pre><p id="d45f" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">…然后等一下。五分钟。接下来，我们为Hyperledger Fabric创建Docker映像:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="5b88" class="lr jc ht nd b fv nh ni l nj nk">make docker</span></pre><p id="a1f9" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">下载和构建这些东西还需要5-10分钟。如果你现在检查码头</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="6668" class="lr jc ht nd b fv nh ni l nj nk">docker images</span></pre><p id="c2fa" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">您应该会看到许多标记有<em class="lq">x86 _ 64–1 . 0 . 1-snapshot-…</em>和<em class="lq">最新</em>的<em class="lq"> hyperledger/fabric-… </em>图像。</p><h2 id="82ce" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">构建网络配置</h2><p id="813a" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">Fabric提供了非常有用的例子，尤其是对于初学者。</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="1945" class="lr jc ht nd b fv nh ni l nj nk">cd examples</span></pre><p id="8039" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">如果你检查一下文件夹里面有什么，你会看到几个子目录，其中两个是我们感兴趣的:<em class="lq">链码</em>和<em class="lq"> e2e-cli </em>。</p><p id="37e7" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated"><em class="lq">链码</em>包含了一个链码的例子，写在Go上。我不会在这篇文章中详述，我计划在我的下一篇文章中这样做。</p><p id="e49c" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">e2e-cli是我们区块链网络的一个例子。首先，我们需要生成网络配置(或网络工件)。我们尤其必须:</p><ul class=""><li id="6784" class="mo mp ht kb b kc kx kg ky kk mq ko mr ks ms kw mt mu mv mw dt translated">为成员的验证、签名和身份验证生成证书。这将做工具<em class="lq">密码本</em></li><li id="2015" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">生成信道配置:起源块、配置事务、锚对等体。这将使工具<em class="lq"> configtxgen </em></li></ul><p id="46cd" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">这两个工具都是我们之前构建的，你可以在<em class="lq">$ GOPATH/src/github . com/hyperledger/fabric/release/&lt;操作系统架构&gt; /bin </em>下找到它们。在我的例子中<em class="lq"> &lt; OS架构&gt; </em>是<em class="lq"> linux-amd64 </em>。</p><p id="5d41" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">在运行脚本之前，插入以下行:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="b374" class="lr jc ht nd b fv nh ni l nj nk">ARTIFACTS_DIR=”./channel-artifacts”<br/>if [ ! -d “$ARTIFACTS_DIR” ]; then<br/>  mkdir “$ARTIFACTS_DIR”<br/>fi</span></pre><p id="27cc" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">在开始的时候</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="803e" class="lr jc ht nd b fv nh ni l nj nk">function generateChannelArtifacts()</span></pre><p id="9864" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">如果输出目录不存在，就不要创建它，所以我们必须注意它。然后运行剪贴程序:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="b073" class="lr jc ht nd b fv nh ni l nj nk">cd e2e_cli<br/>./generateArtifacts.sh &lt;channel-ID&gt;</span></pre><p id="c699" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">其中，通道ID是通信通道的名称，即<em class="lq">测试通道</em>。</p><p id="d68c" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated"><strong class="kb hu">注意</strong>:我建议只使用字符和数字作为频道名称。当我将一个通道命名为<em class="lq"> my_channel </em>(名称中带有_时，我出错。</p><p id="b940" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">您可以在<em class="lq"> crypto-config.yaml </em>中找到证书生成的配置。它包含网络拓扑，并允许为组织及其组件生成证书。你会在<em class="lq">加密配置</em>文件夹中找到输出。每个组织都配备有唯一的根证书(<em class="lq"> ca-cert </em>)，该证书将特定的组件(对等方和订购方)绑定到该组织。Fabric内的事务和通信由实体的私钥(<em class="lq">密钥库</em>)签名，然后通过公钥(<em class="lq">签名者</em>)验证。</p><p id="e254" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">通道工件在<em class="lq"> configtx.yaml </em>中配置。在这里，您可以看到每个成员的组织和起源块、锚定对等点、订购者和成员服务提供商目录位置的标题。值得注意的是，我们使用SOLO ordererer，即最简单的order。我们将头名作为参数传递给<em class="lq"> configtxgen </em>工具。你会在<em class="lq">通道-工件</em>文件夹中找到输出。</p><p id="d1f4" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">而最后生成的文件是<em class="lq">Docker-Compose-e2e . YAML</em>—一个Docker Compose文件，有orderer、peers和certificate authority。我们还不需要认证机构，所以我们在实验中不使用这个文件。</p><h2 id="f1d1" class="lr jc ht bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me dt translated">启动区块链网络</h2><p id="9749" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">该示例提供了一体化脚本<em class="lq"> network_setup.sh </em>，我们用它来运行网络。我们创建了一个由1个订购者、2个组织和4个同行(每个组织2个)组成的网络。对等体将使用<a class="ae lc" href="http://couchdb.apache.org/" rel="noopener ugc nofollow" target="_blank"> CouchDB </a>数据库来保持分类帐状态。此外，我们还创建了一个CLI(命令行界面)容器来与网络成员“对话”。现在启动脚本:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="3519" class="lr jc ht nd b fv nh ni l nj nk">./network_setup.sh up testchannel 10000 couchdb</span></pre><p id="c442" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">第一个参数是通道名称，第二个是CLI容器的超时(接下来的10000秒CLI容器是活动的，您可以使用它来操作区块链),第三个参数指示使用CouchDB作为对等方的分类帐状态的存储。该脚本为orderer、peers、CouchDB和CLI运行Docker容器。</p><p id="76a7" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">CLI容器启动时，执行<em class="lq">。/scripts/script.sh </em>设置网络。值得注意的是，CLI使用带有适当参数的<em class="lq">对等</em>可执行文件在网络上执行操作。这个脚本非常简单:</p><ul class=""><li id="272a" class="mo mp ht kb b kc kx kg ky kk mq ko mr ks ms kw mt mu mv mw dt translated">创建订购者通信通道<em class="lq">测试通道。</em>记住，我们在沟通渠道上执行所有操作，订购者在其中扮演着核心角色。</li><li id="0c88" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">将所有4个对等体加入到通道中—对等体0和1属于org。1、对等2和3属于org。2</li><li id="5927" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">为两个组织设置锚定对等方(对等方0代表组织。组织2的1和对等2)</li><li id="7e5c" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">安装链码<em class="lq">..对等体0和对等体2上的/chain code/go/chain code _ example 02</em>。链码将两个变量保存在分类帐中，并更新它们，使第一个变量减少，第二个变量增加相同的值</li><li id="9091" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">在对等体2上实例化链代码。实例化将链码添加到通道中，为对等体2启动单独的容器，并初始化与链码相关联的值对。请注意，事务(链码实例化)必须得到认可。我已经标注了相关参数。这里我们看到了背书策略，这意味着任何交易都必须由与org相关联的对等方背书。1或组织。2.</li></ul><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="50e8" class="lr jc ht nd b fv nh ni l nj nk">peer chaincode instantiate -o orderer.example.com:7050 --tls $CORE_PEER_TLS_ENABLED --cafile $ORDERER_CA -C $CHANNEL_NAME -n mycc -v 1.0 -c '{"Args":["init","a","100","b","200"]}' <strong class="nd hu">-P "OR    ('Org1MSP.member','Org2MSP.member')"</strong> &gt;&amp;log.txt</span></pre><ul class=""><li id="2b20" class="mo mp ht kb b kc kx kg ky kk mq ko mr ks ms kw mt mu mv mw dt translated">查询对等0上当前值链代码。Query为对等体0创建一个单独的Docker容器来执行链代码</li><li id="cb02" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">通过调用对等0上分类帐状态中的链码来更改值</li><li id="1713" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">安装链码<em class="lq">..对等3上的/chain code/go/chain code _ example 02</em></li><li id="756a" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">查询对等体3上的当前值的链码。Query为peer 3创建一个单独的Docker容器来执行链代码</li></ul><p id="5c23" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">您可以遵循这个过程，并将日志信息打印到终端中。启动和配置后，您应该有Docker容器用于:</p><ul class=""><li id="2bb7" class="mo mp ht kb b kc kx kg ky kk mq ko mr ks ms kw mt mu mv mw dt translated">1名订购者</li><li id="d458" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">4名同行</li><li id="b8dd" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">3个链码执行者</li><li id="897a" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">4 CouchDb</li><li id="7837" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">1个CLI</li></ul><p id="d8ff" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">使用以下命令对此进行检查:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="473a" class="lr jc ht nd b fv nh ni l nj nk">docker ps</span></pre><p id="8f11" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">您可以在对等日志中看到链码输出。这里有一个例子:</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="ff13" class="lr jc ht nd b fv nh ni l nj nk">docker logs dev-peer1.org2.example.com-mycc-1.0</span><span id="43cf" class="lr jc ht nd b fv nl ni l nj nk">ex02 Invoke<br/>Query Response:{"Name":"a","Amount":"90"}</span></pre><p id="2a7e" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">完成后，不要忘记关闭网络(所有容器都将被停止和删除):</p><pre class="mg mh mi mj fq nc nd ne nf aw ng dt"><span id="46f7" class="lr jc ht nd b fv nh ni l nj nk">./network_setup.sh down</span></pre><h1 id="598c" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">结论</h1><p id="0f0a" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">我们在Docker容器中成功创建了区块链网络的所有必要组件，并正确配置了网络。我们还通过部署和操作一个示例链代码来演示网络的功能。</p><p id="6897" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">现在，我们有了在Hyperledger Fabric区块链上开发应用程序的基础:</p><ul class=""><li id="162f" class="mo mp ht kb b kc kx kg ky kk mq ko mr ks ms kw mt mu mv mw dt translated">在链码中加入更多的逻辑</li><li id="38d4" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">编写简单的web应用程序，将数据写入区块链，并从其中读取数据</li></ul><blockquote class="ld"><p id="b456" class="le lf ht bd lg lh nm nn no np nq kw ek translated">加入Coinmonks <a class="ae lc" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae lc" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae lc" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="lr jc ht bd jd ls nr lu jh lv ns lx jl kk nt lz jp ko nu mb jt ks nv md jx me dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="mo mp ht kb b kc kd kg kh kk nw ko nx ks ny kw mt mu mv mw dt translated"><a class="ae lc" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae lc" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae lc" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae lc" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="450c" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" href="https://coincodecap.com/pionex-dual-investment" rel="noopener ugc nofollow" target="_blank"> Pionex双重投资</a> | <a class="ae lc" href="https://coincodecap.com/advcash-review" rel="noopener ugc nofollow" target="_blank"> AdvCash审查</a> | <a class="ae lc" href="https://coincodecap.com/uphold-review" rel="noopener ugc nofollow" target="_blank">光宗耀祖审查</a></li><li id="4c48" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" href="https://coincodecap.com/best-cryptocurrency-apis" rel="noopener ugc nofollow" target="_blank">面向开发者的8个最佳加密货币API</a></li><li id="db49" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" href="https://coincodecap.com/uphold-card-review" rel="noopener ugc nofollow" target="_blank">维护卡审核</a> | <a class="ae lc" href="https://coincodecap.com/trust-wallet-vs-metamask" rel="noopener ugc nofollow" target="_blank">信任钱包vs MetaMask </a></li><li id="0843" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" href="https://coincodecap.com/earn-sign-up-bonus" rel="noopener ugc nofollow" target="_blank">赢取注册奖金——10大最佳加密平台</a></li><li id="f33b" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae lc" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated"><a class="ae lc" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">面向开发人员的最佳加密API</a></li><li id="b359" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">最佳<a class="ae lc" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="mo mp ht kb b kc mx kg my kk mz ko na ks nb kw mt mu mv mw dt translated">杠杆代币的终极指南</li></ul></div></div>    
</body>
</html>