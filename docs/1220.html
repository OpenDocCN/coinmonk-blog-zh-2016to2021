<html>
<head>
<title>SMOTE and ADASYN ( Handling Imbalanced Data Set )</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SMOTE和ADASYN(处理不平衡数据集)</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/smote-and-adasyn-handling-imbalanced-data-set-34f5223e167?source=collection_archive---------0-----------------------#2018-08-03">https://medium.com/coinmonks/smote-and-adasyn-handling-imbalanced-data-set-34f5223e167?source=collection_archive---------0-----------------------#2018-08-03</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="af4f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最近我在做一个项目，我的数据集完全不平衡。这是一个二元分类问题，0类和1类的比例是99:1。</p><blockquote class="jo"><p id="6cd1" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated">数据集不平衡会怎样？</p></blockquote><p id="96e8" class="pw-post-body-paragraph iq ir ht is b it jy iv iw ix jz iz ja jb ka jd je jf kb jh ji jj kc jl jm jn hm dt translated">如果数据集不平衡，模型就会有偏差。你可以这样想，如果你给模型的每一个可能的组合都输入0，那么它给你的每一组输入都是0。</p><blockquote class="jo"><p id="3c5c" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated">我们如何知道模型是否不平衡？</p></blockquote><ol class=""><li id="b7e3" class="kd ke ht is b it jy ix jz jb kf jf kg jj kh jn ki kj kk kl dt translated">我们检查相关分类值的计数。对于被视为平衡数据集的数据集，比率应为10:1。</li></ol><p id="f5a8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2.混淆矩阵:预测完成后，检查混淆矩阵。</p><p id="1fdb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">[[真阳性] [假阳性]</p><p id="a7e0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">[假阴性][真阴性]]</p><p id="a6ad" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果任何值变为0。你的模型有偏见，你的数据集不平衡</p><p id="2cc4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">3.这不是一个好主意，但我也检查了预测变量的数量，从测试数据测试模型中获得。如果计数为0或1，则认为您的模型有偏差。</p><blockquote class="jo"><p id="e69b" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated">处理不平衡数据集的方法:</p></blockquote><blockquote class="km kn ko"><p id="2037" class="iq ir kp is b it jy iv iw ix jz iz ja kq ka jd je kr kb jh ji ks kc jl jm jn hm dt translated"><strong class="is hu">欠采样:</strong>在这种方法中，我们基本上以这样一种方式缩减实际数据集，即相关类别的比率变为10:1。进行欠采样的一些方法是:</p></blockquote><p id="9e5b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">a.浓缩最近邻</p><p id="2192" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">b.片面选择</p><p id="2932" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">更多细节和算法请看列表:</p><div class="kt ku fm fo kv kw"><a href="https://github.com/scikit-learn-contrib/imbalanced-learn" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab ej"><div class="ky ab kz cl cj la"><h2 class="bd hu fv z el lb eo ep lc er et hs dt translated">sci kit-learn-contrib/不平衡学习</h2><div class="ld l"><h3 class="bd b fv z el lb eo ep lc er et ek translated">不平衡-学习- Python模块，使用各种技术执行欠采样和过采样。</h3></div><div class="le l"><p class="bd b gc z el lb eo ep lc er et ek translated">github.com</p></div></div><div class="lf l"><div class="lg l lh li lj lf lk ll kw"/></div></div></a></div><h2 id="08ca" class="lm ln ht bd lo lp lq lr ls lt lu lv lw jb lx ly lz jf ma mb mc jj md me mf mg dt translated">我个人的意见是不要用欠采样。</h2><h1 id="3ecf" class="mh ln ht bd lo mi mj mk ls ml mm mn lw mo mp mq lz mr ms mt mc mu mv mw mf mx dt translated">为什么？</h1><p id="27aa" class="pw-post-body-paragraph iq ir ht is b it my iv iw ix mz iz ja jb na jd je jf nb jh ji jj nc jl jm jn hm dt translated">原因是我们实际上减少了数据集，从而给模型提供了更少的数据。我给你举个例子，我们有一个10000个数据的数据集，只有100个数据点是1，而其他的都是0。现在，在执行欠采样后，我们基本上将数据集减少到1100个样本，其中1000个为0，100个为1。因此，我们去掉了近9000个样本，并将其输入到模型中。所以模型更容易出错。尽管不同的模型使用不同的方法进行欠采样，但最终结果是相同的，即数据集中的行数较少。</p><p id="830b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">注意:</strong>我只是在讨论不要说一个比另一个更好的可能性。这是我个人的看法。我们不打算在这里讨论。</p><p id="1e1a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2.<strong class="is hu"> <em class="kp">过采样:</em> </strong>这种方法使用合成数据生成来增加数据集中的样本数。</p><p id="481f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> <em class="kp">目标:</em> </strong> <em class="kp">增加少数类，以便通过基于现有的少数观察值创建合成观察值来使数据集变得平衡。</em></p><blockquote class="jo"><p id="1b62" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated"><strong class="ak">重击:</strong></p></blockquote><p id="4162" class="pw-post-body-paragraph iq ir ht is b it jy iv iw ix jz iz ja jb ka jd je jf kb jh ji jj kc jl jm jn hm dt translated">smote做的事情很简单。首先，它为类中的每个样本找到少数类中的n个最近邻。然后，它在邻居之间画一条线，并在线上生成随机点。</p><figure class="ne nf ng nh fq ni fe ff paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="fe ff nd"><img src="../Images/1210c67fd4171ef46fd45cbef772f3f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6UFpLFl59O9e3e38ffTXJQ.png"/></div></div><figcaption class="no np fg fe ff nq nr bd b be z ek">img url: <a class="ae ns" href="https://www.researchgate.net/publication/287601878/figure/fig1/AS:316826589384744@1452548753581/The-schematic-of-NRSBoundary-SMOTE-algorithm.png" rel="noopener ugc nofollow" target="_blank">https://www.researchgate.net/publication/287601878/figure/fig1/AS:316826589384744@1452548753581/The-schematic-of-NRSBoundary-SMOTE-algorithm.png</a></figcaption></figure><p id="7ab9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">看到上面的图像，所以它找到了样本点的5个最近的邻居。然后给每个人画一条线。然后在class == minority class的行上创建样本。</p><blockquote class="jo"><p id="1628" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated"><strong class="ak"><em class="nt"/></strong></p></blockquote><p id="bdcb" class="pw-post-body-paragraph iq ir ht is b it jy iv iw ix jz iz ja jb ka jd je jf kb jh ji jj kc jl jm jn hm dt translated">这是Smote的改进版本。它做的和SMOTE一样，只是有一点小的改进。创建这些样本后，它会在点上添加一个随机的小值，从而使其更加真实。换句话说，不是所有的样本都与亲本线性相关，而是它们有更多的方差，即它们有点分散。</p><blockquote class="jo"><p id="f9bf" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated">好吧！所以它的实现时间:所以首先我们必须做KNN，然后创建合成点。开个玩笑！SCIKIT-LEARN已经为它准备了一个包，那就是“不平衡学习”</p></blockquote><p id="3137" class="pw-post-body-paragraph iq ir ht is b it jy iv iw ix jz iz ja jb ka jd je jf kb jh ji jj kc jl jm jn hm dt translated">装置</p><pre class="ne nf ng nh fq nu nv nw nx aw ny dt"><span id="18dc" class="lm ln ht nv b fv nz oa l ob oc">pip install <strong class="nv hu">-</strong>U imbalanced<strong class="nv hu">-</strong>learn</span></pre><p id="3681" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">康达安装:</p><p id="238f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh od oe of nv b">conda install -c conda-forge imbalanced-learn</code></p><div class="kt ku fm fo kv kw"><a href="http://contrib.scikit-learn.org/imbalanced-learn/stable/install.html" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab ej"><div class="ky ab kz cl cj la"><h2 class="bd hu fv z el lb eo ep lc er et hs dt translated">安装和贡献-不平衡-学习0.3.0文档</h2><div class="ld l"><h3 class="bd b fv z el lb eo ep lc er et ek translated">编辑描述</h3></div><div class="le l"><p class="bd b gc z el lb eo ep lc er et ek translated">contrib.scikit-learn.org</p></div></div></div></a></div><pre class="ne nf ng nh fq nu nv nw nx aw ny dt"><span id="9844" class="lm ln ht nv b fv nz oa l ob oc">def <strong class="nv hu">makeOverSamplesSMOTE(</strong>X,y<strong class="nv hu">)</strong>:<br/> #input DataFrame<br/> #X →Independent Variable in DataFrame\<br/> #y →dependent Variable in Pandas DataFrame format<br/><strong class="nv hu"> from imblearn.over_sampling import SMOTE</strong><br/> sm = <strong class="nv hu">SMOTE()</strong><br/> X, y = sm.<strong class="nv hu">fit_sample</strong>(X, y)<br/><strong class="nv hu"> return</strong> X,y</span></pre><p id="dc31" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">注:</strong></p><p id="201f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">熊猫数据框架中的# X→自变量<br/># y→熊猫数据框架格式中的因变量</p><pre class="ne nf ng nh fq nu nv nw nx aw ny dt"><span id="5a44" class="lm ln ht nv b fv nz oa l ob oc">def <strong class="nv hu">makeOverSamplesADASYN(</strong>X,y<strong class="nv hu">)</strong>:<br/> #input DataFrame<br/> #X →Independent Variable in DataFrame\<br/> #y →dependent Variable in Pandas DataFrame format<br/> <strong class="nv hu">from imblearn.over_sampling import ADASYN </strong><br/> sm = <strong class="nv hu">ADASYN()</strong><br/> X, y = sm<strong class="nv hu">.fit_sample(X, y)</strong><br/> <strong class="nv hu">return</strong>(X,y)</span></pre><p id="c9b7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">注:</strong></p><p id="56bb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Pandas数据框架中的# X→自变量<br/># y→Pandas数据框架格式中的因变量</p></div><div class="ab cl og oh hb oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="hm hn ho hp hq"><p id="396d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">跟我来</p><div class="kt ku fm fo kv kw"><a href="https://dataneel.wordpress.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab ej"><div class="ky ab kz cl cj la"><h2 class="bd hu fv z el lb eo ep lc er et hs dt translated">面向所有人的数据科学</h2><div class="ld l"><h3 class="bd b fv z el lb eo ep lc er et ek translated">这篇文章是关于支持向量回归的。从事机器学习或数据科学的人非常熟悉…</h3></div><div class="le l"><p class="bd b gc z el lb eo ep lc er et ek translated">dataneel.wordpress.com</p></div></div><div class="lf l"><div class="on l lh li lj lf lk ll kw"/></div></div></a></div><blockquote class="jo"><p id="e9f7" class="jp jq ht bd jr js oo op oq or os jn ek translated">加入Coinmonks <a class="ae ns" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae ns" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae ns" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="lm ln ht bd lo lp ot lr ls lt ou lv lw jb ov ly lz jf ow mb mc jj ox me mf mg dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="kd ke ht is b it my ix mz jb oy jf oz jj pa jn pb kj kk kl dt translated"><a class="ae ns" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae ns" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="14e6" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated"><a class="ae ns" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae ns" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated"><a class="ae ns" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae ns" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="ed57" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated"><a class="ae ns" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">加密交换</a> | <a class="ae ns" rel="noopener" href="/coinmonks/buy-bitcoin-in-india-feb50ddfef94">印度的加密应用</a></li><li id="47a8" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated">面向开发者的最佳加密API</li><li id="c9bf" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated">最佳<a class="ae ns" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated"><a class="ae ns" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币的终极指南</a></li><li id="4a2a" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated"><a class="ae ns" href="https://coincodecap.com/koinly-review" rel="noopener ugc nofollow" target="_blank">ko only回顾</a> | <a class="ae ns" href="https://coincodecap.com/binaryx-review" rel="noopener ugc nofollow" target="_blank"> Binaryx回顾</a>|<a class="ae ns" href="https://coincodecap.com/hodlnaut-vs-cakedefi-vs-celsius" rel="noopener ugc nofollow" target="_blank">Hodlnaut vs CakeDefi</a></li><li id="fbed" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated"><a class="ae ns" href="https://coincodecap.com/best-telegram-channels" rel="noopener ugc nofollow" target="_blank"> 40个最佳电报频道</a> | <a class="ae ns" href="https://coincodecap.com/1xbit-review" rel="noopener ugc nofollow" target="_blank"> 1xBit回顾</a> | <a class="ae ns" href="https://coincodecap.com/keevo-wallet-review" rel="noopener ugc nofollow" target="_blank"> Keevo钱包回顾</a></li><li id="5d2a" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated"><a class="ae ns" href="https://coincodecap.com/buy-ethereum-in-india" rel="noopener ugc nofollow" target="_blank">如何在印度购买以太坊？</a> | <a class="ae ns" href="https://coincodecap.com/buy-bitcoin-binance" rel="noopener ugc nofollow" target="_blank">如何在币安购买比特币</a></li><li id="6245" class="kd ke ht is b it pc ix pd jb pe jf pf jj pg jn pb kj kk kl dt translated"><a class="ae ns" href="https://coincodecap.com/use-bitmex-in-usa" rel="noopener ugc nofollow" target="_blank">在美国如何使用BitMEX？</a> | <a class="ae ns" href="https://coincodecap.com/bitmex-review" rel="noopener ugc nofollow" target="_blank"> BitMEX回顾</a> | <a class="ae ns" href="https://coincodecap.com/buy-solana" rel="noopener ugc nofollow" target="_blank">买入索拉纳</a></li></ul></div></div>    
</body>
</html>