# 如何运行一个完整的比特币节点

> 原文：<https://medium.com/coinmonks/how-to-run-a-full-bitcoin-node-1a69c92ec518?source=collection_archive---------0----------------------->

![](img/329e80aa6ac1ad6301726174a4c36e75.png)

由于经常有人质疑“虽然余额上有资产”却无法发送支付，我们决定描述一下比特币网络(以及类似的**莱特币**、**破折号**、 **Dogecoin** 等)的运行原理。)以明确的方式。即使您已经对“它是如何工作的”有了一个概念，我们也强烈建议您阅读这篇文章并“刷新”您的知识。也许你会为自己学习一些新的东西或者“整理”你已经知道的东西。

首先，一些数学(简化)……如果你取(生成)一个非常大的数(姑且称之为“私钥”)，然后，使用某种(众所周知的)算法，你可以找到与之对应的一个非常大的数(“公钥”)。没有反向算法。你不能从公钥得到私钥！私钥必须总是只有所有者知道。公钥与每个人共享。这对数字的奇特之处在于，如果消息(数据集)是用私钥“签名”(计算签名)的，那么这个签名就很容易被验证。通过单个公钥。它证明该消息是由该密钥对的所有者创建的。比特币地址(简体)是公钥。

**要点:作为地址的所有者，您可以“代表地址”签署消息。**

当你在 app 中创建新地址的时候，实际上是为你生成了一个私钥，公钥和地址都是从中生成的。你不太可能(几乎不可能)碰到一对以前已经发给过别人的钥匙。删除应用程序或损坏其文件通常会导致私钥丢失，这意味着位于该地址的资产会丢失。

像任何网络一样，比特币区块链网络由运行特殊软件的互联设备组成。每个这样的设备(区块链网络的一部分)通常被称为“节点”。所有节点的权利都是平等的。非常强大的节点可以“挖矿”(见下文)。

每个节点存储一份网络数据库(分类帐)的副本。分类账由分录组成。您只能向此分类帐添加新分录。您不能编辑或删除现有记录。每个条目都是关于从一个地址向另一个地址“发送”和/或“接收”资产的数据。

**要点:总账不存储地址余额。分类账存储所有存款(“输出”)和所有借方(“输入”)地址。**

*例如:* *地址 A:收到 X1，收到 X2，发送 Y1，收到 X3，发送 Y2..*

**要点:当前地址余额是所有输出的和减去所有输入的和(见上图)。**

*例如* **:** *x 来到地址 A(一直)，y 离开。这意味着地址余额等于 X—y。*

当您发送资产时，应用程序会生成一条消息—“交易”，其中包含格式为“地址，输出”的提取(支出)输出和格式为“地址，金额”的接收输入。
请注意，交易金额不得大于或等于已收金额。取款和存款之间的差额被称为“交易费”，它归“矿工”所有(见下文)。理论上，您可以创建一个 fee = 0 的事务，这不会是一个错误。如果交易费用高于期望的金额，则通过在输入列表中添加一个条目来收回未用完的(“变化”)。事务有一个大小。列表中的项目越多，意味着数据越多，交易时间越长。

*例如:地址 A:出口 X1 为总和“1”，出口 X2 为总和“2”。余额 A = 1 + 2 = 3。您需要将总和“2”转移到地址 b。输出 X1 是不够的，我们需要输出 X2 的总和。*

*最初，事务看起来是这样的:输出:“地址 A，X2 ”,输入:“地址 B，2”。借记“2”，贷记“2”。该交易的费用为" 0 "。矿工们不太可能欣赏这一点。我们再加一个费=“0.001”。输出 X2 被完全使用，所以我们使用另一个输出 X1。*

*最初，事务看起来是这样的:输出:“地址 A，X2 ”,输入:“地址 B，2”。借记“3”，贷记“2”。该交易的费用为" 1 "。这是多余的。让我们返回 change = " 1–0.001 " = " 0.999 "。*

*最初，事务看起来是这样的:输出:“地址 A，X2 ”,输入:“地址 B，2”。借记“3”，贷记“2”。该交易的费用为“0.001”。现在没事了！请注意，虽然存入的金额是“2.999”，但它包括了我们的“0.999”零钱，这些零钱将被返还给我们，实际上不会被花掉。*

**要点:交易花费整个产出。你可以不花掉一部分产出，但是你可以通过改变把“超支”的部分退回来。**

**要点:您不能创建多于输出的事务。最大值:一个输出=一个事务。但是你可以有一个输出=多个输入(接收者)。**

**要点:解决方案是资产的任何转移(到达)，包括变更。**

用“私钥”生成和签名的事务可以通过任何节点发送。该节点检查签名是否有效、格式是否正确以及输出是否可用。然后，事务被放入“mempool”中，mempool 是存储新的(未处理的)事务的地方。位于 mempool 中的事务对所有节点都是可见的。从这一点开始，该交易中使用的所有输出都被视为已使用或“失效”,并且**不能用于其他交易**。

向分类账增加新的分录一次几千个一批地发生。块由节点组成——“矿工”。块有大小限制。您不能创建大于最大大小的块。来自 mempool 的几个(几千个)事务被组合成一个单元，然后开始“挖掘”。挖掘是使用匹配方法搜索特定的块散列。第一个“挖掘”该块的节点将其交给其他节点进行验证。每个节点将块条目与其分类帐中以前的条目进行比较。它们不应该冲突。如果该块通过验证，它将被完全添加到该节点的分类帐中。每个节点只使用自己的分类帐。

**要点:每个节点独立工作，有自己的账本。**

如果某个数据块在某些节点上不被接受，那么分类账或“区块链的单独版本”中就会有一些差异。在这种情况下，节点是同步的，最常见的版本“胜出”。由于不同步的可能性，为了确保该块和其中的所有交易都包含在区块链的正确版本中，最终确认**需要在当前块**之后的几个块

**要点:交易在其区块后出现新区块时确认。**

**要点:您只能使用已确认交易的输出。**

对于正确的区块，采矿者接收固定费用，加上该区块中所有交易的所有费用的总和。有道理，最赚钱的方式就是以最大的手续费形成大宗交易，这样回报会更大。但是你也需要记住:块大小是固定的，所以你也需要看事务长度。事实上，包含“密度费”(每单位信息的费用)较高的交易是最有利可图的。这个指示器被称为**“sat/B”**(每字节 Satoshi)。等于“Satoshi 中的费用”除以“交易时长”。

**要点:没有人知道矿工如何从内存池中选择事务。没有办法强迫矿工选择你的交易。但对矿商来说，主要进行 sat/B 分数较高的交易更有利可图。**

**要点:如果您希望您的交易更快进入区块(即被确认)，请设置一个费用，使您的交易的 sat/B 分数高于 mempool 的平均分数。**

如果每个人都同时希望他们的交易进行得更快(例如，因为价值的大幅上升)，那么每个人都会增加 sat/b 值。这意味着它可能因网络负载而异。**这是一个在速度和交易费用之间的艰难选择。**

# **最好的例子**

*   你有地址 a。上面没有出口。它的余额= 0 BTC。
*   1 BTC 被发送到您的地址 A(这意味着这笔款项的交易已被确认)。现在，每 1 BTC 就有一个产出，余额= 1 BTC。
*   0.2 BTC 被发送到您的地址 a。现在它有输出:1 BTC 和 0.2 BTC。它的余额= 1.2 BTC。
*   你从地址 A 向地址 B 转了 0.3 BTC。简单来说，费用= 0。
*   可以理解，0.2 BTC 的输出是不够的，所以我们用 1 BTC。
*   这意味着交易将有“1 BTC”的输出和“地址 B，0.3 BTC”，“地址 A(未用)，0.7 BTC”的输入。
*   在发送并将其放入 mempool 后，只有一个到 0.2 BTC 的输出会留在您的地址上，因为到 1 BTC 的输出刚刚在事务中使用(耗尽)。**从现在开始，你的地址的“可用”余额= 0.2 BTC。**
*   未用完的 0.7 英镑将在交易确认后返还。**这意味着这笔款项不能使用**。
*   理论上你有 0.2 + 0.7 = 0.9 的 BTC，但实际上**你不能用这些 0.7 的 BTC** 。
*   这意味着您将无法在发送后立即转账，即使是 0.20000001 BTC。
*   您的 0.7 BTC 将在您的交易确认之前被**“冻结”。**

# ****一般结论****

****如何让一切“像钟表一样运转”而不出问题？****

*   **有更多的输出。这意味着你应该发送多个交易到你的地址，或者有更多的地址。**
*   **使用较少的输出。这意味着您应该进行更少的交易，但是在单个交易中有更多的接收者。**
*   **采取行动让你的交易更快。换句话说，设置一个费用，使 sat/B 指标在 mempool 中具有竞争力。**

**NOWNodes —资源管理器和节点 API。**

**访问[我们的网站](http://nownodes.io/)并在 1 天内访问您的节点。**

> **[直接在您的收件箱中获得最佳软件交易](https://coincodecap.com/?utm_source=coinmonks)**

**[![](img/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png)](https://coincodecap.com/?utm_source=coinmonks)**