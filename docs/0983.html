<html>
<head>
<title>How to Build Your Own Weather Station Using a Raspberry Pi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Raspberry Pi建立自己的气象站</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-build-your-own-weather-station-using-a-raspberry-pi-9cb3aab0470a?source=collection_archive---------6-----------------------#2018-07-09">https://medium.com/coinmonks/how-to-build-your-own-weather-station-using-a-raspberry-pi-9cb3aab0470a?source=collection_archive---------6-----------------------#2018-07-09</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/4a30320e6379e017e5634b4e6987fe6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xd5roxYoOb_w4paw.png"/></div></div></figure><p id="f265" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在本教程中，我们将介绍如何使用raspberry pi创建气象站并将事件发送到Wia。</p><p id="f5b9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这是我们旧教程的更新版本。自从我们上一个教程以来，Wia仪表板和代码有了一些变化。</p><h1 id="c00f" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">你需要什么</h1><ul class=""><li id="06fd" class="kx ky ht jd b je kz ji la jm lb jq lc ju ld jy le lf lg lh dt translated">树莓Pi 2或型号3 B+</li><li id="9a89" class="kx ky ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">树莓派感官帽</li><li id="af3a" class="kx ky ht jd b je li ji lj jm lk jq ll ju lm jy le lf lg lh dt translated">Node.js和NPM都必须安装在raspberry pi上。</li></ul><p id="5e23" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果您还没有安装它，<a class="ae ln" href="https://community.wia.io/d/4-how-to-install-node-js-on-any-raspberry-pi" rel="noopener ugc nofollow" target="_blank">在这里学习如何安装node.js】。</a></p><h1 id="add1" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">设置树莓Pi</h1><p id="ff97" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">首先，你必须设置树莓派。我们的教程将带你完成它！务必仔细遵循每一步。准备好之后，运行<code class="eh lr ls lt lu b">ssh pi@('RASPBERRY-PI-IP-ADDRESS')</code>。这将允许您通过计算机开始在raspberry pi终端中工作。</p><h1 id="68ae" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">设置Wia Node.js SDK</h1><p id="fcf8" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">首先，我们需要在raspberry pi上创建一个文件夹来存储我们的文件。创建一个名为<code class="eh lr ls lt lu b">wia-wether-device</code>的新文件夹。</p><p id="17f5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">接下来，通过使用命令行<code class="eh lr ls lt lu b">npm init</code>创建packackge.json文件来初始化这个包。对于每个提示，点击<code class="eh lr ls lt lu b">enter</code>，现在它们并不重要。</p><p id="03d3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">一旦您完成了这些，您就可以将Wia SDK安装到raspberry pi上了。使用命令行<code class="eh lr ls lt lu b">npm install --save wia</code>安装Wia SDK。</p><h1 id="bd92" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">对Node.js使用Sense HAT</h1><p id="1df0" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">接下来，我们必须安装nodeimu，以便我们可以使用传感器。使用命令<code class="eh lr ls lt lu b">npm install --save nodeimu</code>。</p><p id="852c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，您的package.json文件应该如下所示:</p><figure class="lw lx ly lz fq iu fe ff paragraph-image"><div class="fe ff lv"><img src="../Images/8c1a29c00df22b13296ca49afab6dc42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/0*d3O2Xuxe8wuKncQX.png"/></div></figure><h1 id="a9d7" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">创建您的天气设备</h1><p id="ede8" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">转到<a class="ae ln" href="https://dashboard.wia.io/" rel="noopener ugc nofollow" target="_blank"> Wia仪表板</a>并选择<code class="eh lr ls lt lu b">Create a New Space</code>然后选择<code class="eh lr ls lt lu b">Devices</code>。添加一个设备并给它命名。现在，在您的设备的<code class="eh lr ls lt lu b">Configuration</code>选项卡中，您会找到应该以<code class="eh lr ls lt lu b">d_sk</code>开头的<code class="eh lr ls lt lu b">device_secret_key</code>。这在以后会很重要。</p><h1 id="1b76" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">代码</h1><p id="df07" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">创建一个名为<code class="eh lr ls lt lu b">index.js</code>的文件。然后，从下面的例子中复制代码并粘贴到<code class="eh lr ls lt lu b">index.js</code>文件中。</p><p id="4e96" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">用您设备的密钥替换<code class="eh lr ls lt lu b">device_secret_key</code>。</p><pre class="lw lx ly lz fq ma lu mb mc aw md dt"><span id="0da2" class="me ka ht lu b fv mf mg l mh mi">'use strict';<br/><strong class="lu hu">var</strong> wia = require('wia')('device-secret-key');<br/><strong class="lu hu">var</strong> util = require('util')<br/><strong class="lu hu">var</strong> nodeimu  = require('nodeimu');<br/><strong class="lu hu">var</strong> IMU = <strong class="lu hu">new</strong> nodeimu.IMU();<br/><strong class="lu hu">var</strong> tic = <strong class="lu hu">new</strong> Date();<br/><strong class="lu hu">var</strong> callback = <strong class="lu hu">function</strong> (error, data) {<br/> <strong class="lu hu">var</strong> toc = <strong class="lu hu">new</strong> Date();<br/> <strong class="lu hu">if</strong> (error) {<br/>   console.log(error);<br/>   <strong class="lu hu">return</strong>;<br/> }<br/> // Send temperature data<br/> wia.events.publish({<br/>   name: "temperature",<br/>   data: data.temperature.toFixed(4) // data received from temperature sensor<br/> });<br/> // Send pressure data<br/> wia.events.publish({<br/>   name: "pressure",<br/>   data: data.pressure.toFixed(4) // data received from pressure sensor<br/> });<br/> // Send humidity data<br/> wia.events.publish({<br/>   name: "humidity",<br/>   data: data.humidity.toFixed(4) // data received from humidity sensor<br/> });<br/> setTimeout(<strong class="lu hu">function</strong>() { tic = <strong class="lu hu">new</strong> Date(); IMU.getValue(callback); } , 250 - (toc - tic));<br/>}<br/>// Using the MQTT stream<br/>wia.stream.on('connect', <strong class="lu hu">function</strong>() {<br/> IMU.getValue(callback);<br/>});<br/>wia.stream.connect();</span></pre><p id="8ec8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">要测试您的程序，现在运行<code class="eh lr ls lt lu b">node index.js</code> <br/>，您应该会看到事件出现在Wia仪表板中您的设备的<code class="eh lr ls lt lu b">Events</code>选项卡中。</p><h1 id="f34c" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">该应用程序</h1><p id="a832" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">接下来，我们将通过Wia制作一些小部件来呈现气象站收集的数据。登录Wia仪表板，导航到您的设备。选择<code class="eh lr ls lt lu b">widgets</code>选项卡并创建一个新的小部件。命名为<code class="eh lr ls lt lu b">Humidity</code>。对于<code class="eh lr ls lt lu b">event</code>框，键入湿度，就像它出现在您之前复制和粘贴的node.js代码中一样。选择<code class="eh lr ls lt lu b">done</code>，你会看到最新的更新！按照以下温度和压力步骤完成气象站项目。</p><figure class="lw lx ly lz fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mj"><img src="../Images/66e4fe42c141611c93ece41e42675b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*74_3sGshE_eHiUfK.png"/></div></div></figure><h1 id="ae96" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">网页</h1><p id="4b84" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">接下来，我们将创建一个网页并将其托管在GitHub上，这样我们就可以随时从我们的气象站查看天气了！</p><p id="b6db" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果您还没有github帐户，<a class="ae ln" href="https://github.com/" rel="noopener ugc nofollow" target="_blank">您可以在这里</a>创建一个。</p><p id="8a9b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">设置好github后，创建一个新的存储库，并将其命名为your-username.github.io。</p><p id="fd8e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，导航到您的新存储库并创建一个新文件。它<strong class="jd hu">必须</strong>命名为<code class="eh lr ls lt lu b">index.html</code>。复制并粘贴以下代码块:</p><pre class="lw lx ly lz fq ma lu mb mc aw md dt"><span id="76c2" class="me ka ht lu b fv mf mg l mh mi">&lt;!DOCTYPE html&gt;<br/>&lt;<strong class="lu hu">html</strong>&gt;<br/>  &lt;<strong class="lu hu">head</strong>&gt;<br/>    &lt;<strong class="lu hu">meta</strong> charset="UTF-8"&gt;<br/>  &lt;/<strong class="lu hu">head</strong>&gt;<br/>  &lt;<strong class="lu hu">body</strong>&gt;</span><span id="876b" class="me ka ht lu b fv mk mg l mh mi">    &lt;<strong class="lu hu">h1</strong>&gt;Wia Weather Station&lt;/<strong class="lu hu">h1</strong>&gt;</span><span id="5b99" class="me ka ht lu b fv mk mg l mh mi">  &lt;/<strong class="lu hu">body</strong>&gt;<br/>&lt;/<strong class="lu hu">html</strong>&gt;</span></pre><p id="9b2b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">到目前为止，我们的网页是相当空白的。导航回您的Wia仪表板。在设备的概览中，您可以看到您的widgets。在小部件的右上角，应该有一个带箭头的框。单击该框。应该会弹出这样的屏幕。</p><figure class="lw lx ly lz fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ml"><img src="../Images/52713170fe31a2a6e1ba4e2c93a41d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-r88Nvc9UVCSxus3.png"/></div></div></figure><p id="d9a5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">更改设置，以便<code class="eh lr ls lt lu b">Anyone can view this widget and embed it in any website</code>。您还应该看到<code class="eh lr ls lt lu b">Embed</code>代码，它将以&lt; iframe &gt;开始，以&lt; /iframe &gt;结束。复制整个代码并粘贴在&lt; h1 &gt; Wia气象站&lt; /h1 &gt;线下方和&lt; /body &gt;线上方。您的完整代码应该如下所示:</p><pre class="lw lx ly lz fq ma lu mb mc aw md dt"><span id="30de" class="me ka ht lu b fv mf mg l mh mi">&lt;!DOCTYPE html&gt;<br/>&lt;<strong class="lu hu">html</strong>&gt;<br/>  &lt;<strong class="lu hu">head</strong>&gt;<br/>    &lt;<strong class="lu hu">meta</strong> charset="UTF-8"&gt;<br/>  &lt;/<strong class="lu hu">head</strong>&gt;<br/>  &lt;<strong class="lu hu">body</strong>&gt;</span><span id="9709" class="me ka ht lu b fv mk mg l mh mi">    &lt;<strong class="lu hu">h1</strong>&gt;Wia Weather Station&lt;/<strong class="lu hu">h1</strong>&gt;</span><span id="47a7" class="me ka ht lu b fv mk mg l mh mi">    &lt;<strong class="lu hu">iframe</strong>&gt; YOUR WIDGET &lt;/<strong class="lu hu">iframe</strong>&gt;<br/></span><span id="fa2d" class="me ka ht lu b fv mk mg l mh mi">  &lt;/<strong class="lu hu">body</strong>&gt;<br/>&lt;/<strong class="lu hu">html</strong>&gt;</span></pre><p id="a596" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">对每个小部件重复此操作。</p><p id="3835" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">单击提交更改。现在，访问你在https://github.com/username/username.github.io的网站</p><p id="a500" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，您应该可以在自己的网页上看到来自您的树莓派的天气了！</p></div></div>    
</body>
</html>