<html>
<head>
<title>Ethereum Tutorial: Sending Transaction via NodeJS Backend</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊教程:通过NodeJS后端发送事务</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethereum-tutorial-sending-transaction-via-nodejs-backend-7b623b885707?source=collection_archive---------1-----------------------#2018-06-07">https://medium.com/coinmonks/ethereum-tutorial-sending-transaction-via-nodejs-backend-7b623b885707?source=collection_archive---------1-----------------------#2018-06-07</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/ab206e32f2cfd37b24bef61bdef4123d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*wdtKY7_FJxRC2CvjhTjneA.png"/></div></figure><p id="fc81" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jv">注:在本教程中，我使用的是web3js 1.0版本</em></p><p id="2278" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">大家好，我将解释如何从NodeJS后端发送事务。我将使用Rinkeby testnet并创建一个路由器，还将添加一些节点模块并使用Infura HTTP provider来完成教程</p><p id="3444" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们需要web3js、express和ethereumjs-tx模块来执行事务。在那之后，你需要通过注册Infura从<a class="ae jw" href="https://infura.io" rel="noopener ugc nofollow" target="_blank"> Infura </a>获得你自己的API密匙。</p><blockquote class="jx"><p id="7eb1" class="jy jz ht bd ka kb kc kd ke kf kg ju ek translated"><a class="ae jw" href="https://coincodecap.com/category/blockchain-node-and-api" rel="noopener ugc nofollow" target="_blank">发现并回顾以太坊开发工具</a></p></blockquote><p id="6658" class="pw-post-body-paragraph ix iy ht iz b ja kh jc jd je ki jg jh ji kj jk jl jm kk jo jp jq kl js jt ju hm dt translated"><strong class="iz hu">开始</strong></p><p id="8738" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">首先，您需要为这个项目创建一个空文件夹，以便于访问它。创建文件夹后，您需要在该文件夹中打开一个命令shell。我假设您的计算机上安装了npm。npm是由nodejs发布的，所以如果你安装了nodejs，你就会得到npm。如果您没有npm下载节点，请从<a class="ae jw" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">这个站点</a>下载。安装npm后，您需要调用。</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="ae21" class="kv kw ht kr b fv kx ky l kz la">npm init</span></pre><figure class="km kn ko kp fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="fe ff lb"><img src="../Images/6c359714b1adc699785b251cc372e073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EYNhUoVfFMs50iCB2NOCfA.png"/></div></div><figcaption class="lg lh fg fe ff li lj bd b be z ek">PowerShell window after finishing th npm init process</figcaption></figure><p id="d5d1" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果要保留默认设置，包括默认名称(即文件夹名称)，可以通过单击enter跳过所有行。在这个过程的最后，您将得到一个package.json文件。</p><p id="4fad" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">启动项目后，在文件夹中你需要创建一个js文件，它的名字是你想要的，这将是我们的后端</p><p id="4158" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">获取模块</strong></p><p id="1ae3" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在我的代码中，你可以看到有模块需求，我们只是通过npm下载将它们包含到项目中。他们的国家预防机制呼吁是:</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="5b4d" class="kv kw ht kr b fv kx ky l kz la">npm install web3 --save</span><span id="78d0" class="kv kw ht kr b fv lk ky l kz la">npm install express --save</span><span id="ec12" class="kv kw ht kr b fv lk ky l kz la">npm install ethereumjs-tx --save</span></pre><p id="a87a" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">您需要从命令行单独调用这几行来将它们安装到项目中。当您完成安装过程时，您可以看到有一个名为node modules的文件夹，这是您的模块下载的文件夹。</p><p id="ad99" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> INFURA </strong></p><p id="e393" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">当你下载完模块后。您需要一个infura api密钥。Api键是完成本教程的关键部分。唱到<a class="ae jw" href="https://infura.io" rel="noopener ugc nofollow" target="_blank"> Infura就能得到。</a>当您获得infura api密钥时，您需要用您的api密钥更改第7行(YOUR_API_KEY)。</p><p id="6e68" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">顺便说一下，infura是非常好的提供商。您还可以联系到ipfs，这是一家区块链的存储提供商，提供infura api。你可以从他们的网站上获得更多关于IPF的信息</p><p id="2127" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">通过获得infura api密钥，我们完成了代码的预请求。我们可以开始编码了。从现在开始，我将逐行解释代码。</p><p id="86d6" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在前3行，我将模块添加到js文件中。</p><ul class=""><li id="508a" class="ll lm ht iz b ja jb je jf ji ln jm lo jq lp ju lq lr ls lt dt translated">web3是将与以太坊交互的模块。</li><li id="900a" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated">创建路由器需要Express。</li><li id="13a2" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated">创建事务需要ethereumjs-tx</li></ul><p id="6cdd" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在第5行，我使用express模块创建了我的应用程序。</p><p id="09d2" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">创建应用程序后，我们需要编写文件的最后一行</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="6448" class="kv kw ht kr b fv kx ky l kz la">app.listen(3000, () =&gt; console.log('Example app listening on port 3000!'))</span></pre><p id="2a3c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在第8行，我用httpprovider创建了web3js对象，它位于nodejs后端。如果你在阅读本教程之前搜索了以太坊后端，你可以看到它们中的许多是由reactjs编码的，并且它们使用元掩码作为提供者。NodeJS后端无法访问浏览器材质，因此NodeJS后端无法使用元掩码作为提供者，所以我为它做了一个变通方法，使用infura作为提供者。</p><p id="93a5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在web3的一些函数中，你需要web3的websocket provider，所以你需要在需要的时候用这行代码替换第8行。</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="3a9d" class="kv kw ht kr b fv kx ky l kz la">web3js = new web3(new web3.providers.WebsocketProvider('wss://mainnet.infura.io/_ws'));</span></pre><p id="f217" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在第10行，我创建了我的路由器，这是一个get，但它需要进行逻辑post。我创建这个教程只是为了展示如何发送事务，所以这一点并不重要。</p><p id="d389" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在路由器内部，我需要我的rinkeby Ethereum地址(myAddress)、我将发送我的事务的地址(toAddress)、合同地址(Contract address)和合同abi(contractABI)。您可以通过以太坊钱包或以太扫描访问联系人的abi。我从以太坊钱包为这个教程部署我自己的合同，你不需要部署任何合同。您可以简单地使用现有的一个。</p><p id="a3b9" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我最不需要的就是我的私钥(private key)。这不是一个安全的方法，但由于我们在前端没有任何钱包(因为我们没有前端:)，我们在这一点上手动做事情。您无法从以太坊钱包中获取您的私人密钥，因此您需要将您的rinkeby以太坊帐户导入到<a class="ae jw" href="https://www.myetherwallet.com" rel="noopener ugc nofollow" target="_blank"> MyEtherWallet </a> like网站</p><p id="5844" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在路由器上定义变量后，我们创建原始事务，然后用我们的私钥对其签名。在签署交易后，我们通过web3js将它发送到rinkeby testnet。</p><p id="fd44" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">完成编码后，我们需要测试它。在同一个文件夹中，打开一个命令shell并启动后端。我的文件名是backend.js，所以我用代码开始它</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="1f16" class="kv kw ht kr b fv kx ky l kz la">node backend.js</span></pre><p id="6ccd" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这意味着您可以用代码启动您的后端</p><pre class="km kn ko kp fq kq kr ks kt aw ku dt"><span id="0b26" class="kv kw ht kr b fv kx ky l kz la">node &lt;filename with extension&gt;</span></pre><p id="1b6d" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">启动我们的后端后，你需要打开你的浏览器，你需要在地址栏写<a class="ae jw" href="http://localhost:3000/sendtx" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/sendtx</a></p><p id="8e0a" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">就是这样。我们为以太坊创建了我们的小后台。</p><figure class="km kn ko kp fq iu"><div class="bz el l di"><div class="lz ma l"/></div></figure><p id="997b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">感谢您阅读本教程。我不是本地人，所以语法可能有问题，抱歉给您带来不便。如果有任何问题或者你想问什么，你可以通过<a class="ae jw" href="https://twitter.com/AhmetSayarli" rel="noopener ugc nofollow" target="_blank">推特</a>联系我</p><blockquote class="jx"><p id="c7a3" class="jy jz ht bd ka kb kc kd ke kf kg ju ek translated">加入Coinmonks <a class="ae jw" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jw" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jw" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="kv kw ht bd mb mc md me mf mg mh mi mj ji mk ml mm jm mn mo mp jq mq mr ms mt dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="ll lm ht iz b ja mu je mv ji mw jm mx jq my ju lq lr ls lt dt translated"><a class="ae jw" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae jw" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated"><a class="ae jw" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae jw" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated"><a class="ae jw" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae jw" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="f33b" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated"><a class="ae jw" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae jw" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated">开发人员的最佳加密API</li><li id="b359" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated">最佳<a class="ae jw" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated">杠杆代币的终极指南</li><li id="3310" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated"><a class="ae jw" href="https://coincodecap.com/ascendex-staking" rel="noopener ugc nofollow" target="_blank">AscendEx Staking</a>|<a class="ae jw" href="https://coincodecap.com/bot-ocean-review" rel="noopener ugc nofollow" target="_blank">Bot Ocean Review</a>|<a class="ae jw" href="https://coincodecap.com/bitcoin-wallets-india" rel="noopener ugc nofollow" target="_blank">最佳比特币钱包</a></li><li id="15e5" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated"><a class="ae jw" href="https://coincodecap.com/bitget-review" rel="noopener ugc nofollow" target="_blank"> Bitget评论</a>|<a class="ae jw" href="https://coincodecap.com/gemini-vs-blockfi" rel="noopener ugc nofollow" target="_blank">Gemini vs BlockFi</a>|<a class="ae jw" href="https://coincodecap.com/okex-futures-trading" rel="noopener ugc nofollow" target="_blank">OKEx期货交易</a></li><li id="c009" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated"><a class="ae jw" href="https://coincodecap.com/crypto-trading-bots-in-the-us" rel="noopener ugc nofollow" target="_blank">美国最佳加密交易机器人</a> | <a class="ae jw" href="https://coincodecap.com/changelly-review" rel="noopener ugc nofollow" target="_blank">经常性评论</a></li><li id="7716" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated"><a class="ae jw" href="https://coincodecap.com/crypto-arbitrage-in-india" rel="noopener ugc nofollow" target="_blank">在印度利用加密套利赚取被动收入</a></li><li id="92d8" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated"><a class="ae jw" href="https://coincodecap.com/huobi-review" rel="noopener ugc nofollow" target="_blank">霍比评论</a> | <a class="ae jw" href="https://coincodecap.com/okex-margin-trading" rel="noopener ugc nofollow" target="_blank"> OKEx保证金交易</a> | <a class="ae jw" href="https://coincodecap.com/futures-trading" rel="noopener ugc nofollow" target="_blank">期货交易</a></li><li id="3bf5" class="ll lm ht iz b ja lu je lv ji lw jm lx jq ly ju lq lr ls lt dt translated"><a class="ae jw" href="https://coincodecap.com/sparrow-exchange-review" rel="noopener ugc nofollow" target="_blank">麻雀交换评论</a> | <a class="ae jw" href="https://coincodecap.com/nash-exchange-review" rel="noopener ugc nofollow" target="_blank">纳什交换评论</a></li></ul></div></div>    
</body>
</html>