<html>
<head>
<title>Solidity Fundamentals: Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">坚固性基础:功能</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/solidity-fundamentals-functions-a7e3d38c1fe5?source=collection_archive---------1-----------------------#2021-01-29">https://medium.com/coinmonks/solidity-fundamentals-functions-a7e3d38c1fe5?source=collection_archive---------1-----------------------#2021-01-29</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><h2 id="1136" class="hr hs ht bd b gc hu hv hw hx hy hz ek ia translated" aria-label="kicker paragraph">以太坊智能合约开发</h2><div class=""/><div class=""><h2 id="6360" class="pw-subtitle-paragraph iz ic ht bd b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ek translated">功能:第二部分</h2></div><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff jr"><img src="../Images/1395ca2b0dc2dc69f4f08dd31323f760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2KLI3_rd9mzYwpBOG2ccAw.jpeg"/></div></div></figure></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="2346" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">大家好！这一部分将是<strong class="km id">坚固性基础</strong>的最后一部分。我们将继续研究<strong class="km id">函数</strong>并检查以下主题:</p><ul class=""><li id="684d" class="lg lh ht km b kn ko kq kr kt li kx lj lb lk lf ll lm ln lo dt translated"><code class="eh lp lq lr ls b">receive</code>乙醚功能</li><li id="3a43" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><code class="eh lp lq lr ls b">fallback</code>功能</li><li id="51fb" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated">函数重载</li><li id="5c1e" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated">事件</li></ul></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="607c" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><code class="eh lp lq lr ls b"><strong class="km id">receive</strong></code> <strong class="km id">以太功能</strong></p><p id="b981" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><code class="eh lp lq lr ls b">receive</code>函数使用<code class="eh lp lq lr ls b">receive() external payable { … }</code>声明，没有<em class="ly">函数</em>关键字，不能有参数，不能返回任何东西，必须有<code class="eh lp lq lr ls b">external</code>可见性和<code class="eh lp lq lr ls b">payable</code>状态关键字。一个合同最多可以有一个<code class="eh lp lq lr ls b">receive</code>功能。通过使用<code class="eh lp lq lr ls b">send()</code>或<code class="eh lp lq lr ls b">transfer()</code>触发普通<em class="ly">以太网</em>传输。如果合同没有这个函数但有<code class="eh lp lq lr ls b">payable fallback</code>函数，这个<code class="eh lp lq lr ls b">fallback</code>函数将在普通<em class="ly">以太</em>传输中被调用。当<code class="eh lp lq lr ls b">receive</code>和<code class="eh lp lq lr ls b">fallback function</code>都不存在时，合同不能通过常规交易接收<em class="ly">醚</em>并抛出异常。</p><blockquote class="lz ma mb"><p id="8148" class="kk kl ly km b kn ko jd kp kq kr jg ks mc ku kv kw md ky kz la me lc ld le lf hm dt translated"><strong class="km id">警告:</strong>直接接收以太(没有函数调用，即使用<code class="eh lp lq lr ls b">send</code>或<code class="eh lp lq lr ls b">transfer</code>)但没有定义接收以太函数或应付回退函数的契约抛出异常，发送回以太(这在Solidity v0.4.0之前是不同的)。因此，如果您希望您的合同接收以太网，您必须实现一个接收以太网函数(不推荐使用payable fallback函数来接收以太网，因为它不会因为接口混乱而失败)。</p></blockquote><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="mf mg l"/></div></figure></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="7525" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><code class="eh lp lq lr ls b"><strong class="km id">fallback</strong></code>功能<strong class="km id">功能</strong></p><p id="6bf0" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">一个契约最多可以有一个回退函数，使用不带<em class="ly"> function关键字的<code class="eh lp lq lr ls b">fallback () external [payable]</code>声明。</em>它不能有参数，不能返回任何东西，必须有<code class="eh lp lq lr ls b">external</code>可见性。当下列情况发生时，它执行；</p><ul class=""><li id="3dd8" class="lg lh ht km b kn ko kq kr kt li kx lj lb lk lf ll lm ln lo dt translated">合同中不存在功能，</li><li id="ec16" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated">发送到合同的普通以太网没有提供任何<code class="eh lp lq lr ls b">msg.data</code>并且没有<code class="eh lp lq lr ls b">receive()</code>以太网功能。在这种情况下，<code class="eh lp lq lr ls b">fallback</code>功能也必须标记为<code class="eh lp lq lr ls b">payable</code>。</li></ul><blockquote class="lz ma mb"><p id="2f5c" class="kk kl ly km b kn ko jd kp kq kr jg ks mc ku kv kw md ky kz la me lc ld le lf hm dt translated"><strong class="km id">警告</strong>:如果<a class="ae mh" href="https://docs.soliditylang.org/en/v0.7.5/contracts.html#receive-ether-function" rel="noopener ugc nofollow" target="_blank">接收以太网功能</a>不存在，普通以太网传输也会执行<code class="eh lp lq lr ls b">payable</code>回退功能。如果您定义了一个可支付的回退功能来区分以太网传输和接口混淆，建议您始终定义一个接收以太网功能。</p></blockquote><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="mf mg l"/></div></figure></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="0f9f" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><strong class="km id">函数重载</strong></p><p id="df8f" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><em class="ly">重载</em>是一个契约有多个同名但参数类型不同的函数的过程。</p><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="mf mg l"/></div></figure><blockquote class="lz ma mb"><p id="8157" class="kk kl ly km b kn ko jd kp kq kr jg ks mc ku kv kw md ky kz la me lc ld le lf hm dt translated"><strong class="km id">警告:</strong>重载函数也存在于外部接口中。如果两个外部可见的函数在实体类型上不同，但在外部类型上没有区别，这是错误的。</p></blockquote><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="mf mg l"/></div></figure></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="a257" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><strong class="km id">事件</strong></p><p id="a497" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">Solidity <strong class="km id"> </strong>中的<strong class="km id"> <em class="ly">事件</em> </strong>与其他编程语言中的事件相同，通常用于借助EVM的日志功能告知调用应用程序合同的当前状态。当您调用它们时，它们会将参数存储在事务日志中，这是区块链中的一种特殊数据结构。日志有两部分保存参数:<strong class="km id"> <em class="ly">数据</em> </strong>和<strong class="km id"> <em class="ly">主题</em> </strong>。</p><p id="eaa9" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">实度事件参数有两种类型:<strong class="km id"> <em class="ly">索引</em> </strong>和<strong class="km id"> <em class="ly">不索引</em> </strong> <em class="ly">。</em>我们可以将多达三个参数标记为索引，这将它们添加到一个称为<strong class="km id"> <em class="ly">主题</em> </strong>的特殊数据结构中，该数据结构允许我们搜索事件，例如，为某些事件过滤一系列块，甚至通过发出事件的合同地址过滤事件。没有索引<strong class="km id">的所有参数都是日志的数据部分。</strong></p><blockquote class="lz ma mb"><p id="aa7e" class="kk kl ly km b kn ko jd kp kq kr jg ks mc ku kv kw md ky kz la me lc ld le lf hm dt translated"><strong class="km id">注意:</strong>事件签名的散列是<strong class="km id">主题</strong>之一，除非您用<code class="eh lp lq lr ls b">anonymous</code>说明符声明了事件。这意味着不能按名称过滤特定的匿名事件，只能按合同地址过滤。匿名事件的优点是部署和调用成本更低。</p></blockquote><p id="7531" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">我们可以使用事件并监听它们来更新我们的离线应用程序的状态，也可以作为一种更便宜的存储形式(稍后在 <strong class="km id"> <em class="ly">高级可靠性</em> </strong>中有更多<em class="ly">)。</em></p><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="mf mg l"/></div></figure><p id="bece" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><em class="ly">执行相关功能后，详见以下事件。</em></p><p id="6cc0" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><code class="eh lp lq lr ls b">EscrowPlanCreated</code>执行函数<code class="eh lp lq lr ls b">addEscrowPlan</code>时发出的事件。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff mi"><img src="../Images/a59269c37b271c9a2c8eab9d7884b625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*petAxMEQogP8-g1YY4Y-xQ.png"/></div></div></figure><p id="4d7b" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">执行<code class="eh lp lq lr ls b">depositEther</code>功能，发出<code class="eh lp lq lr ls b">EtherDeposited</code>。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff mj"><img src="../Images/5f11f08d069540280550fdfd11dacb71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r_8SpbluRn4jcc5WIWJ3TA.png"/></div></div></figure><p id="86bf" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">最终<code class="eh lp lq lr ls b">withdrawEther</code>导致发射事件<code class="eh lp lq lr ls b">EtherWithdrawed</code>。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff mk"><img src="../Images/8c79314da6092777ad9313b0624541a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Av_n1A9FPIpIhttbUtT73A.png"/></div></div></figure></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="61e0" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">恭喜你！这就是<strong class="km id">坚实基础</strong>的结束。感谢你和我一起踏上这段旅程。非常感谢。</p></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="3bd1" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><strong class="km id">参考文献</strong></p><div class="ml mm fm fo mn mo"><a href="https://docs.soliditylang.org/en/v0.7.5/contracts.html#functions" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab ej"><div class="mq ab mr cl cj ms"><h2 class="bd id fv z el mt eo ep mu er et ic dt translated">合同-可靠性0.7.5文件</h2><div class="mv l"><h3 class="bd b fv z el mt eo ep mu er et ek translated">编辑描述</h3></div><div class="mw l"><p class="bd b gc z el mt eo ep mu er et ek translated">docs.soliditylang.org</p></div></div></div></a></div><div class="ml mm fm fo mn mo"><a rel="noopener follow" target="_blank" href="/coinmonks/solidity-fundamentals-a71bf54c0b98"><div class="mp ab ej"><div class="mq ab mr cl cj ms"><h2 class="bd id fv z el mt eo ep mu er et ic dt translated">可靠性基础|数据位置和赋值行为</h2><div class="mv l"><h3 class="bd b fv z el mt eo ep mu er et ek translated">数据位置和分配行为</h3></div><div class="mw l"><p class="bd b gc z el mt eo ep mu er et ek translated">数据位置和分配Behaviormedium.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc kb mo"/></div></div></a></div><div class="ml mm fm fo mn mo"><a href="https://solidity-by-example.org/" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab ej"><div class="mq ab mr cl cj ms"><h2 class="bd id fv z el mt eo ep mu er et ic dt translated">以身作则</h2><div class="mv l"><h3 class="bd b fv z el mt eo ep mu er et ek translated">使用Solidity学习智能合约编程</h3></div><div class="mw l"><p class="bd b gc z el mt eo ep mu er et ek translated">solidity-by-example.org</p></div></div></div></a></div></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><h1 id="38cd" class="nd ne ht bd nf ng nh ni nj nk nl nm nn ji no jj np jl nq jm nr jo ns jp nt nu dt translated">所有部件正常</h1><ul class=""><li id="39f1" class="lg lh ht km b kn nv kq nw kt nx kx ny lb nz lf ll lm ln lo dt translated"><a class="ae mh" href="https://ferdikurt.medium.com/solidity-fundamentals-88ceb4873064" rel="noopener">合同的版式</a></li><li id="49fd" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><a class="ae mh" href="https://ferdikurt.medium.com/solidity-fundamentals-ca824a3ac023" rel="noopener">值类型:第一部分</a></li><li id="5b74" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><a class="ae mh" href="https://ferdikurt.medium.com/solidity-fundamentals-c94460e3be3d" rel="noopener">值类型:第二部分</a></li><li id="b275" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><a class="ae mh" rel="noopener" href="/coinmonks/solidity-fundamentals-1fb0e6b3b607">操作员</a></li><li id="900e" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><a class="ae mh" rel="noopener" href="/coinmonks/solidity-fundamentals-e4e4660e16c8">参考类型</a></li><li id="8ac9" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><a class="ae mh" rel="noopener" href="/coinmonks/solidity-fundamentals-a71bf54c0b98">数据位置和赋值行为</a></li><li id="570c" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><a class="ae mh" rel="noopener" href="/coinmonks/solidity-fundamentals-1dc2af4b453b">控制结构</a></li><li id="2227" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><a class="ae mh" rel="noopener" href="/coinmonks/solidity-fundamentals-a95bb6c8ba2a">错误处理:断言、要求、恢复和异常</a></li><li id="b344" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><a class="ae mh" rel="noopener" href="/coinmonks/solidity-fundamentals-d2216be1c2c3">功能:第一部分</a></li><li id="57d4" class="lg lh ht km b kn lt kq lu kt lv kx lw lb lx lf ll lm ln lo dt translated"><a class="ae mh" href="https://ferdikurt.medium.com/solidity-fundamentals-functions-a7e3d38c1fe5" rel="noopener">功能:第二部分</a></li></ul></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="4d92" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">随意问任何问题。</p><p id="124a" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">注意安全，做好工作，保持联系！</p><p id="93a6" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><a class="ae mh" href="https://www.linkedin.com/in/ferdi-kurt-8b910b164/" rel="noopener ugc nofollow" target="_blank">费尔迪科特</a></p></div></div>    
</body>
</html>