<html>
<head>
<title>Creating and Signing a SegWit Transaction from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始创建和签署SegWit事务</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/creating-and-signing-a-segwit-transaction-from-scratch-ec98577b526a?source=collection_archive---------2-----------------------#2021-10-05">https://medium.com/coinmonks/creating-and-signing-a-segwit-transaction-from-scratch-ec98577b526a?source=collection_archive---------2-----------------------#2021-10-05</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="dc89" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">逐步地</p><p id="1d8d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们之前<a class="ae jo" rel="noopener" href="/@ottosch/manually-creating-and-signing-a-bitcoin-transaction-87fbbfe46032">从头开始创建并签署了一个P2PKH交易</a>。这一次，我们将创建一个SegWit事务，包含来自以下地址的3个输入:</p><ul class=""><li id="24ab" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx dt translated"><a class="ae jo" href="https://mempool.space/testnet/address/mxFEHeSxxKjy9YcmFzXNpuE3FFJyby56jA" rel="noopener ugc nofollow" target="_blank"><strong class="is hu">mxfehesxxkjy 9 ycmfzxnpue 3 ffjyby 56 ja</strong></a>:P2PKH；</li><li id="624f" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated"><a class="ae jo" href="https://mempool.space/testnet/address/tb1qt9xzu0df95vsfal8eptzyruv4e00k4ty6d8zhh" rel="noopener ugc nofollow" target="_blank"><strong class="is hu">TB 1 Qt 9 xzu 0 df 95 vs fal 8 eptzyruv 4 e 00k 4 ty 6d 8 zhh</strong></a>:p 2 wpkh；</li><li id="7370" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated"><a class="ae jo" href="https://mempool.space/testnet/address/2N4yEhDwic9Tm4BRN9EP1hnSu9f6cWJrU31" rel="noopener ugc nofollow" target="_blank"><strong class="is hu">2n 4 yehdwic 9 TM 4 br n9 EP 1 hnsu 9 F6 cwjru 31</strong></a>:P2SH-p 2 wpkh；</li></ul><p id="564b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">一个遗产，一个SegWit和一个包装SegWit。是的，这使它变得更加复杂，但它将有助于理解事务序列化、签名过程以及如何组合legacy和SegWit输入中的差异。</p><p id="6551" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下表总结了我们的UTXOs:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="881e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">从总数16，091，satoshis中，我们将把除矿工费(2000 sats)之外的所有内容发送到地址<strong class="is hu">TB 1 qeds 7 u 3 tgpqkttxkzdwukaj 8 muqgf 5 nqq 6 w05 AK</strong>。这次我会尽量简洁，跳过一些细节。如果需要的话，我推荐阅读<a class="ae jo" rel="noopener" href="/@ottosch/manually-creating-and-signing-a-bitcoin-transaction-87fbbfe46032">之前的教程</a>以获得更详细的解释。</p><figure class="kd ke kf kg fq kh fe ff paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="fe ff kk"><img src="../Images/5dc5e4ce6e0a9af16a8e600d798576a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QqriR_3WyzzO1_sg0m_unA.jpeg"/></div></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">It seems I need a pointless image to get a header — sorry, n00b here</figcaption></figure></div><div class="ab cl kv kw hb kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hm hn ho hp hq"><h1 id="da4b" class="lc ld ht bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">1.生成私钥</h1><p id="4126" class="pw-post-body-paragraph iq ir ht is b it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn hm dt translated">让我们从生成PEM私钥开始:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="abff" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们现在有以下私钥文件:<code class="eh mf mg mh mi b">priv-legacy.pem</code>、<code class="eh mf mg mh mi b">priv-segwit.pem</code>和<code class="eh mf mg mh mi b">priv-wrapped.pem</code>。</p></div><div class="ab cl kv kw hb kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hm hn ho hp hq"><h1 id="1d15" class="lc ld ht bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">2.事务序列化</h1><p id="fc57" class="pw-post-body-paragraph iq ir ht is b it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn hm dt translated">如果一个事务至少有一个SegWit输入，本地的或包装的，那么它就是一个SegWit事务。此类事务的序列化不同于遗留事务。实际上，这有点复杂，因为我们有一种签名格式和一种完全不同的推送格式。<br/>而且，由于我们有一个遗留输入，并且这些输入是使用旧格式签名的，我们还必须构建一个遗留事务。因此，这一次我们将不得不进行3种不同的序列化:</p><ul class=""><li id="596d" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx dt translated">遗留序列化，对我们的遗留输入进行签名；</li><li id="c70d" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated">SegWit one，用于签署每个SegWit输入；</li><li id="fa19" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated">最后序列化，以推动交易；</li></ul><p id="e516" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们可以从任何输入开始。让我们先做传统的。</p></div><div class="ab cl kv kw hb kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hm hn ho hp hq"><h1 id="e2ca" class="lc ld ht bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">3.签署遗留输入</h1><p id="a0d5" class="pw-post-body-paragraph iq ir ht is b it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn hm dt translated">我们首先必须序列化事务，就像我们要推送遗留事务一样。在我们获得遗留输入的签名后，我们丢弃这个事务并处理SegWit输入。</p><p id="9960" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用版本2，有3个输入，我们从:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="363a" class="mn ld ht mi b fv mo mp l mq mr">02000000 03</span></pre><p id="20e6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后，对于遗留输入，我们得到<a class="ae jo" href="https://mempool.space/testnet/tx/d1a92ad68a031c5324981aa920152bd16975686905db41e3fc9d51c7ff4a20ed" rel="noopener ugc nofollow" target="_blank">先前的事务</a> n ID:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="f16f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">并且输出索引<code class="eh mf mg mh mi b">01000000</code>:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="36da" class="mn ld ht mi b fv mo mp l mq mr">ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d1 01000000</span></pre><p id="d742" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于scriptSig，我们添加上一个事务的scriptPubKey及其大小:<code class="eh mf mg mh mi b">19 76a914b780d54c6b03b053916333b50a213d566bbedd1388ac</code>。在添加了序列<code class="eh mf mg mh mi b">ffffffff</code>(没有RBF或locktime)之后，我们的第一个输入完成了:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="b50f" class="mn ld ht mi b fv mo mp l mq mr">ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d101000000<strong class="mi hu">1976a914b780d54c6b03b053916333b50a213d566bbedd1388acffffffff</strong></span></pre><p id="a83a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">其他输入是SegWit，但这不会改变任何东西，因为对于遗留签名，其他scriptSigs应该是空的。因此，对于本机SegWit输入，在收集了<a class="ae jo" href="https://mempool.space/testnet/tx/b7203bd59b3c26c65699251939e1e6353f5f09952156c5b9c01bbe9f5372b89c" rel="noopener ugc nofollow" target="_blank"> UTXO信息</a>之后，我们有:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="b6f8" class="mn ld ht mi b fv mo mp l mq mr">9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b7 01000000 00 ffffffff</span></pre><p id="e2fd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，对于<a class="ae jo" href="https://mempool.space/testnet/tx/04d984cdcf728975c173c45c49a242cedee2da5dc200b2f83ca6a98aecf11280" rel="noopener ugc nofollow" target="_blank">嵌套的SegWit UTXO </a>也是如此:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="5f79" class="mn ld ht mi b fv mo mp l mq mr">8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d904 01000000 00 ffffffff</span></pre><p id="c9dc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们与投入的交易变成:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="e8bb" class="mn ld ht mi b fv mo mp l mq mr">0200000003<strong class="mi hu">ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d1010000001976a914b780d54c6b03b053916333b50a213d566bbedd1388acffffffff9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b70100000000ffffffff8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d9040100000000ffffffff</strong></span></pre><p id="047f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于输出部分，我们有一个单一的输出，所以<code class="eh mf mg mh mi b">0x01</code>。我们正在传输16，089，269个satoshis，因此让我们使用Python的REPL来获得little-endian中的字节数:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="ee74" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将发送到地址<strong class="is hu">TB 1 qeds 7 u 3 tgpqkttxk zdwukaj 8 mu qgf 5 nqq 6 w 05 AK</strong>。P2WPKH的scriptPubKey是<code class="eh mf mg mh mi b">OP_0 &lt;pubkey hash&gt;</code>。在验证事务时，当节点在被花费的输出中发现该模式时，它们将其识别为P2WPKH，并添加与P2PKH相同的操作码，将其转换为<code class="eh mf mg mh mi b">OP_DUP OP_HASH160 &lt;pubkey hash&gt; OP_EQUALVERIFY OP_CHECKSIG</code>。</p><p id="4bef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用类似<a class="ae jo" href="https://bitcoin.sipa.be/bech32/demo/demo.html" rel="noopener ugc nofollow" target="_blank"> bech32 demo </a>或<a class="ae jo" href="https://slowli.github.io/bech32-buffer/" rel="noopener ugc nofollow" target="_blank"> bech32-buffer </a>的网络工具，解码地址以获得公钥哈希:<code class="eh mf mg mh mi b">cb61ee4568082cb59ac26bb96ec8fbe0109a4c00</code>。然后添加推送操作<code class="eh mf mg mh mi b">0x14</code>和scriptPubKey大小<code class="eh mf mg mh mi b">0x16 </code>，我们得到了输出:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="8b1f" class="mn ld ht mi b fv mo mp l mq mr">b580f50000000000 16 00 14 cb61ee4568082cb59ac26bb96ec8fbe0109a4c00</span></pre><p id="aa0e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在加上输出数量<code class="eh mf mg mh mi b">0x01</code>和输出本身之后，我们的事务变成:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="5ef7" class="mn ld ht mi b fv mo mp l mq mr">0200000003ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d1010000001976a914b780d54c6b03b053916333b50a213d566bbedd1388acffffffff9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b70100000000ffffffff8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d9040100000000ffffffff<strong class="mi hu">01b580f50000000000160014cb61ee4568082cb59ac26bb96ec8fbe0109a4c00</strong></span></pre><p id="b9bb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，添加locktime <code class="eh mf mg mh mi b">00000000</code>和sighash <code class="eh mf mg mh mi b">01000000</code>，我们就可以签名了。这是我们要签署的:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="8d36" class="mn ld ht mi b fv mo mp l mq mr">0200000003ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d1010000001976a914b780d54c6b03b053916333b50a213d566bbedd1388acffffffff9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b70100000000ffffffff8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d9040100000000ffffffff01b580f50000000000160014cb61ee4568082cb59ac26bb96ec8fbe0109a4c00<strong class="mi hu">0000000001000000</strong></span></pre><h2 id="f933" class="mn ld ht bd le ms mt mu li mv mw mx lm jb my mz lq jf na nb lu jj nc nd ly ne dt translated">3.1签名</h2><p id="25eb" class="pw-post-body-paragraph iq ir ht is b it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn hm dt translated">让我们<code class="eh mf mg mh mi b">hash256</code>交易并签字:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="0762" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">签名的细节我就不赘述了。请参考<a class="ae jo" rel="noopener" href="/@ottosch/manually-creating-and-signing-a-bitcoin-transaction-87fbbfe46032">上一篇文章</a>。这一次，我真的厌倦了重复的工作，所以我写了一个小的<a class="ae jo" href="https://gist.github.com/ottosch/339aafe8dd5284a47e624b44fba70426" rel="noopener ugc nofollow" target="_blank"> Python脚本来修复签名</a>。尽管我没有明确地编写它，但我已经用<code class="eh mf mg mh mi b">fix-signature.py</code>管道化了所有的签名命令。</p><p id="aad2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">追加sighash <code class="eh mf mg mh mi b">0x01</code>后，我们有了第一个签名:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="1ea6" class="mn ld ht mi b fv mo mp l mq mr">304402200da2c4d8f2f44a8154fe127fe5bbe93be492aa589870fe77eb537681bc29c8ec02201eee7504e37db2ef27fa29afda46b6c331cd1a651bb6fa5fd85dcf51ac01567a01</span></pre><p id="6ed1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们保存它，并继续下一个输入。</p></div><div class="ab cl kv kw hb kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hm hn ho hp hq"><h1 id="87a8" class="lc ld ht bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">4.签署SegWit输入</h1><p id="b2a4" class="pw-post-body-paragraph iq ir ht is b it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn hm dt translated">是时候签署其他意见了。<a class="ae jo" href="https://github.com/bitcoin/bips/blob/master/bip-0143.mediawiki#Specification" rel="noopener ugc nofollow" target="_blank"> BIP143 </a>为签名SegWit输入定义了新的交易格式:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="2d5a" class="mn ld ht mi b fv mo mp l mq mr">Double SHA256 of the serialization of:<br/> 1.  nVersion of the transaction (4-byte little endian)<br/> 2.  hashPrevouts (32-byte hash)<br/> 3.  hashSequence (32-byte hash)<br/> 4.  outpoint (32-byte hash + 4-byte little endian) <br/> 5.  scriptCode of the input (serialized as scripts inside CTxOuts)<br/> 6.  value of the output spent by this input (8-byte little endian)<br/> 7.  nSequence of the input (4-byte little endian)<br/> 8.  hashOutputs (32-byte hash)<br/> 9.  nLocktime of the transaction (4-byte little endian)<br/> 10. sighash type of the signature (4-byte little endian)</span></pre><p id="0c0f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这里也有一些新的说法，我们会看到的。让我们从原生输入开始。</p><h2 id="e01b" class="mn ld ht bd le ms mt mu li mv mw mx lm jb my mz lq jf na nb lu jj nc nd ly ne dt translated">4.1签名输入#1</h2><p id="1d18" class="pw-post-body-paragraph iq ir ht is b it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn hm dt translated">在添加了版本<code class="eh mf mg mh mi b">02000000</code>之后，我们有了新的东西:之前输出点的散列。outpoint是前一个事务ID和输出索引的串联。我们已经从UTXOs中提取了这些数据，所以让我们对其进行哈希运算:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="4871" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">迄今为止的序列化:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="dbd3" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e6</span></pre><p id="deb4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后，哈希序列:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="260f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们有:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="1cf7" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e6<strong class="mi hu">82a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be8</strong></span></pre><p id="f908" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在是outpoint，它特定于这个输入:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="04c2" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e682a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be8<strong class="mi hu">9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b701000000</strong></span></pre><p id="eaea" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后是scriptCode，在P2WPKH的例子中是<code class="eh mf mg mh mi b">1976a914 &lt;pubkey hash&gt; 88ac</code>。这个和P2PKH的scriptPubKey一样。使用bech32工具之一获得pubkey散列后，我们添加脚本代码:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="898e" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e682a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be89cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b701000000<strong class="mi hu">1976a914594c2e3da92d1904f7e7c856220f8cae5efb556488ac</strong></span></pre><p id="e4a5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后输入值:9300 sats，是<code class="eh mf mg mh mi b">5424000000000000</code>，后面是顺序<code class="eh mf mg mh mi b">ffffffff</code>:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="5243" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e682a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be89cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b7010000001976a914594c2e3da92d1904f7e7c856220f8cae5efb556488ac<strong class="mi hu">5424000000000000ffffffff</strong></span></pre><p id="a9f2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">hashOutputs，它是所有输出的散列。每个输出都是<code class="eh mf mg mh mi b">amount || scriptPubKey size || scriptPubKey</code>。我们只有一个，所以:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="6898" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们就快到了:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="24a0" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e682a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be89cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b7010000001976a914594c2e3da92d1904f7e7c856220f8cae5efb556488ac5424000000000000ffffffff<strong class="mi hu">f3ae23c3fd63a2e0479888f95c7a8ab221b20add6ac819e9d8953edd1a0cd924</strong></span></pre><p id="a74f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，locktime和sighash:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="88d9" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e682a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be89cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b7010000001976a914594c2e3da92d1904f7e7c856220f8cae5efb556488ac5424000000000000fffffffff3ae23c3fd63a2e0479888f95c7a8ab221b20add6ac819e9d8953edd1a0cd924<strong class="mi hu">0000000001000000</strong></span></pre><p id="3b1f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们准备好签字了。</p><p id="e997" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> 4.1.1签约<br/> </strong>这里没什么新鲜的。和以前一样，只需重复散列和签名:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="89f1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在加上sighash <code class="eh mf mg mh mi b">0x01</code>就有了第二个签名:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="b6c2" class="mn ld ht mi b fv mo mp l mq mr">3045022100f8dac321b0429798df2952d086e763dd5b374d031c7f400d92370ae3c5f57afd0220531207b28b1b137573941c7b3cf5384a3658ef5fc238d26150d8f75b2bcc61e701</span></pre><h2 id="37c6" class="mn ld ht bd le ms mt mu li mv mw mx lm jb my mz lq jf na nb lu jj nc nd ly ne dt translated">4.2签名输入#2</h2><p id="ce67" class="pw-post-body-paragraph iq ir ht is b it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn hm dt translated">前3项(version、hashPrevouts和hashSequence)与最后一个输入中的相同:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="9720" class="mn ld ht mi b fv mo mp l mq mr">02000000 99197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e6 82a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be8</span></pre><p id="17f8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后是这个输入的输出点:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="1928" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e682a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be8<strong class="mi hu">8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d90401000000</strong></span></pre><p id="414a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在，脚本代码。这个输入也是P2WPKH，所以<code class="eh mf mg mh mi b">1976a914 &lt;pubkey hash&gt; 88ac</code>:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="14c2" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e682a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be88012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d90401000000<strong class="mi hu">1976a9146a721dcca372f3c17b2c649b2ba61aa0fda98a9188ac</strong></span></pre><p id="b573" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后，我将立即添加输入值(16，029，969 = <code class="eh mf mg mh mi b">1199f40000000000</code>)和序列<code class="eh mf mg mh mi b">ffffffff</code>:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="b4fc" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e682a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be88012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d904010000001976a9146a721dcca372f3c17b2c649b2ba61aa0fda98a9188ac<strong class="mi hu">1199f40000000000ffffffff</strong></span></pre><p id="6caa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后是hashOutputs、locktime和sighash，我们已经从前面的输入中获得了它们:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="6fa9" class="mn ld ht mi b fv mo mp l mq mr">0200000099197e88ff743aff3e453e3a7b745abd31937ccbd56f96a179266eba786833e682a7d5bb59fc957ff7f737ca0b8be713c705d6173783ad5edb067819bed70be88012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d904010000001976a9146a721dcca372f3c17b2c649b2ba61aa0fda98a9188ac<!-- -->1199f40000000000ffffffff<strong class="mi hu">f3ae23c3fd63a2e0479888f95c7a8ab221b20add6ac819e9d8953edd1a0cd9240000000001000000</strong></span></pre><p id="e693" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> 4.2.1签名<br/> </strong>一如既往，双哈希，签名并追加sighash:</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div></figure><p id="68cd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是我们最后一个sighash签名:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="1b03" class="mn ld ht mi b fv mo mp l mq mr">304402204ebf033caf3a1a210623e98b49acb41db2220c531843106d5c50736b144b15aa02201a006be1ebc2ffef0927d4458e3bb5e41e5abc7e44fc5ceb920049b46f87971101</span></pre></div><div class="ab cl kv kw hb kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hm hn ho hp hq"><h1 id="2b00" class="lc ld ht bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz dt translated">5.最终事务序列化</h1><p id="8289" class="pw-post-body-paragraph iq ir ht is b it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn hm dt translated">要推送的事务实际上是<a class="ae jo" href="https://github.com/bitcoin/bips/blob/master/bip-0144.mediawiki#Specification" rel="noopener ugc nofollow" target="_blank"> BIP144 </a>中描述的一种新格式。和老格式差不多。<br/>我们从版本开始:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="ecf7" class="mn ld ht mi b fv mo mp l mq mr">02000000</span></pre><p id="ce78" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后我们有了两个新的字段，SegWit标记符<code class="eh mf mg mh mi b">0x00</code>和标志符<code class="eh mf mg mh mi b">0x01</code>，这允许节点将其识别为SegWit事务:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="6b43" class="mn ld ht mi b fv mo mp l mq mr">02000000<strong class="mi hu">0001</strong></span></pre><p id="c41b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后，输入。我们有<code class="eh mf mg mh mi b">0x03</code>。除了scriptSig之外，它们和以前一样，script SIG取决于输入类型。对于遗留输入，我们已经知道它是<code class="eh mf mg mh mi b">&lt;sig&gt; &lt;pubkey&gt;</code>。与推送操作一起，带大小的scriptSig变成:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="626a" class="mn ld ht mi b fv mo mp l mq mr">6a 47 304402200da2c4d8f2f44a8154fe127fe5bbe93be492aa589870fe77eb537681bc29c8ec02201eee7504e37db2ef27fa29afda46b6c331cd1a651bb6fa5fd85dcf51ac01567a01 21 0242BF11B788DDFF450C791F16E83465CC67328CA945C703469A08E37EF0D0E061</span></pre><p id="56be" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">添加输出点和序列，我们完成了遗留输入:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="5f33" class="mn ld ht mi b fv mo mp l mq mr"><strong class="mi hu">ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d101000000</strong>6a47304402200da2c4d8f2f44a8154fe127fe5bbe93be492aa589870fe77eb537681bc29c8ec02201eee7504e37db2ef27fa29afda46b6c331cd1a651bb6fa5fd85dcf51ac01567a01210242BF11B788DDFF450C791F16E83465CC67328CA945C703469A08E37EF0D0E061<strong class="mi hu">ffffffff</strong></span></pre><p id="f250" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">本机SegWit输入更简单，因为scriptSig是空的。签名和公钥将出现在见证部分。第二输入:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="649e" class="mn ld ht mi b fv mo mp l mq mr">9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b7 01000000 00 ffffffff</span></pre><p id="2448" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">包装的SegWit需要在scriptSig中推送救赎脚本，因为这是一个P2SH。嵌套的脚本是一个P2WPKH，所以是<code class="eh mf mg mh mi b">OP_0 &lt;pubkey hash&gt;</code>。包括pubkey哈希的push操作码<code class="eh mf mg mh mi b">0x14</code>和redeemScript本身的<code class="eh mf mg mh mi b">0x16</code>，不要忘记脚本大小<code class="eh mf mg mh mi b">0x17</code>，我们最终得到:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="d58c" class="mn ld ht mi b fv mo mp l mq mr">8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d904 01000000 17 1600146a721dcca372f3c17b2c649b2ba61aa0fda98a91 ffffffff</span></pre><p id="6d88" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">关于签名和公钥位置的相同说明也适用于此处。这是到目前为止的交易，添加了输入的数量和输入本身:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="1126" class="mn ld ht mi b fv mo mp l mq mr">020000000001<strong class="mi hu">03ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d1010000006a47304402200da2c4d8f2f44a8154fe127fe5bbe93be492aa589870fe77eb537681bc29c8ec02201eee7504e37db2ef27fa29afda46b6c331cd1a651bb6fa5fd85dcf51ac01567a01210242BF11B788DDFF450C791F16E83465CC67328CA945C703469A08E37EF0D0E061ffffffff9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b70100000000ffffffff8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d90401000000171600146a721dcca372f3c17b2c649b2ba61aa0fda98a91ffffffff</strong></span></pre><p id="7a8b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">输出部分与遗留事务中的相同。我们已经有了第一个签名，所以:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="eaa2" class="mn ld ht mi b fv mo mp l mq mr">02000000000103ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d1010000006a47304402200da2c4d8f2f44a8154fe127fe5bbe93be492aa589870fe77eb537681bc29c8ec02201eee7504e37db2ef27fa29afda46b6c331cd1a651bb6fa5fd85dcf51ac01567a01210242BF11B788DDFF450C791F16E83465CC67328CA945C703469A08E37EF0D0E061ffffffff9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b70100000000ffffffff8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d90401000000171600146a721dcca372f3c17b2c649b2ba61aa0fda98a91ffffffff<strong class="mi hu">01b580f50000000000160014cb61ee4568082cb59ac26bb96ec8fbe0109a4c00</strong></span></pre><p id="3818" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们已经接近尾声了。现在，在锁定时间之前，我们有了一个新的部分。见证部分是我们放置见证的地方，需要解决SegWit UTXOs的scriptPubKey。这是交易中打折的部分(使得SegWit交易更便宜),并且允许超过1MB的块大小。由于遗留节点不接收见证节点，因此仍然有可能在1MB的限制内产生一个块，从而使块大小增加到可回溯兼容。</p><p id="2d0b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">每个输入都需要自己的见证项数组。每个输入必须指定:</p><ul class=""><li id="4c43" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx dt translated">项目的数量；</li><li id="eb75" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated">项目大小；</li><li id="e547" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated">项目本身；</li></ul><p id="70bc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">第一个输入不需要任何条目，因为验证所需的一切都已经在scriptSig中了；因此，我们只需要项目的数量:<code class="eh mf mg mh mi b">0x00</code>。第二个和第三个输入各有两项，分别是签名和公钥。<br/>这里是我们交易的见证字段:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="7707" class="mn ld ht mi b fv mo mp l mq mr">00<br/>---<br/>02<br/>48 3045022100f8dac321b0429798df2952d086e763dd5b374d031c7f400d92370ae3c5f57afd0220531207b28b1b137573941c7b3cf5384a3658ef5fc238d26150d8f75b2bcc61e701<br/>21 025972A1F2532B44348501075075B31EB21C02EEF276B91DB99D30703F2081B773<br/>---<br/>02<br/>47 304402204ebf033caf3a1a210623e98b49acb41db2220c531843106d5c50736b144b15aa02201a006be1ebc2ffef0927d4458e3bb5e41e5abc7e44fc5ceb920049b46f87971101<br/>21 02AE68D299CBB8AB99BF24C9AF79A7B13D28AC8CD21F6F7F750300EDA41A589A5D</span></pre><p id="74fe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">添加见证:</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="9cb4" class="mn ld ht mi b fv mo mp l mq mr">02000000000103ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d1010000006a47304402200da2c4d8f2f44a8154fe127fe5bbe93be492aa589870fe77eb537681bc29c8ec02201eee7504e37db2ef27fa29afda46b6c331cd1a651bb6fa5fd85dcf51ac01567a01210242BF11B788DDFF450C791F16E83465CC67328CA945C703469A08E37EF0D0E061ffffffff9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b70100000000ffffffff8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d90401000000171600146a721dcca372f3c17b2c649b2ba61aa0fda98a91ffffffff01b580f50000000000160014cb61ee4568082cb59ac26bb96ec8fbe0109a4c00<strong class="mi hu">0002483045022100f8dac321b0429798df2952d086e763dd5b374d031c7f400d92370ae3c5f57afd0220531207b28b1b137573941c7b3cf5384a3658ef5fc238d26150d8f75b2bcc61e70121025972A1F2532B44348501075075B31EB21C02EEF276B91DB99D30703F2081B7730247304402204ebf033caf3a1a210623e98b49acb41db2220c531843106d5c50736b144b15aa02201a006be1ebc2ffef0927d4458e3bb5e41e5abc7e44fc5ceb920049b46f879711012102AE68D299CBB8AB99BF24C9AF79A7B13D28AC8CD21F6F7F750300EDA41A589A5D</strong></span></pre><p id="30b3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，添加锁定时间后，我们就完成了交易！</p><pre class="kd ke kf kg fq mj mi mk ml aw mm dt"><span id="c8c2" class="mn ld ht mi b fv mo mp l mq mr">02000000000103ed204affc7519dfce341db0569687569d12b1520a91a9824531c038ad62aa9d1010000006a47304402200da2c4d8f2f44a8154fe127fe5bbe93be492aa589870fe77eb537681bc29c8ec02201eee7504e37db2ef27fa29afda46b6c331cd1a651bb6fa5fd85dcf51ac01567a01210242BF11B788DDFF450C791F16E83465CC67328CA945C703469A08E37EF0D0E061ffffffff9cb872539fbe1bc0b9c5562195095f3f35e6e13919259956c6263c9bd53b20b70100000000ffffffff8012f1ec8aa9a63cf8b200c25ddae2dece42a2495cc473c1758972cfcd84d90401000000171600146a721dcca372f3c17b2c649b2ba61aa0fda98a91ffffffff01b580f50000000000160014cb61ee4568082cb59ac26bb96ec8fbe0109a4c000002483045022100f8dac321b0429798df2952d086e763dd5b374d031c7f400d92370ae3c5f57afd0220531207b28b1b137573941c7b3cf5384a3658ef5fc238d26150d8f75b2bcc61e70121025972A1F2532B44348501075075B31EB21C02EEF276B91DB99D30703F2081B7730247304402204ebf033caf3a1a210623e98b49acb41db2220c531843106d5c50736b144b15aa02201a006be1ebc2ffef0927d4458e3bb5e41e5abc7e44fc5ceb920049b46f879711012102AE68D299CBB8AB99BF24C9AF79A7B13D28AC8CD21F6F7F750300EDA41A589A5D<strong class="mi hu">00000000</strong></span></pre><p id="119f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们来测试一下…</p><figure class="kd ke kf kg fq kh"><div class="bz el l di"><div class="ki kj l"/></div><figcaption class="kr ks fg fe ff kt ku bd b be z ek">Yeah!</figcaption></figure><h1 id="5fcf" class="lc ld ht bd le lf nf lh li lj ng ll lm ln nh lp lq lr ni lt lu lv nj lx ly lz dt translated">6.结论</h1><p id="77ec" class="pw-post-body-paragraph iq ir ht is b it ma iv iw ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn hm dt translated">唷…我们已经走了很长一段路，但我们完成了。我们已经从头开始创建并签署了一个SegWit事务。我们还了解了新旧交易格式之间的差异、签名流程的不同以及如何将legacy和SegWit UTXOs结合起来。</p><p id="0ef1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">希望你喜欢它，下次再见！</p><blockquote class="nk"><p id="f1e4" class="nl nm ht bd nn no np nq nr ns nt jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote></div></div>    
</body>
</html>