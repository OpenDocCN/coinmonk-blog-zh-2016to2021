<html>
<head>
<title>Truffle TestRPC Accounts Can Cost Unwarry Developers Real World Ether</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Truffle TestRPC帐户会让粗心的开发人员付出现实世界的代价</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/truffle-testrpc-accounts-can-cost-unwarry-developers-real-world-ether-c314c9bc970a?source=collection_archive---------2-----------------------#2018-03-04">https://medium.com/coinmonks/truffle-testrpc-accounts-can-cost-unwarry-developers-real-world-ether-c314c9bc970a?source=collection_archive---------2-----------------------#2018-03-04</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="f3f9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">DApp开发人员在开发与其智能合约交互的用户界面时，通常会将帐户密钥从Truffle TestRPC导入MetaMask。在使用testRPC或测试EVM进行开发时，这是模拟用户体验和工作流的一个很好的方法。不幸的是，这也是丢失真实世界ETH的快速有效的方法。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/a52bcbf3d60a0316c0f361391fce6776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UwPXtwpaFfrRNjXLn28DQA.png"/></div></div></figure><p id="5ef4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当我的团队正在将一个支持web3的React组件转换成一个wordpress插件时，我的一个队友，为了保护无辜，我们姑且称他为<a class="ae ka" href="http://brian@web3devs.com" rel="noopener ugc nofollow" target="_blank"> Brian </a>，开始抓狂了，因为Etherscan.io显示了他的Rinkeby账户上发生的一大堆交易。原来他在看<a class="ae ka" href="https://rinkeby.etherscan.io/address/0x627306090abab3a6e1400e9345bc60c78a8bef57" rel="noopener ugc nofollow" target="_blank">0x 627306090 abab 3 a6 e 1400 e 9345 BC 60 c 78 A8 bef 57</a>的交易历史。如果这个地址看起来很熟悉，那是因为当你运行Truffle Develop时它是Accounts(0)。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff kb"><img src="../Images/595bfb555483068dfd530131fadb0364.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*6e0BFV3Nk5Ko-ruij9DA6Q.png"/></div></figure><p id="b55a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们从来没有想到过相同的私钥会在每个网络上创建相同的地址。在实践中，我们会将正在处理的地址的私钥导入到元掩码中，并为其指定一个名称，如TruffleDev0或MewRinkeby0。然后，当我们通过测试网络将提供商从本地主机切换到Rinkeby时，我们也会切换地址。这是我们中的一个人第一次忘记在MetaMask中切换帐户以反映web3 provider的变化。</p><blockquote class="kc"><p id="8661" class="kd ke ht bd kf kg kh ki kj kk kl jn ek translated"><a class="ae ka" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="kn ko kp kq kr jt fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff km"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><p id="d8df" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以下是Brian写的描述他如何发现漏洞的笔记:</p><blockquote class="ks kt ku"><p id="c70f" class="iq ir kv is b it iu iv iw ix iy iz ja kw jc jd je kx jg jh ji ky jk jl jm jn hm dt translated">我们发现了<br/> 1漏洞。运行块菌开发<br/> 2。使用truffle dev种子短语或私钥导入元掩码<br/> 3。然后使用相同的元掩码帐户连接到本地以外的网络<br/>这样做的目的:<br/>在我连接到的每个网络上创建相同的钱包(使用相同的私钥)<br/>我们如何发现:<br/>元掩码不显示其他人的交易<br/>当我们访问以太扫描时，注意到一堆我们没有启动的交易<br/>漏洞:<br/>每个运行truffle dev的人都知道那些私钥<br/>所以，当我连接到live net时，其他所有以太坊开发者都知道</p></blockquote><p id="9565" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">意识到松露私钥在Rinkeby上有效后，我们将提供商切换到主以太坊网络，并点击了以太扫描上的“<a class="ae ka" href="https://etherscan.io/address/0x627306090abab3a6e1400e9345bc60c78a8bef57" rel="noopener ugc nofollow" target="_blank">查看账户”按钮。原来自从松露4.0部署以来，Accounts(0)在主网上一直很活跃。在撰写本文时，通过一个完全开放的地址已经进行了378笔交易，价值约为1万美元。</a></p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff kz"><img src="../Images/5bc5aecd7b12f6328b1355495f3b7411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnshW3bWb8u5lmygRvMjGQ.png"/></div></div></figure><p id="c480" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们回顾了所有10个Truffle TestRPC地址的历史，发现它们目前正被一些GETH脚本利用，这些脚本重定向所有到达这些地址的ETH。经过不断发现，我们在几个流行的web3应用程序中发现了以下漏洞:</p><ul class=""><li id="55dd" class="la lb ht is b it iu ix iy jb lc jf ld jj le jn lf lg lh li dt translated">通过在本地存储事务随机数，元掩码可以返回给定地址不完整的事务历史。此外，由于估计了nonce，在部署契约时可能会产生冲突。</li><li id="9242" class="la lb ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated">比特币基地允许通过这个账户购买ETH。在我们的测试中，我们从Accounts(0)购买了0.001 ETH，交易执行时没有任何错误处理。三个街区后，另一个演员把一部分ETH寄到了另一个地址。那个<a class="ae ka" href="https://etherscan.io/address/0x2d7311279a3ba818db2ad84eed09324a2577188a" rel="noopener ugc nofollow" target="_blank">目标地址</a>在过去的33天里从账户(0)和账户(1)收集了超过500美元。</li></ul><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff lo"><img src="../Images/3e407ea7792d9031f8063f8e4fdbf9ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ebawe2IjhhJg-isV1pzUA.png"/></div></div></figure><ul class=""><li id="3291" class="la lb ht is b it iu ix iy jb lc jf ld jj le jn lf lg lh li dt translated">Etherscan没有以任何方式标记这些地址，也没有相关公民在Disqus评论区为这些帐户留下任何评论。</li><li id="90cf" class="la lb ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated">Poloniex合约在某一点上存放了0.9 ETH，这表明他们的接口并不禁止他们的用户向这些帐户提款。</li><li id="f6c9" class="la lb ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated">与合法ico相关联的各种帐户在其售前和代币销售期间向这些帐户汇款。</li></ul><p id="565c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我的公司<a class="ae ka" href="https://web3devs.com/" rel="noopener ugc nofollow" target="_blank"> Web3Devs </a>目前正在向上面确定的团队提出这个问题，以便他们可以标记这些帐户以保护他们的客户。但与此同时，我们想提供一些提示，以帮助其他开发人员在使用这些帐户时保持安全。</p><ul class=""><li id="a6dd" class="la lb ht is b it iu ix iy jb lc jf ld jj le jn lf lg lh li dt translated">在MetaMask中命名您的帐户，以便您可以轻松地看到每个帐户应该活跃在哪个网络上。</li><li id="cd8d" class="la lb ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated">不要在测试EVM上使用testRPC地址，因为在这些地址上有成千上万的其他事务，这会使测试出现不必要的错误。</li><li id="5ad6" class="la lb ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated">不要在开发环境中存储的地址存储您的储蓄或接受实际付款。</li><li id="4465" class="la lb ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated">在您的开发环境中，将生产部署所需的资金保持在绝对最低水平。</li></ul><p id="e344" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Truffle 4.0帮了我们一个大忙，它从一个Truffle TestRPC实例到下一个实例都保持了相同的帐户和种子短语。但是这种便利是有代价的。让我们都确保我们的团队遵守最佳实践，并保持不同网络之间的地址分离。</p><p id="8e47" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">此外，我们在发现过程中发现了<a class="ae ka" href="https://etherscan.io/address/0xce853db3359326db6d03981c9fb42983bbcdd007#code" rel="noopener ugc nofollow" target="_blank">这份合同</a>，如果你需要一个好的笑话，请阅读评论。</p></div></div>    
</body>
</html>