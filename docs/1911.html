<html>
<head>
<title>Advanced EOS Series — Part 4 — Table Uniqueness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">高级EOS系列—第4部分—表格唯一性</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/advanced-eos-series-part-4-table-uniqueness-835843a207fc?source=collection_archive---------0-----------------------#2018-12-24">https://medium.com/coinmonks/advanced-eos-series-part-4-table-uniqueness-835843a207fc?source=collection_archive---------0-----------------------#2018-12-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/7872299622326cfe6c53348fb8aba86a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EiofFa9-wj6IoL06gbTilw@2x.jpeg"/></div></div></figure><p id="ea31" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">欢迎回到高级EOS开发系列，在这里我将涉及到教程或课程很少涉及的高级技术和功能。本系列的目的是将您作为EOS网络上的分布式应用程序开发人员所需的技能整合在一起。每篇文章都是按照难度排序的，所以如果你想要一个总体的概述，我建议你从第1部分开始，一步步往上。这些例子的完整代码可以在GitHub 上找到<a class="ae jz" href="https://github.com/MitchPierias/Advanced-EOS-Examples" rel="noopener ugc nofollow" target="_blank">。</a></p><div class="ka kb fm fo kc kd"><a href="https://github.com/MitchPierias/Advanced-EOS-Examples/tree/master/04_Table-Uniqueness" rel="noopener  ugc nofollow" target="_blank"><div class="ke ab ej"><div class="kf ab kg cl cj kh"><h2 class="bd hu fv z el ki eo ep kj er et hs dt translated">MitchPierias/高级-EOS-示例</h2><div class="kk l"><h3 class="bd b fv z el ki eo ep kj er et ek translated">一系列EOS合同开发实例。通过创建…为MitchPierias/Advanced-EOS-Examples开发做出贡献</h3></div><div class="kl l"><p class="bd b gc z el ki eo ep kj er et ek translated">github.com</p></div></div><div class="km l"><div class="kn l ko kp kq km kr iz kd"/></div></div></a></div><blockquote class="ks kt ku"><p id="612d" class="jb jc kv jd b je jf jg jh ji jj jk jl kw jn jo jp kx jr js jt ky jv jw jx jy hm dt translated">由于这些是高级或扩展的主题，我很危险地假设你已经知道了基础知识，并且正在寻求进一步的知识。出于这个原因，这些文章中共享的代码将只针对所讨论的目的进行精简。</p></blockquote><p id="58dd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这篇文章相对来说比较短，但是涵盖了一个基本的，看起来没有涉及到的方法，多索引表，唯一的主索引。</p><h1 id="452d" class="kz la ht bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw dt translated">唯一索引</h1><p id="df86" class="pw-post-body-paragraph jb jc ht jd b je lx jg jh ji ly jk jl jm lz jo jp jq ma js jt ju mb jw jx jy hm dt translated">到目前为止，我们已经能够在表中创建由唯一的<code class="eh mc md me mf b">account_name</code>标识符索引的行，但是我们如何使用不同的<code class="eh mc md me mf b">primary_key</code>并确保它是唯一的呢？幸运的是EOSio的开发者为我们提供了<code class="eh mc md me mf b">available_primary_key()</code>功能。</p><p id="b054" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们从创建一个结构来定义我们的<code class="eh mc md me mf b">items</code>表中的<code class="eh mc md me mf b">Item</code>开始。我们将使用一个普通的<code class="eh mc md me mf b">uint64_t</code>来指定我们的主键<code class="eh mc md me mf b">id</code>。</p><pre class="mg mh mi mj fq mk mf ml mm aw mn dt"><span id="00be" class="mo la ht mf b fv mp mq l mr ms">// @abi table items i64<br/>struct Item {<br/>  uint64_t          id;<br/>  string            name;<br/>  uint64_t          attack;<br/>  account_name      owner;<br/><br/>  auto primary_key() const { return id; };<br/>  EOSLIB_SERIALIZE(Item, (id)(name)(attack));<br/>};<br/><br/>typedef multi_index&lt;N(items), Item&gt; items_table;</span></pre><p id="531d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">你会注意到这是我们在<a class="ae jz" rel="noopener" href="/coinmonks/advanced-eos-series-part-3-secondary-indexes-1798f339cbb8">高级EOS系列—第3部分—二级索引</a>中使用的相同的表结构。现在让我们更新我们的操作来生成一个惟一的主键，而不是要求它们作为一个参数。</p><pre class="mg mh mi mj fq mk mf ml mm aw mn dt"><span id="fd64" class="mo la ht mf b fv mp mq l mr ms">void inventory::create(const account_name account, const string name, const uint64_t attack) {<br/><br/>  items_table items(_self, _self);<br/><br/>  items.emplace(account, account, [&amp;](auto&amp; item) {<br/>    item.id = items.available_primary_key();<br/>    item.name = name;<br/>    item.attack = attack;<br/>    item.owner = account;<br/>  });<br/>}</span></pre><p id="af1d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们已经从我们的动作<code class="eh mc md me mf b">void post(const account_name username, uint64_t index const string&amp; msg_str)</code>中移除了<code class="eh mc md me mf b">uint64_t index</code>，并且我们已经用<code class="eh mc md me mf b">items.available_primary_key()</code>替换了<code class="eh mc md me mf b">index</code>，以便在我们创建新项目时设置主键<code class="eh mc md me mf b">id</code>。</p><blockquote class="mt"><p id="8359" class="mu mv ht bd mw mx my mz na nb nc jy ek translated"><a class="ae jz" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="ne nf ng nh ni iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nd"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><figure class="mg mh mi mj fq iu fe ff paragraph-image"><a href="http://bit.ly/2G71Sp7"><div class="fe ff nj"><img src="../Images/449450761cd76f44f9ae574333f9e9af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKX2mtg7p1lOs7JmosPLsA.png"/></div></a></figure></div></div>    
</body>
</html>