<html>
<head>
<title>How to Implement a Crypto Trading Bot (for Dummies) — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何实现一个加密交易机器人(针对傻瓜)——第2部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-implement-a-crypto-trading-bot-for-dummies-part-2-d16fc8acde03?source=collection_archive---------5-----------------------#2021-06-04">https://medium.com/coinmonks/how-to-implement-a-crypto-trading-bot-for-dummies-part-2-d16fc8acde03?source=collection_archive---------5-----------------------#2021-06-04</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="405c" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">在Django web服务器上运行交易机器人</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/da47ed73d4449651fcade78bbb0c6647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3665FE210D39PXDSUcIAKw.jpeg"/></div></div></figure><p id="203a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><a class="ae kq" rel="noopener" href="/coinmonks/how-to-implement-a-crypto-trading-bot-for-dummies-part-1-efc9d14dffb7"> <strong class="jw hu">第一部分</strong> </a></p><p id="32c7" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在教程的这一部分，我们用<a class="ae kq" href="https://www.djangoproject.com/" rel="noopener ugc nofollow" target="_blank"> Django </a>建立了一个web服务器。我们通过HTTP与服务器通信。目标是通过HTTP请求启动和停止交易机器人。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff kr"><img src="../Images/d4de1045f552e02e873ff4cd1c5bd810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*k4QsIscjs8OqTVIYAnwvEQ.png"/></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Our setup is based on the <a class="ae kq" href="https://en.wikipedia.org/wiki/Client%E2%80%93server_model" rel="noopener ugc nofollow" target="_blank">client-server model</a>.</figcaption></figure><h1 id="f1f2" class="kw kx ht bd ky kz la lb lc ld le lf lg iz lh ja li jc lj jd lk jf ll jg lm ln dt translated">建立Django项目</h1><p id="cb9e" class="pw-post-body-paragraph ju jv ht jw b jx lo iu jz ka lp ix kc kd lq kf kg kh lr kj kk kl ls kn ko kp hm dt translated">打开一个终端(您也可以使用PyCharm中的终端)并检查我们的conda环境是否处于活动状态。验证我们是否在项目的根文件夹中</p><pre class="jj jk jl jm fq lt lu lv lw aw lx dt"><span id="fa5e" class="ly kx ht lu b fv lz ma l mb mc">$ conda activate crypto-for-dummies<br/>$ ls<br/>binance-trade-bot-master</span></pre><p id="7cd8" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">然后安装Django:</p><pre class="jj jk jl jm fq lt lu lv lw aw lx dt"><span id="35d4" class="ly kx ht lu b fv lz ma l mb mc">$ pip install django</span></pre><p id="2886" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">开始一个新的Django项目:</p><pre class="jj jk jl jm fq lt lu lv lw aw lx dt"><span id="1850" class="ly kx ht lu b fv lz ma l mb mc">$ django-admin startproject myserver<br/>$ ls<br/>binance-trade-bot-master <strong class="lu hu">myserver</strong></span></pre><p id="26c8" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">这将创建文件夹<code class="eh md me mf lu b">myserver</code>。</p><p id="d38d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">让我们运行服务器:</p><pre class="jj jk jl jm fq lt lu lv lw aw lx dt"><span id="2079" class="ly kx ht lu b fv lz ma l mb mc">$ cd myserver<br/>$ python manage.py runserver</span></pre><p id="5878" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">输出如下所示:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff mg"><img src="../Images/f82c7dccaa80bffbdd33a25b8f214627.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJ_qrBPzLCglf0xo0JWBbQ.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Terminal output when starting the server.</figcaption></figure><p id="415e" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">前往网址<code class="eh md me mf lu b"><a class="ae kq" href="http://127.0.0.1:8000/." rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/</a></code>。有一个来自Django的欢迎页面。</p></div><div class="ab cl mh mi hb mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hm hn ho hp hq"><h1 id="2fcc" class="kw kx ht bd ky kz mo lb lc ld mp lf lg iz mq ja li jc mr jd lk jf ms jg lm ln dt translated">创建一个端点</h1><p id="d7d0" class="pw-post-body-paragraph ju jv ht jw b jx lo iu jz ka lp ix kc kd lq kf kg kh lr kj kk kl ls kn ko kp hm dt translated">现在，我们想要创建一个HTTP端点。我们稍后使用这个端点来启动和停止机器人。端点总是带有特定的URL。例如:<code class="eh md me mf lu b"><a class="ae kq" href="http://127.0.0.1:8000/." rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/</a>api/bot</code>。</p><p id="b6d1" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">首先，让我们创建一个Django应用程序:</p><pre class="jj jk jl jm fq lt lu lv lw aw lx dt"><span id="7bf6" class="ly kx ht lu b fv lz ma l mb mc">$ python manage.py startapp bot<br/>$ ls<br/><strong class="lu hu">bot</strong> db.sqlite3 manage.py myserver</span></pre><p id="40fc" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">这就创建了目录<code class="eh md me mf lu b">bot</code>。Django允许我们创建多个应用程序。应用程序可以区分我们服务器的不同用途。</p><p id="30d2" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">让我们快速调查一下其他文件和文件夹:</p><ul class=""><li id="ec42" class="mt mu ht jw b jx jy ka kb kd mv kh mw kl mx kp my mz na nb dt translated"><code class="eh md me mf lu b">manage.py</code>是来自Django的Python文件。我们用那个文件管理我们的整个Django项目。</li><li id="4749" class="mt mu ht jw b jx nc ka nd kd ne kh nf kl ng kp my mz na nb dt translated"><code class="eh md me mf lu b">db.sqlite3</code>是一个<a class="ae kq" href="https://en.wikipedia.org/wiki/SQLite" rel="noopener ugc nofollow" target="_blank"> SQLite </a>数据库文件。Django应用程序使用这个数据库来存储信息。我们不会使用那个数据库，因为我们已经有了另一个SQLite数据库。检查文件夹<code class="eh md me mf lu b">binance-trade-bot-master/data</code>。里面是一个名为<code class="eh md me mf lu b">crypto_trading.db</code>的文件。这也是一个SQLite数据库，机器人在其中存储关于我们当前硬币的信息，与其他硬币的比率，以及其他信息。</li><li id="0faa" class="mt mu ht jw b jx nc ka nd kd ne kh nf kl ng kp my mz na nb dt translated"><code class="eh md me mf lu b">myserver</code>是一个目录，它包含了来自Django的一系列Python文件(如<code class="eh md me mf lu b">settings.py</code>),以使我们的web服务器运行。</li></ul><p id="c6c5" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">改编<code class="eh md me mf lu b">bot/views.py</code>内的代码:</p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="4571" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">转到<code class="eh md me mf lu b">myserver/url.py</code>并将其修改为:</p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="e8b8" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">皮查姆可能会抱怨:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff nj"><img src="../Images/0fb9ca6f198a69cf2fea13400602dd4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*2H8IQWZyWqvVkEobTv1t-w.png"/></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">PyCharm: wrong folder set as root</figcaption></figure><p id="1610" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">要解决这个问题，右击<strong class="jw hu">外部的</strong> <code class="eh md me mf lu b">myserver</code>文件夹。点击:“将目录标记为”→“源根目录”。</p><p id="7b7a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">前往<a class="ae kq" href="https://www.postman.com/downloads/" rel="noopener ugc nofollow" target="_blank">邮差</a>下载。我们使用postman向我们的服务器发送一个HTTP请求，并触发新创建的端点。把Postman想象成<a class="ae kq" href="https://en.wikipedia.org/wiki/Client%E2%80%93server_model" rel="noopener ugc nofollow" target="_blank">客户</a>。以后，当我们出去吃冰淇淋时，我们可以用手机代替邮递员。</p><p id="8d32" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在Postman中，我们可以创建一个GET请求。如果一切设置正确，我们将从服务器得到一个响应:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nk"><img src="../Images/a38e2735983b28ae30e898459530340c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avTXAXS6bKM4gEQ0TbP0cw.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Response of the server in Postman</figcaption></figure></div><div class="ab cl mh mi hb mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hm hn ho hp hq"><h1 id="e88a" class="kw kx ht bd ky kz mo lb lc ld mp lf lg iz mq ja li jc mr jd lk jf ms jg lm ln dt translated">通过端点启动bot</h1><p id="f292" class="pw-post-body-paragraph ju jv ht jw b jx lo iu jz ka lp ix kc kd lq kf kg kh lr kj kk kl ls kn ko kp hm dt translated">将文件夹<code class="eh md me mf lu b">binance-trade-bot-master</code>移动到<code class="eh md me mf lu b">myserver/bot</code>文件夹中:</p><pre class="jj jk jl jm fq lt lu lv lw aw lx dt"><span id="f0fa" class="ly kx ht lu b fv lz ma l mb mc">$ ls<br/>myserver binance-trade-bot-master<br/>$ mv binance-trade-bot-master/ myserver/bot<br/>$ ls<br/>myserver</span></pre><p id="8768" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">将<code class="eh md me mf lu b">binacne-trade-bot-master</code>文件夹重命名为<code class="eh md me mf lu b">binance_bot:</code></p><pre class="jj jk jl jm fq lt lu lv lw aw lx dt"><span id="a5d3" class="ly kx ht lu b fv lz ma l mb mc">$ cd myserver/bot<br/>$ mv binance-trade-bot-master binance_bot //This renames the folder<br/>$ ls<br/><strong class="lu hu">binance_bot</strong> <strong class="lu hu">migrations</strong> admin.py apps.py models.py ....</span></pre><p id="2952" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">用<code class="eh md me mf lu b">python manage.py runserver</code>重启我们的服务器会导致以下错误:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nl"><img src="../Images/9a93f106de7e4fbb995143f63338abfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R2kx3ZWjfoA9R9XAIXwujA.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Error when starting the server.</figcaption></figure><p id="7db4" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">转到错误描述中提到的文件<code class="eh md me mf lu b">backtest.py</code>，将第14行改为:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nm"><img src="../Images/544f4a93c9389a9a24fa188ea5562f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CgNyIpAyJtXaKvGyc8gwqA.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">backtest.py: update line 14.</figcaption></figure><p id="d3c5" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">提示:按“SHIFT”两次，搜索文件。</p><p id="8b1d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">我们现在必须更改几个文件中的路径。这是因为应用程序的根发生了变化。转到以下文件:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nn"><img src="../Images/74bb9d1a8d25446c21886eb28deeefbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*NyEGFZjvOWDHuxXG5bHBMA.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">config.py: update line 7 and 8.</figcaption></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff no"><img src="../Images/1146b2e7c6ec5860a0b0f30020f840b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBbTAGAOnGO9W5AdzNEahw.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">database.py: update line 19.</figcaption></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff np"><img src="../Images/b42afdadfff431c33dd26f1e0132649d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*20sx46omjUT3fvGmaaX-fg.png"/></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">default_strategy.py: update line 5.</figcaption></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nq"><img src="../Images/4efe96f5616933831e11f29db44fd0cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lGA0Dq6v1OX2AL9SBR0HWw.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">logger.py: update line 18 and 19.</figcaption></figure><p id="1db1" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">现在，我们在一个新的<a class="ae kq" href="https://en.wikipedia.org/wiki/Thread_(computing)" rel="noopener ugc nofollow" target="_blank">线程</a>中启动机器人:</p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="728e" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">为了更好地理解线程，请阅读本文末尾的“深入探讨:线程”。简单的解释是，我们不希望Django服务器在运行bot时被阻塞。它应该仍然能够回答HTTP请求。</p><p id="7918" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">我们还添加了一个名为<code class="eh md me mf lu b">action</code>的<a class="ae kq" href="https://en.wikipedia.org/wiki/Query_string" rel="noopener ugc nofollow" target="_blank">查询参数</a>。转到postman并更新URL:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/4e855d7cce2c269db0eb73dfc4881e28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kjeL-4Xxg9QBQA4wXG0wzA.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">URL with query parameter “action”</figcaption></figure><p id="5a66" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">现在，我们应该能够通过GET请求启动bot。</p><p id="eb89" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">要停止bot，我们需要在终端中按下“CMD + C”来停止服务器。</p></div><div class="ab cl mh mi hb mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hm hn ho hp hq"><h1 id="4a3e" class="kw kx ht bd ky kz mo lb lc ld mp lf lg iz mq ja li jc mr jd lk jf ms jg lm ln dt translated">通过端点停止bot</h1><p id="6084" class="pw-post-body-paragraph ju jv ht jw b jx lo iu jz ka lp ix kc kd lq kf kg kh lr kj kk kl ls kn ko kp hm dt translated">在我们继续之前，我强烈建议您阅读本文末尾的“深入探讨:线程”。否则你会很难理解我们在做什么。</p><p id="ee33" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">为了通过HTTP请求停止线程，我们需要一个“可停止的”线程。将这个类添加到其他代码下面的<code class="eh md me mf lu b">views.py</code>:</p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="nh ni l"/></div></figure><p id="9caf" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">更新<code class="eh md me mf lu b">BotView</code>。使用<code class="eh md me mf lu b">StoppableThread</code>代替传统的<code class="eh md me mf lu b">Thread</code>:</p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="nh ni l"/></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Line 7: Use the StoppableThread. Line 11: Calls a function to find a thread with a specific name and stops it.</figcaption></figure><p id="7624" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在<code class="eh md me mf lu b">crypto_trading.py</code>内部稍微修改一下代码:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ns"><img src="../Images/2415f2e17836053d08f418b186caf54d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0JyJPdFrXt7pfDMs_HzDA.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Our changes happened in line 48, 49 and 52–54.</figcaption></figure><p id="4e7c" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">交易机器人通过一个<a class="ae kq" href="https://en.wikipedia.org/wiki/Scheduling_(computing)" rel="noopener ugc nofollow" target="_blank">调度器</a>运行。调度程序重复执行第43到46行中定义的任务。</p><p id="7316" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在我们改变之前，我们有一个<a class="ae kq" href="https://en.wikipedia.org/wiki/Infinite_loop" rel="noopener ugc nofollow" target="_blank">无限循环</a> ( <code class="eh md me mf lu b">while True</code>),其中调度程序重复执行任务。</p><p id="3013" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">现在，在第48行我们找到了我们的<code class="eh md me mf lu b">StoppableThread</code>。在第49行，我们扩展了while循环的条件。如果bot线程应该停止，我们将停止执行while循环。</p><p id="4975" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">别忘了<code class="eh md me mf lu b">import threading</code>在上面。</p><p id="dfce" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在第52–54行，我们添加了一些额外的日志记录。</p><p id="298a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">现在，让我们通过HTTP请求再次启动bot。然后我们发出第二个HTTP请求，如下所示:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nt"><img src="../Images/c6d36cb5106e5dd7c0e4681f8561e8ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZA0XtAwRQ2KIGb5DerYIJg.png"/></div></div><figcaption class="ks kt fg fe ff ku kv bd b be z ek">Postman: HTTP request to stop the bot</figcaption></figure><p id="b31b" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">我们终端的输出如下所示:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nu"><img src="../Images/5ee9cb1de906393450780c56ec505cbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*olE06I4ywn8TP25QEo4z5w.png"/></div></div></figure></div><div class="ab cl mh mi hb mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hm hn ho hp hq"><h1 id="3478" class="kw kx ht bd ky kz mo lb lc ld mp lf lg iz mq ja li jc mr jd lk jf ms jg lm ln dt translated">深潜:线程</h1><p id="a4b9" class="pw-post-body-paragraph ju jv ht jw b jx lo iu jz ka lp ix kc kd lq kf kg kh lr kj kk kl ls kn ko kp hm dt translated">让我们来看看<a class="ae kq" href="https://simple.wikipedia.org/wiki/Thread_(computer_science)" rel="noopener ugc nofollow" target="_blank">简单的维基百科</a>对线程的定义:</p><blockquote class="nv nw nx"><p id="39ab" class="ju jv ny jw b jx jy iu jz ka kb ix kc nz ke kf kg oa ki kj kk ob km kn ko kp hm dt translated">计算机科学中的<strong class="jw hu">线程</strong>是执行的<em class="ht">线程的简称。线程是程序将自身划分(称为<em class="ht">“split”</em>)为两个或更多同时(或伪同时)运行的任务的一种方式。</em></p></blockquote><p id="8a1d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">线程允许我们并行执行多项任务。在我们的例子中，我们有两个任务:</p><ul class=""><li id="e780" class="mt mu ht jw b jx jy ka kb kd mv kh mw kl mx kp my mz na nb dt translated">运行Django web服务器(主线程)</li><li id="6bfa" class="mt mu ht jw b jx nc ka nd kd ne kh nf kl ng kp my mz na nb dt translated">运行币安机器人</li></ul><p id="44fe" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">因此，在我们的例子中，它看起来像这样:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff oc"><img src="../Images/6caeeba9bf7633ded03a3cf5c7411f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*WGV1xXEH4FLDhYNkA2jz3Q.png"/></div></figure><p id="ed2b" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">如果我们不使用另一个线程，主线程就会忙于运行交易机器人。它无法处理其他HTTP请求。</p></div><div class="ab cl mh mi hb mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hm hn ho hp hq"><p id="4bc0" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><em class="ny">随时联系我</em><a class="ae kq" href="https://www.linkedin.com/in/lorenzhofmannwellenhof/" rel="noopener ugc nofollow" target="_blank"><em class="ny">LinkedIn</em></a><em class="ny">。订阅我的</em> <a class="ae kq" href="http://eepurl.com/hx6Jvf" rel="noopener ugc nofollow" target="_blank"> <em class="ny">时事通讯</em> </a> <em class="ny">，当我写博客介绍我作为软件工程师的个人经历时，我会收到通知。你对如何成为一名更好的软件工程师感兴趣吗？编码快乐！</em></p><div class="od oe fm fo of og"><a href="https://levelup.gitconnected.com/why-solving-algorithmic-problems-make-you-a-better-software-engineer-bc543cb034e" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab ej"><div class="oi ab oj cl cj ok"><h2 class="bd hu fv z el ol eo ep om er et hs dt translated">为什么解决算法问题会让你成为更好的软件工程师</h2><div class="on l"><h3 class="bd b fv z el ol eo ep om er et ek translated">我从LeetCoding中学到的6件事</h3></div><div class="oo l"><p class="bd b gc z el ol eo ep om er et ek translated">levelup.gitconnected.com</p></div></div><div class="op l"><div class="oq l or os ot op ou js og"/></div></div></a></div><h2 id="0302" class="ly kx ht bd ky ov ow ox lc oy oz pa lg kd pb pc li kh pd pe lk kl pf pg lm ph dt translated">另外，阅读</h2><ul class=""><li id="b0f2" class="mt mu ht jw b jx lo ka lp kd pi kh pj kl pk kp my mz na nb dt translated"><a class="ae kq" href="https://blog.coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">电网交易机器人</a></li><li id="4309" class="mt mu ht jw b jx nc ka nd kd ne kh nf kl ng kp my mz na nb dt translated"><a class="ae kq" href="https://blog.coincodecap.com/best-crypto-trading-bots" rel="noopener ugc nofollow" target="_blank">密码交易机器人</a></li></ul></div></div>    
</body>
</html>