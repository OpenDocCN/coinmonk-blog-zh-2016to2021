<html>
<head>
<title>DEFI Sandwich Attack Explain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DEFI三明治攻击解释</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/defi-sandwich-attack-explain-776f6f43b2fd?source=collection_archive---------0-----------------------#2021-06-12">https://medium.com/coinmonks/defi-sandwich-attack-explain-776f6f43b2fd?source=collection_archive---------0-----------------------#2021-06-12</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="1516" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在这篇文章中，我将通过一个例子和数学观点来总结什么是三明治攻击，这样你就可以理解加密市场操纵。</p><p id="f9f6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">三明治攻击并不新鲜，<a class="ae jo" href="https://ethresear.ch/t/improving-front-running-resistance-of-x-y-k-market-makers/1281" rel="noopener ugc nofollow" target="_blank"> Vitalik已经在2018年的Uniswap中谈到过它们</a>。</p><p id="4c26" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们试着用简单的术语来理解什么是三明治攻击。</p><h2 id="1edc" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj dt translated"><strong class="ak">什么是三明治攻击？</strong></h2><p id="e0d1" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hm dt translated">受害者交易将加密货币资产X(例如:瑞士联邦理工学院、戴、赛、)交易到另一加密资产Y，并进行大额购买。一个机器人嗅到了交易，并在大宗交易被批准之前，通过购买资产Y抢先受害者一步。这种购买提高了受害交易者的资产Y的价格，并增加了滑点(基于交易量和可用流动性的预期价格上涨或下跌)。</p><p id="c6af" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">因为资产Y的高购买，它的价格上升，受害者以更高的价格购买资产Y，然后攻击者以更高的价格出售。</p><figure class="kq kr ks kt fq ku fe ff paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="fe ff kp"><img src="../Images/aa77988a94bd2792f336d25705ca7cdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBVNSdoerugpCiXD7KTmFw.png"/></div></div></figure><h2 id="ee9c" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj dt translated">打破三明治攻击</h2><p id="3bdb" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hm dt translated">由于区块链的公共性质，这些攻击经常出现在野外，所有交易都可以被<a class="ae jo" rel="noopener" href="/@danrobinson/ethereum-is-a-dark-forest-ecc5f0505dff"> mempool </a>中的任何人观察到(除非有人与矿池有特殊的直接联系)。或者，智能合约可以包含没有执行这种交易的访问限制的功能。这些功能通常用于申请LP奖励代币，并使用DEX立即将它们换成其他代币。</p><pre class="kq kr ks kt fq lb lc ld le aw lf dt"><span id="b658" class="jp jq ht lc b fv lg lh l li lj"><a class="ae jo" rel="noopener" href="/@danrobinson/ethereum-is-a-dark-forest-ecc5f0505dff">mempool</a> : The main utility of a mempool, is its ability to store network transactions so that they can be processed later.</span><span id="d73a" class="jp jq ht lc b fv lk lh l li lj">Front-Runs: Front Running happens when a attacker manupulate a standard transaction. The Front-Running bot(attacker) searches for victims by scanning transactions in the mempool so an attacker can jump ahead of the trade. </span></pre><figure class="kq kr ks kt fq ku fe ff paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="fe ff ll"><img src="../Images/10abcc15d374b062bc1c5868e984a9f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sSWax95jtC9eUCNLe8FJmQ.png"/></div></div><figcaption class="lm ln fg fe ff lo lp bd b be z ek"><strong class="bd lq">Frontrunning</strong></figcaption></figure><ul class=""><li id="45f0" class="lr ls ht is b it iu ix iy jb lt jf lu jj lv jn lw lx ly lz dt translated">三明治攻击遵循类似的过程:</li></ul><ol class=""><li id="6988" class="lr ls ht is b it iu ix iy jb lt jf lu jj lv jn ma lx ly lz dt translated">检测受害者的交易。</li><li id="87e1" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn ma lx ly lz dt translated">提前处理受害者的交易。</li><li id="d6f4" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn ma lx ly lz dt translated">受害者交易并遭受更高的滑点。</li><li id="b254" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn ma lx ly lz dt translated">攻击者然后从背后袭击受害者。</li></ol><div class="mg mh fm fo mi mj"><a href="https://blog.coincodecap.com/sandwiched-wtf-review" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab ej"><div class="ml ab mm cl cj mn"><h2 class="bd hu fv z el mo eo ep mp er et hs dt translated">wtf:你输给MEV交易者了吗？</h2><div class="mq l"><h3 class="bd b fv z el mo eo ep mp er et ek translated">您是否曾经遇到过这样的情况:您打算在uni WAP/ETH网络上购买令牌，但不知从哪里…</h3></div><div class="mr l"><p class="bd b gc z el mo eo ep mp er et ek translated">blog.coincodecap.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx kz mj"/></div></div></a></div><h2 id="46a7" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj dt translated">Uniswap</h2><p id="4124" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hm dt translated">让我们用一个例子来理解市场是如何运作的。</p><ul class=""><li id="07bf" class="lr ls ht is b it iu ix iy jb lt jf lu jj lv jn lw lx ly lz dt translated"><strong class="is hu">交换马卡尼萨姆:</strong>市场包含一个内部状态，<code class="eh my mz na lc b"><strong class="is hu">PRICE</strong></code>，是当前市场价格。它也有两个参数，<code class="eh my mz na lc b"><strong class="is hu">FEE</strong></code>和<code class="eh my mz na lc b"><strong class="is hu">DEPTH</strong></code>。如果用户想购买<code class="eh my mz na lc b"><strong class="is hu">ORDER_AMOUNT</strong></code>硬币，他们会把价格提高到<code class="eh my mz na lc b"><strong class="is hu">PRICE + ORDER_AMOUNT / DEPTH</strong></code>，然后付款</li></ul><pre class="kq kr ks kt fq lb lc ld le aw lf dt"><span id="cfd3" class="jp jq ht lc b fv lg lh l li lj">ORDER_AMOUNT * (PRICE + ORDER_AMOUNT / DEPTH / 2) * (1 + FEE)<!-- -->.</span></pre><p id="b84e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">本质上，这构成了在旧价格和新价格之间的每个价格点购买无限数量的硬币。</p><ul class=""><li id="5120" class="lr ls ht is b it iu ix iy jb lt jf lu jj lv jn lw lx ly lz dt translated"><strong class="is hu"> Uniswap: </strong> Uniswap方程特征是<code class="eh my mz na lc b">r0 * r1 = k</code>一个方程，其中<code class="eh my mz na lc b">r_i</code>是Uniswap池的储量。Uniswap对每笔交易的投入金额收取0.3%的费用。</li><li id="2f67" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" href="https://github.com/Uniswap/uniswap-v2-core/blob/master/contracts/UniswapV2Pair.sol#L182" rel="noopener ugc nofollow" target="_blank"> Uniswap贸易方程式</a></li><li id="4db7" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated">三明治攻击包括用购买相同资产的交易抢先受害者交易。获得的代币在受害者交易后再次出售。</li></ul><h2 id="ab2b" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj dt translated"><strong class="ak">什么构成了三明治攻击:</strong></h2><p id="4e26" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hm dt translated">让我们仔细看看，分析是什么造成了三明治攻击。</p><ul class=""><li id="ab50" class="lr ls ht is b it iu ix iy jb lt jf lu jj lv jn lw lx ly lz dt translated"><strong class="is hu">自动做市商(AMM): </strong>这是一个预定义的定价算法，根据流动性池中的资产自动执行价格发现和做市。AMM允许流动性提供者观察和跟踪市场，然后设定买价和卖价。流动性接受者反过来与AMM进行交易。</li><li id="44cc" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><strong class="is hu">价格滑移:</strong>价格滑移是交易过程中资产价格的变化。预期价格滑移是基于交易量和可用流动性的预期价格上涨或下跌，在交易开始时形成预期。</li></ul><p id="a6e3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">“意外价格滑动是指价格的上涨或下跌。在交易过程中由于某种未知或不可预测的原因`。</p><ul class=""><li id="940e" class="lr ls ht is b it iu ix iy jb lt jf lu jj lv jn lw lx ly lz dt translated"><strong class="is hu">预期执行价格:</strong>当流动性接受者在X/Y发布交易时，接受者希望以预期执行价格(基于AMM算法和X/Y状态)执行交易，给定预期滑点。</li><li id="c403" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><strong class="is hu">意外价格滑移:</strong>执行价格与预期执行价格之间的差异。</li><li id="50f9" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><strong class="is hu">意外滑点率:</strong>超出预期价格的意外滑点。</li></ul><h2 id="ef21" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj dt translated"><strong class="ak">总结</strong></h2><p id="329b" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hm dt translated">你可以理解三明治攻击的一般工作原理。所以在我看来，机器人或攻击者分析内存池中的事务来决定是否发起攻击。所以最好加密交易细节。</p><p id="b3f8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> zk-SNARKs: </strong>社区中有人提议使用zk-SNARKs，一种零知识证明技术来实现这个目标。换句话说，zk-SNARKs将用于加密和隐藏每笔交易的信息，因此机器人对此无能为力。</p><p id="3553" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然而，这种方法不足以控制这种类型的攻击，因为它具有诸如高Gas成本的缺点，并且它可能被用来执行阻塞攻击，从而导致整体活跃度的降低。</p><p id="dd06" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">目前的情景仍然是R&amp;D在区块链mempool为这种攻击进行辩护的工作。</p><p id="178a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">参考:</strong></p><ul class=""><li id="6948" class="lr ls ht is b it iu ix iy jb lt jf lu jj lv jn lw lx ly lz dt translated"><a class="ae jo" href="https://uniswap.org/docs/v2/smart-contract-integration/trading-from-a-smart-contract/" rel="noopener ugc nofollow" target="_blank">https://unis WAP . org/docs/v2/smart-contract-integration/trading-from-a-smart-contract/</a></li><li id="534f" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated">【https://cmichel.io/de-fi-sandwich-attacks/ T2】号</li><li id="18b6" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" href="https://www.semanticscholar.org/paper/High-Frequency-Trading-on-Decentralized-On-Chain-Zhou-Qin/3baaa599187dddadf085ed6c43141874d4189c51" rel="noopener ugc nofollow" target="_blank">https://www . semantic scholar . org/paper/High-Frequency-Trading-On-Decentralized-On-Chain-Zhou-Qin/3 baaa 599187 dddadf 085 ed 6 c 43141874d 4189 c 51</a></li></ul><blockquote class="nb"><p id="a23b" class="nc nd ht bd ne nf ng nh ni nj nk jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jo" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="jp jq ht bd jr js nl ju jv jw nm jy jz jb nn kb kc jf no ke kf jj np kh ki kj dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="lr ls ht is b it kk ix kl jb nq jf nr jj ns jn lw lx ly lz dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae jo" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae jo" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="f33b" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae jo" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated">开发人员的最佳加密API</li><li id="b359" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated">最佳<a class="ae jo" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币</a>终极指南</li><li id="f1ee" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" href="https://coincodecap.com/zero-fee-crypto-exchanges" rel="noopener ugc nofollow" target="_blank"> 7个最佳零费用加密交换平台</a></li><li id="5aa5" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" href="https://coincodecap.com/best-online-casinos" rel="noopener ugc nofollow" target="_blank">最佳网上赌场</a> | <a class="ae jo" rel="noopener" href="/coinmonks/futures-trading-bots-5a282ccee3f5">期货交易机器人</a></li><li id="3d0e" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" href="https://coincodecap.com/what-are-decentralized-exchanges" rel="noopener ugc nofollow" target="_blank">分散交易所</a> | <a class="ae jo" href="https://coincodecap.com/bitbns-fip" rel="noopener ugc nofollow" target="_blank">比特FIP </a></li><li id="5cf9" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" href="https://coincodecap.com/buy-crypto-with-credit-card" rel="noopener ugc nofollow" target="_blank">用信用卡购买密码的10个最佳地点</a></li><li id="3d13" class="lr ls ht is b it mb ix mc jb md jf me jj mf jn lw lx ly lz dt translated"><a class="ae jo" href="https://coincodecap.com/5-best-crypto-trading-bots-in-canada" rel="noopener ugc nofollow" target="_blank">加拿大最佳加密交易机器人</a> | <a class="ae jo" href="https://coincodecap.com/bybit-binance-moonxbt" rel="noopener ugc nofollow" target="_blank"> Bybit vs币安</a></li></ul></div></div>    
</body>
</html>