<html>
<head>
<title>Understanding Structs in solidity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解固体中的结构</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/understanding-structs-in-solidity-3910905c38c3?source=collection_archive---------2-----------------------#2021-07-11">https://medium.com/coinmonks/understanding-structs-in-solidity-3910905c38c3?source=collection_archive---------2-----------------------#2021-07-11</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/08f993900cba2973f871271d1ba62381.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*ny8LbIAqwOxu0UNQRVnfkg.jpeg"/></div></figure><p id="b350" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">使用Struct可以在Solidity中定义自定义类型。它可以由几个变量组成。</p><p id="2dbb" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">您可以查看https://docs.soliditylang.org/en/v0.6.8/types.html? solidity @<a class="ae jv" href="https://docs.soliditylang.org/en/v0.6.8/types.html?highlight=struct#structs" rel="noopener ugc nofollow" target="_blank">官方文件中的参考文件突出显示=结构#结构</a></p><p id="fc0e" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">示例:</p><pre class="jw jx jy jz fq ka kb kc kd aw ke dt"><span id="830e" class="kf kg ht kb b fv kh ki l kj kk">struct User {<br/>    uint level;<br/>    uint status;<br/>}</span><span id="ab4f" class="kf kg ht kb b fv kl ki l kj kk">mapping(address =&gt; User) public userList;</span><span id="ef15" class="kf kg ht kb b fv kl ki l kj kk">User userDetail = User(1, 1);<br/></span><span id="e665" class="kf kg ht kb b fv kl ki l kj kk">function updateUserLevel(uint userLevel) public { <br/>    userDetail.level = userLevel;<br/>}</span><span id="a63e" class="kf kg ht kb b fv kl ki l kj kk">function getUserDetail(address userAddress) public returns (User memory) {<br/>    return userList[userAddress];<br/>}</span></pre><p id="abb6" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">代码的完整工作示例可以在@ <a class="ae jv" href="https://gist.github.com/sagarduwal/71ab106116372057ffcc87d6efaf8f94" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="2c62" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在上面的例子中，我们已经创建了一个结构<code class="eh km kn ko kb b">User</code>，并使用<code class="eh km kn ko kb b">User</code>作为类型创建了变量<code class="eh km kn ko kb b">userDetail</code>，并将其用作变量的类型。</p><p id="21e2" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们已经使用关键字<code class="eh km kn ko kb b">struct</code>在Solidity中定义了struct数据类型，以及在花括号中定义的struct名称和变量名。</p><pre class="jw jx jy jz fq ka kb kc kd aw ke dt"><span id="2b3e" class="kf kg ht kb b fv kh ki l kj kk">struct StructName {<br/>    string name;<br/>    uint value;<br/>}</span></pre><p id="9a0a" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在上面的代码中，我们在第` User userDetail = User(1，1)行中定义了struct'这是定义struct的最短方法。</p><p id="4f83" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们也可以用其他方式定义struct。</p><pre class="jw jx jy jz fq ka kb kc kd aw ke dt"><span id="9ea6" class="kf kg ht kb b fv kh ki l kj kk">function createUserRecord (address userAddress_, uint level_, uint status_) public {<br/>    User storage newRecord = userList[userAddress];<br/>    newRecord.level = level_;<br/>    newRecord.status = status_;<br/>}</span><span id="4b8d" class="kf kg ht kb b fv kl ki l kj kk">function createUserRecordTwo (address userAddress_, uint level_, uint status_) public {<br/>    userList[userAddress_] = User({<br/>        level : level_,   status : status_<br/>    });<br/>}</span></pre><p id="8369" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">所以，以上是另外两种使用struct和create object的方法，并且是在<code class="eh km kn ko kb b">userList</code>中设置的映射(这一点我们将在另一个教程中看到)。</p><p id="484d" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">注意</strong>:带结构的完整代码示例可以在这里找到<a class="ae jv" href="https://gist.github.com/sagarduwal/65795273b0b2cc514169d2f2b39605cd#file-structexamplefull-sol" rel="noopener ugc nofollow" target="_blank"><strong class="iz hu">structexamplefull . sol</strong></a></p><p id="0620" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">使用Struct有一些限制，</p><ul class=""><li id="980d" class="kp kq ht iz b ja jb je jf ji kr jm ks jq kt ju ku kv kw kx dt translated">函数不能返回结构数据，除非其内部函数调用</li><li id="7041" class="kp kq ht iz b ja ky je kz ji la jm lb jq lc ju ku kv kw kx dt translated"><code class="eh km kn ko kb b">struct</code>不能递归ie。结构内部的结构类型相同</li></ul><pre class="jw jx jy jz fq ka kb kc kd aw ke dt"><span id="4b06" class="kf kg ht kb b fv kh ki l kj kk">struct User {<br/>    uint level;<br/>    uint status;<br/>    User refererUser; // this will return error since recursive<br/>}</span></pre></div></div>    
</body>
</html>