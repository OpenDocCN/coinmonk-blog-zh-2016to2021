<html>
<head>
<title>Building an Algorithmic Trading Strategy with Enigma Catalyst</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Enigma Catalyst构建算法交易策略</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/building-an-algorithmic-trading-strategy-with-enigma-catalyst-1a407e9c02f8?source=collection_archive---------3-----------------------#2018-05-29">https://medium.com/coinmonks/building-an-algorithmic-trading-strategy-with-enigma-catalyst-1a407e9c02f8?source=collection_archive---------3-----------------------#2018-05-29</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/122c6007d50317f34300d0212e785e0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x5pLaIKaZqbMknhJ."/></div></div></figure><div class=""/><div class=""><h2 id="6e98" class="pw-subtitle-paragraph jb id ie bd b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ek translated">向您介绍Enigma项目，并使用Catalyst构建自动化交易策略。</h2></div><h1 id="637f" class="jt ju ie bd jv jw jx jy jz ka kb kc kd jk ke jl kf jn kg jo kh jq ki jr kj kk dt translated">英格玛简介</h1><p id="920a" class="pw-post-body-paragraph kl km ie kn b ko kp jf kq kr ks ji kt ku kv kw kx ky kz la lb lc ld le lf lg hm dt lh translated">当前形式的锁链不能很好地保护隐私。每个人都可以查看存储在区块链上的数据——这是彻底透明的副作用。虽然这仍然比当前的数据模型(下面我总结了它的问题)要好，但有些数据就是不适合展示。</p><p id="3e16" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated"><em class="lv">当前模型的问题:</em></p><ul class=""><li id="4039" class="lw lx ie kn b ko lq kr lr ku ly ky lz lc ma lg mb mc md me dt translated"><strong class="kn if">没有隐私</strong> ~盗窃(黑客)，出售给其他方等。</li><li id="0c1a" class="lw lx ie kn b ko mf kr mg ku mh ky mi lc mj lg mb mc md me dt translated"><strong class="kn if">自然收入损失</strong> ~您的数据是一种自然资源</li><li id="1baf" class="lw lx ie kn b ko mf kr mg ku mh ky mi lc mj lg mb mc md me dt translated"><strong class="kn if">敏感产品问题</strong> ~有些数据是极其私人的</li><li id="4a68" class="lw lx ie kn b ko mf kr mg ku mh ky mi lc mj lg mb mc md me dt translated"><strong class="kn if">聚合力</strong> ~大公司基本上拥有我们所有的数据</li></ul><p id="d074" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">机器学习，尤其是深度学习，给了我们对数据的洞察力，这是非常宝贵的。随着我们计算能力的快速增长，以及数据的巨大增长，现在是训练这些模型的最佳时机。深度学习正在重塑几乎所有行业:</p><figure class="ml mm mn mo fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff mk"><img src="../Images/26e95facc39fbe10589d11657af1abe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBaVRB1YxRZUstTsCbe_yg.png"/></div></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">Industries disrupted by Deep Learning [Source: <a class="ae mt" href="https://uploads-ssl.webflow.com/57c954d37d70832a623199f5/5ae0a4cd0391ea70216558ae_Insight_AI_White_Paper_Apr2018.pdf" rel="noopener ugc nofollow" target="_blank">Insight AI whitepaper</a>]</figcaption></figure><p id="1936" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">需要一种新的方式来存储我们的个人数据，解决我上面提到的4个主要问题，机器学习模型仍然可以在其上训练，这是巨大的。这就是谜语的由来。</p><p id="ec30" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">Enigma是一个<em class="lv">分散的计算平台，具有保密保证</em>。数据可以存储在公共区块链(非敏感数据，如ENG令牌交易)或私有Enigma网络(敏感数据，如医疗日志)上。私有的Enigma网络架构不是区块链，而是一个分布式哈希表，也是星际文件系统(IPFS)的一个重要部分。在这里阅读<a class="ae mt" rel="noopener" href="/coinmonks/a-hands-on-introduction-to-ipfs-ee65b594937"><em class="lv"/></a>。你拥有你的数据，所以本质上，如果一家大公司想要训练一个模型(比如定向广告模型)，你会把你的数据卖给那家公司，让他们使用。由于Enigma的<em class="lv">安全多方计算</em>，对敏感数据的计算仍然是可能的。如果你想了解更多关于Enigma的信息，请阅读他们的白皮书。</p><h1 id="b315" class="jt ju ie bd jv jw jx jy jz ka kb kc kd jk ke jl kf jn kg jo kh jq ki jr kj kk dt translated">催化剂</h1><blockquote class="mu mv mw"><p id="c7c7" class="kl km lv kn b ko lq jf kq kr lr ji kt mx ls kw kx my lt la lb mz lu le lf lg hm dt translated">受加密资产的快速增长和扩散的启发，我们提出了Catalyst——第一个使开发者能够构建、测试和执行微型加密基金的投资平台。</p></blockquote><p id="05d0" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">这段摘录来自<a class="ae mt" href="https://enigma.co/enigma_catalyst.pdf" rel="noopener ugc nofollow" target="_blank"> Catalyst白皮书</a>，它很好地总结了他们的目标。<em class="lv"> Catalyst是英格玛协议</em>的第一个应用，因为驱动平台的加密数据来自英格玛分散数据市场。</p><p id="c5d3" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">它的目标是为量化交易者提供一站式服务，测试他们在加密资产领域的策略。它还旨在成为一个平台，人们可以在这个平台上从Catalyst开发者那里购买策略。Python软件开发工具包是一个基于<a class="ae mt" href="http://www.zipline.io/index.html" rel="noopener ugc nofollow" target="_blank"> Zipline </a>的引擎，其中的策略可以进行回溯测试或实时交易。</p><h1 id="74f7" class="jt ju ie bd jv jw jx jy jz ka kb kc kd jk ke jl kf jn kg jo kh jq ki jr kj kk dt translated">制定战略</h1><p id="13ff" class="pw-post-body-paragraph kl km ie kn b ko kp jf kq kr ks ji kt ku kv kw kx ky kz la lb lc ld le lf lg hm dt translated">第一步是在您的系统上安装Catalyst。遵循他们的文档提供的<a class="ae mt" href="https://enigma.co/catalyst/install.html" rel="noopener ugc nofollow" target="_blank">指南<em class="lv">这里</em>这里</a>。</p><p id="6d7d" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">我们将建立一个简单的策略，利用相对强弱指数。这是一个动量指标，表示价格变动的强度。逻辑是这样的:</p><ul class=""><li id="4d21" class="lw lx ie kn b ko lq kr lr ku ly ky lz lc ma lg mb mc md me dt translated">如果我们没有仓位，RSI超卖(≤ 30)，做多</li><li id="d18f" class="lw lx ie kn b ko mf kr mg ku mh ky mi lc mj lg mb mc md me dt translated">如果我们做多，RSI达到60，平仓</li><li id="e86b" class="lw lx ie kn b ko mf kr mg ku mh ky mi lc mj lg mb mc md me dt translated">如果我们没有持仓，RSI超买(≥ 70)，做空</li><li id="471f" class="lw lx ie kn b ko mf kr mg ku mh ky mi lc mj lg mb mc md me dt translated">如果我们处于空头头寸，RSI达到40，做空</li></ul><p id="02dd" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">这些随机的出场位置数字(短40，长60)是任意选择的。这是为了确保一旦RSI回调，策略实际上可以退出头寸。你可以尝试的一件事是优化这些值以获得最大利润。<em class="lv">不像那样会一整批</em>。</p><p id="f62c" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">这是Python中完整策略的样子，我们将一部分一部分地分解它:</p><figure class="ml mm mn mo fq hv"><div class="bz el l di"><div class="na nb l"/></div></figure><p id="5e48" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">我建议只复制第1行到第12行。这基本上是任何策略的框架(以及初始化、处理数据和分析),我不会深入讨论这些。</p><p id="e316" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">如果我用catalyst.run_algorithm函数运行这个算法(提供正确的参数)，这就是输出。第一张图是我们的投资组合价值，第二张图是价格，买卖显示为箭头。第三张图绘制了RSI，最后一张图显示了我们相对于只持有资产(橙色)的百分比收益(蓝色)。感谢我们的<em class="lv">分析</em>功能。</p><figure class="ml mm mn mo fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff nc"><img src="../Images/ecc5132b73190201fc1a3fe2bfbdfc3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O9KiTGnj3K6KOuS-TomnIw.png"/></div></div></figure><p id="a740" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">现在我们来分解一下。每个Catalyst算法都需要定义这两个函数:</p><ul class=""><li id="b75c" class="lw lx ie kn b ko lq kr lr ku ly ky lz lc ma lg mb mc md me dt translated"><code class="eh nd ne nf ng b">initialize(context)</code></li><li id="f11b" class="lw lx ie kn b ko mf kr mg ku mh ky mi lc mj lg mb mc md me dt translated"><code class="eh nd ne nf ng b">handle_data(context, data)</code></li></ul><p id="1711" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">先说<code class="eh nd ne nf ng b">initialize</code>。当你运行一个算法时，Catalyst调用<code class="eh nd ne nf ng b">initialize</code>函数并把<code class="eh nd ne nf ng b">context</code>作为参数传入。该参数可用于存储需要通过不同迭代在不同函数中使用的变量。在第3行，我们创建了一个存储在<code class="eh nd ne nf ng b">context</code>中的变量<code class="eh nd ne nf ng b">asset</code>。要从Catalyst库中获取货币对，您需要使用<code class="eh nd ne nf ng b">symbol</code>函数并传入相关数据。<code class="eh nd ne nf ng b">context.i</code>是一个跟踪迭代的变量，而<code class="eh nd ne nf ng b">context.base_price</code>将存储资产的初始价格。</p><figure class="ml mm mn mo fq hv"><div class="bz el l di"><div class="na nb l"/></div></figure><p id="7981" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">算法初始化后，根据<code class="eh nd ne nf ng b">run_algorithm</code>中指定的时间范围，每<em class="lv">分钟</em>或<em class="lv">天</em>调用一次<code class="eh nd ne nf ng b">handle_data</code>函数。在我们的例子中，那是<em class="lv">分钟</em>。传入的是同一个<code class="eh nd ne nf ng b">context</code>变量，以及一个名为<code class="eh nd ne nf ng b">data</code>的对象，该对象在每次迭代中都会更新，包含我们定义的资产的当前交易棒线，包括开盘价、最高价、最低价、收盘价和成交量。</p><p id="564c" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">这个函数才是真正有趣的地方。我们将从定义RSI的周期开始，在大多数情况下是14。接下来，我们将把迭代次数<code class="eh nd ne nf ng b">context.i</code>增加1。记住，这个函数每分钟调用一次，不需要循环。一旦我们有了足够的数据来实际计算RSI，也就是14个数据点，我们就可以移到第9行了。</p><p id="eea9" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">这里我们将利用<code class="eh nd ne nf ng b">data</code>对象，对其调用<code class="eh nd ne nf ng b">history</code>。根据我们如何定义参数，这将返回许多数据点。通过<code class="eh nd ne nf ng b">frequency</code>，我们定义了一根棒线包含多少时间帧(在本例中为分钟)。这意味着我们将计算30分钟图的RSI。</p><p id="ac69" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">下一步是计算RSI。在Python中是这样做的。如果您想了解更多关于RSI如何计算的信息，请阅读<a class="ae mt" href="https://en.wikipedia.org/wiki/Relative_strength_index" rel="noopener ugc nofollow" target="_blank">本</a>。在第27行上，我们称<code class="eh nd ne nf ng b">current</code>价格为<code class="eh nd ne nf ng b">data</code>对象。这样我们就可以通过一个每分钟都会更新的简单变量来访问它。在第29行上，我们使用<code class="eh nd ne nf ng b">context.base_price</code>变量得到第一根蜡烛的价格作为参考。<strong class="kn if">第32行</strong>计算价格变化，我们以后可以用它作为基准。在<strong class="kn if">第34行</strong>中，我们使用了一个名为<code class="eh nd ne nf ng b">record</code>的函数。这创建了一个性能<code class="eh nd ne nf ng b">perf</code>数据帧，我们稍后可以在<code class="eh nd ne nf ng b">analyze</code>函数中调用它来进行性能分析。在第39到45行我们检查状态；我们在订单完成之前不会交易，如果现在不能交易，我们会更新状态。接下来，在<strong class="kn if">行47 </strong>上，位置量存储在源于<code class="eh nd ne nf ng b">context.portfolio</code>对象的变量中。</p><p id="2248" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">在<code class="eh nd ne nf ng b">handle_data</code>的最后部分，策略逻辑被确定。算法现在准备好了。</p><figure class="ml mm mn mo fq hv"><div class="bz el l di"><div class="na nb l"/></div></figure><p id="792a" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">最后一个函数<code class="eh nd ne nf ng b">analyze</code>创建了几个图，从中我们可以看到我们的策略的性能。这个我就不深究了。</p><p id="5f78" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">算法现在可以进行回溯测试了。因为我们在脚本的末尾进行了<code class="eh nd ne nf ng b">run_algorithm</code>调用，所以我们可以使用<code class="eh nd ne nf ng b">python &lt;filename.py&gt;</code>从命令行运行它。确保首先使用命令行中的<code class="eh nd ne nf ng b">source activate catalyst</code>激活Catalyst环境，并使用<code class="eh nd ne nf ng b">catalyst ingest-exchange -x bitfinex -i btc_usd -f minute</code>接收交换数据。后者将在您的系统中保留bitfinex价格数据的记录。</p><figure class="ml mm mn mo fq hv"><div class="bz el l di"><div class="na nb l"/></div></figure><p id="39d8" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">你现在应该看到你的业绩图表弹出，并看到你的利润或损失！如果你想更深入地了解Catalyst，并且一旦你有了好的算法，正在考虑实时交易，请阅读他们广泛的文档<a class="ae mt" href="https://enigma.co/catalyst/beginner-tutorial.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="c093" class="pw-post-body-paragraph kl km ie kn b ko lq jf kq kr lr ji kt ku ls kw kx ky lt la lb lc lu le lf lg hm dt translated">感谢你的阅读，并考虑关注更多类似的故事。</p></div></div>    
</body>
</html>