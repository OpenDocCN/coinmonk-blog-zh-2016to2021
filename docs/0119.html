<html>
<head>
<title>Geth on Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android上的Geth</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/geth-on-android-f6392fe81434?source=collection_archive---------1-----------------------#2018-02-25">https://medium.com/coinmonks/geth-on-android-f6392fe81434?source=collection_archive---------1-----------------------#2018-02-25</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="5fde" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们学习如何运行一个Geth节点，并在原生Android应用程序中与之交互。我们将启动一个Geth节点，创建一个新的Ethereum帐户，并将有关该帐户的信息安全地存储在设备上。如果你想简单了解以太坊移动世界，以太坊的Github上有相关信息:</p><div class="jo jp fm fo jq jr"><a href="https://github.com/ethereum/go-ethereum/wiki/Mobile:-Introduction" rel="noopener  ugc nofollow" target="_blank"><div class="js ab ej"><div class="jt ab ju cl cj jv"><h2 class="bd hu fv z el jw eo ep jx er et hs dt translated">以太坊/围棋以太坊</h2><div class="jy l"><h3 class="bd b fv z el jw eo ep jx er et ek translated">以太坊-以太坊协议的官方go实现</h3></div><div class="jz l"><p class="bd b gc z el jw eo ep jx er et ek translated">github.com</p></div></div><div class="ka l"><div class="kb l kc kd ke ka kf kg jr"/></div></div></a></div><p id="efd9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您可以在我的Github上找到与本文相关的所有代码:</p><div class="jo jp fm fo jq jr"><a href="https://github.com/drkhannah/GethAndroid" rel="noopener  ugc nofollow" target="_blank"><div class="js ab ej"><div class="jt ab ju cl cj jv"><h2 class="bd hu fv z el jw eo ep jx er et hs dt translated">drkhannah/GethAndroid</h2><div class="jy l"><h3 class="bd b fv z el jw eo ep jx er et ek translated">原生Android上的GethAndroid - Geth节点</h3></div><div class="jz l"><p class="bd b gc z el jw eo ep jx er et ek translated">github.com</p></div></div><div class="ka l"><div class="kh l kc kd ke ka kf kg jr"/></div></div></a></div></div><div class="ab cl ki kj hb kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hm hn ho hp hq"><h1 id="ef7a" class="kp kq ht bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">在你的应用构建中获得Geth依赖。格雷德</h1><p id="e226" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hm dt translated">您首先需要将Geth作为一个依赖项添加到您的应用程序的<strong class="is hu">版本中。格雷德</strong>。</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="ecfa" class="mb kq ht lx b fv mc md l me mf">// Your App's build.gradle</span><span id="760b" class="mb kq ht lx b fv mg md l me mf">dependencies {<br/>    ...<strong class="lx hu"><br/><br/>    </strong><em class="mh">// Geth<br/>    </em>compile <strong class="lx hu">'org.ethereum:geth:1.7.3'</strong>;<br/>}</span></pre><p id="d50e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们还将连接到互联网，因此请确保您的应用在其<strong class="is hu"> AndroidManifest.xml </strong>文件中获得使用互联网的权限</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="e015" class="mb kq ht lx b fv mc md l me mf">// AndroidManifest.xml</span><span id="a9c8" class="mb kq ht lx b fv mg md l me mf">&lt;<strong class="lx hu">uses-permission android:name="android.permission.INTERNET" </strong>/&gt;</span></pre><h1 id="05e2" class="kp kq ht bd kr ks mi ku kv kw mj ky kz la mk lc ld le ml lg lh li mm lk ll lm dt translated">在单例中保存第一个节点:</h1><p id="3cc2" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hm dt translated">你需要做的第一件事是在“主”以太网上启动一个Geth节点。该节点需要在应用程序的整个生命周期中保持活动和运行，因此我们将在单例中保存节点实例。在开始节点本身之前，让我们先创建我们的单例。你会在我在本文顶部链接的项目代码中看到，我已经创建了一个<strong class="is hu">GethNodeHolder.java</strong>类，这是我们的单例。</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="1dce" class="mb kq ht lx b fv mc md l me mf">// GethNodeHolder.java</span><span id="7ef9" class="mb kq ht lx b fv mg md l me mf"><strong class="lx hu">public class </strong>GethNodeHolder {<br/><br/>    <strong class="lx hu">private </strong>Node <strong class="lx hu">node</strong>;<br/>    <strong class="lx hu">private </strong>Account <strong class="lx hu">account</strong>;<br/>    <strong class="lx hu">private static </strong>GethNodeHolder <em class="mh">instance </em>= <strong class="lx hu">null</strong>;<br/><br/>    <strong class="lx hu">private </strong>GethNodeHolder() {<br/>    }<br/><br/>    <strong class="lx hu">public static </strong>GethNodeHolder getInstance() {<br/>        <strong class="lx hu">if </strong>(<em class="mh">instance </em>== <strong class="lx hu">null</strong>) {<br/>            <em class="mh">instance </em>= <strong class="lx hu">new </strong>GethNodeHolder();<br/>        }<br/>        <strong class="lx hu">return </strong><em class="mh">instance</em>;<br/>    }<br/><br/>    <strong class="lx hu">public </strong>Node getNode() {<br/>        <strong class="lx hu">return node</strong>;<br/>    }<br/><br/>    <strong class="lx hu">public void </strong>setNode(Node node) {<br/>        <strong class="lx hu">this</strong>.<strong class="lx hu">node </strong>= node;<br/>    }<br/><br/>    <strong class="lx hu">public </strong>Account getAccount() {<br/>        <strong class="lx hu">return account</strong>;<br/>    }<br/><br/>    <strong class="lx hu">public void </strong>setAccount(Account account) {<br/>        <strong class="lx hu">this</strong>.<strong class="lx hu">account </strong>= account;<br/>    }<br/><br/>}</span></pre><p id="1f30" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个singleton不仅有方法来<strong class="is hu">设置</strong>和<strong class="is hu">获取</strong>一个Geth节点，而且还有方法来设置和<strong class="is hu">获取</strong>一个我们将在节点启动并运行后创建的以太坊帐户。</p><h1 id="7059" class="kp kq ht bd kr ks mi ku kv kw mj ky kz la mk lc ld le ml lg lh li mm lk ll lm dt translated"><strong class="ak">启动一个Geth节点</strong></h1><p id="fee4" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hm dt translated">让我们在<strong class="is hu">MainActivity.java</strong>文件的<strong class="is hu"> onCreate() </strong>方法中开始一个Geth节点。</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="f25c" class="mb kq ht lx b fv mc md l me mf">// MainActivity.java </span><span id="f088" class="mb kq ht lx b fv mg md l me mf">@Override<br/><strong class="lx hu">protected void </strong>onCreate(Bundle savedInstanceState) {<br/>    <strong class="lx hu">super</strong>.onCreate(savedInstanceState);<br/>    setContentView(R.layout.<strong class="lx hu"><em class="mh">activity_main</em></strong>);<br/><br/>    <strong class="lx hu">try </strong>{<br/>        NodeConfig nc = <strong class="lx hu">new </strong>NodeConfig();<br/>        Node node = Geth.<em class="mh">newNode</em>(getFilesDir() + <strong class="lx hu">"/.ethNode"</strong>, nc);<br/>        node.start();<br/><br/>        GethNodeHolder gethNode = GethNodeHolder.<em class="mh">getInstance</em>();<br/>        gethNode.setNode(node);<br/><br/>    } <strong class="lx hu">catch </strong>(Exception e) {<br/>        Log.<em class="mh">e</em>(<strong class="lx hu">"error: "</strong>, e.getMessage());<br/>        e.printStackTrace();<br/>    }<br/>}</span></pre><p id="0bc4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要创建一个Geth节点，首先需要将一个<strong class="is hu"> NodeConfig </strong>传递给Geth的<strong class="is hu"> newNode() </strong>方法。<strong class="is hu"> newNode() </strong>方法创建一个新的Geth节点，并将其<strong class="is hu"> NodeConfig </strong>存储在应用程序默认文件系统的一个名为<strong class="is hu"> "ethNode" </strong>的文件中。然后我们通过调用它的<strong class="is hu"> start() </strong>方法来启动节点。这将启动节点并将其连接到“主”以太网</p><p id="62fb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">一旦节点被启动，我们就获得我们的<strong class="is hu">GethNodeHolder</strong>singleton的一个实例，并调用它的<strong class="is hu"> setNode() </strong>方法，传入我们新启动的节点。这确保了节点将被存储在我们的<strong class="is hu">GethNodeHolder</strong>singleton中，并在应用程序的整个生命周期中保持活跃。</p><h1 id="a34c" class="kp kq ht bd kr ks mi ku kv kw mj ky kz la mk lc ld le ml lg lh li mm lk ll lm dt translated"><strong class="ak">在“主”网络上创建一个新的以太坊账户</strong></h1><p id="fe0e" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hm dt translated">现在我们已经启动了一个节点，让我们通过在“主”以太网上创建一个新的以太网帐户来与它交互。我们将使用加密的<strong class="is hu"> Geth </strong> <strong class="is hu">密钥库</strong>将该账户的信息安全地存储在设备上。我们还将创建一个非常简单的用户界面，带有一个创建新帐户的按钮。让我们先看看UI部分。这只是一个简单的按钮，它将调用一个<strong class="is hu"> createAccount() </strong>方法，我们稍后将定义这个方法。它还有一个文本视图，稍后将显示新创建的帐户的地址。</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="7478" class="mb kq ht lx b fv mc md l me mf">// activity_main.xml</span><span id="8a09" class="mb kq ht lx b fv mg md l me mf"><em class="mh">&lt;?</em><strong class="lx hu">xml version="1.0" encoding="utf-8"</strong><em class="mh">?&gt;<br/></em>&lt;<strong class="lx hu">android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:app="http://schemas.android.com/apk/res-auto"<br/>    xmlns:tools="http://schemas.android.com/tools"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"<br/>    tools:context="software.toybox.derek.geth.MainActivity"</strong>&gt;<br/><br/>    &lt;<strong class="lx hu">Button<br/>        android:id="@+id/create_acc_btn"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:onClick="createAccount"<br/>        android:text="Create Account"<br/>        app:layout_constraintBottom_toTopOf="@+id/acc_display_textview"<br/>        app:layout_constraintEnd_toEndOf="parent"<br/>        app:layout_constraintHorizontal_bias="0.5"<br/>        app:layout_constraintStart_toStartOf="parent"<br/>        app:layout_constraintTop_toTopOf="parent" </strong>/&gt;<br/><br/>    &lt;<strong class="lx hu">TextView<br/>        android:id="@+id/acc_display_textview"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:text="Account Display"<br/>        app:layout_constraintBottom_toBottomOf="parent"<br/>        app:layout_constraintEnd_toEndOf="parent"<br/>        app:layout_constraintHorizontal_bias="0.5"<br/>        app:layout_constraintStart_toStartOf="parent"<br/>        app:layout_constraintTop_toBottomOf="@+id/create_acc_btn" </strong>/&gt;<br/><br/>&lt;/<strong class="lx hu">android.support.constraint.ConstraintLayout</strong>&gt;</span></pre><p id="9082" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来让我们看看当用户点击<strong class="is hu">“创建帐户”</strong>按钮时调用的<strong class="is hu"> createAccount() </strong>方法。</p><pre class="ls lt lu lv fq lw lx ly lz aw ma dt"><span id="61d6" class="mb kq ht lx b fv mc md l me mf">// MainActivity.java</span><span id="897e" class="mb kq ht lx b fv mg md l me mf"><strong class="lx hu">public void </strong>createAccount(View button) {<br/><br/>    <strong class="lx hu">try </strong>{<br/>        GethNodeHolder gethNodeHolder = GethNodeHolder.<em class="mh">getInstance</em>();<br/>        Node gethNode = gethNodeHolder.getNode();<br/><br/>        <strong class="lx hu">if </strong>(gethNode != <strong class="lx hu">null</strong>) {<br/><br/>            KeyStore ks = <strong class="lx hu">new </strong>KeyStore(getFilesDir() + <strong class="lx hu">"/keystore"</strong>, Geth.<strong class="lx hu"><em class="mh">LightScryptN</em></strong>, Geth.<strong class="lx hu"><em class="mh">LightScryptP</em></strong>);<br/>            Account newAccount = ks.newAccount(<strong class="lx hu">"Password"</strong>);<br/><br/>            Log.<em class="mh">d</em>(<strong class="lx hu">"account address: "</strong>, newAccount.getAddress().getHex());<br/>            gethNodeHolder.setAccount(newAccount);<br/><br/>            Account account = gethNodeHolder.getAccount();<br/>            <strong class="lx hu">accDisplayTextView</strong>.setText(<strong class="lx hu">"Here is your Account Address: " </strong>+ account.getAddress().getHex());<br/>        }<br/>    } <strong class="lx hu">catch </strong>(Exception e) {<br/>        Log.<em class="mh">d</em>(<strong class="lx hu">"error: "</strong>, e.getMessage());<br/>        e.printStackTrace();<br/>    }<br/>}</span></pre><p id="bafb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">该方法首先获取<strong class="is hu">GethNodeHolder</strong>singleton，然后获取我们在其中设置的节点。然后它创建一个<strong class="is hu">新的KeyStore() </strong>实例，这是一个安全的<strong class="is hu"> Geth Keystore </strong>来保存设备上的帐户信息。第一个参数是希望在设备上创建密钥库文件的路径。我们使用应用程序的默认文件目录，并创建一个名为<strong class="is hu"> "/keystore" </strong>的目录。您还将看到传递给<strong class="is hu"> new KeyStore() </strong>构造函数、<strong class="is hu"> Geth的另外两个参数。<em class="mh">light cryptn</em></strong>和<strong class="is hu"> <em class="mh"> </em> Geth。<em class="mh">light cryptp。</em> </strong>这些参数表示我们只想从以太坊区块链下载<em class="mh">标头</em>，这些标头与我们决定存储在这个密钥库中的任何以太坊帐户相关联。然后，我们通过调用<strong class="is hu"> KeyStore </strong>的<strong class="is hu"> newAccount() </strong>方法创建一个新帐户，并向其传递一个硬编码的密码<strong class="is hu">“password”</strong>。现在我们创建了新的帐户，我们调用我们的<strong class="is hu"> GethNodeHolder </strong>的<strong class="is hu"> setAccount() </strong>方法，并将其传递给我们新创建的以太坊帐户。然后为了好玩，我们从<strong class="is hu"> GethNodeHolder </strong>中取回账户(主要是为了演示)。最后，我们向用户显示帐户的地址。</p><h1 id="e0b7" class="kp kq ht bd kr ks mi ku kv kw mj ky kz la mk lc ld le ml lg lh li mm lk ll lm dt translated"><strong class="ak">结论</strong></h1><p id="a38c" class="pw-post-body-paragraph iq ir ht is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hm dt translated">写这篇文章让我意识到在移动设备上使用Geth的文档并不多。这项技术太新了，docs不在那里的最大原因是因为技术本身还不存在。我已经意识到以太坊技术和区块链技术作为一个整体还有很多问题需要解决。</p><p id="9a88" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">不过，我确实发现了一个为Android上的以太坊开发的框架:</p><div class="jo jp fm fo jq jr"><a href="https://ethereum-android.com/" rel="noopener  ugc nofollow" target="_blank"><div class="js ab ej"><div class="jt ab ju cl cj jv"><h2 class="bd hu fv z el jw eo ep jx er et hs dt translated">以太坊Android -您的以太坊移动门户</h2><div class="jy l"><h3 class="bd b fv z el jw eo ep jx er et ek translated">安卓以太坊应用平台和钱包</h3></div><div class="jz l"><p class="bd b gc z el jw eo ep jx er et ek translated">ethereum-android.com</p></div></div><div class="ka l"><div class="mn l kc kd ke ka kf kg jr"/></div></div></a></div><p id="40f5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">请继续关注这篇文章的未来更新，很可能还有一篇关于如何在iOS上做这件事的类似文章。</p><blockquote class="mo"><p id="6a46" class="mp mq ht bd mr ms mt mu mv mw mx jn ek translated"><a class="ae my" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="na nb nc nd ne nf fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff mz"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>