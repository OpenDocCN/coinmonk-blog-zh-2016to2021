<html>
<head>
<title>Integrating physical devices with IOTA — Peer-to-peer energy trading with IOTA Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将物理设备与IOTA集成—使用IOTA进行点对点能源交易第1部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/integrating-physical-devices-with-iota-peer-to-peer-energy-trading-with-iota-part-1-b86a1e173328?source=collection_archive---------0-----------------------#2020-07-24">https://medium.com/coinmonks/integrating-physical-devices-with-iota-peer-to-peer-energy-trading-with-iota-part-1-b86a1e173328?source=collection_archive---------0-----------------------#2020-07-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="099d" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">关于将物理设备与IOTA协议集成的初学者教程系列的第18部分。</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/38f3efbf57665f3f29f8ccd0e9ecd775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7Q5-su5CfoNDKMpJzzYBQ.jpeg"/></div></div></figure><h1 id="cc57" class="ju jv ht bd jw jx jy jz ka kb kc kd ke iz kf ja kg jc kh jd ki jf kj jg kk kl dt translated">介绍</h1><p id="0b5e" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">这是初学者教程系列的第18部分，我们将探索如何将物理设备与IOTA协议集成在一起。这将是一个分为两部分的教程，我们将学习在对等能源交易解决方案中使用IOTA令牌作为结算货币。在第一部分中，我们将重点监控实时功耗，并相应地进行支付。在第二部分，我们将着眼于处理可变能源价格。</p><p id="7d5c" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><em class="ln">注意！<br/>在第一个教程中，太阳能电池板是可选的，因为我们将主要关注能源供应商电池和最终客户之间的电路。</em></p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="fedd" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">使用案例</h1><p id="6493" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">最近，我们酒店的老板一直在考虑在酒店的后院安装一些新的花园灯。唯一的问题是，在花园的那个特定区域，没有电来给灯供电。当与他的隔壁邻居讨论这个问题时，邻居解释说，他附近有一个太阳能系统，如果他得到补偿增加现有系统的额外成本，他可能能够提供额外的电力。这听起来像是完美的解决方案，但仍有一个问题；他们如何处理付款以便反映实际用电量，同时消除监控用电量和处理手动付款的手动负担？</p><p id="6e83" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">思考了一会儿这个问题后，旅馆老板向他的邻居提出了以下想法:</p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="bac1" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">这个提议</h1><ol class=""><li id="4b12" class="ma mb ht ko b kp kq ks kt kv mc kz md ld me lh mf mg mh mi dt translated">首先，我们将一个带有电源监控传感器的树莓皮放入邻居太阳能电池和酒店业主新花园灯之间的电源电路中。</li><li id="42a1" class="ma mb ht ko b kp mj ks mk kv ml kz mm ld mn lh mf mg mh mi dt translated">然后，我们让PI每秒从传感器读取一次读数，并记录当前的用电量。</li><li id="7573" class="ma mb ht ko b kp mj ks mk kv ml kz mm ld mn lh mf mg mh mi dt translated">然后，在某个预定义的时间段(假设一个小时)，我们计算该时间段的平均用电量，并乘以时间(一个小时)和双方都同意的IOTA中的能源价格。</li><li id="af43" class="ma mb ht ko b kp mj ks mk kv ml kz mm ld mn lh mf mg mh mi dt translated">最后，在每个周期(一个小时)之后，PI自动创建新的IOTA交易，并且在开始新的周期之前，将所计算的IOTA令牌从酒店管理器传送到邻居接收器地址。</li></ol><p id="8e84" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">幸运的是，邻居喜欢这个主意，所以让我们开始建吧:-)</p><p id="e4b8" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><em class="ln">注意！<br/>如果我们想在真实规模上实现这个用例，我们可能必须使用更高的电压，如12V及以上。然而，为了最大限度地降低元件成本，同时注重安全性，我们将一切都缩小到低压电路。毕竟，</em> <strong class="ko hu"> <em class="ln">任何人都不应该摆弄高压电路，除非他们绝对知道自己在做什么</em> </strong> <em class="ln">。</em></p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="0a11" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">组件</h1><p id="9692" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">首先，让我们快速看一下这个项目中使用的不同硬件组件。</p><p id="3a75" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">除了Raspberry PI本身和一些连接它的电线，我们还需要以下组件:</p><p id="274e" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><strong class="ko hu"> INA219电流/电压/功率传感器</strong><br/>ina 219是一款低成本电流/电压/功率传感器，采用分线板形式，可轻松连接到Raspberry PI的GPIO引脚。你应该可以从易趣或亚马逊上以低于10美元的价格买到INA219传感器。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mo"><img src="../Images/41680a1adf27f20cea87328b13e91827.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*34I8XPROPk8_0LWd.jpg"/></div></figure><p id="00b1" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><strong class="ko hu">电位计</strong> <br/>电位计基本上是一个放置在电路中的可变电阻器，用来模拟可变的功率使用。用一些可开关的发光二极管或可调节的DC马达来代替电位计也同样有效。我决定使用电位计的唯一原因是为了减少电路中的器件和连接数量。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mp"><img src="../Images/e83f9dda96a637bccdec13f0e0086daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*Rjnm7a1zAIUgGVkB.jpg"/></div></figure><p id="743b" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><strong class="ko hu">电阻器</strong> <br/>电阻器放置在LED前面，以限制进入LED的电流。不使用电阻直接从电池为LED供电可能会损坏LED。根据LED的类型，200至500欧姆的电阻应该可以正常工作。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff mq"><img src="../Images/98005469167070e28852c064804588ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/0*R3p5Hh4su5SUifze.jpg"/></div></div></figure><p id="954c" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><strong class="ko hu"> LED </strong> <br/>在我们的用例中，LED代表花园灯。转动电位计，我们可以调节进入LED的电流量，从而调节它产生的光量。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mr"><img src="../Images/5ac4fe1e7b8c3764c5f85965d6542901.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/0*XpYQsCXOsnn4_H9b.jpg"/></div></figure><p id="8a1d" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><strong class="ko hu">电池</strong></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mp"><img src="../Images/aca0f5ae4df97ff18573ec04d11b2480.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/0*XFhVe2O6AbA1PI-e"/></div></figure><p id="21c7" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><em class="ln">注意！在本教程的第二部分，我们将添加一个太阳能电池板和一个二极管来给电池充电。让我们在下一个教程中看看这些组件。</em></p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="3a99" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">布线图</h1><p id="b11a" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">这是一个简单的示意图，显示了如何连接电路。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ms"><img src="../Images/50a17fac640d2051ade1bdb192e7a0c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3HQ9eqw1v2HfD8lB-1sPAQ.png"/></div></div></figure><p id="272f" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><em class="ln">注意！<br/>如前所述，太阳能电池板和二极管在本教程中是可选的，可以从电路中排除。</em></p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="69bd" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">所需的软件和库</h1><p id="68ca" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">该项目需要以下Python库。</p><p id="c579" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">用于与IOTA tangle通信的<a class="ae mt" href="https://github.com/iotaledger/iota.py" rel="noopener ugc nofollow" target="_blank"> PyOTA库</a>。</p><p id="3f27" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">用于与INA219传感器通信的<a class="ae mt" href="https://pypi.org/project/pi-ina219/" rel="noopener ugc nofollow" target="_blank"> INA219库</a>。</p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="cce3" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">Python代码</h1><p id="04f6" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">这个项目的Python代码非常简单，所以除了指出一些重要的变量之外，我就不再赘述了。</p><p id="03cd" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><strong class="ko hu"><em class="ln">pay _ frequency</em></strong>变量以秒为单位定义了我们计算平均功耗并发出IOTA支付交易的时间段。</p><p id="c583" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><strong class="ko hu"> <em class="ln"> mW_price </em> </strong>变量指定IOTA的每毫瓦/秒(mW/s)能量的价格。计算出的IOTA交易值中的任何小数都将被删除，因为我们无法发送IOTA的分数。</p><p id="328e" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><em class="ln">注意！<br/>由于我们在这个小电路中处理的功耗非常低，因此使用毫瓦(mW)而不是典型的瓦特或千瓦更方便。</em></p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="mu mv l"/></div></figure><p id="f37f" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">你可以从<a class="ae mt" href="https://gist.github.com/huggre/23a2db302eb7adb8b7e71fe3dc7e06cf" rel="noopener ugc nofollow" target="_blank">这里</a>下载代码</p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="e398" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">运行项目</h1><p id="ce5c" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">要运行该项目，首先需要将上一节中的Python代码保存到您的机器上。</p><p id="6392" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">要执行代码，只需启动一个新的终端窗口，导航到保存文件的文件夹，然后键入:</p><p id="1166" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated"><strong class="ko hu">python</strong>T7<strong class="ko hu">P2P _ energy _ trade . py</strong>T10】</p><p id="cda6" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">现在，您应该可以看到每秒钟打印到终端的当前LED电源使用情况。注意当你转动电位计时，数值是如何变化的。</p><p id="0923" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">每60秒，在创建IOTA值(支付)交易并将其发送到tangle之前，计算最后一段时间(60秒)的平均用电量并将其打印到监视器。</p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="2177" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">接下来是什么？</h1><p id="e556" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">在本教程的第二部分，我们将了解可变能源价格的管理，这是在处理太阳能、风能、水能等可再生能源时必须解决的一个常见问题。</p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="d026" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">贡献</h1><p id="335a" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">如果你想对本教程有所贡献，你可以在这里找到一个Github库<a class="ae mt" href="https://github.com/huggre/p2p_energy_trading_p1" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl lo lp hb lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hm hn ho hp hq"><h1 id="2ca8" class="ju jv ht bd jw jx lv jz ka kb lw kd ke iz lx ja kg jc ly jd ki jf lz jg kk kl dt translated">捐款</h1><p id="e295" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">如果你喜欢这个教程，并希望我继续让其他人感到自由，使一个小的捐赠给下面的IOTA地址。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff mw"><img src="../Images/6db3c9d035d0a203ac4162ebfe72d097.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/0*JSb0LwJEBYpCYhQA.png"/></div></figure><p id="ec7c" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">nyzbhovsmdwabxsacajttwjoqrvvawlbsfqvsjswwbjjlsqknzfc 9 xcrpqsvfqzpbjcjrannpvmmezqjrqsvvgz</p><blockquote class="mx"><p id="871c" class="my mz ht bd na nb nc nd ne nf ng lh ek translated"><a class="ae mt" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank"> <em class="nh">在您的收件箱中直接获得最佳软件交易</em> </a></p></blockquote><figure class="nj nk nl nm nn jn fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff ni"><img src="../Images/3de8198132c97a191b6161d9769b0516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*uRVHCulstglkgV-E.png"/></div></a></figure></div></div>    
</body>
</html>