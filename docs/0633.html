<html>
<head>
<title>Understanding The eosio.token Contract</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解eosio.token合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/understanding-the-eosio-token-contract-87466b9fdca9?source=collection_archive---------2-----------------------#2018-05-28">https://medium.com/coinmonks/understanding-the-eosio-token-contract-87466b9fdca9?source=collection_archive---------2-----------------------#2018-05-28</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="bf83" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我必须承认，学习eosio不是在公园里散步，我可以理解为什么许多人说它有一个陡峭的学习曲线。随着eosio软件的持续快速发展，可参考的文档和工作示例非常有限。我已经被难住了好几次，我想帮助下一个开发人员改善体验。在本文中，我将把“eosio.token”合同分解成几个独立的部分。</p><blockquote class="jo"><p id="6058" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated"><a class="ae jy" href="https://coincodecap.com" rel="noopener ugc nofollow" target="_blank">发现并回顾最佳区块链软件</a></p></blockquote><p id="fd7e" class="pw-post-body-paragraph iq ir ht is b it jz iv iw ix ka iz ja jb kb jd je jf kc jh ji jj kd jl jm jn hm dt translated"><strong class="is hu">EOS io . token契约是什么？</strong></p><p id="e817" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">eosio.token契约允许创建许多不同的令牌。这使得任何人都能够创建和转移令牌。每个代币必须由“发行者”账户发行。由于帐户可以包含多方，因此您可以使用具有所有者和活动权限的普通帐户或自定义配置的帐户来创建和管理令牌。每个令牌都是一个<code class="eh ke kf kg kh b">asset</code>类型，如下所示:</p><p id="8a22" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">1000000000.0000 SYS</code></p><p id="8a7f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">1.0000 SYMBOL</code></p><p id="e895" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">0.10 SYS</code></p><p id="51db" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">asset</code>类型是一个数字(如果我没记错的话，可以达到18位小数)和一个符号，可以是1-7个大写字母。这个契约有三个动作可以用来与之交互。它们是:创建、发布和转移。</p><p id="7739" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">创建用于定义新令牌的特征。这包括代币(<code class="eh ke kf kg kh b">asset</code>)符号、最大供应量以及允许发行代币的账户。创建还会将新令牌配置持久化到区块链上。这意味着新令牌配置的存储必须由某人来标记。正如您稍后将看到的，部署此合同的帐户(在我们的示例中为“eosio.token”)也将为令牌配置存储付费。</p><p id="97b5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">发行用于增加令牌的主动供应。代币可以不断发行，直到达到最大供应量。在令牌创建过程中定义的<code class="eh ke kf kg kh b">issuer</code>必须批准该操作才能成功。</p><p id="34b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">转账<strong class="is hu"> </strong>让一个账户向另一个账户转账代币。</p></div><div class="ab cl ki kj hb kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hm hn ho hp hq"><p id="81f9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">部署合同</strong></p><p id="1c87" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你应该知道的第一件事是，每个eosio智能合约都属于一个eosio账户。契约基本上是其他帐户可以与之交互的对象。契约包含在区块链上执行代码的“动作”。合同可以直接访问区块链上的存储、移除和更新数据。</p><p id="9cf7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将操作推送到合同需要至少一个帐户的授权。根据合同的复杂程度，可能需要更多的帐户和权限。在基于许可的配置中，一个帐户可以由一个或多个个人创建。智能合约只能由一个帐户运行，一个帐户只能有一个智能合约。最佳做法是为帐户和合同提供相同的(小写)名称。</p><p id="185b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在与eosio.token合同进行交互之前，您需要创建一个同名的帐户，并将合同部署到该帐户上。</p><p id="9704" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">首先创建一个帐户</p><p id="17b8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">$cleos create account eosio eosio.token &lt;OWNER-KEY&gt; &lt;ACTIVE-KEY&gt;</code></p><p id="6dba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后编制合同</p><p id="c1a3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">$cd eos/contract/eosio.token</code></p><p id="cb3b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">$eosiocpp -o eosio.token.wast eosio.token.cpp</code></p><p id="2ca1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，将合同部署到帐户上</p><p id="1768" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">$cleos set contract eosio.token ../eosio.token</code></p><p id="2e68" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您可以验证该合同是使用</p><p id="e3f0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">$cleos get code eosio.token</code></p></div><div class="ab cl ki kj hb kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hm hn ho hp hq"><p id="a692" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">合同架构</strong></p><p id="21e7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">合同分为两个文件“eosio.token.cpp”和“eosio.token.hpp”。的’。hpp '文件定义了合同类、动作和表格，而。cpp '文件实现了动作逻辑。让我们首先看一下将用于实例化契约对象的契约类。(我把‘EOS io . token . HPP’的一些遗留代码去掉了)</p><figure class="kp kq kr ks fq kt"><div class="bz el l di"><div class="ku kv l"/></div></figure><p id="780e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">构造函数和动作被定义为公共成员函数。构造函数获取一个帐户名(这将是部署契约的帐户，又名eosio.token ),并将其设置为<code class="eh ke kf kg kh b">contract</code>变量。请注意，此类是从“eosio::contract”继承的。</p><p id="b7a0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">表和助手函数是作为私有成员提供的。底部定义了两个内联函数，但从未使用过。这给我们留下了重要的功能<code class="eh ke kf kg kh b">sub_balance()</code>和<code class="eh ke kf kg kh b">add_balance()</code>。这些将被转移动作调用。</p></div><div class="ab cl ki kj hb kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hm hn ho hp hq"><p id="0a77" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">表格</strong></p><p id="9692" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">定义的两个表是<code class="eh ke kf kg kh b">accounts</code>和<code class="eh ke kf kg kh b">stat</code>。<code class="eh ke kf kg kh b">accounts</code>桌子由不同的<code class="eh ke kf kg kh b">account</code>对象组成，每个对象持有不同令牌的余额。<code class="eh ke kf kg kh b">stat</code>表由<code class="eh ke kf kg kh b">currency_stats</code>对象(由<code class="eh ke kf kg kh b">struct currency_stats</code>定义)组成，包含一个supply、一个max_supply和一个issuer。在继续之前，重要的是要知道这个契约将数据保存在两个不同的范围内。<code class="eh ke kf kg kh b">accounts</code>表的作用域是eosio帐户，而<code class="eh ke kf kg kh b">stat</code>表的作用域是令牌符号名。</p><p id="8756" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="kw">根据“eosio::multi_index”的定义，“code”是具有写权限的帐户的名称，而“scope”是存储数据的帐户。</em></p><p id="cf10" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">作用域本质上是一种在契约中划分数据的方式，以便它只能在定义的空间内访问。在令牌契约中，每个eosio帐户都被用作<code class="eh ke kf kg kh b">accounts</code>表的作用域。<code class="eh ke kf kg kh b">accounts</code>表是一个包含多个<code class="eh ke kf kg kh b">account</code>对象的多索引容器。每个<code class="eh ke kf kg kh b">account</code>对象由其令牌符号索引，并包含令牌余额。当使用用户的范围查询用户的<code class="eh ke kf kg kh b">accounts</code>表时，将返回用户拥有余额的所有令牌的列表。</p><p id="15fa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以下是我的设想。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="fe ff kx"><img src="../Images/cc0028f30db53b28138acfad5c91e7bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YBRMbKDC4i0EGOXF7eyZ_w.jpeg"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek">In the above picture, there is an eosio account named tom who has his own scope. Within his scope is a table called <code class="eh ke kf kg kh b">`accounts`</code>. Within that table is a separate `account` object for each token he holds, ‘SYS’ and ‘EOS’.</figcaption></figure><p id="ba82" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">还有第二个表叫<code class="eh ke kf kg kh b">stat</code>。此表将包含现有令牌的状态。新的标记是在它们自己的符号名范围内创建的。范围内是一个保存有一个<code class="eh ke kf kg kh b">currency_stats</code>对象的<code class="eh ke kf kg kh b">stat</code>表。与包含许多不同的<code class="eh ke kf kg kh b">account</code>对象的<code class="eh ke kf kg kh b">accounts</code>表不同，<code class="eh ke kf kg kh b">stat</code>表只保存给定令牌符号的单个<code class="eh ke kf kg kh b">currency_stats</code>对象。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="fe ff li"><img src="../Images/765091ca84941c98342c3d40202259f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ELEckoUaW7KNBSNG7uXXJQ.jpeg"/></div></div></figure></div><div class="ab cl ki kj hb kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hm hn ho hp hq"><p id="1aad" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">动作</strong></p><p id="5ade" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">操作在'中实现。“cpp”文件。为了创建新令牌，必须发送创建操作。Create有两个参数；发行者和新令牌的最大供应量。只有<code class="eh ke kf kg kh b">issuer</code>被允许增加新的代币供应。<code class="eh ke kf kg kh b">issuer</code>不能发出超过最大供应量的量。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div class="fe ff lj"><img src="../Images/ca16120c0e53ad83b095e93c3492ba38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*7kQkLSOBeN1g_lWQNCv8UQ.png"/></div></figure><p id="5275" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">第一行代码只需要合同帐户本身的授权。这可以在推动动作时用命令行标志<code class="eh ke kf kg kh b">-p eosio.token </code>给出。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/35f7bd1fb592980d0b688418c4172547.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*JMfBOjOectFuKKvZ9P43vw.png"/></div></figure><p id="99ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来的几行提取传入的<code class="eh ke kf kg kh b">maximum_supply</code>资产的符号，并执行一些错误处理。如果任何一个<code class="eh ke kf kg kh b">eosio_assert</code>失败，那么所有的代码都将回滚，事务不会被推送到区块链。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="fe ff ll"><img src="../Images/77f1cb10eefe4eaac040c11010afcb60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l7YSLAjXUFNC5C0k428v-g.png"/></div></div></figure><p id="b2b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">名为<code class="eh ke kf kg kh b">statstable</code>的<code class="eh ke kf kg kh b">stat</code>表是使用符号名(令牌符号)作为其作用域构建的。代码检查令牌是否已经存在。如果没有，它将创建新的令牌状态并保存到区块链上。<code class="eh ke kf kg kh b">emplace</code>函数中的第一个参数<code class="eh ke kf kg kh b">_self</code>表示该合约账户‘EOS io . token’将支付赌注存储。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="fe ff lm"><img src="../Images/0242e31f43ba7bba6ed7c12f700c06b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wwLcoGFMKHrNETC8gVlk6g.png"/></div></div></figure><p id="5f6b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">请注意，<code class="eh ke kf kg kh b">supply</code>的符号被保存，因为它被用作定位表格行的键，但是耗材量尚未发出。</p><p id="1fc8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在，您可以执行下一个操作，问题。Issue将接收已发行令牌的帐户、正在发行的令牌数量和备忘录。issue操作将两个操作合二为一，因为它既会修改已创建的令牌供应，又会调用transfer操作来发送已颁发的令牌。同样，前几行提取令牌符号并执行错误检查。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div class="fe ff ln"><img src="../Images/bffde3f1595ed8cc7bb4f391cd3788e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*aFDdPjaBNhvpKgeIPv_9cw.png"/></div></figure><p id="e5ab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下面的代码部分将使用符号名作为作用域来构造<code class="eh ke kf kg kh b">stat</code>表。这用作查找先前通过创建操作创建的令牌的密钥。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="fe ff lo"><img src="../Images/f12c23506511f66689ff9eb54bdab362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8yKteU-88gjSZd9vSrcRTw.png"/></div></div></figure><p id="fd88" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">注意从<code class="eh ke kf kg kh b">statstable.find()</code>返回的<code class="eh ke kf kg kh b">existing</code> currency_stat是一个迭代器，它指向找到的对象。为了简洁起见，声明了一个名为<code class="eh ke kf kg kh b">st</code>的新变量，并将其设置为<code class="eh ke kf kg kh b">existing</code>迭代器所指向的实际对象。这让我们使用<code class="eh ke kf kg kh b">.</code>操作符来访问成员变量，而不是指针符号<code class="eh ke kf kg kh b">-&gt;</code>。</p><p id="674d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">需要创建的令牌的<code class="eh ke kf kg kh b">issuer</code>来签署该交易，并执行更多的错误处理。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="fe ff lp"><img src="../Images/b530e0993f9ff9ed901a555212e2e8d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1jEzhM3wVtxiu_nImgFwvQ.png"/></div></div></figure><p id="6f9a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，我们现有令牌的currency_stats <code class="eh ke kf kg kh b">st</code>被修改，已发行的<code class="eh ke kf kg kh b">quantity</code>被添加到<code class="eh ke kf kg kh b">supply</code>中。<code class="eh ke kf kg kh b">issuer</code>也将把这个<code class="eh ke kf kg kh b">supply</code>添加到他们的余额中，以便初始供应可以追溯到他们的账户。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="fe ff lq"><img src="../Images/0e227120d7cd79302e333aeb407f8b06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qoLfPeTBTSTYbflHG0i2LA.png"/></div></div></figure><p id="de37" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">紧接着，通过<code class="eh ke kf kg kh b">SEND_INLINE_ACTION()</code>宏调用<code class="eh ke kf kg kh b">transfer</code>函数，该宏将转移资金。论据如下:</p><ol class=""><li id="6db4" class="lr ls ht is b it iu ix iy jb lt jf lu jj lv jn lw lx ly lz dt translated"><code class="eh ke kf kg kh b">*this</code>该行动所属的合同代码</li><li id="3b21" class="lr ls ht is b it ma ix mb jb mc jf md jj me jn lw lx ly lz dt translated"><code class="eh ke kf kg kh b">transfer</code>行动的安姆</li><li id="c1c8" class="lr ls ht is b it ma ix mb jb mc jf md jj me jn lw lx ly lz dt translated"><code class="eh ke kf kg kh b">{st.issuer, N(active)}</code>动作所需的权限</li><li id="cab8" class="lr ls ht is b it ma ix mb jb mc jf md jj me jn lw lx ly lz dt translated"><code class="eh ke kf kg kh b">{st.issuer, to, quantity, memo}</code>行动本身的论据</li></ol><p id="2d72" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这就把我们带到了最后的行动转移。传输将采用四个输入参数<code class="eh ke kf kg kh b">from</code>、<code class="eh ke kf kg kh b">to</code>、<code class="eh ke kf kg kh b">quantity</code>和<code class="eh ke kf kg kh b">memo</code>。<code class="eh ke kf kg kh b">from</code>是将发送代币的人，因此将从他们的余额中减去<code class="eh ke kf kg kh b">quantity</code>。<code class="eh ke kf kg kh b">to</code>将接收代币，因此<code class="eh ke kf kg kh b">quantity</code>将添加到他们的余额中。<code class="eh ke kf kg kh b">quantity</code>是发送的令牌数量，<code class="eh ke kf kg kh b">memo</code>是可以随交易一起发送的字符串。<code class="eh ke kf kg kh b">memo</code>未在本合同中使用或储存。</p><p id="3e4b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">该操作首先要求<code class="eh ke kf kg kh b">from</code>帐户权限，并对<code class="eh ke kf kg kh b">from</code>和<code class="eh ke kf kg kh b">to</code>帐户执行错误处理。该符号从<code class="eh ke kf kg kh b">quantity</code>中提取，并用于获取令牌的<code class="eh ke kf kg kh b">currency_stats</code>。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="fe ff mf"><img src="../Images/d3c4ab987ef94a257da8978e01cc034a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*XTAN8iPWK8v8uhWMrYdrLA.png"/></div></div></figure><p id="3c65" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh ke kf kg kh b">require_recipient()</code>功能将在动作完成时通知发送方和接收方。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div class="fe ff mg"><img src="../Images/275b761f0cbec933013ed3156818488e.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*NUPWriZOj30b18DALGWpUA.png"/></div></figure><p id="8157" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">进行更多的错误处理，最后调用两个私有函数<code class="eh ke kf kg kh b">sub_balance()</code>和<code class="eh ke kf kg kh b">add_balance()</code>，从发送方减去令牌余额，并为接收方增加令牌余额。</p><p id="1562" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是完整的“eosio.token.cpp”文件</p><figure class="kp kq kr ks fq kt"><div class="bz el l di"><div class="ku kv l"/></div></figure></div><div class="ab cl ki kj hb kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hm hn ho hp hq"><p id="5110" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">命令示例:</p><figure class="kp kq kr ks fq kt"><div class="bz el l di"><div class="ku kv l"/></div></figure><p id="c4c3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">表格命令:</p><figure class="kp kq kr ks fq kt"><div class="bz el l di"><div class="ku kv l"/></div></figure></div><div class="ab cl ki kj hb kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hm hn ho hp hq"><blockquote class="mh mi mj"><p id="adcf" class="iq ir kw is b it iu iv iw ix iy iz ja mk jc jd je ml jg jh ji mm jk jl jm jn hm dt translated">注意:本文是在Dawn4.1代码发布时撰写的</p></blockquote><figure class="kp kq kr ks fq kt fe ff paragraph-image"><a href="http://bit.ly/2G71Sp7"><div class="fe ff mn"><img src="../Images/449450761cd76f44f9ae574333f9e9af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKX2mtg7p1lOs7JmosPLsA.png"/></div></a></figure></div></div>    
</body>
</html>