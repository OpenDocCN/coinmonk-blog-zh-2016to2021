<html>
<head>
<title>Beginning with the Hyperledger Fabric</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Hyperledger结构开始</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/beginning-with-the-hyperledger-fabric-241b54859476?source=collection_archive---------4-----------------------#2018-07-18">https://medium.com/coinmonks/beginning-with-the-hyperledger-fabric-241b54859476?source=collection_archive---------4-----------------------#2018-07-18</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/1bf91834b775219ac09f1c371524dbad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TK5jWgpbsOydrhiFLaoC0g.png"/></div></div></figure><div class=""/><p id="fbe0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">自过去3年以来，区块链技术一直在快速发展。这一切都始于10年前的比特币。今天，我们有超过1600种加密货币，许多项目使用区块链技术完成加密货币交易以外的任务。这篇文章讲述了这类项目中最流行的一个，Hyperledger Fabric。</p><p id="347b" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">区块链框架被分为公共、私有和联盟(又称许可)。比特币被认为是公共的，因为它允许任何人连接并开始挖掘。加入该网络进一步意味着你将有机会获得一份完整的账本。即使你不能确定谁拥有多少比特币，这个概念对于B2B网络来说仍然是不可取的。</p><p id="bb11" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在B2B网络中，企业所有者必须有权决定谁能够看到他们的信息。这就是像Hyperledger Fabric这样的区块链联盟框架发挥作用的地方。如果您想要加入Hyperledger Fabric网络，您必须首先获得该网络其他参与者的同意。此外，通过渠道特性，业务数据只对那些真正需要它的参与者可用。</p><p id="7dc6" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我将为另一篇文章保留Hyperledger Fabric的详细架构。但这里有一些基本概念。</p><h1 id="71bc" class="jz ka ie bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">资产</h1><p id="53b0" class="pw-post-body-paragraph jb jc ie jd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hm dt translated">在加密货币网络中，你拥有的硬币就是你的资产。在比特币里叫比特币本身，在以太坊里叫以太。在这些网络中发生的交易包括发送和接收这些硬币。</p><p id="c047" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">由于区块链不仅仅是兑换硬币，Hyperledger Fabric允许您定义自定义资产。例如，车辆可以是汽车制造商的资产。车辆将有几个带值的属性，这些属性被称为该资产的状态。这种状态的任何变化都被视为一笔交易，记录在分类账中。</p><h1 id="b600" class="jz ka ie bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">链码/智能合同</h1><p id="b9f7" class="pw-post-body-paragraph jb jc ie jd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hm dt translated">现在，这些定制资产是如何定义的呢？答案是链码。它只是一个用Golang或Node.js编写的程序(对其他语言的支持正在进行中)。该代码将包含将成为网络中资产的结构或对象，以及将对这些对象执行CRUD操作的几个方法或函数。这些功能执行的每个创建、更新和删除操作都将记录在分类帐中。</p><h1 id="a2f8" class="jz ka ie bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">共识；一致</h1><p id="0530" class="pw-post-body-paragraph jb jc ie jd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hm dt translated">正如在区块链中，每个参与者都有自己的本地账本，我们需要一种机制来保持它们同步。做到这一点的唯一方法是确保每个参与者都以相同的顺序提交事务，并且这些事务必须得到相应各方的批准。</p><p id="fa42" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这是由共识机制处理的，共识机制不仅在区块链中流行，在分布式系统中也很流行。工作证明是比特币使用的共识算法。鉴于此，Hyperledger Fabric使用订购者实体来实现此目的。核心思想是，在实例化链码时，定义一个认可策略，该策略指示必须通过该链码认可交易的网络参与者。订购者从这些参与者处获得已认可的交易，并对它们进行批量订购，然后分发给所有参与者。</p><h1 id="7cd4" class="jz ka ie bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">频道</h1><p id="8ac1" class="pw-post-body-paragraph jb jc ie jd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hm dt translated">假设你是一家汽车制造商，想与一家零部件制造商和一家汽车经销商做生意。现在你不想让汽车经销商知道你和零部件制造商之间的交易，反之亦然。一种方法是设置两个Hyperledger Fabric服务器实例，或者通过将它们连接到不同的通道来隔离它们。</p><p id="27a8" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">Hyperledger结构网络中的参与者实际上连接到一个或多个渠道，并且他们对每个渠道都有单独的分类帐。此外，在一个通道上运行的链码不能访问另一个通道的数据。</p><h1 id="ad77" class="jz ka ie bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dt translated">设置您的第一个网络</h1><p id="5d89" class="pw-post-body-paragraph jb jc ie jd b je kx jg jh ji ky jk jl jm kz jo jp jq la js jt ju lb jw jx jy hm dt translated">理论部分到此为止，让我来帮你建立一个个人网络，让你兴奋起来。</p><blockquote class="lc ld le"><p id="3754" class="jb jc lf jd b je jf jg jh ji jj jk jl lg jn jo jp lh jr js jt li jv jw jx jy hm dt translated">开始前给你一点建议。不要试图在Windows机器上运行它，因为有些问题你现在不想处理。而且为了这篇文章的篇幅，我也不想描述他们。请改用云虚拟机。即使是Amazon EC2的t2.micro自由层VM对于本教程也足够了。</p></blockquote><p id="2b1f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">软件安装<br/> </strong>下面是你必须安装的软件。</p><ul class=""><li id="63e9" class="lj lk ie jd b je jf ji jj jm ll jq lm ju ln jy lo lp lq lr dt translated"><strong class="jd if"> Docker: </strong>从<a class="ae ls" href="https://store.docker.com/search?type=edition&amp;offering=community" rel="noopener ugc nofollow" target="_blank">这里</a>抓取最新版本</li><li id="a28b" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if"> Docker-compose: </strong>随Mac版Docker自动安装，对于Linux，从<a class="ae ls" href="https://docs.docker.com/compose/install/#install-compose" rel="noopener ugc nofollow" target="_blank">这里</a>下载</li><li id="1d1d" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if"> Go编程语言编译器:</strong>从<a class="ae ls" href="https://golang.org/dl" rel="noopener ugc nofollow" target="_blank">这里抓取最新版本</a></li><li id="3574" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if"> Node.js运行时:</strong>撰写本文时还不支持9.x及更高版本，所以从这里的<a class="ae ls" href="https://nodejs.org" rel="noopener ugc nofollow" target="_blank">抓取8 . x</a></li><li id="64d4" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if"> Python 2(不是3): </strong> Linux和Mac必须已经有了，但是要确保用<code class="eh ly lz ma mb b">python</code>命令激活版本2</li><li id="bb61" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if"> Git运行时:</strong>从<a class="ae ls" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank">这里</a>抓取最新版本</li><li id="4a2a" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if"> cURL: </strong>你必须已经在Linux和Mac上安装了它，如果你想升级的话从<a class="ae ls" href="https://curl.haxx.se/download.html" rel="noopener ugc nofollow" target="_blank">这里</a>获取最新版本</li></ul><p id="3ec9" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">您必须确保上述所有软件都在您的路径中，并且Docker守护程序正在运行(运行命令<code class="eh ly lz ma mb b">docker ps</code>)。如果不是，就执行Mac版的Docker应用程序，或者如果你使用的是Linux，就运行<code class="eh ly lz ma mb b">dockerd</code>命令。</p><p id="86f2" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">下载Docker图像、样本&amp;实用程序</strong> <br/>软件设置完成后，导航至您选择的目录并运行以下命令:</p><figure class="mc md me mf fq hv"><div class="bz el l di"><div class="mg mh l"/></div></figure><p id="c5ca" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这个命令需要几分钟的时间来下载所需的Docker映像，并将包含一些示例和实用程序的Git存储库克隆到“fabric-samples”目录中。以下是fabric-samples中一些文件夹内容的详细信息:</p><ul class=""><li id="4277" class="lj lk ie jd b je jf ji jj jm ll jq lm ju ln jy lo lp lq lr dt translated"><strong class="jd if"> bin </strong>:包含设置网络的命令行实用程序</li><li id="ff16" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if"> chaincode </strong>:包含示例链码，在本教程中我们将从中运行chaincode_example02</li><li id="c937" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if">包含一个脚本，用于设置一个包含一个订购者、一个组织和一个cli的网络。这有助于在开发过程中对链代码进行单元测试</strong></li><li id="f820" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if">配置:</strong>示例网络配置，您稍后在设置生产网络时需要参考</li><li id="ea3b" class="lj lk ie jd b je lt ji lu jm lv jq lw ju lx jy lo lp lq lr dt translated"><strong class="jd if"> first-network: </strong>包含shell脚本，用于启动包含两个组织、四个对等方、一个订购方和一个cli的网络</li></ul><p id="18cc" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们使用first-network中的脚本生成一个网络。导航到该目录并执行byfn.sh shell脚本，如下所示:</p><figure class="mc md me mf fq hv"><div class="bz el l di"><div class="mg mh l"/></div></figure><p id="e0aa" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">以上命令将启动示例网络并实例化用Go语言编写的<a class="ae ls" href="https://github.com/hyperledger/fabric-samples/blob/release-1.2/chaincode/chaincode_example02/go/chaincode_example02.go" rel="noopener ugc nofollow" target="_blank">链码_示例02 </a>链码。链码由两个实体“a”和“b”初始化，分别包含100和200个单元。如果一切顺利，会输出一个大大的“结局”。</p><p id="8bc2" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">chaincode_example02 chaincode还包含在它们之间转移单元、删除任一实体以及查询一个实体拥有多少单元的方法。因为我们的chaincode已经被实例化了，所以让我们看一个查询、传输和删除方法的例子。</p><p id="2f05" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果你运行命令<code class="eh ly lz ma mb b">docker ps</code>，那么你可以看到一堆由byfn脚本创建的容器。<code class="eh ly lz ma mb b">cli</code>就是其中之一，它配置了所需的环境变量，并包含了使用我们的链码所需的实用程序。遵循以下要点中的步骤来处理该问题:</p><figure class="mc md me mf fq hv"><div class="bz el l di"><div class="mg mh l"/></div></figure><p id="81cb" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里，我们使用了示例脚本来准备我们的网络。但是它们不能用于生产部署。Hyperledger Fabric中有许多概念和配置，我将在以后的文章中介绍它们。所以，敬请期待！</p></div></div>    
</body>
</html>