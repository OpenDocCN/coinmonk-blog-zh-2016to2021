<html>
<head>
<title>Ethereum — Vyper Development Using Truffle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊——使用块菌开发Vyper</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethereum-vyper-development-using-truffle-73781c4d81d5?source=collection_archive---------1-----------------------#2018-09-14">https://medium.com/coinmonks/ethereum-vyper-development-using-truffle-73781c4d81d5?source=collection_archive---------1-----------------------#2018-09-14</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/0f4cf0bfea46051f6920a68e6f4b276d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bgBCdx65C6_w6XztyRXfYg.png"/></div></div></figure><h1 id="f886" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">为什么是Vyper？</h1><blockquote class="jz ka kb"><p id="d104" class="kc kd ke kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la hm dt translated">Vyper是一种面向契约的pythonic编程语言，目标是以太坊虚拟机(EVM)</p></blockquote><p id="6fad" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">Vyper 是一种相对较新的语言，它的编写注重安全性、简单性和可听性。它是以Pythonic的方式编写的，这吸引了我，作为一种更安全的替代物，我认为它有很大的潜力。我计划在未来写更多关于与Vyper合作的内容。</p><h1 id="fa54" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">块菌——太爱吃甜食了？</h1><p id="e86d" class="pw-post-body-paragraph kc kd ht kf b kg lf ki kj kk lg km kn lb lh kq kr lc li ku kv ld lj ky kz la hm dt translated">我最近完成了一个<a class="ae le" rel="noopener" href="/@johngrant/ethereum-development-colony-hackathon-consenys-academy-react-8fc845ea47f1">黑客马拉松项目</a>，并完成了<a class="ae le" rel="noopener" href="/@johngrant/progress-34e8ad37442d"> 2018 ConsenSys Academy </a>，在那段时间里，不管是好是坏，我已经非常习惯使用<a class="ae le" href="https://www.truffleframework.com/" rel="noopener ugc nofollow" target="_blank"> Truffle </a>开发环境来编写代码、测试和部署——它只是让生活变得更容易。</p><p id="888d" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">所以，在一个理想的世界里，我想用松露和Vyper一起工作。经过一番调查后，我发现了Maurelian的这个<a class="ae le" href="https://github.com/maurelian/erc721-vyper" rel="noopener ugc nofollow" target="_blank"> ERC721 Vyper实现</a>，他做了一些工作使它与Truffle兼容。我认为记录构建过程以用于其他项目可能是有用的。</p><h1 id="10c4" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">如何使用块菌进行葡萄开发</h1><h2 id="9031" class="lk jc ht bd jd ll lm ln jh lo lp lq jl lb lr ls jp lc lt lu jt ld lv lw jx lx dt translated">安装Vyper</h2><p id="224f" class="pw-post-body-paragraph kc kd ht kf b kg lf ki kj kk lg km kn lb lh kq kr lc li ku kv ld lj ky kz la hm dt translated">第一步是确保Vyper安装在本地。如果在您跳过之前已经完成了这一步，您可以通过运行<code class="eh ly lz ma mb b">$ vyper -h</code>命令进行检查。有多种安装方式，包括使用PIP，这里的文档是<a class="ae le" href="https://viper.readthedocs.io/en/latest/installing-vyper.html" rel="noopener ugc nofollow" target="_blank">这里是</a>。我正在使用Mac电脑，并完成了以下操作:</p><p id="2b0b" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">设置虚拟环境:</p><pre class="mc md me mf fq mg mb mh mi aw mj dt"><span id="eecb" class="lk jc ht mb b fv mk ml l mm mn">$ virtualenv -p python3.6 --no-site-packages ~/vyper-venv</span></pre><p id="f74c" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">记住激活环境:</p><pre class="mc md me mf fq mg mb mh mi aw mj dt"><span id="9489" class="lk jc ht mb b fv mk ml l mm mn">$ source ~/vyper-venv/bin/activate</span></pre><p id="ca81" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">然后在我的工作目录中:</p><pre class="mc md me mf fq mg mb mh mi aw mj dt"><span id="c5dd" class="lk jc ht mb b fv mk ml l mm mn">$ git clone <a class="ae le" href="https://github.com/ethereum/vyper.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ethereum/vyper.git</a><br/>$ cd vyper<br/>$ make<br/>$ make test</span></pre><h2 id="be2d" class="lk jc ht bd jd ll lm ln jh lo lp lq jl lb lr ls jp lc lt lu jt ld lv lw jx lx dt translated">安装Truper</h2><p id="78d0" class="pw-post-body-paragraph kc kd ht kf b kg lf ki kj kk lg km kn lb lh kq kr lc li ku kv ld lj ky kz la hm dt translated">接下来我安装了<a class="ae le" href="https://github.com/maurelian/truper" rel="noopener ugc nofollow" target="_blank"> Truper </a>，这是一个由Maurelian编写的工具，用于将Vyper合同编译成Truffle兼容的工件。它使用Vyper，这也是我们之前安装它的原因。(参见下一节了解它的详细功能)。要安装run:</p><pre class="mc md me mf fq mg mb mh mi aw mj dt"><span id="216a" class="lk jc ht mb b fv mk ml l mm mn">$ npm i -g truper</span></pre><h2 id="f7ac" class="lk jc ht bd jd ll lm ln jh lo lp lq jl lb lr ls jp lc lt lu jt ld lv lw jx lx dt translated">编译、测试、部署</h2><p id="4044" class="pw-post-body-paragraph kc kd ht kf b kg lf ki kj kk lg km kn lb lh kq kr lc li ku kv ld lj ky kz la hm dt translated">从你的项目目录(你可以克隆<a class="ae le" href="https://github.com/maurelian/erc721-vyper" rel="noopener ugc nofollow" target="_blank"> ERC-721项目</a>进行快速测试)。</p><p id="e190" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">运行ganache测试网络:</p><pre class="mc md me mf fq mg mb mh mi aw mj dt"><span id="1f5e" class="lk jc ht mb b fv mk ml l mm mn">$ ganache-cli</span></pre><p id="7ca7" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">像往常一样，使用以下方法编制任何可靠性合同:</p><pre class="mc md me mf fq mg mb mh mi aw mj dt"><span id="e2ad" class="lk jc ht mb b fv mk ml l mm mn">$ truffle compile</span></pre><p id="f0dc" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">使用以下命令编译Vyper合同:</p><pre class="mc md me mf fq mg mb mh mi aw mj dt"><span id="dd16" class="lk jc ht mb b fv mk ml l mm mn">$ truper<br/>* this must be called from the project dir and you must have the virtual environment you built Vyper in running.</span></pre><p id="cf0f" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">块菌测试可以按常规方式编写和运行，即:</p><pre class="mc md me mf fq mg mb mh mi aw mj dt"><span id="9402" class="lk jc ht mb b fv mk ml l mm mn">Use artifacts in test files:<br/>const NFToken = artifacts.require('NFToken.vyper');</span><span id="793d" class="lk jc ht mb b fv mo ml l mm mn">Run tests using:<br/>$ truffle test</span></pre><p id="f852" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">块菌的迁移也以通常的方式进行。例如，我使用以下迁移文件部署到ganache:</p><pre class="mc md me mf fq mg mb mh mi aw mj dt"><span id="4a9d" class="lk jc ht mb b fv mk ml l mm mn">2_deploy_contracts.js</span><span id="40fd" class="lk jc ht mb b fv mo ml l mm mn">const NFToken = artifacts.require('NFToken.vyper');<br/>const TokenReceiverMockVyper = artifacts.require('NFTokenReceiverTestMock.vyper');</span><span id="d4d9" class="lk jc ht mb b fv mo ml l mm mn">module.exports = function(deployer) {<br/>  deployer.deploy(NFToken, [], []);<br/>  deployer.deploy(TokenReceiverMockVyper);<br/>};</span><span id="a0b8" class="lk jc ht mb b fv mo ml l mm mn">$ truffle migrate</span></pre><h1 id="c608" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">发生什么事了</h1><p id="d04b" class="pw-post-body-paragraph kc kd ht kf b kg lf ki kj kk lg km kn lb lh kq kr lc li ku kv ld lj ky kz la hm dt translated">Truper使用Vyper，这也是我们在第一步安装它的原因。如果我们看一下<a class="ae le" href="https://github.com/maurelian/truper/blob/master/index.js" rel="noopener ugc nofollow" target="_blank">https://github.com/maurelian/truper/blob/master/index.js</a>，我们可以看到Truper正在为每个Vyper合同创建Truffle工件文件，并将它们写入。项目的/build/contracts文件夹。</p><h2 id="3a34" class="lk jc ht bd jd ll lm ln jh lo lp lq jl lb lr ls jp lc lt lu jt ld lv lw jx lx dt translated">松露藏物文件</h2><p id="b1d1" class="pw-post-body-paragraph kc kd ht kf b kg lf ki kj kk lg km kn lb lh kq kr lc li ku kv ld lj ky kz la hm dt translated">这些*。json文件包含它们各自的智能合约的描述。描述包括:</p><ul class=""><li id="6a41" class="mp mq ht kf b kg kh kk kl lb mr lc ms ld mt la mu mv mw mx dt translated">合同名称</li><li id="13ba" class="mp mq ht kf b kg my kk mz lb na lc nb ld nc la mu mv mw mx dt translated">契约ABI(应用程序二进制接口-智能契约中所有函数及其参数和返回值的列表)。由Truper使用<code class="eh ly lz ma mb b">$ vyper -f json file.vy</code>创建</li><li id="986a" class="mp mq ht kf b kg my kk mz lb na lc nb ld nc la mu mv mw mx dt translated">合同字节码(编译的合同数据)。由Truper使用<code class="eh ly lz ma mb b">$ vyper -f bytecode file.vy</code>创建</li><li id="9e7c" class="mp mq ht kf b kg my kk mz lb na lc nb ld nc la mu mv mw mx dt translated">契约部署的字节码(部署到区块链的字节码的最新版本)。由Truper创建，使用:<code class="eh ly lz ma mb b">$ vyper -f bytecode_runtime file.vy</code></li><li id="663e" class="mp mq ht kf b kg my kk mz lb na lc nb ld nc la mu mv mw mx dt translated">上次编译协定时使用的编译器版本。(在部署之前不会添加。)</li><li id="b63e" class="mp mq ht kf b kg my kk mz lb na lc nb ld nc la mu mv mw mx dt translated">已部署合同的网络列表以及每个网络上的合同地址。(在部署之前不会添加。)</li></ul><p id="167e" class="pw-post-body-paragraph kc kd ht kf b kg kh ki kj kk kl km kn lb kp kq kr lc kt ku kv ld kx ky kz la hm dt translated">Maurelian将其描述为一个临时的权宜之计，但它确实有效，所以谢谢你！</p><blockquote class="nd"><p id="9c70" class="ne nf ht bd ng nh ni nj nk nl nm la ek translated"><a class="ae le" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="no np nq nr ns iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nn"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>