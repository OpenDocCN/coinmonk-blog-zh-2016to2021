<html>
<head>
<title>Ethereum Contract Inheritance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太契约继承</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethereum-contract-inheritance-427ccb685079?source=collection_archive---------0-----------------------#2017-11-09">https://medium.com/coinmonks/ethereum-contract-inheritance-427ccb685079?source=collection_archive---------0-----------------------#2017-11-09</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/71dad307c2f64cc124e3d7269a13c7aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*QPF2TLrP312R5YXVTiiPaA.png"/></div></figure><p id="785d" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jv">这是摘自</em><a class="ae jw" href="https://concurrence.io/" rel="noopener ugc nofollow" target="_blank"><em class="jv"/></a><em class="jv"/><a class="ae jw" href="https://concurrence.io/exploration/" rel="noopener ugc nofollow" target="_blank"><em class="jv">探索</em></a><em class="jv"/><a class="ae jw" href="https://concurrence.io/exploration/contractinheritance/" rel="noopener ugc nofollow" target="_blank"><em class="jv">契约继承</em> </a> <em class="jv">。</em></p><p id="2c59" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在我们之前，非常聪明的人已经在以太坊合同中找到了共同的模式，并发表了标准化和硬化的例子来扩展。我们将站在他们的肩膀上，对我们舰队的某些部分使用契约继承。让我们深入研究一下这是如何工作的一个例子。</p><p id="20ac" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">与其编码我们自己的所有权层并可能引入不安全性，不如让我们看看从<a class="ae jw" href="https://github.com/OpenZeppelin/zeppelin-solidity" rel="noopener ugc nofollow" target="_blank"> OpenZeppelin的zeppelin-solidity repo </a>继承的东西。</p><p id="8588" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们将创建一个名为<strong class="iz hu"> Inherit </strong>的契约，探索如何继承OpenZeppelin的<a class="ae jw" href="https://github.com/OpenZeppelin/zeppelin-solidity/blob/master/contracts/ownership/Ownable.sol" rel="noopener ugc nofollow" target="_blank"> Ownable </a>契约:</p><figure class="jx jy jz ka fq iu"><div class="bz el l di"><div class="kb kc l"/></div></figure><p id="a85c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这个轻量级契约只有一个状态变量，即<strong class="iz hu">消息</strong>字符串，并且只能由所有者设置。我们没有自己处理逻辑，而是使用了一个来自<a class="ae jw" href="https://github.com/OpenZeppelin/zeppelin-solidity/blob/master/contracts/ownership/Ownable.sol" rel="noopener ugc nofollow" target="_blank"> Ownable </a>契约的修饰符。</p><p id="f3ba" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">同样，在我们可以部署之前，<strong class="iz hu">继承</strong>契约需要添加一个<strong class="iz hu"> dependencies.js </strong>:</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="cfee" class="ki kj ht ke b fv kk kl l km kn">const fs = require('fs'); </span><span id="aafb" class="ki kj ht ke b fv ko kl l km kn">module.exports = {   <br/>'zeppelin-solidity/contracts/ownership/Ownable.sol': fs.readFileSync('zeppelin-solidity/contracts/ownership/Ownable.sol', 'utf8') }</span></pre><p id="b894" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">和一个<strong class="iz hu"> arguments.js </strong>来传递一个字符串给<strong class="iz hu"> Inherit() </strong>构造函数。</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="edb5" class="ki kj ht ke b fv kk kl l km kn">const fs = require('fs'); <br/>module.exports = ["Ethereum is totally rad!"]</span></pre><p id="5fdd" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在我们可以编译和部署<strong class="iz hu">继承</strong>:</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="6802" class="ki kj ht ke b fv kk kl l km kn">node compile Inherit <br/>node deploy Inherit</span></pre><p id="7aca" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><a class="ae jw" href="https://ropsten.etherscan.io/tx/0x7a8bb50c31574bba53b394bd02ce7dffd208c20680ba08656fee4dc4cc5ef385" rel="noopener ugc nofollow" target="_blank"> Ropsten testnet </a>上的合同地址:</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="1fb7" class="ki kj ht ke b fv kk kl l km kn">0xd5fa4a24897db806d4879fd72c1637af5c83af65</span></pre><p id="3d5e" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们需要一个脚本来告诉我们关于<strong class="iz hu">继承</strong>契约的当前信息:</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="19c5" class="ki kj ht ke b fv kk kl l km kn">module.exports = (contract,params,args)=&gt;{   <br/>  contract.methods.message().call().then((message)=&gt;{ <br/>    console.log("MESSAGE:"+message)  <br/>  })<br/>}<br/></span><span id="f9e1" class="ki kj ht ke b fv ko kl l km kn">node contract getMessage Inherit  </span><span id="8c0c" class="ki kj ht ke b fv ko kl l km kn">MESSAGE:Ethereum is totally rad!</span></pre><p id="871b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们还需要一个脚本来告诉我们哪个帐户是当前的所有者:</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="4ddb" class="ki kj ht ke b fv kk kl l km kn">module.exports = (contract,params,args)=&gt;{   <br/>  contract.methods.owner().call().then((owner)=&gt;{    <br/>   console.log("OWNER:"+owner)   <br/>  }) <br/>}<br/></span><span id="c90a" class="ki kj ht ke b fv ko kl l km kn">node contract getOwner Inherit  </span><span id="6ac5" class="ki kj ht ke b fv ko kl l km kn">OWNER:0xA3EEBd575245E0bd51aa46B87b1fFc6A1689965a</span></pre><p id="51c4" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">太棒了，看起来一切都准备好了。现在，让我们看看当我们尝试一个<strong class="iz hu"> setMessage.js </strong>脚本时，它是否正常工作:</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="fb80" class="ki kj ht ke b fv kk kl l km kn">module.exports = (contract,params,args)=&gt;{   <br/>  console.log("**== setting message to "+args[6]+" with account "+params.accounts[args[5]])   <br/>  return contract.methods.setMessage(args[6]).send({     <br/>    from: params.accounts[args[5]],     <br/>    gas: params.gas,     <br/>    gasPrice:params.gasPrice   <br/>  }) <br/>}</span><span id="8242" class="ki kj ht ke b fv ko kl l km kn">node contract setMessage Inherit null 1 "WHAT'S GUCC'?"</span></pre><p id="c93c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">(状态为:<a class="ae jw" href="https://ropsten.etherscan.io/tx/0xffd37b5ceb5284a26d65f194068fa109f7fbb713b9b7c5a915d2a710aace6e34" rel="noopener ugc nofollow" target="_blank"> etherscan.io </a>上的‘0x 0’的交易)</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="0e03" class="ki kj ht ke b fv kk kl l km kn">node contract getMessage Inherit  </span><span id="ffc6" class="ki kj ht ke b fv ko kl l km kn">MESSAGE:WHAT'S GUCC'?</span></pre><p id="f1b3" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">太好了，我们看起来很安全，不用编写和审核我们自己的所有权功能。继承的最后一个测试是看看内置在<a class="ae jw" href="https://github.com/OpenZeppelin/zeppelin-solidity/blob/master/contracts/ownership/Ownable.sol" rel="noopener ugc nofollow" target="_blank"> Ownable </a>契约中的<strong class="iz hu"> transferOwnership() </strong>函数是否对我们的契约有效。</p><p id="8b91" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们需要一个transferOwnership.js脚本:</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="06ea" class="ki kj ht ke b fv kk kl l km kn">module.exports = (contract,params,args)=&gt;{   <br/>  console.log("**== transferring ownership from "+params.accounts[args[5]]+" to "+args[6])   <br/>  return contract.methods.transferOwnership(args[6]).send({     <br/>   from: params.accounts[args[5]],     <br/>   gas: params.gas,     <br/>   gasPrice:params.gasPrice   <br/>  }) <br/>}</span></pre><p id="d56d" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">(在<a class="ae jw" href="https://ropsten.etherscan.io/tx/0x5081fdd66cc9822fe5b65ea72d1afa788f5c8b43ef5928c0a3fe0d5533ae6d73" rel="noopener ugc nofollow" target="_blank"> etherscan.io </a>上的交易)</p><pre class="jx jy jz ka fq kd ke kf kg aw kh dt"><span id="9309" class="ki kj ht ke b fv kk kl l km kn">node contract getOwner Inherit </span><span id="5636" class="ki kj ht ke b fv ko kl l km kn">OWNER:0x4fFD642A057Ce33579a3CA638347b402B909f6D6</span></pre><p id="860b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在编写了一段时间的Solidity和尝试了超级安全的T7，并经历了我们能想到的尽可能多的场景之后，能够依靠一个已经对他们的代码有很多关注的值得信赖的第三方真的很好。随着生态系统的发展，项目将会有越来越多的审计，我们将能够信任越来越多的库。</p><blockquote class="kp"><p id="cc9e" class="kq kr ht bd ks kt ku kv kw kx ky ju ek translated"><a class="ae jw" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="la lb lc ld le iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff kz"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><p id="449b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">更多阅读请访问<a class="ae jw" href="https://concurrence.io" rel="noopener ugc nofollow" target="_blank"> https://concurrence.io </a>。</p><figure class="jx jy jz ka fq iu"><div class="bz el l di"><div class="lf kc l"/></div></figure></div></div>    
</body>
</html>