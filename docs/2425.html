<html>
<head>
<title>Using Waffle — Writing &amp; Testing Smart Contracts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用华夫——撰写和测试智能合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/using-waffle-writing-testing-smart-contracts-b0f350e0f838?source=collection_archive---------0-----------------------#2019-09-30">https://medium.com/coinmonks/using-waffle-writing-testing-smart-contracts-b0f350e0f838?source=collection_archive---------0-----------------------#2019-09-30</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/38c061b78e02d9c338d7da2533642368.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*TC0x5SrhD-5fzSdBupd8ow.png"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek"><strong class="bd jb">Sweeter, Simpler &amp; Faster</strong></figcaption></figure><h1 id="49c1" class="jc jd ht bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated"><strong class="ak">什么是华夫饼？</strong></h1><p id="f7fd" class="pw-post-body-paragraph ka kb ht kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hm dt translated">Waffle是一个用于编写和测试智能合同的库。它更甜，更简单，更快。<br/> <strong class="kc hu">更甜</strong>:极简主义，很少依赖。<br/> <strong class="kc hu">更简单</strong>:语法好，易于扩展。<br/> <strong class="kc hu">更快</strong>:关注测试执行的速度。</p><h1 id="83cf" class="jc jd ht bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated"><strong class="ak">使用华夫饼</strong></h1><h2 id="9aa8" class="ky jd ht bd je kz la lb ji lc ld le jm kl lf lg jq kp lh li ju kt lj lk jy ll dt translated">按照以下步骤开始使用华夫饼:</h2><p id="2dc7" class="pw-post-body-paragraph ka kb ht kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hm dt translated">1.创建项目结构</p><pre class="lm ln lo lp fq lq lr ls lt aw lu dt"><span id="4ba8" class="ky jd ht lr b fv lv lw l lx ly">mkdir using-waffle<br/>cd using-waffle<br/>mkdir build<br/>mkdir contracts<br/>mkdir test</span><span id="db2a" class="ky jd ht lr b fv lz lw l lx ly"><strong class="lr hu">Note:</strong> In case of truffle, <em class="ma">truffle init</em> creates all these directories plus migrations directory, however, there is no <em class="ma">waffle init</em> command as such, thus, creating the project structure is manual.</span></pre><p id="8ada" class="pw-post-body-paragraph ka kb ht kc b kd mb kf kg kh mc kj kk kl md kn ko kp me kr ks kt mf kv kw kx hm dt translated">2.安装依赖项</p><pre class="lm ln lo lp fq lq lr ls lt aw lu dt"><span id="ab2f" class="ky jd ht lr b fv lv lw l lx ly">Ensure you are in the <em class="ma">using-waffle </em>directory.</span><span id="8371" class="ky jd ht lr b fv lz lw l lx ly">npm i ethereum-waffle -D<br/>npm i chai -D<br/>npm i mocha -D</span></pre><p id="db47" class="pw-post-body-paragraph ka kb ht kc b kd mb kf kg kh mc kj kk kl md kn ko kp me kr ks kt mf kv kw kx hm dt translated">3.创建waffle.config.json文件，并在其中添加以下代码</p><figure class="lm ln lo lp fq iu"><div class="bz el l di"><div class="mg mh l"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">using-waffle/waffle.confing.json</figcaption></figure><p id="e9d2" class="pw-post-body-paragraph ka kb ht kc b kd mb kf kg kh mc kj kk kl md kn ko kp me kr ks kt mf kv kw kx hm dt translated">4.将以下脚本添加到package.json</p><figure class="lm ln lo lp fq iu"><div class="bz el l di"><div class="mg mh l"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">using-waffle/package.json</figcaption></figure><p id="9ed4" class="pw-post-body-paragraph ka kb ht kc b kd mb kf kg kh mc kj kk kl md kn ko kp me kr ks kt mf kv kw kx hm dt translated">5.让我们创建一个简单的存储契约</p><pre class="lm ln lo lp fq lq lr ls lt aw lu dt"><span id="a4ad" class="ky jd ht lr b fv lv lw l lx ly">cd contracts<br/>vi SimpleStorage.sol<br/>Paste the below code in it.</span></pre><figure class="lm ln lo lp fq iu"><div class="bz el l di"><div class="mg mh l"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">contracts/SimpleStorage.sol</figcaption></figure><p id="5e3d" class="pw-post-body-paragraph ka kb ht kc b kd mb kf kg kh mc kj kk kl md kn ko kp me kr ks kt mf kv kw kx hm dt translated">6.现在，让我们为上面的契约创建测试文件</p><pre class="lm ln lo lp fq lq lr ls lt aw lu dt"><span id="32d9" class="ky jd ht lr b fv lv lw l lx ly">cd test<br/>vi simpleStorage.test.js<br/>Paste the below code in it</span></pre><figure class="lm ln lo lp fq iu"><div class="bz el l di"><div class="mg mh l"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">test/simpleStorage.test.js</figcaption></figure><p id="a988" class="pw-post-body-paragraph ka kb ht kc b kd mb kf kg kh mc kj kk kl md kn ko kp me kr ks kt mf kv kw kx hm dt translated">注意:</p><ul class=""><li id="d72f" class="mi mj ht kc b kd mb kh mc kl mk kp ml kt mm kx mn mo mp mq dt translated">您可能已经注意到，我们没有明确讨论任何区块链节点(甚至没有ganache)，这是因为功能性<strong class="kc hu"> createMockProvider()。</strong></li><li id="f21b" class="mi mj ht kc b kd mr kh ms kl mt kp mu kt mv kx mn mo mp mq dt translated">契约发出的事件可以用一两行代码测试出来(更简单——华夫:语法很好，易于扩展😄)</li><li id="adf9" class="mi mj ht kc b kd mr kh ms kl mt kp mu kt mv kx mn mo mp mq dt translated">回复测试也是一行程序(甜蜜华夫饼:极简主义😎)</li></ul><p id="5671" class="pw-post-body-paragraph ka kb ht kc b kd mb kf kg kh mc kj kk kl md kn ko kp me kr ks kt mf kv kw kx hm dt translated">7.编译并运行测试</p><pre class="lm ln lo lp fq lq lr ls lt aw lu dt"><span id="5cc5" class="ky jd ht lr b fv lv lw l lx ly">npm run compile<br/>npm run test</span></pre><figure class="lm ln lo lp fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="fe ff mw"><img src="../Images/bdb371164f8e6160178b353c5545878b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5YIvqrPiUQCPfRwc06kew.png"/></div></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">Output of npm run compile and npm run test</figcaption></figure><h1 id="84df" class="jc jd ht bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">结论</h1><p id="48b5" class="pw-post-body-paragraph ka kb ht kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hm dt translated">华夫饼自带优势。与Truffle相比，waffle中的抽象更高，例如，如果您使用Truffle，所有的迁移脚本都保存在迁移目录下，如果是waffle，则没有迁移目录，Waffle会随时为您完成。捕获发出的事件和测试还原案例是一个或两个衬里。一定要试一试，“更甜、更简单、更快——华夫饼。”</p><p id="dc6a" class="pw-post-body-paragraph ka kb ht kc b kd mb kf kg kh mc kj kk kl md kn ko kp me kr ks kt mf kv kw kx hm dt translated">参考资料:</p><div class="nb nc fm fo nd ne"><a href="https://ethereum-waffle.readthedocs.io/en/latest/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab ej"><div class="ng ab nh cl cj ni"><h2 class="bd hu fv z el nj eo ep nk er et hs dt translated">华夫饼文件-华夫饼文件</h2><div class="nl l"><h3 class="bd b fv z el nj eo ep nk er et ek translated">Waffle是一个用于编写和测试智能合同的库。</h3></div><div class="nm l"><p class="bd b gc z el nj eo ep nk er et ek translated">以太坊-华夫饼. readthedocs.io</p></div></div></div></a></div><div class="nb nc fm fo nd ne"><a href="https://github.com/balajipachai/smart-contract-for-fun" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab ej"><div class="ng ab nh cl cj ni"><h2 class="bd hu fv z el nj eo ep nk er et hs dt translated">balajipachai/有趣的智能合同</h2><div class="nl l"><h3 class="bd b fv z el nj eo ep nk er et ek translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nm l"><p class="bd b gc z el nj eo ep nk er et ek translated">github.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns iv ne"/></div></div></a></div><figure class="lm ln lo lp fq iu fe ff paragraph-image"><a href="https://coincodecap.com"><div class="fe ff nt"><img src="../Images/e9dbce386c4f90837b5db529a4c87766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fZu_SfnNF6m_BGbXlsl-A@2x.png"/></div></a></figure><blockquote class="nu"><p id="f747" class="nv nw ht bd nx ny nz oa ob oc od kx ek translated"><a class="ae oe" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="og oh oi oj ok iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff of"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>