<html>
<head>
<title>Hyperledger Caliper —Hyperledger Fabric TPS identification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Hyperledger卡尺-Hyperledger织物TPS标识</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/hyperledger-fabric-tps-identification-using-hyperledger-caliper-f7a5d070f647?source=collection_archive---------5-----------------------#2020-07-03">https://medium.com/coinmonks/hyperledger-fabric-tps-identification-using-hyperledger-caliper-f7a5d070f647?source=collection_archive---------5-----------------------#2020-07-03</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="00b4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> Hyperledger Caliper </strong>是由<strong class="is hu"> Hyperledger </strong>项目提供的平台，方便了各种区块链平台的<strong class="is hu">标杆</strong>，例如</p><ul class=""><li id="4c1e" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">超级分类帐</li><li id="6d77" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">超分类帐洞穴</li><li id="b829" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">以太坊</li><li id="b863" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">超分类帐结构</li><li id="9d79" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">FISCO·BCOS</li><li id="2a8d" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">Hyperledger Iroha</li><li id="c5cf" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">超级账本锯齿。</li></ul><p id="da42" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Hyperledger Caliper目前支持以下指标:资源消耗、事务/读取延迟、事务/读取吞吐量和成功率。</p><p id="4ef8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在这篇博客中，我们将讨论hyperledger caliper的生命周期，<strong class="is hu">如何安装hyperledger caliper </strong>，<strong class="is hu">如何用fabric配置caliper</strong>，最后<strong class="is hu">如何运行一个演示项目</strong>。<strong class="is hu">我们希望您对hyperledger结构有一个基本的了解，并且非常熟悉链码、对等体、订购者、加密材料等术语。</strong></p><p id="313b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">大钩卡尺的生命周期</strong></p><p id="58a4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">hyperledger卡尺的一般生命周期如下:</p><ul class=""><li id="6ed9" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">启动SUT(被测系统)</li><li id="f87e" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">初始化SUT</li><li id="1cdd" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">安装智能合同/链码</li><li id="0059" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">执行基准测试</li><li id="cf8f" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">推倒SUT</li></ul><p id="7870" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">上面提到的是一般步骤，我们没有必要经历每一步，即:我们可以根据我们的要求跳过一两步，例如:测径-流量-跳过-开始-这跳过了SUT的开始</p><p id="cae4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">安装大横杆卡钳</strong></p><p id="531b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Hyperledger caliper发布为一个<strong class="is hu">节点包</strong><a class="ae kc" href="https://www.npmjs.com/package/@hyperledger/caliper-cli" rel="noopener ugc nofollow" target="_blank">@ hyperledger/caliper-CLI</a>，也发布为一个<strong class="is hu">docker image</strong><a class="ae kc" href="https://hub.docker.com/r/hyperledger/caliper" rel="noopener ugc nofollow" target="_blank">hyperledger/caliper</a>。在这个博客中，我们将使用节点包。</p><p id="e7ec" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">基本上有两种方法来安装这个软件包:</p><ul class=""><li id="2fad" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">全球范围:</li><li id="f01b" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">NPM I-g-only<strong class="is hu">=</strong>prod @ hyperledger/caliper-CLI @ 0 . 3 . 0</li><li id="b7e7" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">本地存储库中:</li><li id="f726" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">npm初始化-y</li><li id="9acf" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">NPM I-g-only<strong class="is hu">=</strong>prod @ hyperledger/caliper-CLI @ 0 . 3 . 0</li></ul><p id="d2a1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">安装完软件包后，我们将我们的绑定到我们需要的SDK软件包。这里我们是用面料1.4.6捆绑的。(如果我们在全球范围内安装，我们不需要使用npx前缀，如下所示，我们可以直接使用caliper)</p><ul class=""><li id="3d22" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">npx卡尺粘合-卡尺粘合-sut织物-卡尺粘合-sdk 1.4.6</li></ul><p id="0710" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个绑定过程也可以在我们运行基准/测试过程时自动完成。</p><p id="8874" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">运行演示项目</strong></p><p id="97a4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">hyperledger caliper项目回购附带了构建示例，如织物样本。在本节中，我们将运行一个演示项目，该项目包含以下配置单独订购者、两个各有一个同级的组织和两个ca。该项目是fabric的1.4.1版本。所以我们必须相应地绑定卡尺。</p><p id="0485" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">运行演示的命令非常简单，如下所示。(下面的命令我将SUT SDK和启动命令绑定在一起)</p><ul class=""><li id="4512" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">npx测径仪启动主程序—测径仪-粘合-缝合织物:1.4.0 —测径仪-工作空间。— caliper-benchconfig基准/scenario/simple/config . YAML—caliper-network config networks/fabric/fabric-v 1 . 4 . 1/2 org 1 peergoleveldb/fabric-go . YAML</li></ul><p id="b5c6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">运行此命令，我们将启动演示项目并基于benchmarks/scenario/simple文件夹中的config.yaml文件运行测试，网络配置可以在networks/fabric/fabric/fabric-v 1 . 4 . 1/2 org 1 peergoleveldb/fabric-go . YAML中找到</p><p id="4fc9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">因此，在下一节中，我们将更多地讨论如何开发我们自己的网络配置。</p><p id="706a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">如何用面料项目配置卡尺</strong></p><p id="e763" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我们详细配置卡尺和结构之前，让我们回顾一下刚刚运行的演示，看看其中提到了哪些不同的东西，以便更清楚地了解这些东西。让我们首先分析一下<strong class="is hu"> fabric-go.yaml </strong>文件</p><p id="ead2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> fabric-go.yaml </strong>文件实际上是<strong class="is hu">连接</strong>卡尺和我们的<strong class="is hu"> fabric网络</strong>的文件。如果我们浏览这个文件，我们可以找到一些类似的网络参数的结构。我们基本上配置网络的<strong class="is hu">加密细节以及对等配置和链码版本和语言</strong>。等等</p><p id="8312" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> config.yaml </strong>文件实际上是我们定义<strong class="is hu">轮数</strong>的文件，即要测试的不同链码函数的数量。</p><p id="dcf3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在每一轮中，我们定义了<strong class="is hu"> txNumber </strong>，它表示要执行的事务数量。我们还定义了每秒要发送的tps(每秒事务数)或<strong class="is hu"> txDuration </strong>，它指定了我们将发送事务的持续时间。这就是所谓的<strong class="is hu">速率控制器</strong>。有不同类型的速率控制器:</p><ul class=""><li id="c28b" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated"><strong class="is hu">固定速率:</strong>固定速率控制器是<strong class="is hu">最基本的控制器</strong>，也是没有指定控制器时的默认选项。它将以固定的间隔发送输入事务，该间隔被指定为TPS(每秒事务数)。</li><li id="77d7" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><strong class="is hu">固定反馈率</strong>:固定反馈率控制器是固定反馈率的延伸，最初也会以固定的间隔发送输入交易<strong class="is hu">。当未完成的事务超过为每个客户端定义的未完成事务的次数时，它将通过长时间休眠暂时停止发送输入事务</strong>。</li><li id="357f" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><strong class="is hu">固定积压:</strong>固定积压比率控制器是用于以目标负载(积压事务)驱动测试的控制器。<strong class="is hu">该控制器旨在通过修改被驱动的交易计划来维护系统内已定义的交易积压。结果是系统的最大可能TPS，同时保持积压水平。</strong></li><li id="bea3" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><strong class="is hu">复合速率:</strong>卡尺中的基准轮与单个速率控制器相关联。然而，单个速率控制器很少足以模拟高级客户端行为。此外，为这种行为实现新的速率控制器可能很麻烦并且容易出错。大多数情况下，一个复杂的客户端行为可以分成几个简单的阶段。因此，复合速率控制器使得能够在单轮 中配置<strong class="is hu">多个“更简单”的速率控制器<em class="kd">，促进了现有速率控制器实现的可重用性。复合速率控制器将根据指定的权重在给定的控制器之间自动切换</em></strong></li><li id="9778" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><strong class="is hu">线性速率</strong>:探索系统的性能极限通常包括随着负载强度的增加进行多次测量。然而，通过这种方式找到系统的临界点并不容易，这更像是一种试错法。<strong class="is hu">线性速率控制器可以逐渐地(线性地)在开始和结束TPS值之间改变TPS速率(以增加和减少的方式)</strong>。这使得更容易找到以有趣的方式影响系统性能的工作负载率。线性速率控制器既可用于基于持续时间的回合，也可用于基于交易次数的回合。</li></ul><p id="35b4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">配置文件中下一个重要的东西是<strong class="is hu">回调</strong>。回调实际上指定了一个JavaScript文件，它将在每一轮执行中被调用。这个JavaScript文件主要有三个函数<strong class="is hu"> init </strong>、<strong class="is hu"> run </strong>和<strong class="is hu"> end </strong>。<strong class="is hu"> init </strong>函数是轮次开始时调用的第一个函数，它检索从配置文件传递的所有参数，如<strong class="is hu"> txNumber/txDuration </strong>参数等。在执行<strong class="is hu"> init </strong>函数后，调用<strong class="is hu"> run </strong>函数，在该函数中，我们调用<strong class="is hu"> invokeSmartContract() </strong>，它接受<strong class="is hu">上下文、链代码名称、版本参数和超时</strong>。运行函数执行后，调用<strong class="is hu">结束</strong>函数生成测试报告。</p><p id="69ce" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对于每个链代码调用，如果我们需要传递不同的参数，那么我们需要使用一个函数在这个文件中编写一个相应的逻辑，并在运行函数开始时调用那个函数。同样，如果我们有一轮来自区块链的查询数据，那么我们可能会基于索引或键进行查询，因此我们需要编写一个逻辑来适当地存储这些键或索引，并将其导出，以便在另一轮的回调中使用它。</p><p id="8aab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下面给出了一个代码示例:</p><p id="8cee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">配置文件</strong></p><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff ke"><img src="../Images/67c4299138f6b89bb0b5b13848b05520.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I21zDSvLFF_upPJw"/></div></div></figure><p id="43b4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">工作量模块/回调</strong></p><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff ke"><img src="../Images/13e4c647caf1569bfca51e6ef581705b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QRzsB0B9yk2Fifx3"/></div></div></figure><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff ke"><img src="../Images/671b16ccfb4daf0a4f929be30879aed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zyXBnHbzLgzLZoiM"/></div></div></figure><p id="2677" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">网络配置文件</strong></p><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff kq"><img src="../Images/3402674403cacc44e5df293158efe4df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HuLhzjoces990SvX"/></div></div></figure><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff kr"><img src="../Images/a494a32a6a16cfef76c3c0364299a15b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rN_29LEa8jAsM54W"/></div></div></figure><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff ks"><img src="../Images/df4e0d6d1fdf8eaeb08cdd35f6226eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3oWG3c-0otvVHifG"/></div></div></figure><p id="8773" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">一旦测试完成，caliper将在项目的基本目录中生成一个html格式的详细报告，其中包括我们前面讨论的所有参数。</p><figure class="kf kg kh ki fq kj fe ff paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="fe ff kt"><img src="../Images/56e24617c513d3eb8c82e9896ff061a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uc0S1QYFu5lvHB7q7_IUWQ.png"/></div></div></figure><p id="9ee8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">感谢您抽出宝贵的时间阅读本博客，我希望您对hyperledger caliper及其用途以及配置和测试它的方法有一个基本的了解。希望在那之前回来更多有趣的文章</p><p id="8163" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">✌和平</p><blockquote class="ku"><p id="c145" class="kv kw ht bd kx ky kz la lb lc ld jn ek translated"><a class="ae kc" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="lf lg lh li lj kj fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff le"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>