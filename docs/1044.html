<html>
<head>
<title>Our beautiful immune system in action – Modeling an interactive neural network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们美丽的免疫系统在运行——模拟一个交互式神经网络</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/our-beautiful-immune-system-in-action-modeling-an-interactive-neural-network-1abdb40a868c?source=collection_archive---------2-----------------------#2018-07-15">https://medium.com/coinmonks/our-beautiful-immune-system-in-action-modeling-an-interactive-neural-network-1abdb40a868c?source=collection_archive---------2-----------------------#2018-07-15</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/b38916653bda094a65601527ce3473ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*l6eSfhsGaIUwQWZd-HGJsw.gif"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">White Blood Cell chasing and consuming a Bacterial Organism</figcaption></figure><p id="d4f1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">继续我上一篇<a class="ae jz" rel="noopener" href="/@npattarone/emulating-gene-expression-in-prokaryotes-using-a-javascript-neural-network-fa61ceaa3ab6">文章</a>的相关话题，我想介绍一个我做的小模拟，关于我们的白细胞如何追逐外部威胁，比如细菌。你可以在这里找到回购<a class="ae jz" href="https://github.com/npattarone/lymphocytes-and-bacterias" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="158e" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">基础知识</h1><p id="179a" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">尽管很复杂，但我们的免疫系统可以用不同而迷人的方式追踪威胁，使用不同类型的白细胞，将它们分别放在几种方法上来做到这一点。</p><p id="c200" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我简单模拟的基础是:</p><ul class=""><li id="90ca" class="ld le ht jd b je jf ji jj jm lf jq lg ju lh jy li lj lk ll dt translated"><em class="lm">细菌</em> <strong class="jd hu"> <em class="lm"> </em>逃离白细胞</strong></li><li id="2e06" class="ld le ht jd b je ln ji lo jm lp jq lq ju lr jy li lj lk ll dt translated"><em class="lm">白细胞</em> <strong class="jd hu">追逐细菌留下的化学痕迹</strong></li></ul><p id="338b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">实际上，这部分是正确的。我没有在代码上使用化学痕迹，因为这将导致主要的奉献和开发，这不是本教程的重点。比方说，我只让细菌随机运动，然后让它们从白细胞运动中学习，知道那些是它们不想去或不想去的地方。</p><h1 id="85b6" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">该项目</h1><p id="ee03" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">如果你想了解更多关于神经网络的知识，你可以访问这个<a class="ae jz" href="http://stevenmiller888.github.io/mind-how-to-build-a-neural-network/" rel="noopener ugc nofollow" target="_blank">教程</a>，它包含了关于学习过程如何在神经网络内部发生的完整而详细的解释。</p><p id="6471" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我使用了<em class="lm"> synaptic.js </em>库，一个优秀的javascript库来开始这个主题的工作。它有一个很棒的<a class="ae jz" href="https://github.com/cazala/synaptic/wiki" rel="noopener ugc nofollow" target="_blank"> wiki </a>,里面有一些例子，你可以基于这些例子进行自己的开发，最重要的是，它们真的很容易理解。</p><p id="bb46" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">对于这个特殊的项目，我与建筑师对象一起工作。它允许您创建多层感知器，也称为前馈神经网络。它们由一系列层组成，每一层都与下一层完全相连。</p><figure class="lt lu lv lw fq iu fe ff paragraph-image"><div class="fe ff ls"><img src="../Images/43cce3d53f67ded32bf40ce7f3bef8dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*SxKHIqKDgWKOFuQZ4M2NMA.jpeg"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">Perceptron</figcaption></figure><p id="b942" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因此，对于我们的情况，我们将需要两个不同的神经网络，用不同的数据进行训练。首先，我们有一种特殊的白细胞，即<strong class="jd hu">淋巴细胞</strong>；还有<strong class="jd hu">细菌</strong>本身。快速看一下下面的代码，但是不要太担心不同的值(你可以以后再玩；) ).</p><figure class="lt lu lv lw fq iu"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="02a1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如你所见，它们都声明了一个<strong class="jd hu">感知器</strong>，具有不同的输入、隐藏和输出层值。让我们稍微修改一下:</p><p id="6c07" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="lm">淋巴细胞</em>只定义<strong class="jd hu"> 3输出</strong>(也定义<em class="lm">细菌</em>)。你能想象为什么吗？让我们试着通过想象现实生活中实际发生的事情来抽象出我们的发展目标。淋巴细胞在我们的身体上自由地“随机”移动，每当细菌破坏环境时，它就会成为白细胞的目标，朝着它移动，以便“吃掉它”。好，基本上它会动，对吗？。</p><p id="b250" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我的意图是让这变得更容易，并思考一个<strong class="jd hu"> <em class="lm"> 2D世界</em> </strong>上的动作。换句话说，我们将使用<strong class="jd hu"> <em class="lm">向量</em> </strong>(天啊！)和由<strong class="jd hu"> <em class="lm"> x </em> </strong>和<strong class="jd hu"> <em class="lm"> y </em> </strong>组成的坐标轴的值只有<em class="lm">。</em></p><p id="566f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">回到问题的核心，这个数字<strong class="jd hu"> 3 </strong>代表将<em class="lm">淋巴细胞</em>(或<em class="lm">细菌</em>)移向特定位置所需的预期值，在训练结束时，我们的网将“出汗”出所有的值，预期值:淋巴细胞的细菌位置，以及淋巴细胞远离<em class="lm">细菌的位置</em>。很简单！</p><p id="d94e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，看看我们的世界定义…</p><figure class="lt lu lv lw fq iu"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="74ae" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">当然是细菌和淋巴细胞的集合！因此，请记住这一点，因为这是正确训练我们的网络的最重要的理解。这里我选择添加<strong class="jd hu"> 10淋巴细胞</strong>和<strong class="jd hu"> 2菌苗</strong>。因此，为了使输入对我们的任何有机体都有意义和正确，我们需要使用:它们的<strong class="jd hu"><em class="lm"/></strong>(分解为x和y值)和它们的<strong class="jd hu"> <em class="lm">速度</em> </strong>(也分解x和y上的向量)来训练我们的网络。</p><p id="2a8d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因此，对于<em class="lm">淋巴细胞神经网络</em>，我们将有<strong class="jd hu"> 2个分量用于位置</strong>和<strong class="jd hu"> 2个分量用于速度</strong>，给我们总共<em class="lm"> 4个值乘以2个细菌等于</em> <strong class="jd hu"> <em class="lm"> 8 </em> </strong>。</p><p id="095c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">同样对于<strong class="jd hu">细菌</strong>，<em class="lm"> 4个数值乘以10个淋巴细胞等于</em> <strong class="jd hu"> <em class="lm"> 40。</em> </strong></p><figure class="lt lu lv lw fq iu"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="7626" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">除了知道<em class="lm"> x </em>和<em class="lm"> y </em>值，我们还需要一个<em class="lm">角度</em>(咄！当然我记得高中的代数)，它决定了向量的方向。我们试图从这些价值观中“学习”,换句话说，训练我们的神经网络，让它尽可能准确地知道如何达到目标。</p><p id="3381" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里有几件事值得一提:</p><ol class=""><li id="0b7e" class="ld le ht jd b je jf ji jj jm lf jq lg ju lh jy lz lj lk ll dt translated">这个神经网络以一种内聚的方式工作，这意味着每一组有机体都粘在一起。想象一个排的士兵行进到他们的敌人被设置路障的特定地点；他们必须在团队中工作，联合起来，这样他们才能尽可能的有效。</li></ol><p id="b1ef" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">a) <strong class="jd hu">细菌</strong>“粘在一起”在这个特殊的练习中，这样可以更容易地在画布上描绘出来。我鼓励你在这一点上努力，让它变得更有趣:)，并尝试编码一组非依赖型细菌。</p><p id="a5a3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">b) <strong class="jd hu">淋巴细胞</strong>也一样，然而在现实生活的例子中，它们实际上遵循化学轨迹。我们可以认为它们在我们体内随机传播，当突然遇到其中一个轨迹时，它们会立即开始跟随它。因此，让它们一起工作可能有一定的意义，但这也是出于实际原因。</p><h2 id="0a1f" class="ma kb ht bd kc mb mc md kg me mf mg kk jm mh mi ko jq mj mk ks ju ml mm kw mn dt translated">给我看看《T4的汗水》</h2><ol class=""><li id="3a1f" class="ld le ht jd b je ky ji kz jm mp jq mq ju mr jy lz lj lk ll dt translated">让我们仔细看看训练过程，从<strong class="jd hu"> <em class="lm">淋巴细胞</em> </strong>开始。</li></ol><figure class="lt lu lv lw fq iu"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="d413" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这段代码属于我们的<strong class="jd hu"> <em class="lm"> world.js </em> </strong>文件。首先，我们遍历淋巴细胞集合，在每个循环中，我们遍历细菌集合，并将它们的<em class="lm">位置</em>和<em class="lm">速度值</em>存储在一个数组中。接下来，我们用这个阵列来训练每个淋巴细胞，把网络“喂”到它应该移动的地方。此外，我们定义了一个学习率，可以修改它来“玩”网络行为的快慢/难易/快慢/错误。</p><figure class="lt lu lv lw fq iu"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="fd7e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> <em class="lm">目标</em> </strong>变量掌握着我之前所说的衔接。上面你可以快速浏览一下它是如何工作的。在负责基于属于我们世界的细菌定义和计算位置的几个函数后面(你可以在GitHub的项目源代码中更深入地查看它们)，它检索内聚值，从而允许淋巴细胞群<em class="lm">将</em>粘在一起，此外，跟随它们的<em class="lm">目标</em>，细菌。</p><p id="aae6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最后，循环过程在画布上画出我们淋巴细胞的位置。细菌训练过程也遵循这一逻辑，但在学习向何处移动时略有不同。</p><p id="bcff" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">2.<strong class="jd hu"/></p><figure class="lt lu lv lw fq iu"><div class="bz el l di"><div class="lx ly l"/></div></figure><p id="35ad" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果你想一会儿，你就会意识到这里发生了什么。<strong class="jd hu"> <em class="lm">细菌</em> </strong>不想靠近淋巴细胞吧？所以它们的输入不能是淋巴细胞的位置，这导致我们除了淋巴细胞以外的任何位置。代码上写的差不多:我们用<em class="lm">随机位置和速度</em>训练我们的细菌网络，然后<em class="lm">去除</em>那些属于<em class="lm">淋巴细胞</em>的细菌。正因为如此，我们可能以少于40个输入<strong class="jd hu"><em class="lm"/></strong>(因为我们的细菌网络需要被训练)结束，所以我们继续生成随机输入，直到达到40个。然后，我们把这些值输入网络，并把它画在画布上。</p><figure class="lt lu lv lw fq iu"><div class="bz el l di"><div class="ms ly l"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">Sorry for the horrible resolution :)</figcaption></figure><p id="52bd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">就是这样！:)</p></div><div class="ab cl mt mu hb mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hm hn ho hp hq"><p id="5d1c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">希望你能像我写这篇文章时一样喜欢它！这个项目有大量的工作、改变、修改或游戏。让我知道进展如何！如果你真的喜欢它，请不要忘记鼓掌，这样每个人都可以享受它:)</p></div></div>    
</body>
</html>