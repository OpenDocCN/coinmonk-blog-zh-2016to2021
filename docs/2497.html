<html>
<head>
<title>We Tried Hacking Telegram’s Cryptocurrency TON For 3 Straight Weeks [Part I]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们连续三周尝试入侵Telegram的加密货币吨(第一部分)</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/we-tried-hacking-telegrams-cryptocurrency-ton-for-3-straight-weeks-part-i-eeed1e8273f5?source=collection_archive---------1-----------------------#2019-11-06">https://medium.com/coinmonks/we-tried-hacking-telegrams-cryptocurrency-ton-for-3-straight-weeks-part-i-eeed1e8273f5?source=collection_archive---------1-----------------------#2019-11-06</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="749d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="jo">总结</em><a class="ae jp" href="https://contest.com/blockchain" rel="noopener ugc nofollow" target="_blank"><em class="jo">【https://contest.com/blockchain】</em></a><em class="jo">来自纽扣钱包团队</em></p><p id="d4c4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">不是每个人都听说过几周前<a class="ae jp" href="https://cointelegraph.com/news/telegram-to-award-devs-400k-in-ton-blockchain-smart-contracts-contest" rel="noopener ugc nofollow" target="_blank">发生的</a>电报开放网络竞赛。这是一个非常重要的事件，它改变了TON开发者社区的很多东西。</p><blockquote class="jq jr js"><p id="809e" class="iq ir jo is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated"><em class="ht">正如我们已经</em> <a class="ae jp" href="https://cointelegraph.com/news/what-to-expect-from-the-telegram-open-network-a-developers-perspective" rel="noopener ugc nofollow" target="_blank"> <em class="ht">说过的</em> </a> <em class="ht">，TON相当缺乏一个开发者社区，并且</em><a class="ae jp" href="https://test.ton.org/fiftbase.pdf" rel="noopener ugc nofollow" target="_blank"><em class="ht">Fift</em></a><em class="ht">(TON的智能契约语言)由于其低级的方法而与普通语言大相径庭。</em></p></blockquote><p id="65d1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae jp" href="https://contest.com/blockchain" rel="noopener ugc nofollow" target="_blank">竞赛</a>是吸引新开发者和建立社区的好方法，也是解决缺少文档和例子的问题的好方法。我们决定从我们的角度总结比赛期间和之后发生的一切。</p><h1 id="2cc5" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">缺少文件</h1><p id="d2cf" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">(<strong class="is hu"> FunC </strong>)没有FunC(类C智能合约语言)的文档。这是一个问题，因为大多数吨竞赛任务需要你写一个聪明的合同。FunC——是将要使用的主要语言，可用于编写智能合同。</p><p id="1587" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">用它代替Fift要容易得多。然而，由于缺乏文档(根本没有文档)，每个人都需要分析并试图理解使用funC at编写的几个示例</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="b38f" class="li jx ht le b fv lj lk l ll lm"><a class="ae jp" href="https://github.com/ton-blockchain/ton/tree/master/crypto/smartcont" rel="noopener ugc nofollow" target="_blank">crypto/smartcontract</a></span></pre><p id="bb16" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">文件夹。</p><blockquote class="jq jr js"><p id="a90a" class="iq ir jo is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated">这并不真的那么难，然而，很难理解必要的东西。开始在funC上写东西没有困难大概需要几天时间。</p></blockquote><p id="5f81" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">(<strong class="is hu">基础</strong>)当你用funC写一个智能合约——你需要理解如何部署和编译它，以及如何用参数调用你的函数——基础。有趣的是，没有任何关于这方面的详细信息，也没有完整的步骤示例。</p><p id="fb7a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们很感激TON给了我们一个小的指导方针，这对我们真的很有帮助，但是这仍然很有挑战性。我们发现了如何做到所有这些——但这需要很多时间和痛苦。</p><h1 id="b605" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">关于竞赛任务</h1><p id="5a67" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">我们想强调5中的两个任务。异步支付通道和同步支付通道。那么，什么是支付渠道呢？</p><p id="356a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">支付渠道——是一种在两方<strong class="is hu">之间进行非连锁交易</strong>(在区块链之外)的方式，以使交易更快、更便宜且更具定制性。每一方在区块链上都有自己的账户。</p><blockquote class="jq jr js"><p id="ec65" class="iq ir jo is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated"><em class="ht">此外，还有一种特殊的智能合同，在支付通道开放时，它将存储双方的存款。您可以用您的存款金额在彼此之间发送交易。</em></p></blockquote><p id="4127" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当您需要撤销时，您将调用带有特殊数据的智能合约，这将在下面讨论。</p><figure class="kz la lb lc fq lo fe ff paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="fe ff ln"><img src="../Images/3431c95220518561c9ecbae378289a37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bvr__sqxh_bUypRD"/></div></div></figure><p id="2bab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="jo">代理人A和B向智能合约发送硬币，进行存款以在他们之间开通支付通道</em></p><p id="ebfe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当你打开支付通道时——你需要从双方向智能合约存入资金。</p><figure class="kz la lb lc fq lo fe ff paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="fe ff ln"><img src="../Images/f66b98d56e5decbd358728af53de3d4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jTKXXR97rvp8P8fD"/></div></div></figure><p id="2f8c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="jo"> A向B发送交易，并将支付通道的状态从(A，B)更改为新的状态</em></p><blockquote class="jq jr js"><p id="6a1d" class="iq ir jo is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated"><em class="ht">如果支付通道开放，您可以开始以每秒超过100，00 0笔交易的速度向对方发送交易。</em></p></blockquote><p id="775d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">重要的是要明白，所有事情都发生在链外，有一天你将需要与你的对手达成协议，并从智能合约中撤出你的资金。</p><figure class="kz la lb lc fq lo fe ff paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="fe ff ln"><img src="../Images/e411559e4b2b184498cfc66362eb15a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CpN0p6r10J9Q-S-r"/></div></div></figure><p id="ca20" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="jo">(在同步支付通道从A到B的链外交易的可视化表示)</em></p><p id="82b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们假设每一方都可以欺骗收回所有的池。因此，每一方都需要证明他们将要提取的金额属于他们。</p><p id="c66a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">为了证明这一点</strong> —他们需要发送证明状态正确的每个合作伙伴的签名(金额A、金额B和一些其他信息)。如果我们谈论的是同步支付渠道，我们有一个州号。</p><p id="0c44" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">a不能连续向B发送几笔交易。每个新状态都需要双方(A和B)的签名。因此，当A向B发送交易时，A需要创建一个状态，该状态将改变属于A和B的金额，使用私钥对该状态进行签名，并将新的状态和签名发送给B。</p><p id="c8ab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">只有在交易状态被确认之后。此后，a不能在B之前发送另一个事务。a需要等待B创建一个新的状态。因此，它被称为同步通道。</p><figure class="kz la lb lc fq lo fe ff paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="fe ff ln"><img src="../Images/c96b4b1896f4eeb45c6244d79e92fd87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JVHerV0CIxcDA3d0"/></div></div></figure><p id="7f2b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">(<em class="jo">异步支付通道从A到B的链外交易的可视化表示)</em></p><p id="f93e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在异步支付通道中，每个交易对手都有自己的状态组。每个状态由A从B收到的金额，A发送给B的交易数量，B发送给A的金额，B发送给A的交易数量组成。</p><blockquote class="jq jr js"><p id="603c" class="iq ir jo is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated">在那种情况下，A和B不需要等待确认。他们只需要发送一个签名状态。</p></blockquote><p id="f108" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这两种渠道中最困难的部分是取款过程。智能合同需要检查每一方是否提供了正确的数据来提取资金。</p><p id="e74a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们需要检查状态的签名，并且该状态是最新的。这可能是当事人之间的冲突，智能合同需要根据规则(最新状态)来解决它。必须有保护发送相同的数据到不同的支付渠道，我们也需要解决的情况下，如果一个参与者将不会提供任何信息。</p><p id="2c67" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">所有这些都必须用funC编写，并经过充分测试以确保安全。听起来很有挑战性。</p><h1 id="7444" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">解决方案和竞争对手</h1><p id="ac51" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">根据官方的竞赛渠道，有65份参赛作品。</p><p id="1e60" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">大部分提交的都是多签名钱包和DNS解析器。不过有几家是有支付渠道的。很明显，支付渠道是最复杂的任务，因此解决方案会更少，大多数提供这些解决方案的团队会比其他团队更强大。我们看到了像<a class="ae jp" href="https://contest.com/blockchain/entry363" rel="noopener ugc nofollow" target="_blank"> 363 </a>、<a class="ae jp" href="https://contest.com/blockchain/entry375" rel="noopener ugc nofollow" target="_blank"> 375 </a>、<a class="ae jp" href="https://contest.com/blockchain/entry381" rel="noopener ugc nofollow" target="_blank"> 381 </a>这样的几个强队和方案</p><h1 id="e3a2" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">下一步是什么？</h1><p id="4685" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">目前，大约有10-20个团队拥有足够的技能和知识来开始构建TON的基础设施。我们认为这些团队会将大多数成功的ETH解决方案转移给TON。TON大赛真正改变局面的是能和TON合作的队伍数量。一些团队将继续他们的项目。</p><h1 id="562d" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">纽扣钱包团队体验</h1><p id="567a" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">作为电报的早期采用者和爱好者，我们决定全力以赴。我们有一个很大的团队，大约有8个人。因此，我们决定建立同步和异步支付渠道。</p><p id="b1f5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们在比赛中犯了很多错误，但是，我们成功地用所有的包装器创建了一个同步支付通道，允许您使用我们的CLI存款、取款和发送交易。因此，我们不仅制定了一个智能契约，而且在它上面有许多包装器，使得与TON一起工作更加容易。</p><p id="f5c9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我们完成sync频道后，我们想起了许多我们已经从等离子开发经验中了解到的东西，所以我们建立了另一个智能合同，实现异步链外支付。</p><blockquote class="jq jr js"><p id="525a" class="iq ir jo is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated">然而，我们没能在截止日期前将所有的包装器都写入其中。</p><p id="059f" class="iq ir jo is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated">我们真的很喜欢所有的任务，希望我们有更多的时间来完成它们。但目前我们只有同步和异步支付渠道:)</p></blockquote><p id="6ddb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在即将发布的第2部分中，我们将有更多关于智能合约的细节</p><p id="674c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">由<a class="ae jp" href="https://github.com/button-tech" rel="noopener ugc nofollow" target="_blank">纽扣钱包</a>的首席技术官尼克·科兹洛夫<br/>撰写</p><blockquote class="lv"><p id="dba9" class="lw lx ht bd ly lz ma mb mc md me jn ek translated"><a class="ae jp" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="mg mh mi mj mk lo fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff mf"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>