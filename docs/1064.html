<html>
<head>
<title>Storing on Ethereum. Analyzing the costs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">存储在以太坊上。分析成本</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/storing-on-ethereum-analyzing-the-costs-922d41d6b316?source=collection_archive---------4-----------------------#2018-07-17">https://medium.com/coinmonks/storing-on-ethereum-analyzing-the-costs-922d41d6b316?source=collection_archive---------4-----------------------#2018-07-17</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="764b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当我们开发智能合同时，我们有不同类型的存储可用:</p><ul class=""><li id="b3d5" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">易失性堆栈访问:堆栈</li><li id="a0b4" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">易失性存储器访问:存储器</li><li id="906f" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">非易失性:存储</li></ul><p id="1816" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">此外，我们还可以获得上下文信息:</p><ul class=""><li id="e249" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">与合同关联的代码</li><li id="ce6c" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">访问交易的数据字段</li></ul><blockquote class="kc"><p id="88df" class="kd ke ht bd kf kg kh ki kj kk kl jn ek translated">交易新手？试试<a class="ae km" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或者<a class="ae km" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote><h1 id="51b7" class="kn ko ht bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk dt translated">如何操作不同的存储类型</h1><h2 id="b2da" class="ll ko ht bd kp lm ln lo kt lp lq lr kx jb ls lt lb jf lu lv lf jj lw lx lj ly dt translated">堆</h2><p id="c0b0" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hm dt translated">除了STOP、JUMPDEST和INVALID操作之外，所有以太坊虚拟机操作(EVM操作码)都使用堆栈来读取或写入堆栈。然而，我们将看到不执行任何计算就读取或写入数据的操作:</p><blockquote class="me mf mg"><p id="def4" class="iq ir mh is b it iu iv iw ix iy iz ja mi jc jd je mj jg jh ji mk jk jl jm jn hm dt translated">堆栈深度范围从0到最大值1024</p></blockquote><ul class=""><li id="0b98" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">POP:获取堆栈顶部的值(0级)</li><li id="fb63" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">推送1...PUSH32 (PUSHX):在堆栈顶部插入X个字节</li><li id="aa45" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">DUP1…DUP16 (DUPX):在堆栈顶部复制X处的值</li><li id="c488" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">SWAP1…SWAP16 (SWAPX):交换X和堆栈顶部的值</li></ul><h2 id="22fc" class="ll ko ht bd kp lm ln lo kt lp lq lr kx jb ls lt lb jf lu lv lf jj lw lx lj ly dt translated">记忆</h2><p id="805c" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hm dt translated">对该存储器进行读取或写入的操作包括:</p><ul class=""><li id="d348" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated"><em class="mh"> CALLDATACOPY </em>:读取一个事务的数据字段，并加载到内存中</li><li id="1ef6" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><em class="mh"> CODECOPY </em>:读取与<strong class="is hu">当前合同</strong>关联的代码，并加载到内存中</li><li id="0a1e" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><em class="mh"> EXTCODECOPY </em>:读取与<strong class="is hu">外部契约</strong>相关联的代码，并将其加载到内存中</li><li id="7f2b" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><strong class="is hu"><em class="mh">M</em></strong><em class="mh">LOAD</em>:从存储器中读取一个值</li><li id="9d91" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><strong class="is hu"> <em class="mh"> M </em> </strong> <em class="mh">存储</em>:在内存中存储一个字/32字节<em class="mh"> </em>的值</li><li id="7d6e" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><strong class="is hu"><em class="mh">M</em></strong><em class="mh">store 8</em>:在内存中存储一个8字节<em class="mh"> </em>值</li></ul><h2 id="58d8" class="ll ko ht bd kp lm ln lo kt lp lq lr kx jb ls lt lb jf lu lv lf jj lw lx lj ly dt translated">储存；储备</h2><p id="d171" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hm dt translated">与堆栈和内存不同，存储在该内存上的数据将持久存储在约定地址上，以供将来访问。操作该存储器的操作是:</p><ul class=""><li id="3264" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated"><strong class="is hu"> S </strong>负载</li><li id="0a8f" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><strong class="is hu"> S </strong>店</li></ul><p id="e048" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">值得一提的是，“S”和“M”分别表示存储和内存。</p><h2 id="46ee" class="ll ko ht bd kp lm ln lo kt lp lq lr kx jb ls lt lb jf lu lv lf jj lw lx lj ly dt translated">费用</h2><p id="a0c1" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hm dt translated">所有以前的操作都有以气体单位表示的成本。当用户发送交易时，他/她设置每气单位的ETH价格。矿商已经设定了最低天然气价格，因此更高的最低天然气价格将获得更多利润，但会放弃更多交易。它产生了一个市场，在这个市场上，每种气体都可以进行乙烯醚交易。代码消耗的气体越少，执行代码所需的资源就越有效。下表显示了不同操作的天然气成本，具体取决于数据的大小:</p><figure class="mm mn mo mp fq mq fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff ml"><img src="../Images/3039342c398c9bdcf68e289bf2200d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XXc5DbhiS2jTWpvBbFprXw.png"/></div></div></figure><p id="45f5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最贵的是非易失性存储器。就GAS而言，当大小约为KB时，对存储器的操作类似于对堆栈的操作，但它随大小呈指数增长。下图显示了这种关系:</p><figure class="mm mn mo mp fq mq fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff mx"><img src="../Images/f08672872aefb787e7dc0ae2b464aae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wkWUW5wxy_mfcwxZIQwkAg.png"/></div></div><figcaption class="my mz fg fe ff na nb bd b be z ek">3*&lt;words&gt;+ROUND(POWER(&lt;words&gt;,2)/512,0)</figcaption></figure><p id="f7b8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果我们根据<a class="ae km" href="https://ethgasstation.info/" rel="noopener ugc nofollow" target="_blank">https://ETH gastation . info</a>在ETH中设定天然气价格:</p><figure class="mm mn mo mp fq mq fe ff paragraph-image"><div class="fe ff nc"><img src="../Images/909c45f1efe1fdcbaa698107b9169605.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*YyoIQFjRPyy2nTC6keOugA.png"/></div><figcaption class="my mz fg fe ff na nb bd b be z ek">2018/01/14 12:17 AM</figcaption></figure><p id="55fd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们可以根据ETH来估算每种存储类型的成本:</p><figure class="mm mn mo mp fq mq fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff nd"><img src="../Images/5fa4afcbb4a0b5c7781f33332dfd5a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OrlJKZJPC7FM2pZNxAqeBA.png"/></div></div><figcaption class="my mz fg fe ff na nb bd b be z ek">STD=5gwei, FAST=50gwei</figcaption></figure><p id="ff83" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">上表中的数值是ETH中的价格。采矿者将包括具有更高价格的交易，因此当用户每气支付更多时，他/她的交易将更快地被包括在区块中。</p><p id="5a8c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，我们可以设置一个每以太网的价格，例如1356.30美元:</p><figure class="mm mn mo mp fq mq fe ff paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="fe ff ne"><img src="../Images/73067c37d499bb42104ccadbd181cfcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QfzrnJrZYx3bCNTPD4KDSQ.png"/></div></div><figcaption class="my mz fg fe ff na nb bd b be z ek">1356.3$ = 1 ETH, 2018/01/14 12:17 AM</figcaption></figure><h1 id="b548" class="kn ko ht bd kp kq kr ks kt ku kv kw kx ky nf la lb lc ng le lf lg nh li lj lk dt translated">结论</h1><p id="e989" class="pw-post-body-paragraph iq ir ht is b it lz iv iw ix ma iz ja jb mb jd je jf mc jh ji jj md jl jm jn hm dt translated">在以太坊上永久存储数据非常昂贵。使用以太坊存储数据是没有意义的。它应该只存储正常工作所需的数据，并将存储委托给其他解决方案:Swarm、Filecoin、IPFS等。一个好主意是在外部服务上存储一个<a class="ae km" href="https://en.wikipedia.org/wiki/Merkle_tree" rel="noopener ugc nofollow" target="_blank"> Merkle树</a>根散列作为数据存储的防篡改。</p><p id="be63" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">此外，ETH价格的意外快速上涨会将法定货币的运营成本提高到很高的水平。如果发生这种情况，矿商必须调整他们的最低天然气价格，以重新调整成本。</p><p id="7939" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">从天然气消耗的角度分析智能合同以控制运营成本非常重要。</p><h1 id="d794" class="kn ko ht bd kp kq kr ks kt ku kv kw kx ky nf la lb lc ng le lf lg nh li lj lk dt translated">参考</h1><ul class=""><li id="6f5f" class="jo jp ht is b it lz ix ma jb ni jf nj jj nk jn jt ju jv jw dt translated">【https://ethereum.github.io/yellowpaper/paper.pdf T4】</li><li id="4608" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><a class="ae km" href="https://www.coindesk.com/ethereum-price/" rel="noopener ugc nofollow" target="_blank">https://www.coindesk.com/ethereum-price/</a></li><li id="3783" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><a class="ae km" href="https://remix.ethereum.org" rel="noopener ugc nofollow" target="_blank">https://remix.ethereum.org</a></li></ul><blockquote class="kc"><p id="123c" class="kd ke ht bd kf kg kh ki kj kk kl jn ek translated">加入Coinmonks <a class="ae km" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae km" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae km" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="ll ko ht bd kp lm nl lo kt lp nm lr kx jb nn lt lb jf no lv lf jj np lx lj ly dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="jo jp ht is b it lz ix ma jb ni jf nj jj nk jn jt ju jv jw dt translated"><a class="ae km" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae km" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><a class="ae km" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">电网交易</a> | <a class="ae km" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><a class="ae km" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae km" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="f33b" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><a class="ae km" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae km" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><a class="ae km" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">面向开发人员的最佳加密API</a></li><li id="b359" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">最佳<a class="ae km" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="3c98" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated"><a class="ae km" rel="noopener" href="/coinmonks/free-crypto-signals-48b25e61a8da">免费加密信号</a> | <a class="ae km" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a></li><li id="9487" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">杠杆代币的终极指南</li></ul></div></div>    
</body>
</html>