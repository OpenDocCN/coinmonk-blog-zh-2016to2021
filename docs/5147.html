<html>
<head>
<title>Smart Contract Development &amp; Deployment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">智能合同开发和部署</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/smart-contract-blockchain-splitwise-dapp-544d344c838e?source=collection_archive---------5-----------------------#2021-08-10">https://medium.com/coinmonks/smart-contract-blockchain-splitwise-dapp-544d344c838e?source=collection_archive---------5-----------------------#2021-08-10</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="31bc" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">区块链Splitwise去中心化App</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/67b249e7938c73db48483f8631e1a5a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uBX4ASj2EPKOviZ8wnd2kw.jpeg"/></div></div></figure><p id="85ff" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">你可能听说过智能合约，并对它们的工作原理感到好奇。如果你对这项新技术感兴趣，你就在一个好地方，因为在这篇文章中，我们将发现这些合同是多么有趣，它们是如何有用的。</p><p id="6610" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">为了达到我们的目的，我们将用一个项目来解释这个主题。因此，通过一步一步地理解和做这个项目，你可以找到这些问题的答案:</p><p id="9907" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kq">什么是智能合约？</em>T3】</strong></p><p id="787f" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kq">我们如何将这项技术用于不同的用例？</em> </strong></p><p id="0c52" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">什么是可靠性语言，我们怎样才能写出一份聪明的合同？T11】</p><p id="d4db" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kq">什么是去中心化应用，它们是如何开发的？</em>T15】</strong></p><p id="1355" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">所以有很多话要说，让我们去挖掘它。我们想创建一个去中心化的系统来跟踪借贷Splitwise的区块链版本。如果你没有听说过这款应用，这是一种简单的方法来记录一群人中谁欠谁钱(可能在分摊午餐、杂货或账单后)。为了说明该应用程序，请考虑以下场景:</p><p id="de52" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">艾丽斯、鲍勃和卡罗尔都是喜欢一起出去吃饭的朋友。鲍勃上次和爱丽丝出去吃饭时付了午饭钱，所以爱丽丝欠鲍勃10美元。同样，卡罗尔和鲍勃出去吃饭时付了钱，所以鲍勃欠卡罗尔10美元。</p><p id="436d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">现在，想象一下卡罗尔现金短缺，向爱丽丝借了10美元。请注意，在这一点上，不是每个人都在某个时候偿还他们的“贷款”，而是他们都同意谁也不欠谁。换句话说，无论何时出现债务循环，我们都可以将其从我们的簿记中删除，从而使一切变得更简单，并减少现金转手的次数。</p><p id="706d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">我们将建立一种去中心化的方法来跟踪谁欠谁什么，这样就不需要依赖任何可信的第三方。有了这个介绍，你可能会猜测，这个过程将由一个智能合同来处理。</p><p id="925b" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">智能契约是一段代码，由<strong class="jw hu">管理</strong>流程的<strong class="jw hu">状态。如果所需的条件得到满足，这个自动执行的协议可以使用<strong class="jw hu">区块链</strong>达成不同类型的<strong class="jw hu">协议</strong>。这些合同的关键是被称为区块链的分散网络。</strong></p><p id="2c83" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><code class="eh kr ks kt ku b">Smart contracts</code>使用<code class="eh kr ks kt ku b">blockchain technology</code>到<strong class="jw hu"> <em class="kq">验证</em> </strong>，<strong class="jw hu"> <em class="kq">验证</em> </strong>，<strong class="jw hu"> <em class="kq">捕获</em> </strong>，<strong class="jw hu"> <em class="kq">强制执行</em> </strong>多方约定的条款。我会在另一篇文章中解释更多关于区块链的事情。</p><p id="6c79" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">所以回到我们的项目，我们的<code class="eh kr ks kt ku b">DApp</code>将在智能合约和区块链技术的帮助下编写。因为是在区块链，所以当Carol为她和Bob的餐费买单时，她可以要求Bob提交一张借据(他可以使用我们的DApp来完成)，她可以验证他确实提交了借据。公开的链上存储将作为谁欠谁的唯一事实来源。稍后，当上述循环得到解决时，Carol将看到Bob不再欠她的钱。</p><p id="7763" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">因此，让我们来实现我们的智能合同，您可以添加一个欠条(我欠你)，所以我们需要<code class="eh kr ks kt ku b">IOU</code>功能，我们需要一个获取所有债务的功能，我们需要为用户添加和获取功能。</p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="kw kx l"/></div></figure><p id="5a97" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">从上面的代码中可以看出，<code class="eh kr ks kt ku b">splitwise contract</code>包含了我们所需要的函数。这是一个用solidity语言写的代码。<code class="eh kr ks kt ku b">Solidity</code>是我们用于实施智能合同的语言。它是在以太坊平台上开发的，允许程序员编写区块链DApps。</p><p id="eee8" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><em class="kq">下面我们来看看这些函数是做什么的:</em></p><p id="cfda" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> lookup(地址债务人，地址债权人)</strong>public view Returns(uint 32 ret):返回债务人欠债权人的金额。</p><p id="c18e" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu">add _ IOU(address credential，uint32 amount，...):</strong>通知合同，msg.sender现在欠债权人更多美元。这是附加的:如果你已经欠了钱，这将增加。</p><p id="aaa4" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> addDebt(address债务人，address债权人，int32 amount): </strong>实际上，<strong class="jw hu"> </strong> add IOU函数使用了这个函数，它给出了msg.sender地址而不是债务人，然后，它将债务人和债权人之间的债务增加了给它的金额。它还向用户添加债权人和债务人地址。</p><p id="489c" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">现在是时候部署和运行我们的智能合同了，看看它实际上是如何工作的。为此，我们可以使用<a class="ae kv" href="https://remix.ethereum.org" rel="noopener ugc nofollow" target="_blank">混音网站</a>。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff ky"><img src="../Images/92e32dd5fc25f4f8b00d435fdfa19bd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*rrkIzaj_NvzrUH0ENY3e8g.png"/></div></figure><p id="f61a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在创建了扩展名为<code class="eh kr ks kt ku b">.sol</code>的合同文件后，我们可以通过选择正确的编译器版本从<code class="eh kr ks kt ku b">SOLIDITY COMPILER</code>部分编译它。</p><p id="c45a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在这种状态下，我们需要安装并运行<code class="eh kr ks kt ku b">ganache-cli</code>，这是一个<strong class="jw hu">区块链仿真器</strong>。它用于在我们的本地机器上模拟一个真实的以太坊节点。它允许您调用区块链，而无需运行实际以太坊节点的开销。要安装这个模拟器，首先需要在系统上安装Node.js和npm。然后，您可以通过以下命令轻松安装ganache:</p><p id="871f" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><code class="eh kr ks kt ku b">npm install -g ganache-cli</code></p><p id="6f6c" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">通过运行ganache-cli，它将设置<strong class="jw hu"> 10个默认以太网地址</strong>，包括私钥和所有内容，并为每个地址预装100个模拟以太网。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff kz"><img src="../Images/25ea02bc695cf9f0db06a36ac082368f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*e1_1Xwzb5UGi9YVkpfjs3w.png"/></div></figure><p id="7e01" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">现在，我们可以从remix网站的<code class="eh kr ks kt ku b">DEPLOY &amp; RUN TRABSACTIONS</code>部分轻松地将我们的合同部署到区块链。我们将环境设置为<code class="eh kr ks kt ku b">Web3 Provider</code>，然后将端点设置为<a class="ae kv" href="http://localhost:8545" rel="noopener ugc nofollow" target="_blank">http://localhost:8545</a>——这应该是默认设置。现在，我们也有了部署合同的地址。</p><p id="ee90" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">一旦部署了合同，您就可以使用智能合同的功能并进行交易。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff la"><img src="../Images/3752ab9a74f638a8f2587101d2f4b636.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*DdSfBSwwh8hEuTHj3jHcxQ.png"/></div></figure><p id="e335" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">首先，我们来做一笔欠条交易。默认情况下，我们当前的地址是ganache为我们创建的第一个地址。例如，我们选择ganache地址的第二个地址来表示我们欠它5英镑(ether或$)。完成交易后，我们还可以看到交易详情:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff lb"><img src="../Images/fd2e1678e857074bb322ad3284f050d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*MEXWrSPQjMb8IC49dG0Kpg.png"/></div></figure><p id="b470" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">使用查找函数会告诉我们债务人欠债权人多少钱:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff lc"><img src="../Images/c08e907b4321f75601e443de2b5414c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*SjirZKU-Zf5qpBUPTDQALw.png"/></div></figure><p id="a9ea" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">您可以自己测试其他功能，享受部署智能合约的体验。</p><p id="fb27" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">此外，我们有一个用户界面，为用户计算有用的信息，并允许非程序员使用DApp。在<code class="eh kr ks kt ku b">index.html</code>和<code class="eh kr ks kt ku b">script.js</code>文件中实现。所有的源代码都可以在我的<a class="ae kv" href="https://github.com/mohsenamjadi/Ethereum-Smart-Contract-Blockchain-Splitwise-Solidity" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到。</p><p id="35b7" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">要使用客户端用户界面，只需在script.js文件中用<code class="eh kr ks kt ku b">var contractAddress</code>替换您部署的智能合约的地址，就大功告成了。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff ld"><img src="../Images/cb1cb31226a9178dfede15059fc0c9a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Vk49ZMgnpqH9zW-NTfs4eQ.png"/></div></figure><p id="c7c7" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">此外，更多的细节在客户端源代码中处理，包括<strong class="jw hu">解决债务循环</strong>如下，我稍后将解释它们，或者你可以通过你的好奇心找到它是如何工作的。我希望你喜欢它。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff le"><img src="../Images/3fbf66972879ab385c0909270c424082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*9QR6RadHMYRJGndw96Z6Kg.png"/></div></figure><blockquote class="lf"><p id="abff" class="lg lh ht bd li lj lk ll lm ln lo kp ek translated">加入<a class="ae kv" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank"> Coinmonks电报频道</a>，了解加密交易和投资</p></blockquote></div></div>    
</body>
</html>