<html>
<head>
<title>Loss Optimization in TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">张量流中的损耗优化</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/loss-optimization-in-tensorflow-c4336629504f?source=collection_archive---------1-----------------------#2018-06-24">https://medium.com/coinmonks/loss-optimization-in-tensorflow-c4336629504f?source=collection_archive---------1-----------------------#2018-06-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/c22db78bec5e0697ca584d4673ac7810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R9Nd0WlHp1q_QBBzYZR8Xw.jpeg"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">Optimization is like trying to find the lowest point in a terrain such as this</figcaption></figure><p id="7f32" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">机器学习总是有一个阶段，你做出预测，然后将你的预测与地面事实进行比较。这是<em class="kd">训练</em>步骤。将你的预测与实际情况进行比较的算法是<em class="kd">损失</em>函数。下一步是你<em class="kd">优化</em>损失，尝试减少损失。虽然这不是唯一的目标，但却是最常用的目标。</p><p id="29e0" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">大多数机器学习的学生被教导从头开始实现批量梯度下降、小批量梯度下降和随机梯度下降算法。在了解工作原理后，只有研究人员可能会从头开始继续实现。</p><p id="022f" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">三种算法都有各自的优点，更重要的是，也有各自的局限性。我不会在这里详述，但是你可以在这里阅读Sebastian Ruder的精彩文章<a class="ae ke" href="http://ruder.io/optimizing-gradient-descent/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="d225" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">在本文中，我将向您展示如何在TensorFlow中的自定义函数上实现黑盒优化算法。让我们从导入所需的库开始。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="4428" class="ko kp ht kk b fv kq kr l ks kt">import pandas as pd<br/>import numpy as np<br/>import tensorflow as tf<br/>from tensorflow.python.ops import confusion_matrix<br/>from tensorflow.python.ops import math_ops</span></pre><p id="7ef9" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">我们引入通常的疑点，和两个不常见的疑点来计算均方误差。本例中使用的示例数据集来自Kaggle上的波士顿房价预测。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="6861" class="ko kp ht kk b fv kq kr l ks kt">train_df = pd.read_csv('./train.csv', index_col='ID')</span></pre><p id="1f80" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">让我们从提取地面真相开始。我们需要重塑它来得到一个矩阵或数组。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="fea9" class="ko kp ht kk b fv kq kr l ks kt">y = train_df['medv'].values<br/>y = y.reshape(-1, 1)</span></pre><p id="7fc0" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">对于我们的预测器，我们将添加一个常数列，这样我们就不需要在函数中做任何加法。我们也需要从中提取我们的数组。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="beca" class="ko kp ht kk b fv kq kr l ks kt">train_df['constant'] = 1<br/>columns = ['constant', 'rm', 'zn', 'indus']<br/>x = train_df[columns].values</span></pre><p id="862e" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">因为我们和TensorFlow合作，所以需要和tensors合作。更重要的是，为了优化我们的函数，我们需要指定我们的权重是可训练的。我们在初始化期间这样做。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="9edc" class="ko kp ht kk b fv kq kr l ks kt">w = tf.Variable([[0],[0],[0],[0]], trainable=True, dtype=tf.float64) # this is needed to make the weights trainable<br/>x = tf.convert_to_tensor(x)<br/>y = tf.convert_to_tensor(y)</span></pre><p id="40ea" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">接下来，我们实现我们的预测。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="46e7" class="ko kp ht kk b fv kq kr l ks kt">y_pred = tf.matmul(x, w)</span></pre><p id="4303" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">然后，我们声明我们的损失函数。TensorFlow在TF . loss中提供了许多标准损失函数。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="c8eb" class="ko kp ht kk b fv kq kr l ks kt">mse = tf.losses.mean_squared_error(y, y_pred) # the loss function</span></pre><p id="f35e" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">接下来，我们实例化我们的优化器。这里，我们利用了adam优化器。tf.train中提供了许多优化器。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="421c" class="ko kp ht kk b fv kq kr l ks kt">adam = tf.train.AdamOptimizer(learning_rate=0.3) # the optimizer</span></pre><p id="fb40" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">我们需要一种方法在梯度下降的每一步调用优化函数。我们通过将最小化调用分配给一个句柄来实现这一点。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="364f" class="ko kp ht kk b fv kq kr l ks kt">a = adam.minimize(mse, var_list=w) # this runs one step of gradient descent</span></pre><p id="3f43" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">我们需要知道我们的MSE是什么的方法。虽然这在TensorFlow中存在，但它一直抛出异常，所以我只是在这里实现了它。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="c03c" class="ko kp ht kk b fv kq kr l ks kt">l, p = confusion_matrix.remove_squeezable_dimensions(y, y_pred)<br/>s = math_ops.square(p - l)<br/>mean_t = math_ops.reduce_mean(s)<br/>print(mean_t)</span></pre><p id="1267" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">就这样，我们结束了。当然，这是张量流，我们需要一个会话。</p><pre class="kf kg kh ki fq kj kk kl km aw kn dt"><span id="28a6" class="ko kp ht kk b fv kq kr l ks kt">with tf.Session() as sess:<br/>    sess.run(tf.global_variables_initializer())<br/>    for i in range(200):<br/>        sess.run(a) # run for the number of training steps<br/>    w = sess.run(w)<br/>    <br/>    print(w) # this will output our current weights after training<br/>    e_val = sess.run(mean_t) # compute our MSE<br/>    print(e_val) # print our MSE.</span></pre><p id="d5a7" class="pw-post-body-paragraph jf jg ht jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">我希望这对你的工作或研究有用。编码快乐！</p><blockquote class="ku"><p id="5412" class="kv kw ht bd kx ky kz la lb lc ld kc ek translated">加入Coinmonks <a class="ae ke" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae ke" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae ke" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="ko kp ht bd le lf lg lh li lj lk ll lm jq ln lo lp ju lq lr ls jy lt lu lv lw dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="lx ly ht jh b ji lz jm ma jq mb ju mc jy md kc me mf mg mh dt translated"><a class="ae ke" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae ke" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="lx ly ht jh b ji mi jm mj jq mk ju ml jy mm kc me mf mg mh dt translated"><a class="ae ke" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae ke" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="lx ly ht jh b ji mi jm mj jq mk ju ml jy mm kc me mf mg mh dt translated"><a class="ae ke" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae ke" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="f33b" class="lx ly ht jh b ji mi jm mj jq mk ju ml jy mm kc me mf mg mh dt translated"><a class="ae ke" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae ke" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="lx ly ht jh b ji mi jm mj jq mk ju ml jy mm kc me mf mg mh dt translated"><a class="ae ke" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">开发人员的最佳加密API</a></li><li id="b359" class="lx ly ht jh b ji mi jm mj jq mk ju ml jy mm kc me mf mg mh dt translated">最佳<a class="ae ke" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="lx ly ht jh b ji mi jm mj jq mk ju ml jy mm kc me mf mg mh dt translated">杠杆代币的终极指南</li></ul></div></div>    
</body>
</html>