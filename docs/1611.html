<html>
<head>
<title>Build Smart Contract without Truffle, just Solcjs — Solidity Tutorial 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建智能合约，无需块菌，只需Solcjs —可靠性教程1</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/build-smart-contract-without-truffle-just-solcjs-solidity-tutorial-1-4434f98dbb18?source=collection_archive---------4-----------------------#2018-10-06">https://medium.com/coinmonks/build-smart-contract-without-truffle-just-solcjs-solidity-tutorial-1-4434f98dbb18?source=collection_archive---------4-----------------------#2018-10-06</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/97accc73f7437e561af588a1af59dfca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*w9j4-aWIYhaAjSJqdwCQYw.jpeg"/></div></figure><p id="7224" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">有许多方法来建立坚实的智能合同，如松露框架，Embark JS等。我试图不使用任何DApp框架，只使用Solcjs。</p><p id="ab50" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">下面是gist示例代码</p><figure class="jv jw jx jy fq iu"><div class="bz el l di"><div class="jz ka l"/></div></figure><p id="421c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">首先，在Javascript教程中，我需要声明所有必需的包</p><pre class="jv jw jx jy fq kb kc kd ke aw kf dt"><span id="f8fe" class="kg kh ht kc b fv ki kj l kk kl">const path = require('path');<br/>const fs = require('fs');<br/>const solc = require('solc');<br/>const md5File = require('md5-file');</span><span id="f83d" class="kg kh ht kc b fv km kj l kk kl">// Retrieve the command line arguments<br/>var argv = require('minimist')(process.argv.slice(2));</span></pre><p id="46bc" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">“solc”</strong>是Solidity编译器，它将编译sol源代码，输出JSON格式的ABI &amp;字节码。</p><pre class="jv jw jx jy fq kb kc kd ke aw kf dt"><span id="1cd3" class="kg kh ht kc b fv ki kj l kk kl">var solcInput = {    <br/>    language: "Solidity",    <br/>    sources: { },    <br/>    settings: {<br/>...<br/>    }<br/>};</span></pre><p id="53e8" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> solcInput </strong>变量为solc编译器提供设置。输入参数说明请参见此<a class="ae kn" href="https://solidity.readthedocs.io/en/develop/using-the-compiler.html#compiler-input-and-output-json-description" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><pre class="jv jw jx jy fq kb kc kd ke aw kf dt"><span id="78a2" class="kg kh ht kc b fv ki kj l kk kl">function findImports(importFile) {<br/>...<br/>}</span></pre><p id="1d3c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> findImports() </strong>将被调用来查找外部sol文件，这些文件在sol文件内部用<strong class="iz hu"> import() </strong>语句声明。首先，该函数将尝试在"中查找sol文件。/contracts“文件夹then”。/node_modules”文件夹，然后将sol文件的内容返回给编译器。</p><pre class="jv jw jx jy fq kb kc kd ke aw kf dt"><span id="fce3" class="kg kh ht kc b fv ki kj l kk kl">function buildContract(contract) {<br/>...<br/>}<strong class="kc hu"> </strong></span></pre><p id="7c0e" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> buildContract() </strong>将检查先前编译的JSON格式的文件是否存在。如果编译的JSON文件存在，它将根据编译的JSON文件中记录的校验和检查源sol文件的md5校验和，如果两个校验和都匹配，函数将返回而不编译源。</p><p id="3cf5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果校验和不同或者没有找到JSON文件，该函数将继续执行编译过程，该过程将输出JSON格式的内容。将智能合约部署到以太坊区块链需要“<strong class="iz hu"> abi </strong>”和“<strong class="iz hu">字节码</strong>”字段。</p><p id="ae90" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">下一个教程会讲如何使用web3js将智能合约部署到以太坊区块链。</p><p id="7383" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我的源代码库是这里的<a class="ae kn" href="https://github.com/onimusya/SolidityTutorial" rel="noopener ugc nofollow" target="_blank"/>。😄</p><blockquote class="ko"><p id="d9f1" class="kp kq ht bd kr ks kt ku kv kw kx ju ek translated"><a class="ae kn" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="kz la lb lc ld iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff ky"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>