<html>
<head>
<title>Smart contract architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">智能合同架构</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/smart-contract-architecture-77a17ae9255d?source=collection_archive---------1-----------------------#2021-10-12">https://medium.com/coinmonks/smart-contract-architecture-77a17ae9255d?source=collection_archive---------1-----------------------#2021-10-12</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="c216" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们对应用程序中的智能合约有一个大致的了解。这些合同可以分为三种类型:</p><ul class=""><li id="f5b2" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">NFT分数存储库合同，存储每个独立NFT的铸造NFT股份。这些存储库合同实现了ERC1155标准，因此代表原始NFT的每个令牌都可以分成任意数量。</li><li id="054b" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">持有交换功能的分散交换契约。</li><li id="a7f3" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">跨链实现必要转移功能的桥接协定。</li></ul><p id="19e7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们正在谈论合同组，因为每种类型在每条链上都有一个版本。例如，Polygon和BSC上都存在NFT分数库契约，因为每个链都必须单独处理在特定链上保存了多少分数。</p><p id="ae75" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">两个链上的这些单个契约从一个公共基础契约继承了它们的核心功能，该公共基础契约也属于该智能契约组。</p><p id="fff8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们在下图中将其形象化:</p><figure class="kd ke kf kg fq kh fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kc"><img src="../Images/94aac227c920c39399b21d14846124da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s1SokiW1t9n6OxJ9YlCO-g.jpeg"/></div></div></figure><p id="5cab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在图的中间，是NFT分数存储库合同组。它由特定于每个链的版本(MaticNftFractionsRepository、BscNftFractionsRepository)、它们的基本联系(NftFractionsRepositoryBase)以及可以从另一组合同引用的接口(例如:DexBase合同)组成。</p><p id="74c7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在左侧，有一个结构更简单的Dex合同组:一个基础合同和每个链上的一个版本。特定于链的契约引用了相应链上的NFT分数库契约，例如:MaticDex契约引用了MaticNftRepositoryContract。如果交易成功，Dex必须在交易者之间转让股票，则需要此参考。</p><p id="eb82" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在右侧，有一个与Dex合同结构相似的桥梁合同组。</p><p id="42e7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将在单独的文章中深入探讨每一组的功能，但一般来说，我们可以有两个观察结果:</p><ol class=""><li id="1ab6" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn ko ju jv jw dt translated">持有状态的合同可以通过Openzeppelin升级插件升级。这对于NFT分数储存库组和Dex合同组中的合同是真实的，因为两者都持有状态变量。另一方面，桥契约只实现逻辑，它们没有任何状态(它们只跟踪已处理的随机数，稍后会对它们进行更多的跟踪)，因此它们不必是可升级的。在出现错误的情况下，这些合同可以很容易地用新版本替换，而不需要任何复杂的升级过程来保存状态。可升级合同组从Openzeppelin的可升级合同版本继承其功能(例如:ERC1155Upgradeable、PausableUpgradeable、OwnableUpgradeable等。).你可以在这里阅读更多关于Openzeppelin升级插件和如何写可升级合同的内容。</li><li id="dfaf" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn ko ju jv jw dt translated">这个项目的目的之一是玩技术。这也涵盖了<a class="ae kp" href="https://thegraph.com/" rel="noopener ugc nofollow" target="_blank">图</a>。应用程序的多边形端通过图形读取数据，而BSC端直接从智能合同读取数据，以便能够比较两种解决方案的优缺点。这种差异对我们必须如何编写智能合同产生了影响。与图形集成的组件必须发出事件，其他没有图形的组件必须支持丰富的数据读取功能:契约和数据读取函数中更多的内部数据结构。基于这些功能，我们可以支持数据读取用例。为了能够处理这些差异，基础契约定义了挂钩函数，这些函数可以在子契约中实现，以挂钩特定的功能。在多边形契约的情况下，这些钩子包含事件发射，在BSC契约的情况下，这些钩子函数更新内部数据结构。我们将在深入具体的合同组时详细说明这些差异。</li></ol><p id="f166" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">关于智能合同安全性的一些思考:</p><ul class=""><li id="8b7e" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">合同一般是可以中止的。所以关键功能可以暂停。</li><li id="ca89" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">合同也是可以拥有的。所以有些函数只能被契约的所有者调用。</li><li id="d9de" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">处理货币或股票转移的函数是防止重入的。</li></ul><p id="3c9c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">上述所有功能都是通过适当的Openzeppelin合同实现的。</p><p id="869c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在下一节中，我们将详细介绍<a class="ae kp" rel="noopener" href="/@szmizorsz/nft-fractions-repository-contracts-3ecab96f3d1"> NFT分数库合同</a>。</p><p id="f800" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你想阅读该系列的其他文章，你可以在<a class="ae kp" rel="noopener" href="/@szmizorsz/nft-fractions-decentralised-exchange-introduction-3e696f27c065">的主要文章</a>中找到链接。</p><p id="d753" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">或者如果你想看我的其他项目和贡献:<br/><a class="ae kp" href="https://www.szabolcsszentes.com/" rel="noopener ugc nofollow" target="_blank">https://www.szabolcsszentes.com/</a></p><blockquote class="kq"><p id="1a01" class="kr ks ht bd kt ku kv kw kx ky kz jn ek translated">加入Coinmonks <a class="ae kp" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae kp" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h2 id="6048" class="la lb ht bd lc ld le lf lg lh li lj lk jb ll lm ln jf lo lp lq jj lr ls lt lu dt translated">也阅读</h2><div class="lv lw fm fo lx ly"><a rel="noopener follow" target="_blank" href="/coinmonks/leveraged-token-3f5257808b22"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hu fv z el md eo ep me er et hs dt translated">杠杆代币[多头代币]终极指南</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">杠杆化令牌是具有杠杆化风险敞口的ERC20令牌，不考虑保证金、要求、管理…</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm km ly"/></div></div></a></div><div class="lv lw fm fo lx ly"><a href="https://blog.coincodecap.com/bitsgap-review" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hu fv z el md eo ep me er et hs dt translated">获取信号、交易机器人和套利</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">在本文中，我们将回顾Bitsgap，这是一个满足您所有交易需求的一站式加密交易平台。它…</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">blog.coincodecap.com</p></div></div><div class="mh l"><div class="mn l mj mk ml mh mm km ly"/></div></div></a></div><div class="lv lw fm fo lx ly"><a href="https://blog.coincodecap.com/best-social-trading-platforms" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hu fv z el md eo ep me er et hs dt translated">5个最佳社交交易平台[2021] | CoinCodeCap</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">困惑于社交交易和副本交易哪个平台最好？本文将带您了解各种…</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">blog.coincodecap.com</p></div></div><div class="mh l"><div class="mo l mj mk ml mh mm km ly"/></div></div></a></div><div class="lv lw fm fo lx ly"><a href="https://blog.coincodecap.com/blockfi-review" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hu fv z el md eo ep me er et hs dt translated">BlockFi评论2021:利弊和利率| CoinCodeCap</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">今天，我们提出了一个全面的BlockFi评论，这是一个成立于2017年的加密贷款平台，拥有其…</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">blog.coincodecap.com</p></div></div><div class="mh l"><div class="mp l mj mk ml mh mm km ly"/></div></div></a></div><div class="lv lw fm fo lx ly"><a rel="noopener follow" target="_blank" href="/coinmonks/buy-bitcoin-in-india-feb50ddfef94"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hu fv z el md eo ep me er et hs dt translated">如何在印度购买比特币？2021年购买比特币的7款最佳应用[手机版]</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">如何使用移动应用程序购买比特币印度</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">medium.com</p></div></div><div class="mh l"><div class="mq l mj mk ml mh mm km ly"/></div></div></a></div><div class="lv lw fm fo lx ly"><a rel="noopener follow" target="_blank" href="/coinmonks/best-crypto-tax-tool-for-my-money-72d4b430816b"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hu fv z el md eo ep me er et hs dt translated">加密税务软件——五大最佳比特币税务计算器[2021]</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">不管你是刚接触加密还是已经在这个领域呆了一段时间，你都需要交税。</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">medium.com</p></div></div><div class="mh l"><div class="mr l mj mk ml mh mm km ly"/></div></div></a></div><div class="lv lw fm fo lx ly"><a href="https://blog.coincodecap.com/best-hardware-wallet-bitcoin" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hu fv z el md eo ep me er et hs dt translated">存储比特币的最佳加密硬件钱包[2021] | CoinCodeCap</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">保管您的数字资产很容易，但找到正确的存储方式却是一项繁琐的任务。在线钱包有一个风险…</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">blog.coincodecap.com</p></div></div><div class="mh l"><div class="ms l mj mk ml mh mm km ly"/></div></div></a></div><div class="lv lw fm fo lx ly"><a rel="noopener follow" target="_blank" href="/coinmonks/pionex-review-exchange-with-crypto-trading-bot-1e459d0191ea"><div class="lz ab ej"><div class="ma ab mb cl cj mc"><h2 class="bd hu fv z el md eo ep me er et hs dt translated">Pionex评论2021 |免费加密交易机器人和交换</h2><div class="mf l"><h3 class="bd b fv z el md eo ep me er et ek translated">Pionex是为交易自动化提供工具的后起之秀。Pionex上提供了9个加密交易机器人…</h3></div><div class="mg l"><p class="bd b gc z el md eo ep me er et ek translated">medium.com</p></div></div><div class="mh l"><div class="mt l mj mk ml mh mm km ly"/></div></div></a></div></div></div>    
</body>
</html>