<html>
<head>
<title>Adding peer to a running network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将对等体添加到运行中的网络</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/adding-a-peer-to-a-running-network-3e71e16dd0a?source=collection_archive---------9-----------------------#2020-02-17">https://medium.com/coinmonks/adding-a-peer-to-a-running-network-3e71e16dd0a?source=collection_archive---------9-----------------------#2020-02-17</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/27fb18e6b4cab267b750c810b5ab4780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*U6V0H9W0l6htg0mpiEvPJw.png"/></div></figure><p id="8fa1" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">大家好，</p><p id="6553" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">最近，我与大家讨论了<a class="ae jv" href="https://blog.coincodecap.com/tag/blockchain/" rel="noopener ugc nofollow" target="_blank">区块链</a>中的各种认证选项，我们详细了解了Hyperledger fabric认证考试的模式。</p><p id="ffc1" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">Hyperledger fabric考试中解决问题的一个主题是<strong class="iz hu">向现有网络添加新的对等点</strong>，这是Hyperledger fabric网络日常实施中非常常见的要求，这就是为什么在认证考试中占有一席之地，但这个主题在Hyperledger fabric产品文档中没有一席之地，所以我们在这里将讨论<strong class="iz hu">如何向已经是网络一部分的组织添加对等点，并详细说明所需步骤</strong></p><p id="34e4" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">因此，在我们开始之前，我已经做好了基础工作，示例BYFN网络已经启动并运行</p><p id="16ae" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">您可以按照Hyperledger fabric文档进行同样的操作。</p><div class="jw jx fm fo jy jz"><a href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/build_network.html" rel="noopener  ugc nofollow" target="_blank"><div class="ka ab ej"><div class="kb ab kc cl cj kd"><h2 class="bd hu fv z el ke eo ep kf er et hs dt translated">构建您的第一个网络- hyperledger-fabricdocs主文档</h2><div class="kg l"><h3 class="bd b fv z el ke eo ep kf er et ek translated">编辑描述</h3></div><div class="kh l"><p class="bd b gc z el ke eo ep kf er et ek translated">hyperledger-fabric . readthedocs . io</p></div></div><div class="ki l"><div class="kj l kk kl km ki kn iv jz"/></div></div></a></div><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/989b363bf3dd454d42e7b9c3c9680e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*H6Rflm6pSfjxs-qpxbLTfw.png"/></div></figure><p id="0c92" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在，我们将开始向现有网络添加对等体的过程。</p><p id="45e5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">步骤1 </strong>:更新加密配置文件，如果你知道设置网络的步骤,“加密配置”起着重要的作用，并且是开始的第一步，所以添加对等点也是如此</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff kt"><img src="../Images/cb8f9b35e26130a508fb61243fcd8cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*I7Vm6Cgv8wGUk5b2lJGCeA.png"/></div></figure><p id="bb62" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">加密配置文件的count属性定义了文件中定义的任何org的对等体数量，因此向org添加新的对等体时，首先期望计数增加所需的新对等体数量</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/c18bd230d86aebb30566fe50cc586b84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*LA77VB97gNFBEVJz8cxNQw.png"/></div></figure><p id="ddae" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在加密配置文件的示例byfn网络文件夹中，我们将把计数从2增加到3，因为我们想要添加一个新的对等点</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/00683fd97ee55f609cd7a86cff9294d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*BL48zUsY_v3JS996uFqJzg.png"/></div></figure><p id="73ea" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">步骤2 </strong>:为新的对等体生成证书，现在，由于新的对等体将属于一个现有的组织，并且我们正在用一个对等体扩展该组织，我们将在同一个cryptogen-config文件上再次运行cryptogen工具，但是这一次我们将使用cryptogen工具的扩展标志，而不是生成</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/c35628a08f9eac95ce9da10c26f957fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*DDlYmqTRarimRcNwZ9yILA.png"/></div></figure><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="fe ff ko"><img src="../Images/cb9a9f93774f23a82b6d62446395dff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*I4_tWrcpXsj15umpUPF4Ig.png"/></div></div></figure><p id="08d5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">该命令将简单地更新证书的现有crypto-config文件夹，该文件夹最初只有两个对等体的身份证书，现在将携带我们新对等体的新创建的证书</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ky"><img src="../Images/19e7747e0848b5076b9e3ce16dfcb459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*8sP9if5ZctddiyC-01h0WQ.png"/></div></figure><p id="f7aa" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在这里，您可以看到添加了新的对等文件夹</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/abf8cdd3ffc2dbd9bff243a46bba3039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*MsQXvtNSHvgsmuQU-_uJkA.png"/></div></figure><p id="cffd" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">步骤3 </strong>:为新的对等体设置容器。</p><p id="939d" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在下一步中，我们需要更新网络的docker-compose文件，以包含新的对等容器配置</p><p id="3a06" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">为了便于输入新的对等配置，我们只需引用现有的对等容器配置，并通过更改对等名称来复制相同的配置</p><p id="b4c8" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">docker-compose-CLI . YAML</strong></p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff kz"><img src="../Images/1cdf3165ed1a4b488d19787300e15b98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*CGDVrZ7cd2Ge5rBqdp6zNQ.png"/></div></figure><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff la"><img src="../Images/72a27f9a73e4ea5e6ffddf47bb02b437.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*QwXpRGl80u9JXtLXT8XobQ.png"/></div></figure><p id="cbf1" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">下一个文件是:<strong class="iz hu">docker-compose-base . YAML</strong></p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/29801438dace4152b1cf1ab5afabe717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*4uEEko5shJEM6XxI3RXgbg.png"/></div></figure><p id="1f2c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">复制配置时，请记住准确更新端口、卷和容器名称，而不要更新核心对等引导</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/c09f7e64a7eb47f929f2f8d351dba328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*1qCJqq9hOyjbN0owi-a5pg.png"/></div></figure><p id="7243" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">步骤4 </strong>:接下来的步骤与启动网络非常相似</p><p id="9560" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们将运行与启动网络相同的命令，这一次docker composer将读取配置文件，但这一次将读取新对等体的配置，因为它不存在，composer将使用我们添加的配置为新对等体创建容器。</p><pre class="kp kq kr ks fq lb lc ld le aw lf dt"><span id="3e15" class="lg lh ht lc b fv li lj l lk ll">“docker<strong class="lc hu">-</strong>compose <strong class="lc hu">-</strong>f docker<strong class="lc hu">-</strong>compose<strong class="lc hu">-</strong>cli<strong class="lc hu">.</strong>yaml up <strong class="lc hu">-</strong>d”</span></pre><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/6f5744a8b03bba55ce530ff1e3b52714.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*BvFRJFYyjErI6Jdp5UiXiA.png"/></div></figure><p id="ce90" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在我们可以看到新的对等容器正在运行</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/39095930880548fdd8cc4686d2fcc13d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Pc0993r8vjegu33wfyLn3Q.png"/></div></figure><p id="edc6" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">步骤5 </strong>:接下来我们将这个新的对等体连接到通道</p><p id="89fb" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">让我们进入CLI容器，在这里我们会找到我们之前为其他对等体加入而创建的通道的genesis块，我们将使用同一个块</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/a5e86fd617e26549e40f58da59cecd6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*qpoRErkBCE7bWwNdZGD2Vg.png"/></div></figure><p id="7e6e" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">设置指向新对等点的环境变量</p><pre class="kp kq kr ks fq lb lc ld le aw lf dt"><span id="b02d" class="lg lh ht lc b fv li lj l lk ll">CORE_PEER_MSPCONFIGPATH<strong class="lc hu">=/</strong>opt<strong class="lc hu">/</strong>gopath<strong class="lc hu">/</strong>src<strong class="lc hu">/</strong>github<strong class="lc hu">.</strong>com<strong class="lc hu">/</strong>hyperledger<strong class="lc hu">/</strong>fabric<strong class="lc hu">/</strong>peer<strong class="lc hu">/</strong>crypto<strong class="lc hu">/</strong>peerOrganizations<strong class="lc hu">/</strong>org1<strong class="lc hu">.</strong>example<strong class="lc hu">.</strong>com<strong class="lc hu">/</strong>users<strong class="lc hu">/</strong>Admin@org1<strong class="lc hu">.</strong>example<strong class="lc hu">.</strong>com<strong class="lc hu">/</strong>msp</span><span id="297b" class="lg lh ht lc b fv lm lj l lk ll">CORE_PEER_ADDRESS<strong class="lc hu">=</strong>peer2<strong class="lc hu">.</strong>org1<strong class="lc hu">.</strong>example<strong class="lc hu">.</strong>com:8151</span><span id="d5f1" class="lg lh ht lc b fv lm lj l lk ll">CORE_PEER_LOCALMSPID<strong class="lc hu">=</strong>"Org1MSP"</span><span id="74fd" class="lg lh ht lc b fv lm lj l lk ll">CORE_PEER_TLS_ROOTCERT_FILE<strong class="lc hu">=/</strong>opt<strong class="lc hu">/</strong>gopath<strong class="lc hu">/</strong>src<strong class="lc hu">/</strong>github<strong class="lc hu">.</strong>com<strong class="lc hu">/</strong>hyperledger<strong class="lc hu">/</strong>fabric<strong class="lc hu">/</strong>peer<strong class="lc hu">/</strong>crypto<strong class="lc hu">/</strong>peerOrganizations<strong class="lc hu">/</strong>org1<strong class="lc hu">.</strong>example<strong class="lc hu">.</strong>com<strong class="lc hu">/</strong>peers<strong class="lc hu">/</strong>peer2<strong class="lc hu">.</strong>org1<strong class="lc hu">.</strong>example<strong class="lc hu">.</strong>com<strong class="lc hu">/</strong>tls<strong class="lc hu">/</strong>ca<strong class="lc hu">.</strong>crt</span></pre><p id="f217" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">然后用下面的命令将新的对等体连接到现有的通道</p><pre class="kp kq kr ks fq lb lc ld le aw lf dt"><span id="26b2" class="lg lh ht lc b fv li lj l lk ll">“peer channel join <strong class="lc hu">-</strong>b mychannel<strong class="lc hu">.</strong>block”</span></pre><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/12cfe86811cea2078775cbe95926eaaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*AKL9DdLQs4Yp5neUXinXMQ.png"/></div></figure><p id="bc47" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果我们试图通过这个对等体查询已经在通道上运行的chaincode，这将会失败，因为我们没有在这个对等体上安装chaincode</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/ac90fd00678b2bce568630c62564228e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*dcaXbkeR2AQ1olBvTutfdw.png"/></div></figure><p id="421b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">第六步</strong>:现在我们要在这个对等体上设置链码，完成我们的教程</p><p id="53cc" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们将使用以下命令安装chaincode，</p><pre class="kp kq kr ks fq lb lc ld le aw lf dt"><span id="c50c" class="lg lh ht lc b fv li lj l lk ll">“peer chaincode install <strong class="lc hu">-</strong>n mycc <strong class="lc hu">-</strong>v 1.0 <strong class="lc hu">-</strong>p github<strong class="lc hu">.</strong>com<strong class="lc hu">/</strong>chaincode<strong class="lc hu">/</strong>chaincode_example02<strong class="lc hu">/</strong>go<strong class="lc hu">/”</strong></span></pre><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/01cca704a4d2ea008c5e4d6ece5a886d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*UZwIvwyLqXkMntUmMyiLRQ.png"/></div></figure><p id="275b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">最后，我们将调用安装在新对等体上的chaincode，这将为我们的对等体创建一个新的chaincode容器，并且将花费一些时间来处理第一个调用</p><figure class="kp kq kr ks fq iu fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/8e4076f22dd9c03374126d0f6c0ddc74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*6_qgqjkbYmrFm19MU74l-g.png"/></div></figure><p id="5e1d" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">就这样，我们将org1的一个新对等体添加到了现有的运行网络中。</p><blockquote class="ln"><p id="d756" class="lo lp ht bd lq lr ls lt lu lv lw ju ek translated"><a class="ae jv" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="ly lz ma mb mc iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff lx"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><figure class="kp kq kr ks fq iu fe ff paragraph-image"><a href="https://coincodecap.com"><div class="fe ff md"><img src="../Images/e9dbce386c4f90837b5db529a4c87766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fZu_SfnNF6m_BGbXlsl-A@2x.png"/></div></a></figure></div></div>    
</body>
</html>