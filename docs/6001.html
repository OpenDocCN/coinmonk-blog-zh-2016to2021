<html>
<head>
<title>Connecting to MetaMask +React.js + Custom Hook + State Management</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">连接到MetaMask +React.js +自定义钩子+状态管理</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/connecting-to-metamask-react-js-custom-hook-state-management-2f1f3203f509?source=collection_archive---------0-----------------------#2021-11-07">https://medium.com/coinmonks/connecting-to-metamask-react-js-custom-hook-state-management-2f1f3203f509?source=collection_archive---------0-----------------------#2021-11-07</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/f7bdb2483b8ff562ba5c633134efad75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p7ccJQjQMgHEgoJU"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">Photo by <a class="ae jf" href="https://unsplash.com/@drawkit?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">DrawKit Illustrations</a> on <a class="ae jf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8275" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">将您的dApp连接到MetaMask是让您的应用程序为Web3带来无限可能性的重要一步。创建一个自定义钩子相当简单，可以在整个应用程序中实现这个钩子来处理MetaMask。</p><p id="b1a9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们希望为这个项目实现3件事。</p><ol class=""><li id="56e3" class="ke kf ht ji b jj jk jn jo jr kg jv kh jz ki kd kj kk kl km dt translated">将元掩码连接到React.js应用程序</li><li id="4f49" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated">创建一个自定义钩子来跟踪使用元掩码的应用程序的状态</li><li id="fa3b" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated">在应用程序周围包装一个Web3提供者，以便将来与您选择的ETH链进行交易</li></ol><p id="1c8d" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">最终结果看起来会像这样:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ks"><img src="../Images/1f5016d84618292774b3d3bbb1599269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*p7qm5HYBpnh2jTyf3QqQkw.gif"/></div></div></figure><p id="7c32" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们还将包括一个选项，如果这是用户想要做的，可以从MetaMask断开你的应用程序。</p><p id="6b55" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们走吧！</p><p id="e609" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">让我们首先用React创建一个新的应用程序。我用的是<code class="eh kx ky kz la b">npx create-react-app</code>。我在本教程中也使用了VS代码，只是注意一下。</p><p id="7f4f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">npx create-react-app react-metamask-medium &amp;&amp; cd react-metamask &amp;&amp; code .</code></p><p id="ada8" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">好了，可以走了！您应该有一个简单的react应用程序，如果您打开<strong class="ji hu"> App.js </strong>，它应该是这样的:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lb"><img src="../Images/1c335e7f9a3df8694317e4e4a8e849ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3oFcyZhsi-Aw-NWs8KlGw.png"/></div></div></figure><p id="ca74" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">让我们做一点清洁，把我们不需要的东西都搬走。我将删除<code class="eh kx ky kz la b">&lt;header&gt;&lt;/header&gt;</code>之间的所有内容，并将我的新内容放在那里。我将使用现有的CSS来居中放置新内容:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lc"><img src="../Images/4402c4e4c6d41210b6809e2e11c6c666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U1mUIvZL_Z06UUCutOutwg.png"/></div></div></figure><p id="dba2" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">现在让我们添加几个包，为内容添加一些按钮。我还将添加一个MetaMask标志和hand wave svg，如果你感兴趣，这里有下载链接:<a class="ae jf" href="https://github.com/blakewood84/react-metamask/blob/main/public/images/metamask.svg" rel="noopener ugc nofollow" target="_blank"> metamask.svg </a>。<a class="ae jf" href="https://github.com/blakewood84/react-metamask/blob/main/public/images/noun_waving_3666509.svg" rel="noopener ugc nofollow" target="_blank"> hand.svg </a></p><p id="2bc6" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">yarn add react-bootstrap bootstrap@5.1.3</code></p><p id="e61c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">让我们将<code class="eh kx ky kz la b">import ‘bootstrap/dist/css/bootstrap.min.css’</code>添加到我们的<strong class="ji hu"> index.js </strong>文件中，并删除一些额外的代码。您的index.js应该如下所示:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ca"><img src="../Images/3308378e305ca842f6de7becccdb283c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zs0Jpkew3-iUQtqImHqvZg.png"/></div></div></figure><p id="e059" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">现在让我们将按钮添加到应用程序中，这样我们就可以连接到MetaMask。</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ld"><img src="../Images/3fad4add568f8d228bbe294f7dadfd23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SBDu3BpEEzfYt2db8Tb1GQ.png"/></div></div></figure><p id="2789" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">现在我们需要创建一个自定义钩子，我们可以用它来调用这些按钮上的连接和断开。这个自定义挂钩还将跟踪我们的应用程序的状态，并分发我们需要的任何数据，如<strong class="ji hu">帐户信息</strong>或<strong class="ji hu">余额</strong>。</p><p id="0924" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们应该创建一个名为<strong class="ji hu"> hooks </strong>的文件夹，并为自定义钩子放入<strong class="ji hu"> useMetaMask.js </strong>，这样我们的文件夹结构看起来像这样:<strong class="ji hu">src/hooks/usemetamask . js</strong></p><p id="5b44" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了在整个应用的生命周期中跟踪这个钩子的状态，我们必须利用React的<strong class="ji hu"> createContext </strong></p><p id="43b4" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这有点难以分解，但是对于我们将要填充的简单锅炉板，请参见下面的代码:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff le"><img src="../Images/b5eacc6377a5d7444421ba99d01c2705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-yb-ePZechKej128BbjEiQ.png"/></div></div></figure><p id="029b" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">对于这个组件，我们将需要来自React、<strong class="ji hu"> useState、useEffect、useMemo和useCallback </strong>的以下内容</p><p id="e5d6" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们还需要使用<code class="eh kx ky kz la b">@web3-react/core</code>的<strong class="ji hu"> useWeb3React </strong>钩子，并创建一个名为<strong class="ji hu"> injected的新组件。</strong>该注入组件将利用web3-react/injected-connector将支持的链连接到应用程序和元掩码。</p><p id="41cc" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">让我们运行以下代码:</p><p id="5653" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">yarn add @web3-react/injected-connector @web3-react/core</code></p><p id="f1b8" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">接下来，让我们开始填写我们的新useMetaMask挂钩，以配合我们的应用程序。为此，我们将把所有代码放到<strong class="ji hu"> MetaMaskProvider </strong>组件中。</p><p id="aa82" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">首先，我们想添加useWeb3React钩子来收集一些重要的资源，以便与MetaMask连接。</p><p id="512d" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">const { activate, account, library, connector, active, deactivate } = useWeb3React()</code></p><p id="b966" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我还开始创建一些我想要跟踪的特定状态，比如<strong class="ji hu">活动</strong>和<strong class="ji hu">正在加载。</strong></p><p id="5fd0" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu"> isLoading </strong>将有助于判断useMetaMask钩子何时正在加载，以读取它与MetaMask的连接。<strong class="ji hu"> isActive </strong>将有助于判断MetaMask当前是否通过我允许的应用内部的适当链连接到应用。</p><p id="a7d4" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">const [isActive, setIsActive] = useState(false)</code></p><p id="b050" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">const [isLoading, setIsLoading] = useState(true)</code></p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ld"><img src="../Images/71f47a3ceee83e3ceaea6dd5c3b668c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*13m20KZiutx5KeoYkahfUw.png"/></div></div></figure><p id="6252" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">要查看这个自定义挂钩的完整代码，请<a class="ae jf" href="https://github.com/blakewood84/react-metamask/blob/main/src/hooks/metamask.js" rel="noopener ugc nofollow" target="_blank">单击此处</a></p><p id="5dd3" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">接下来，我应该创建我的注入组件，该组件将用于将元掩码连接到我希望在我的应用程序中使用的特定链。</p><p id="e181" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我将创建一个名为<strong class="ji hu">src/components/wallet/injected . js</strong>的文件夹来存放注入的组件文件。代码很简单:</p><p id="f2e7" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">import { InjectedConnector } from ‘@web3-react/injected-connector’</code></p><p id="9750" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">export const injected = new InjectedConnector({ supportedChainIds: [1, 42, 1337] })</code></p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lf"><img src="../Images/e568638d91499f8aec3f9681ef81dba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mCn6RRGm1gJ4eN25VRQddw.png"/></div></div></figure><p id="918f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu"> supportedChainIds </strong>将有助于确保元掩码连接到我的应用程序正在使用的正确链，否则它不会在我们的自定义钩子中显示活动。</p><p id="6d8c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">有关更多支持链id，请参见<a class="ae jf" href="https://chainlist.org/" rel="noopener ugc nofollow" target="_blank">https://chainlist.org/</a></p><p id="d368" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">1 =以太坊主网<br/>42 = Kovan Testnet——我将在以后的文章中使用Web3和<a class="ae jf" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> Infura </a>来连接它，它将处理简单的事务来测试我的应用程序</p><p id="fe40" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">1337 =本地主机链。为此，我使用<a class="ae jf" href="https://www.trufflesuite.com/ganache" rel="noopener ugc nofollow" target="_blank"> Ganache </a>创建了一个本地链，并连接到我的MetaMask钱包。</p><p id="e14a" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">现在回到我们的<strong class="ji hu">使用MetaMask </strong>钩子。</p><p id="0ad7" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们希望使用没有依赖关系的<strong class="ji hu"> useEffect </strong>，它将在钩子初始化时运行一次。在这个<strong class="ji hu"> useEffect </strong>的内部，钩子将会放在一个<strong class="ji hu"> connect() </strong>函数上，以便在应用首次运行时初始化与应用和元掩码的连接:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lg"><img src="../Images/a4c726ca9f799216150b74c30c293ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sSw6JxQLAUBfRZ8EpTA6Qg.png"/></div></div></figure><p id="7685" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这些函数在被调用时将帮助连接和断开钱包与应用程序的连接。我将它们用作useCallback函数，因为我不希望它们在应用程序中只在被调用时重新渲染超过需要的内容。</p><p id="6269" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">接下来，让我们创建一个<strong class="ji hu"> handleIsActive </strong>函数来检查MetaMask当前是否连接到我们的应用程序。为此，我将使用一个<strong class="ji hu"> useCallback </strong>，并从我们的<strong class="ji hu"> useWeb3React </strong>挂钩中加入<strong class="ji hu"> active </strong>属性，作为一个依赖项，以便在MetaMask与我们的应用程序连接和断开时更新我们的挂钩。这通常是因为用户在MetaMask上为一个未连接到我们的应用程序的链切换帐户:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lh"><img src="../Images/32dc695f8ec8cf95e3df1bb56df64a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ML-FDegZRnBGHipceYQvA.png"/></div></div></figure><p id="a60f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我还创建了一个useEffect钩子，它将依赖于<strong class="ji hu"> handleIsActive </strong>，并且仅当<strong class="ji hu"> active </strong>在<strong class="ji hu"> handleIsActive </strong>回调中发生变化时才运行这个函数。这将在<strong class="ji hu">激活</strong>时更新我们的应用程序，对还是错。从我们的应用断开MetaMask也会导致<strong class="ji hu">活动</strong>为假。</p><p id="2636" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">最后，为了确保useMetaMask自定义钩子在它的任何依赖关系改变时相应地更新我们应用程序的其余部分，我们将使用<strong class="ji hu"> useMemo </strong>来相应地改变钩子的属性。我们这样做是为了让应用程序的其余部分能够判断出<strong class="ji hu">是活动的</strong>还是正在加载的<strong class="ji hu">被更新了。这也将访问我们的<strong class="ji hu">连接</strong>和<strong class="ji hu">断开</strong>功能，加上我们的<strong class="ji hu">账户。</strong>他们只会在我们需要的依赖关系改变时重新评估，比如<strong class="ji hu">是活动的</strong>和<strong class="ji hu">正在加载</strong>:</strong></p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff li"><img src="../Images/98af4ae36a0a87bfe21e3ec72fb3c549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c63NTCl0FGq3aJEYbDstEg.png"/></div></div></figure><p id="3a4c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">酷，现在可以走了。要查看这个定制钩子<a class="ae jf" href="https://github.com/blakewood84/react-metamask-medium/blob/main/src/hooks/metamask.js" rel="noopener ugc nofollow" target="_blank">的完整源代码，请点击这里</a></p><p id="8265" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">最后一步是在我们现有的应用程序周围使用<strong class="ji hu"> Web3ReactProvider </strong>，同时使用我们的<strong class="ji hu"> MetaMaskProvider </strong>来包装应用程序，这样我们就可以让我们的定制钩子的状态一直存在。</p><p id="38c0" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们需要最后添加最后一个依赖项:</p><p id="6719" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">yarn add web3</code></p><p id="864c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">一旦我们将应用程序包装在<strong class="ji hu"> index.js </strong>中，并使用它应该看起来像这样:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lj"><img src="../Images/37243b21f40483a40688c1ad8f3f5c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gx0BOmR5mhtokWdwjXbi0A.png"/></div></div></figure><p id="79c7" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">包装app的原因如下<strong class="ji hu"> Web3ReactProvider </strong>是我们的<strong class="ji hu"> useWeb3React </strong> hook所依赖的，它也为使用<strong class="ji hu"> Web3 </strong>和与我们的app进行交易铺平了道路。</p><p id="6ef2" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在我们的<code class="eh kx ky kz la b">&lt;App /&gt;</code>周围使用<strong class="ji hu"> MetaMaskProvider </strong>使我们能够在整个应用程序中保持自定义钩子的状态。</p><p id="7aea" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">接下来我们可以回到我们的<strong class="ji hu"> App.js </strong>，使用我们创建的自定义钩子。</p><p id="70a1" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">将以下内容放入我们的应用程序:</p><p id="6cc1" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">const { connect, disconnect, isActive, account } = useMetaMask()</code></p><p id="a352" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">此外，我们应该在关联账户旁边注明以下信息:</p><p id="870a" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh kx ky kz la b">{ isActive ? account : ‘’ }</code></p><p id="6456" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这将告诉我们的应用程序，如果帐户连接，然后显示帐户信息。如果不是，则显示一个空字符串。</p><p id="c238" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们还应该连接我们的按钮，以便从useMetaMask挂钩连接和断开功能。</p><p id="b802" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">最终结果将如下所示:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lk"><img src="../Images/a7f5d8cf570e57d6a6bf3190bd8ea809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35wM3DTg_pQP9Q3hgeR4vg.png"/></div></div></figure><p id="ec42" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这是我们的应用程序运行时的样子:</p><figure class="kt ku kv kw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ks"><img src="../Images/1f5016d84618292774b3d3bbb1599269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*p7qm5HYBpnh2jTyf3QqQkw.gif"/></div></div></figure><p id="36c2" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">好极了。感谢你和我一起编码！请点击<a class="ae jf" href="https://github.com/blakewood84/react-metamask-medium" rel="noopener ugc nofollow" target="_blank">https://github.com/blakewood84/react-metamask-medium</a>查看完整的源代码</p><p id="a73c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">如果您对项目或谈论代码感兴趣，请随时在LinkedIn上联系我！<a class="ae jf" href="https://www.linkedin.com/in/blakewoodjr/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/blakewoodjr/</a></p><p id="8bdb" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">非常感谢！祝福</p><blockquote class="ll"><p id="4b7e" class="lm ln ht bd lo lp lq lr ls lt lu kd ek translated">加入Coinmonks <a class="ae jf" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jf" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h2 id="6048" class="lv lw ht bd lx ly lz ma mb mc md me mf jr mg mh mi jv mj mk ml jz mm mn mo mp dt translated">也阅读</h2><div class="mq mr fm fo ms mt"><a rel="noopener follow" target="_blank" href="/coinmonks/leveraged-token-3f5257808b22"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">杠杆代币[多头代币]终极指南</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">杠杆化令牌是具有杠杆化风险敞口的ERC20令牌，不考虑保证金、要求、管理…</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh iz mt"/></div></div></a></div><div class="mq mr fm fo ms mt"><a href="https://blog.coincodecap.com/crypto-exchange" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">最佳加密交易所| 2021年十大加密货币交易所</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">编辑描述</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">blog.coincodecap.com</p></div></div><div class="nc l"><div class="ni l ne nf ng nc nh iz mt"/></div></div></a></div><div class="mq mr fm fo ms mt"><a rel="noopener follow" target="_blank" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">2021年最佳加密借贷平台| 6大比特币借贷平台</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">获得比特币和其他加密货币的最佳贷款利率</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">medium.com</p></div></div><div class="nc l"><div class="nj l ne nf ng nc nh iz mt"/></div></div></a></div><div class="mq mr fm fo ms mt"><a rel="noopener follow" target="_blank" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">2021年最佳免费加密交易机器人</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">2021年币安、比特币基地、库币和其他密码交易所的最佳密码交易机器人。四进制，位间隙…</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">medium.com</p></div></div><div class="nc l"><div class="nk l ne nf ng nc nh iz mt"/></div></div></a></div><div class="mq mr fm fo ms mt"><a rel="noopener follow" target="_blank" href="/coinmonks/best-crypto-signals-telegram-5785cdbc4b2b"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">最佳4个加密交易信号电报通道</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">这是乏味的找到正确的加密交易信号提供商。因此，在本文中，我们将讨论最好的…</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">medium.com</p></div></div><div class="nc l"><div class="nl l ne nf ng nc nh iz mt"/></div></div></a></div><div class="mq mr fm fo ms mt"><a href="https://blog.coincodecap.com/best-social-trading-platforms" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">5个最佳社交交易平台[2021] | CoinCodeCap</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">编辑描述</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">blog.coincodecap.com</p></div></div></div></a></div><div class="mq mr fm fo ms mt"><a href="https://blog.coincodecap.com/blockfi-review" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">BlockFi评论2021:利弊和利率| CoinCodeCap</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">编辑描述</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">blog.coincodecap.com</p></div></div><div class="nc l"><div class="nm l ne nf ng nc nh iz mt"/></div></div></a></div><div class="mq mr fm fo ms mt"><a rel="noopener follow" target="_blank" href="/coinmonks/buy-bitcoin-in-india-feb50ddfef94"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">如何在印度购买比特币？2021年购买比特币的7款最佳应用[手机版]</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">如何使用移动应用程序购买比特币印度</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">medium.com</p></div></div><div class="nc l"><div class="nn l ne nf ng nc nh iz mt"/></div></div></a></div><div class="mq mr fm fo ms mt"><a rel="noopener follow" target="_blank" href="/coinmonks/best-crypto-tax-tool-for-my-money-72d4b430816b"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">加密税务软件——五大最佳比特币税务计算器[2021]</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">不管你是刚接触加密还是已经在这个领域呆了一段时间，你都需要交税。</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">medium.com</p></div></div><div class="nc l"><div class="no l ne nf ng nc nh iz mt"/></div></div></a></div><div class="mq mr fm fo ms mt"><a href="https://blog.coincodecap.com/best-hardware-wallet-bitcoin" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">存储比特币的最佳加密硬件钱包[2021] | CoinCodeCap</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">编辑描述</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">blog.coincodecap.com</p></div></div><div class="nc l"><div class="np l ne nf ng nc nh iz mt"/></div></div></a></div><div class="mq mr fm fo ms mt"><a rel="noopener follow" target="_blank" href="/coinmonks/pionex-review-exchange-with-crypto-trading-bot-1e459d0191ea"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">Pionex评论2021 |免费加密交易机器人和交换</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">Pionex是为交易自动化提供工具的后起之秀。Pionex上提供了9个加密交易机器人…</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">medium.com</p></div></div><div class="nc l"><div class="nq l ne nf ng nc nh iz mt"/></div></div></a></div></div></div>    
</body>
</html>