<html>
<head>
<title>Augmented Reality: Google’s ARCore Sample App Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">增强现实:谷歌的ARCore示例应用教程</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/arcore-tutorial-21d67fce04dd?source=collection_archive---------2-----------------------#2018-06-25">https://medium.com/coinmonks/arcore-tutorial-21d67fce04dd?source=collection_archive---------2-----------------------#2018-06-25</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/6c5adadd317dcf141adc942f85d6bc80.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*AjZ5OBkuFK4geYO5FnySMA.jpeg"/></div></figure><p id="6759" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在完成ARCore之后，我不可能不写它。毫无疑问，这是最好的基于增强现实的库之一，我强烈建议你尝试一下。</p><p id="8944" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在这篇文章中，我将概述ARCore，并使用Google提供的HelloAr示例应用程序解释ARCore的功能。</p><h1 id="198f" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dt translated">概观</h1><p id="d427" class="pw-post-body-paragraph ix iy ht iz b ja kt jc jd je ku jg jh ji kv jk jl jm kw jo jp jq kx js jt ju hm dt translated">ARCore是谷歌构建增强现实体验的平台。它是苹果开发的ArKit的替代产品，用于在android设备上构建基于增强现实的应用程序。ArCore使用不同的API，使开发人员能够感知环境、理解世界并与信息交互。</p><p id="b4b9" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">ARCore提供的算法集exposed APIs是Tango项目的成果，由于一些原因，该项目无法公开。</p><p id="975b" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">ARCore使用三种关键功能将虚拟内容与通过手机摄像头看到的真实世界相结合:</p><ul class=""><li id="037f" class="ky kz ht iz b ja jb je jf ji la jm lb jq lc ju ld le lf lg dt translated"><a class="ae lh" href="https://developers.google.com/ar/discover/concepts#motion_tracking" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hu">动作追踪</strong> </a>让手机了解并追踪自己相对于世界的位置。</li><li id="1942" class="ky kz ht iz b ja li je lj ji lk jm ll jq lm ju ld le lf lg dt translated"><a class="ae lh" href="https://developers.google.com/ar/discover/concepts#environmental_understanding" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hu">环境理解</strong> </a>允许手机检测所有类型表面的大小和位置:水平、垂直和有角度的表面，如地面、茶几或墙壁。</li><li id="5271" class="ky kz ht iz b ja li je lj ji lk jm ll jq lm ju ld le lf lg dt translated"><a class="ae lh" href="https://developers.google.com/ar/discover/concepts#light_estimation" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hu">光线估计</strong> </a>允许手机估计环境的当前光线条件</li></ul><p id="554f" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">希望你对ARCore有个大概的了解。为了更好地理解该平台，让我们深入了解HelloAR示例应用程序。我将使用unity框架来解释该应用程序，但是这些知识可以扩展到所有其他框架。</p><h1 id="2514" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dt translated">辅导的</h1><p id="d4c5" class="pw-post-body-paragraph ix iy ht iz b ja kt jc jd je ku jg jh ji kv jk jl jm kw jo jp jq kx js jt ju hm dt translated">HelloAR核心应用利用了一堆类，这些类在<a class="ae lh" href="https://developers.google.com/ar/reference/" rel="noopener ugc nofollow" target="_blank">这个</a>链接中有很好的记录。</p><p id="c845" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">一开始，应用程序启动一个名为Session的实例。GoogleARCore。Session是处理应用程序与ARCore服务通信的类。每个会话在应用程序启动时启动,“SessionStatus”用于确定应用程序的跟踪状态。</p><p id="ea2a" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">该会话将处于跟踪状态，除非并且直到它能够从它已经检测到的点中找到平面。会话检测到的平面由</p><pre class="ln lo lp lq fq lr ls lt lu aw lv dt"><span id="d33e" class="lw jw ht ls b fv lx ly l lz ma">Session.GetTrackables&lt;DetectedPlane&gt;(temp); </span></pre><p id="6eb0" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">变量temp将保存会话能够找到的所有检测到的平面。</p><p id="6b1a" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在不用物理学。Raycast是Unity框架提供的光线投射方法，googleARCore使用自己的光线投射实现，可以通过以下方式访问</p><pre class="ln lo lp lq fq lr ls lt lu aw lv dt"><span id="9cbe" class="lw jw ht ls b fv lx ly l lz ma">Frame.Raycast(<br/>  float x,<br/>  float y,<br/>  <a class="ae lh" href="https://developers.google.com/ar/reference/unity/namespace/GoogleARCore.html#namespaceGoogleARCore_1a8da5a2395bdef6ffe411700df5a713ff" rel="noopener ugc nofollow" target="_blank"><strong class="ls hu">TrackableHitFlags</strong></a> filter,<br/>  out <a class="ae lh" href="https://developers.google.com/ar/reference/unity/struct/GoogleARCore/TrackableHit.html#structGoogleARCore_1_1TrackableHit" rel="noopener ugc nofollow" target="_blank"><strong class="ls hu">TrackableHit</strong></a> hitResult<br/>)</span></pre><figure class="ln lo lp lq fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="fe ff mb"><img src="../Images/68751e95a1b89ad6af178287db80e15b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*EWXE5t3eo7ai0JcJi45JSw.jpeg"/></div></div><figcaption class="mg mh fg fe ff mi mj bd b be z ek">User touch for RayCast</figcaption></figure><p id="b909" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这个特定的函数从一个点发送光线，该点由参数x，y指定，并转储对象的数量，具有网格过滤器的刚性对象，光线在其路径上命中，在真实世界场景中，在可跟踪的外部命中。</p><p id="1d13" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">当用户手势通过轻击屏幕来选择现实世界中的位置时，使用上面的API。然后，向用户触摸点的方向发送光线投射，并且只有当光线投射在hitResult上给出检测到的平面时，虚拟对象才被放置在该平面上。相同的代码如下所示:-</p><blockquote class="mk ml mm"><p id="7b11" class="ix iy mn iz b ja jb jc jd je jf jg jh mo jj jk jl mp jn jo jp mq jr js jt ju hm dt translated">TrackableHit命中；<br/>trackable hit flags raycast filter = trackable hit flags。planewithpolygon | TrackableHitFlags。FeaturePointWithSurfaceNormal</p><p id="f640" class="ix iy mn iz b ja jb jc jd je jf jg jh mo jj jk jl mp jn jo jp mq jr js jt ju hm dt translated">如果(帧。Raycast(touch.position.x，touch.position.y，raycastFilter，out hit)) <br/> { <br/> //检查out hit是否为检测平面<br/>如果((hit。trackable is detected plane)<br/>{<br/>//添加虚拟物体<br/> }</p><p id="3858" class="ix iy mn iz b ja jb jc jd je jf jg jh mo jj jk jl mp jn jo jp mq jr js jt ju hm dt">}</p></blockquote><p id="068c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">为了将对象添加到虚拟空间，您需要该对象在现实世界中的位置和旋转。利用光线在检测平面上的入射点可以容易地获得位置。</p><pre class="ln lo lp lq fq lr ls lt lu aw lv dt"><span id="156d" class="lw jw ht ls b fv lx ly l lz ma">hit.Pose.position ; //Position of the incidence </span></pre><p id="f2a2" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">为了设置旋转，你需要自己做一些调整，这主要取决于想要的输出。但是，您可以访问相机的旋转，入射平面的旋转，平面的法线等。您可以使用这些旋转作为参考，然后相应地旋转对象。</p><pre class="ln lo lp lq fq lr ls lt lu aw lv dt"><span id="3e11" class="lw jw ht ls b fv lx ly l lz ma">hit.Pose.rotation; //Rotation of the incidence of the ray to plane</span><span id="d83d" class="lw jw ht ls b fv mr ly l lz ma">//rotation of the plane on to which the ray cast hits.((DetectedPlane)hit.Trackable).CenterPose.rotation ; </span></pre><p id="f3d5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">旋转是以四元数而不是欧拉角提供的，尽管您可以使用以下API将它们相互转换。</p><pre class="ln lo lp lq fq lr ls lt lu aw lv dt"><span id="97fe" class="lw jw ht ls b fv lx ly l lz ma">//For euler to quaternion<br/>Quaternion.Euler(x, y,z ); // where x,y,z are euler angles</span><span id="ce05" class="lw jw ht ls b fv mr ly l lz ma">//For getting euler angles from the quaternion variable<br/>Quaternion q ; <br/>q.eulerAngles.x ; //get x rotation <br/>q.eulerAngles.y ; //get y rotation<br/>q.eulerAngles.z ; //get z rotation</span></pre><p id="4813" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在，一旦您在AR空间中实例化/创建了虚拟对象，您将需要确保即使当您移动时，该对象也相对于创建它的平面保持在相同的位置。此外，随着对空间理解的发展，保留以前的数据也很重要。使用锚，googleArCore能够有效地解决这个问题。锚点用于创建虚拟对象和检测到的平面之间的链接。每当飞机在现实世界空间中显示时，物体总是与它相关联。</p><pre class="ln lo lp lq fq lr ls lt lu aw lv dt"><span id="f9ca" class="lw jw ht ls b fv lx ly l lz ma">var anchor = hit.Trackable.CreateAnchor(hit.Pose);                     // Make Andy model a child of the anchor.                    andyObject.transform.parent = anchor.transform;</span></pre><figure class="ln lo lp lq fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="fe ff ms"><img src="../Images/69c26ccd55fd5f3c3ff9488b99c50d8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdFgbzI8Ybent6VmdCMfNA.png"/></div></div></figure><p id="1543" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这些是googleArCore提供的HelloAR示例应用程序中使用的主要API。为了更好地理解每个API和类，你可以在这里阅读详细的文档<a class="ae lh" href="https://developers.google.com/ar/reference/unity/" rel="noopener ugc nofollow" target="_blank"><strong class="iz hu"><em class="mn"/></strong></a>。另外，在开始开发之前，确保你有一部支持ARCore的手机，你可以在这里  找到支持手机的列表<a class="ae lh" href="https://developers.google.com/ar/discover/supported-devices" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hu"> <em class="mn">。</em></strong></a></p><h1 id="270f" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dt translated">缺点</h1><p id="ce34" class="pw-post-body-paragraph ix iy ht iz b ja kt jc jd je ku jg jh ji kv jk jl jm kw jo jp jq kx js jt ju hm dt translated">我在使用ARCore时面临的唯一缺点是无法更改或调整用于特征跟踪和平面检测的算法参数。公开的API所使用的算法在任何地方都没有记录，而且开发人员也不能根据自己的问题调整参数。例如，特征点检测、表面检测、光估计是可以使用的不同功能，但是不能由开发者调整。然而，API的执行和工作本身就非常强大，并且在许多不同的场景中都能很好地工作。</p><p id="fbca" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果你对我的帖子或ARCore有任何疑问，请在下面评论。我会尽我所能帮助你。开发愉快:)。</p><blockquote class="mt"><p id="ccc7" class="mu mv ht bd mw mx my mz na nb nc ju ek translated">加入Coinmonks <a class="ae lh" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae lh" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae lh" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="lw jw ht bd jx nd ne nf kb ng nh ni kf ji nj nk kj jm nl nm kn jq nn no kr np dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="ky kz ht iz b ja kt je ku ji nq jm nr jq ns ju ld le lf lg dt translated"><a class="ae lh" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae lh" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="ky kz ht iz b ja li je lj ji lk jm ll jq lm ju ld le lf lg dt translated"><a class="ae lh" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae lh" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="ky kz ht iz b ja li je lj ji lk jm ll jq lm ju ld le lf lg dt translated"><a class="ae lh" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae lh" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="f33b" class="ky kz ht iz b ja li je lj ji lk jm ll jq lm ju ld le lf lg dt translated"><a class="ae lh" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae lh" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="ky kz ht iz b ja li je lj ji lk jm ll jq lm ju ld le lf lg dt translated"><a class="ae lh" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">面向开发人员的最佳加密API</a></li><li id="b359" class="ky kz ht iz b ja li je lj ji lk jm ll jq lm ju ld le lf lg dt translated">最佳<a class="ae lh" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="ky kz ht iz b ja li je lj ji lk jm ll jq lm ju ld le lf lg dt translated"><a class="ae lh" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币终极指南</a></li></ul></div></div>    
</body>
</html>