<html>
<head>
<title>Micro Services pipeline for an Industrial Internet of Things (IIOT) Framework… towards Data Engineering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向数据工程的工业物联网(IIOT)框架的微服务管道</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/micro-services-pipeline-for-an-industrial-internet-of-things-a8cdd67f1eb9?source=collection_archive---------4-----------------------#2018-07-15">https://medium.com/coinmonks/micro-services-pipeline-for-an-industrial-internet-of-things-a8cdd67f1eb9?source=collection_archive---------4-----------------------#2018-07-15</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="a0a7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是我第一次在Medium上分享我硕士论文的摘录；微服务架构如何帮助我在6个月的时间内开发出一个工业物联网框架。</p><p id="f84d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这也是为了写给渴望论文(或最后一年项目)的学生，渴望了解多个小应用程序如何在企业级应用程序中发挥更大作用的新开发人员，以及所有经验丰富/熟练的观众，他们会对我如何在论文实施中取得辉煌给予反馈。这篇论文是我在德国亚琛工业大学<strong class="is hu">🇩🇪.</strong>攻读硕士学位的一部分</p><blockquote class="jo"><p id="b624" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated">“我们的想法是利用物联网中的技术，并将它们与第四代工业革命(即工业4.0)重叠。”</p></blockquote><figure class="jz ka kb kc kd ke fe ff paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="fe ff jy"><img src="../Images/37460ced2492ef515efdebb4541a47a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UeptKy7XPFtY5ASjU72FzA.jpeg"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek"><a class="ae kp" href="https://www.amec.com.vn/du-hoc-duc-voi-10-truong-dai-hoc-hang-dau-dao-tao-nganh-y.html" rel="noopener ugc nofollow" target="_blank">SuperC Building, RWTH Aachen University</a></figcaption></figure><p id="5fa3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在几乎每个人都听说过微服务这个词；专用于执行一些特定任务的小型应用程序/服务，独立于任何其他软件或服务。对于新手来说，这并不是什么太复杂的事情，只是一个松散耦合(几乎没有依赖性)的软件服务的概念，它们结合在一起形成了一个完整的应用程序。</p><blockquote class="kq kr ks"><p id="a7ad" class="iq ir kt is b it iu iv iw ix iy iz ja ku jc jd je kv jg jh ji kw jk jl jm jn hm dt translated">微服务架构(有时也称为面向服务的架构)是一个复杂应用程序的服务集合。它的概念是，如果应用程序的任何部分出现故障，它不应该影响周围的其他特性和功能。听起来很可靠，很健壮，对吧？</p></blockquote><p id="fe62" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">虽然微服务架构(MSA)没有正式的定义，但是有一些特征可以证明这一点。<strong class="is hu">马丁·福勒</strong>将<strong class="is hu">微服务描述为；具有可扩展性、业务能力、自动化部署、端点智能以及语言和数据分散控制的软件应用</strong>。</p><blockquote class="kq kr ks"><p id="35c0" class="iq ir kt is b it iu iv iw ix iy iz ja ku jc jd je kv jg jh ji kw jk jl jm jn hm dt translated">微服务架构的<strong class="is hu">*替代方案</strong>是<strong class="is hu">单片应用</strong>，构建在单个编程堆栈上，每个组件高度相互依赖。</p></blockquote><figure class="ky kz la lb fq ke fe ff paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="fe ff kx"><img src="../Images/030c05d07d002cd62d076285fe1abb00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S1kWdAuHYbxc7sUW7k-0hA.png"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek"><a class="ae kp" href="https://martinfowler.com/articles/microservices.html" rel="noopener ugc nofollow" target="_blank">Monoliths and Microservices</a></figcaption></figure><p id="6f7f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">组合所有:软件应用程序是可独立部署的，本质上是模块化的，运行具有良好定义的范围的独特过程，拥有轻量级机制来服务于业务目标，并且以高内聚松散耦合，最终成为微服务架构的一部分。这种架构最适合处理不同的编程堆栈，并使它们按照实现管道协同工作。</p><p id="179c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这就是我所做的…制作几个小应用程序的管道，作为我硕士论文实现的一个构建块。这些应用程序的实现基于<strong class="is hu"> Apache Kafka </strong>(用于消息传递系统)<strong class="is hu">、Apache Spark </strong>(用于实时数据流和处理)<strong class="is hu">、MEAN Stack </strong> (Node.js，Angular用于数据摄取和可视化)<strong class="is hu">、Python用于RaspberryPi </strong>(以及传感器编程)<strong class="is hu"> MySQL </strong>(样本数据)<strong class="is hu"> JAVA Spring </strong>(用于地图匹配)<strong class="is hu"> </strong>和<strong class="is hu">因此，考虑到6个月的总时间框架，我选择微服务架构是合适的。通过这种方式，我能够亲自动手使用这些技术进行实施，并节省了按照硕士论文的要求撰写详细报告的时间。</strong></p><figure class="ky kz la lb fq ke fe ff paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="fe ff lc"><img src="../Images/dc8af9b308dcf2ba637f4e10469f32f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hSu4Wsitt8afciNdnzvzNg.png"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Technology (Implementation) Pipeline</figcaption></figure><blockquote class="jo"><p id="68dc" class="jp jq ht bd jr js ld le lf lg lh jn ek translated">“硕士论文通常为期6个月。在这6个月中，每个学生都必须开发一个POC / MVP(概念证明/最小可行产品)以及研究论文/作品，以便在大学教授(导师)面前进行答辩。这样，它可以成为某个研究项目的一部分，也可以成为某个工业项目的基础。”</p></blockquote></div><div class="ab cl li lj hb lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hm hn ho hp hq"><blockquote class="kq kr ks"><p id="0fd5" class="iq ir kt is b it iu iv iw ix iy iz ja ku jc jd je kv jg jh ji kw jk jl jm jn hm dt translated"><strong class="is hu">现在将范围</strong>限制为分解包括不同技术堆栈的硕士论文实现，以及我如何在6个月的时间跨度内将它们与微服务架构结合起来？</p></blockquote><p id="0a18" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我提交论文的时候，大学导师提出了两个主要问题。第一个问题是所涉及的各种技术，第二个问题是在6个月内实施的可行性。第二个问题的答案在前面的段落中已经清楚了，关于第一个问题，是的，变化是为了实现。因为目标是开发“<strong class="is hu">工业物联网环境下传感器数据的可扩展框架</strong>”。因此，我需要各种传感器来使它们按照我的Node和Python管道工作，类似地，为了处理来自传感器的各种输入数据，我需要足够快速和健壮的消息传递系统来处理任何时间点的多个流，所以我选择了Kafka。同样，传入的数据要用Spark的流引擎进行处理，然后数据被转储到基于文档的数据库MongoDB中。</p><figure class="ky kz la lb fq ke fe ff paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="fe ff lp"><img src="../Images/156a3c16fcbc2a1ce8e3385d1a6b897f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3nFTn4krTR-nHLuvIbnM4w.png"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Master Thesis Phase (Flow) Diagram</figcaption></figure><p id="18c9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">因此，当您拥有各种各样的技术时，您不能依赖单一的体系结构(单一的应用程序是作为一个独立的单元构建的，其中一个组件的变化会影响整个应用程序)。因此，微服务架构(MSA)拯救了我们！MSA的概念是，如果应用程序的任何部分出现故障，它不应该影响周围的其他特性和功能。我对它进行了一点建模，并为我的硕士论文实现制作了这种微应用程序(服务)的管道。</p><h1 id="f7fd" class="lq lr ht bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn dt translated">工业物联网的背景</h1><p id="22b9" class="pw-post-body-paragraph iq ir ht is b it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj ms jl jm jn hm dt translated">这个想法是利用<strong class="is hu">物联网</strong>中的技术，并将其与第四代工业革命<strong class="is hu">工业4.0 </strong>重叠。我们都知道物联网(IOT)背后的理念，即每一个电子设备都以一种有意义的方式相互连接，使我们的生活变得更加轻松；为我们的日常生活提供便利。同样，工业4.0也有自动化的想法。让工厂完全基于机器人；也就是说，更少的人为参与将导致更少的人为错误和更少的事情需要担心。一个简单的例子是制造业，你提供原材料，然后在有限或没有人工参与的情况下获得成品。因此，未来的工厂。</p><h2 id="ef3b" class="mt lr ht bd ls mu mv mw lw mx my mz ma jb na nb me jf nc nd mi jj ne nf mm ng dt translated">未来的城市和未来的工厂</h2><p id="b32d" class="pw-post-body-paragraph iq ir ht is b it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj ms jl jm jn hm dt translated">其概念是开发这样一个框架，它足够灵活，可以根据输入数据的性质进行调整。在工业物联网的背景下，这些传入的数据流大多来自机器传感器和工业机器人。这些数据随后被我的框架处理和利用。从而产生有意义的数据，这些数据可以成为该特定行业流水线中的后续运输机器的输入。</p><blockquote class="kq kr ks"><p id="dfef" class="iq ir kt is b it iu iv iw ix iy iz ja ku jc jd je kv jg jh ji kw jk jl jm jn hm dt translated">在实际的实现中，被吸收到数据湖中的数据实际上是行业管道的下一个组件的输入。</p></blockquote><p id="4f46" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">框架处理来自几个不同来源的输入数据流，随时进行分析，并将有意义的信息吸收到数据湖中。</strong>其中，输入数据来自多个巨型工业机器人，这些机器人采用不同的通信协议，以极高的速度生成不同数据类型和格式的数据。通信协议从OPC-UA到传统的网络套接字各不相同，而数据格式则从低级二进制到JSON和XML各不相同。这是另一个流程图，展示了数据如何从工业机器人流向数据湖的架构。</p><figure class="ky kz la lb fq ke fe ff paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="fe ff nh"><img src="../Images/358063a9184fdfb9d1e6b09ce0e5cab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TAVKcOQt9w2p_GLtMzzIrg.png"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Master Thesis Architecture Diagram</figcaption></figure><p id="459c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这解释了“传感器数据的框架”部分，但是“<strong class="is hu">可扩展</strong>”部分呢？由此产生的框架可以在工业物联网环境中执行上述任务，但也足够健壮，可以处理来自其他域的输入数据；这是一种即插即用的思想，只需轻微的配置，无需更改或更新应用程序的任何组件。</p><blockquote class="kq kr ks"><p id="e1f1" class="iq ir kt is b it iu iv iw ix iy iz ja ku jc jd je kv jg jh ji kw jk jl jm jn hm dt translated">为了<!-- -->捍卫框架的可扩展性，我还开发了一个基于Car-to-X应用程序的POC，可以帮助实时监控交通拥堵，包括<strong class="is hu">地图匹配</strong>。</p></blockquote></div><div class="ab cl li lj hb lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hm hn ho hp hq"><h2 id="a3d3" class="mt lr ht bd ls mu mv mw lw mx my mz ma jb na nb me jf nc nd mi jj ne nf mm ng dt translated">阶段# 1 —包装来自机器的输入数据</h2><p id="d29c" class="pw-post-body-paragraph iq ir ht is b it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj ms jl jm jn hm dt translated">由于工业系统是基于异构数据源的，我们需要这样的软件组件，它们足够动态以适应可能发生的变化。从消息队列系统开始的功能和涉及的流引擎将或多或少保持不变，但是数据的来源将随着输入数据或传感器的相关协议的变化而变化。最初，我开始工作的机器人的目标是Web套接字、TCP客户端和OPC-UA客户端。它们可以通过相关的XML资源文件根据传感器的预期输入进行配置，这有助于它们与本文构建的生态系统进行高效通信。我为这些输入编写的包装应用程序通过配置文件处理数据，通过配置文件可以控制来自传感器、机器人和工业机器的数据流。</p><h2 id="3cac" class="mt lr ht bd ls mu mv mw lw mx my mz ma jb na nb me jf nc nd mi jj ne nf mm ng dt translated">第2阶段—使用Apache Kafka的消息队列系统</h2><p id="2faf" class="pw-post-body-paragraph iq ir ht is b it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj ms jl jm jn hm dt translated">一个基于Apache Kafka的API，一个分布式消息传递框架被开发并部署在一个大学云上(得到了一个专用的<strong class="is hu">云服务器</strong>用于实现消息传递系统，这要感谢我的教授😃).Apache Kafka的目标功能是处理来自多个传感器的生成数据。我选择Apache Kafka是因为它具有重放数据的功能和主题订阅的实现。Kafka的主题订阅本身充当了订阅的框架，不同的生产者和消费者在不同来源的基础上处理传入的数据。通过这种方式，使用Apache Kafka作为容错和低内存消耗系统，大大降低了流媒体引擎之前的负载。这是一个流程图，代表了卡夫卡在我的硕士论文中扮演的角色。其他选项将是阿帕奇水槽，但是的卡夫卡赢了！</p><figure class="ky kz la lb fq ke fe ff paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="fe ff ni"><img src="../Images/dc1e887676595389d68316ad5814f338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjz78THhTZRynvFwwt0mCw.png"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Kafka Messaging System Implementation</figcaption></figure><h2 id="059d" class="mt lr ht bd ls mu mv mw lw mx my mz ma jb na nb me jf nc nd mi jj ne nf mm ng dt translated">阶段# 3 —实时流引擎</h2><p id="0600" class="pw-post-body-paragraph iq ir ht is b it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj ms jl jm jn hm dt translated">Apache Spark被用作流引擎来实时处理传入的数据流。这种实时处理利用了数据，并为进一步的分析提供了便利。Apache Spark提供了很多支持，比如窗口技术、滑动步骤和数据流挖掘。Apache Kafka也可以充当流媒体引擎，但我们选择Apache Spark，因为它可以在需要涉及机器学习时进行扩展，Spark MLib可以在实时预测中发挥主要作用。Apache Spark提供了这样一个令人敬畏的生态系统，这是Apache Kafka或任何其他流媒体引擎都无法提供的。这包括对动态查询语言的原生支持、图形库和机器学习库。</p><blockquote class="kq kr ks"><p id="9f32" class="iq ir kt is b it iu iv iw ix iy iz ja ku jc jd je kv jg jh ji kw jk jl jm jn hm dt translated">就像各种数据收集来源一样，Apache Kafka和这个实时流引擎实现也是一个独立的项目，与我论文中的其他组件没有任何依赖关系。Spark的实现是基于Scala的，可以在任何有Java虚拟机的系统上配置和执行。</p></blockquote><h2 id="7960" class="mt lr ht bd ls mu mv mw lw mx my mz ma jb na nb me jf nc nd mi jj ne nf mm ng dt translated">第4阶段—摄入数据湖</h2><p id="0382" class="pw-post-body-paragraph iq ir ht is b it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj ms jl jm jn hm dt translated">从生成传感器数据的机器开始的过程，在数据湖中结束。对于我的论文，一个基于文档的数据库MongoDB充当了一个数据湖，供以后使用收集到的有意义的数据。我选择MongoDB有几个原因，但是我相信这些原因不打算在这个摘录中解释。然而，除了MongoDB，我还可以选择Apache Cassandra或Apache Hbase。</p><p id="0f3f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">除了将数据接收到最终位置之外，我还编写了一个小的<strong class="is hu"> MEAN Stack应用程序(MongoDB，Express，Angular，Node) </strong>来直观地表示流向数据湖的数据。</p><p id="7ab6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Visualized MongoDB是一个简单的应用程序，是使用MongoDB控制台的一种替代方法，它表示特定MongoDB数据库集合中文档的文本格式。使用这个应用程序，我们可以避免在控制台上使用文本命令来检查数据库中的数据。这种替代方法帮助我监控每一组数据的插入，如果没有实现，就必须非常频繁地手动执行，以监控数据的接收。</p><blockquote class="kq kr ks"><p id="61ff" class="iq ir kt is b it iu iv iw ix iy iz ja ku jc jd je kv jg jh ji kw jk jl jm jn hm dt translated">这份申请并不是我最初申请硕士论文的一部分，而是为了显示我的奉献精神而付出的额外努力……这一小小的努力得到了我的教授的认可。</p></blockquote></div><div class="ab cl li lj hb lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hm hn ho hp hq"><h1 id="2f45" class="lq lr ht bd ls lt nj lv lw lx nk lz ma mb nl md me mf nm mh mi mj nn ml mm mn dt translated">联网汽车，地图匹配实现</h1><p id="d4a1" class="pw-post-body-paragraph iq ir ht is b it mo iv iw ix mp iz ja jb mq jd je jf mr jh ji jj ms jl jm jn hm dt translated">最后但同样重要的是，为了证明我硕士论文的可扩展性，我提出了基于联网汽车的<strong class="is hu">用例</strong>。我没有对我的实际实现做任何更改，只是切换了数据源。我将机器传来的数据与车内传感器产生的数据进行了交换，开始实时获取每辆车的位置。我的Spark流引擎中的地图匹配算法的额外实现让我通过检测道路上的交通拥堵来证明我的框架的可扩展性。这里有一个GIF图像形式的可视化表示。</p><figure class="ky kz la lb fq ke fe ff paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="fe ff no"><img src="../Images/d3900d732809859d691b7166f86d4ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LHx-2pWfQhrF0DONc1PHwg.gif"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Connected Car — Map Matching Algorithm</figcaption></figure><blockquote class="kq kr ks"><p id="5bd3" class="iq ir kt is b it iu iv iw ix iy iz ja ku jc jd je kv jg jh ji kw jk jl jm jn hm dt translated">地图匹配是如何将记录的地理坐标与现实世界的逻辑模型相匹配的问题，通常使用某种形式的地理信息系统via <a class="ae kp" href="https://en.wikipedia.org/wiki/Map_matching" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><p id="cd20" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">就这些了，希望这对阅读的人有所帮助。<br/>拍手欣赏。一次、两次或多次鼓掌。谢谢你😃</p><blockquote class="kq kr ks"><p id="c4e3" class="iq ir kt is b it iu iv iw ix iy iz ja ku jc jd je kv jg jh ji kw jk jl jm jn hm dt translated">可以找/关注我<a class="ae kp" href="https://twitter.com/intent/follow?screen_name=ok_ansari" rel="noopener ugc nofollow" target="_blank"> @ok_ansari </a>。干杯，<a class="np nq gr" href="https://medium.com/u/bb020ae5c9a8?source=post_page-----a8cdd67f1eb9--------------------------------" rel="noopener" target="_blank">奥迈尔·卡利姆·安萨里</a></p></blockquote></div></div>    
</body>
</html>