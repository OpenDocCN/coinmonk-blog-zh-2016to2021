<html>
<head>
<title>Tutorial : How to create a sports betting dApp on the Ethereum blockchain (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:如何在以太坊区块链创建体育博彩dApp(第1部分)</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/create-a-sports-betting-dapp-on-the-ethereum-blockchain-part-1-1f69f908b939?source=collection_archive---------0-----------------------#2018-08-01">https://medium.com/coinmonks/create-a-sports-betting-dapp-on-the-ethereum-blockchain-part-1-1f69f908b939?source=collection_archive---------0-----------------------#2018-08-01</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/23faa4d0d953260808f3fe10670cc37a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Uz3eMFHVxCDPj-Wp"/></div></div></figure><p id="2e71" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">嗨，大家好，我最近学习了如何用以太坊技术制作一个分布式应用程序，但是作为一个web开发初学者，我很难找到一个易于理解并涵盖制作dapp所有方面的教程，从第一行代码到以太坊网络上的部署。<br/>本教程的目的是制作一个体育博彩Dapp，每个玩家可以在一个团队中下注一定数量的乙醚，智能合约将价格重新分配给下注正确团队的玩家！</p><p id="4e6b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="jz">注意:这个教程现在还能用，但是随着区块链科技的快速发展，它可能会在某些时候贬值。</em></p><p id="df88" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="jz">更新(2018年12月27日) :我编辑了solidity代码，以便与0.5.x </em>一起工作</p><p id="f00a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">本教程面向对Javascript和区块链</strong>有一点经验，并且希望以非常简单的方式学习dApp制作的人。</p><p id="3754" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我将使用React开发前端，并构建一个工作的dApp，该教程也适合那些想使用另一个框架如angular甚至普通javascript的人。本教程将包含以下步骤:</p><ul class=""><li id="230f" class="ka kb ht jd b je jf ji jj jm kc jq kd ju ke jy kf kg kh ki dt translated">准备项目环境(第1部分)</li><li id="0346" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">编写、测试和部署智能合同(第1部分)</li><li id="cc0e" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">创建前端(第2部分)</li></ul><h1 id="a809" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">准备项目环境</h1><h2 id="ca38" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated">先决条件</h2><p id="0f6d" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">对于这个应用程序的开发，将需要<a class="ae mf" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> node.js </a>来安装各种包，所以第一步是确保它已经安装在您的设备上。</p><p id="8e8e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">为了保持简单，我们将使用<strong class="jd hu"> react-create-app </strong>在<a class="ae mf" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>中开发我们的应用程序，这将为我们的应用程序生成一个简单的框架。这不是开发react应用程序的最灵活和最可定制的方式，但将完美地完成本教程的工作。通过键入<code class="eh mg mh mi mj b">npm install -g create-react-app</code>来安装它。<code class="eh mg mh mi mj b">-g</code>标志意味着您正在为您的设备全局安装它。</p><p id="be48" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">开发应用程序的另一个框架将是<a class="ae mf" href="http://truffleframework.com/" rel="noopener ugc nofollow" target="_blank"> Truffle </a>，它将有助于编译、测试&amp;在以太坊区块链上部署我们的智能合约。通过在终端输入<code class="eh mg mh mi mj b">npm install truffle -g</code>来安装它。</p><h2 id="17f9" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated">创建应用程序</h2><p id="47f7" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">一旦你在你的电脑上安装了这两个包，你就可以通过输入<code class="eh mg mh mi mj b">create-react-app bet-eth</code> <em class="jz">(或者你想要的这个应用的任何名字)</em>来创建你的应用。它将在您的工作目录中创建一个名为<strong class="jd hu"> bet-eth </strong>的文件夹，其中安装了一些react有用的依赖项。用你的终端<code class="eh mg mh mi mj b">cd bet-eth</code>访问它。你可以键入<code class="eh mg mh mi mj b">npm start</code>在<em class="jz"> </em> localhost:3000上启动你的网站，你将在你最喜欢的网络浏览器中的create-react-app的主默认页面上结束，但我们稍后会编辑前端。</p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mk"><img src="../Images/b23433bd6df8a57b003987774f1711c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhzEeEAdlZs7-Dr-QKrSsQ.png"/></div></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">create-react-app default homepage</figcaption></figure><p id="0cb3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，让我们安装dapp所需的依赖项:web3、truffle-contract、truffle-wallet-provider &amp; ethereu mjs-wallet。用<code class="eh mg mh mi mj b">npm install web3 truffle-contract truffle-wallet-provider ethereumjs-wallet --save</code>简单安装即可。<code class="eh mg mh mi mj b">--save</code>标志对于将依赖关系保存到应用程序的配置中很有用。</p><p id="684f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最后一步有点棘手，但应该可行:我们需要在项目中通过键入<code class="eh mg mh mi mj b">truffle init</code>来初始化Truffle。<strong class="jd hu">但是由于数据覆盖保护，不可能在已经包含一些数据的文件夹中进行</strong>。有两种方法可以解决这个问题:</p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div class="fe ff mt"><img src="../Images/4860c278bfe892e379b496bb6238a635.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*S604ArE-_1f1fjnkl2IpvA.png"/></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">Content made by using truffle init</figcaption></figure><ul class=""><li id="eeb2" class="ka kb ht jd b je jf ji jj jm kc jq kd ju ke jy kf kg kh ki dt translated">创建一个空文件夹，执行truffle init并复制粘贴我们的项目文件夹<strong class="jd hu"> <em class="jz">(让我们这样做)</em> </strong></li><li id="8a45" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">在我们的项目文件夹中手动创建所有的文件和文件夹<em class="jz">(也可以，但是更长)</em></li></ul><p id="2091" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最后，您的项目文件夹应该如下所示:</p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div class="fe ff mu"><img src="../Images/2f845b43e63e65e7437bf4146866396f.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*AsWRR6SHIkHbGOVe5UBeyQ.png"/></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">Bet-eth folder after configuration</figcaption></figure><p id="c149" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">检查所有的依赖项是否已经安装在你的<strong class="jd hu"> package.json </strong>文件中:</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="7f04" class="lm kp ht mj b fv mz na l nb nc">{<br/>  "name": "bet-eth",<br/>  "version": "0.1.0",<br/>  "private": true,<br/><strong class="mj hu">  "dependencies": {<br/>    "ethereumjs-wallet": "^0.6.0",<br/>    "react": "^16.4.0",<br/>    "react-dom": "^16.4.0",<br/>    "react-scripts": "1.1.4",<br/>    "truffle-contract": "^3.0.5",<br/>    "truffle-wallet-provider": "0.0.5",<br/>    "web3": "^1.0.0-beta.34"<br/>  },</strong><br/>  "scripts": {<br/>    "start": "react-scripts start",<br/>    "build": "react-scripts build",<br/>    "test": "react-scripts test --env=jsdom",<br/>    "eject": "react-scripts eject"<br/>  }<br/>}</span></pre><h1 id="8e06" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">构建和测试智能合约</h1><p id="c6c8" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">现在我们已经准备好了项目，让我们开发应用程序的主要核心:智能合同。</p><p id="c2e0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们可以从制作应用程序的前端开始，然后用这个前端直接编写和测试智能合同。但是由于调试智能合约是一件很困难的事情，并且不是很优化，我们将首先在<a class="ae mf" href="https://remix.ethereum.org/" rel="noopener ugc nofollow" target="_blank"> Remix IDE </a>上编写和测试我们的智能合约，这是一个轻量级和web Solidity IDE，允许我们在任何网络上编写、编译和部署智能合约。</p><p id="aea7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在写任何一行代码之前，让我们写下所有不同的功能，我们需要清楚契约将如何工作，以及需要什么来使它工作。为了使问题简单，假设我们希望能够在两个选项上下注，赢或输。每个玩家都可以在一个团队或另一个团队中下注一定数量的以太币，并根据结果，可以从输掉的累积奖金中赢回最初的赌注和一定数量的以太币。</p><p id="8e5b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">从数学的角度来看，中奖金额可以用这个简单的公式来表示:</p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nd"><img src="../Images/382cb0358c02437b671a34707825580f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MBJENRT53NAYwFucLaEEPA.png"/></div></div></figure><p id="4cfb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">对您团队的赌注/总赌注</strong>代表对您将赢得什么的考虑，这就是为什么我们将它乘以输掉的赌注来分享。</p><p id="4f55" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">例如，让我们想象这样一种情况:</p><ul class=""><li id="28a6" class="ka kb ht jd b je jf ji jj jm kc jq kd ju ke jy kf kg kh ki dt translated">A队已经有<strong class="jd hu"> 60 ETH下注，B队</strong>已经有<strong class="jd hu"> 100 ETH下注</strong></li><li id="1e7c" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated"><strong class="jd hu">玩家1 </strong>在A队下注20 ETH队的总赌注变成80 ETH，因此<strong class="jd hu">玩家1 </strong>的赌注占总赌注的25%。</li><li id="8d60" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">A队赢得了比赛。</li><li id="5669" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated"><strong class="jd hu">玩家1 </strong>将赢得他的初始赌注，与另一队总赌注的25%相加(在本例中为100 ETH)，总共代表45 ETH。</li></ul><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ne"><img src="../Images/1044c491f3bf61ff625e1e367a587e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NrtZd5GWNUgvTZ5Em3d-Og.png"/></div></div></figure><h2 id="bfd6" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated">我们需要什么样的变量和函数？</h2><p id="edb3" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">对于我们需要的变量:</p><ul class=""><li id="d78d" class="ka kb ht jd b je jf ji jj jm kc jq kd ju ke jy kf kg kh ki dt translated">业主— <em class="jz">合同业主的地址</em></li><li id="ca8d" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">minimumBet —到<em class="jz">定义最小赌注(uint) </em></li><li id="65bd" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">totalBetOne — <em class="jz">这是第一队(uint) </em>的赌注</li><li id="172e" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">totalBetTwo — <em class="jz">这是另一个团队(uint) </em></li><li id="e266" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">玩家— <em class="jz">玩家信息的对象，将包含下注金额和所选的球队(结构)</em></li><li id="501a" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">玩家— <em class="jz">一个包含所有玩家地址的地址数组</em></li><li id="b30b" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">玩家信息地址之间的映射— <em class="jz">将玩家地址链接到一些玩家信息</em></li></ul><p id="dfda" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">对于功能:</p><ul class=""><li id="becd" class="ka kb ht jd b je jf ji jj jm kc jq kd ju ke jy kf kg kh ki dt translated">Kill()-如果需要，终止合同</li><li id="2534" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">CheckPlayerExist() —验证玩家是否已经玩过</li><li id="7df5" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">Bet() —对游戏下注</li><li id="a847" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">distribute prices()—给获胜者分发乙醚</li><li id="76cd" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">AmountOne() —查看第一队的赌注</li><li id="a8e9" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">AmountTwo() —查看第二组的赌注</li></ul><p id="180f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在我们已经有了建立合同所需的所有东西，让我们来发展它吧！</p><h2 id="89e8" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated">撰写智能合同</h2><p id="7115" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">让我们打开remix IDE，创建一个名为Betting.sol的契约</p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nf"><img src="../Images/96bed9ef3ad5f44bcf05c8fca95e88a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XY_F2UetE7mWz3vh7a9THg.png"/></div></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">Creating a new file on the Remix IDE</figcaption></figure><p id="f4c7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们首先开始定义可靠性版本，作为合同的约定<code class="eh mg mh mi mj b"><strong class="jd hu">pragma solidity &gt;0.4.99;</strong></code></p><p id="a5c1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">那么让我们用书面形式来定义这份合同</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="da22" class="lm kp ht mj b fv mz na l nb nc"><strong class="mj hu">contract Betting{<br/>   </strong><em class="jz">//content of the contract here </em><strong class="mj hu"><br/>}</strong></span></pre><p id="11ac" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在让我们定义合同中需要的变量</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="b746" class="lm kp ht mj b fv mz na l nb nc"><strong class="mj hu">contract Betting{<br/>   uint256 public minimumBet;<br/>   uint256 public totalBetOne;<br/>   uint256 public totalBetTwo;<br/>   uint256 public numberOfBets;<br/>   uint256 public maxAmountOfBets = 1000;<br/>   <br/>   address payable[] public players;<br/>   <br/>   struct Player {<br/>      uint256 amountBet;<br/>      uint16 teamSelected;<br/>   }<br/>   <br/>   <em class="jz">// Address of the player and =&gt; the user info   </em><br/>   mapping(address =&gt; Player) public playerInfo;</strong></span><span id="d351" class="lm kp ht mj b fv ng na l nb nc"><strong class="mj hu">}</strong></span></pre><p id="6874" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们为这个契约添加一个构造函数，在这里我们将定义最小赌注。<em class="jz"> 1000000000000魏对应0.0001乙醚</em></p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="c623" class="lm kp ht mj b fv mz na l nb nc"><strong class="mj hu">constructor() public {<br/>      minimumBet = 100000000000000;<br/>   }</strong></span></pre><p id="0d39" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在让我们开发第一个函数，检查一个玩家是否存在。如果玩家出现在玩家数组中，那么返回true。如果没有找到，则返回false。<br/>这个函数在参数中取播放器的地址，<em class="jz"> </em> <code class="eh mg mh mi mj b">view</code>的意思是因为它不改变状态，你的本地节点可以运行它并告诉你结果，而不需要一个事务。这并不耗费汽油，因为只有你的节点必须运行计算。<code class="eh mg mh mi mj b">returns(bool)</code>意味着函数返回一个布尔值。</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="32ca" class="lm kp ht mj b fv mz na l nb nc"><strong class="mj hu">function checkPlayerExists(address player) public view returns(bool){<br/>      for(uint256 i = 0; i &lt; players.length; i++){<br/>         if(players[i] == player) return true;<br/>      }<br/>      return false;<br/>   }</strong></span></pre><p id="29ad" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们要做的下一个函数是bet()函数:首先我们检查玩家是否被允许玩游戏。他没有玩过，如果他的赌注高于最小赌注。然后，如果所有条件都正确，我们设置玩家信息(使用映射playerInfo ),并将玩家地址添加到玩家数组中。</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="c772" class="lm kp ht mj b fv mz na l nb nc"><strong class="mj hu">function bet(uint8 _teamSelected) public payable {<br/>      </strong><em class="jz">//The first require is used to check if the player already exist</em><strong class="mj hu"><br/>      require(!checkPlayerExists(msg.sender));<br/></strong><em class="jz">      //The second one is used to see if the value sended by the player is <br/>      //Higher than the minum value</em><strong class="mj hu"><br/>      require(msg.value &gt;= minimumBet);<br/>      <br/></strong><em class="jz">      //We set the player informations : amount of the bet and selected team</em><strong class="mj hu"><br/>      playerInfo[msg.sender].amountBet = msg.value;<br/>      playerInfo[msg.sender].teamSelected = _teamSelected;<br/>      <br/></strong><em class="jz">      //then we add the address of the player to the players array</em><strong class="mj hu"><br/>      players.push(msg.sender);<br/>      <br/></strong><em class="jz">      //at the end, we increment the stakes of the team selected with the player bet</em><strong class="mj hu"><br/>      if ( _teamSelected == 1){<br/>          totalBetOne += msg.value;<br/>      }<br/>      else{<br/>          totalBetTwo += msg.value;<br/>      }<br/>   }</strong></span></pre><p id="db15" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">该合同的第二个核心功能是向玩家分发乙醚，根据初始赌注的重量分配适当的数量。</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="24eb" class="lm kp ht mj b fv mz na l nb nc"><strong class="mj hu">function distributePrizes(uint16 teamWinner) public {<br/>      address payable[1000] memory winners;<br/></strong>      //We have to create a temporary in memory array with fixed size<br/>      //Let's choose 1000<strong class="mj hu"><br/>      uint256 count = 0; </strong>// This is the count for the array of winners<strong class="mj hu"><br/>      uint256 LoserBet = 0; </strong>//This will take the value of all losers bet<strong class="mj hu"><br/>      uint256 WinnerBet = 0; </strong>//This will take the value of all winners bet<strong class="mj hu"><br/>      address add;<br/>      uint256 bet;<br/>      address payable playerAddress;<br/></strong>//We loop through the player array to check who selected the winner team<strong class="mj hu"><br/>      for(uint256 i = 0; i &lt; players.length; i++){<br/>         playerAddress = players[i];<br/></strong>//If the player selected the winner team<br/>         //We add his address to the winners array<strong class="mj hu"><br/>         if(playerInfo[playerAddress].teamSelected == teamWinner){<br/>            winners[count] = playerAddress;<br/>            count++;<br/>         }<br/>      }<br/></strong>//We define which bet sum is the Loser one and which one is the winner<strong class="mj hu"><br/>      if ( teamWinner == 1){<br/>         LoserBet = totalBetsTwo;<br/>         WinnerBet = totalBetsOne;<br/>      }<br/>      else{<br/>          LoserBet = totalBetsOne;<br/>          WinnerBet = totalBetsTwo;<br/>      }<br/></strong>//We loop through the array of winners, to give ethers to the winners<strong class="mj hu"><br/>      for(uint256 j = 0; j &lt; count; j++){<br/>         </strong> // Check that the address in this fixed array is not empty<strong class="mj hu"><br/>         if(winners[j] != address(0))<br/>            add = winners[j];<br/>            bet = playerInfo[add].amountBet;<br/>            </strong>//Transfer the money to the user<strong class="mj hu"><br/>            winners[j].transfer((bet*(10000+(LoserBet*10000/WinnerBet)))/10000 );<br/>      }<br/>      <br/>      delete playerInfo[playerAddress]; </strong>// Delete all the players<strong class="mj hu"><br/>      players.length = 0; </strong>// Delete all the players array<strong class="mj hu"><br/>      LoserBet = 0; </strong>//reinitialize the bets<strong class="mj hu"><br/>      WinnerBet = 0;<br/>      totalBetsOne = 0;<br/>      totalBetsTwo = 0;<br/>    }</strong></span></pre><p id="ff31" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后，我们将第一组和第二组的两个getters相加，这将用于我们前端的前端</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="68e7" class="lm kp ht mj b fv mz na l nb nc"><strong class="mj hu">function AmountOne() public view returns(uint256){<br/>       return totalBetOne;<br/>   }<br/>   <br/>   function AmountTwo() public view returns(uint256){<br/>       return totalBetTwo;<br/>   }</strong></span></pre><p id="0c52" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们的合同现在结束了！以下是最终代码:</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="7c26" class="lm kp ht mj b fv mz na l nb nc">pragma solidity &gt;0.4.99;</span><span id="2bcc" class="lm kp ht mj b fv ng na l nb nc">contract Betting {<br/>   address payable public owner;<br/>   uint256 public minimumBet;<br/>   uint256 public totalBetsOne;<br/>   uint256 public totalBetsTwo;<br/>   address payable[] public players;<br/>   struct Player {<br/>      uint256 amountBet;<br/>      uint16 teamSelected;<br/>    }<br/>// The address of the player and =&gt; the user info<br/>   mapping(address =&gt; Player) public playerInfo;<br/>   function() external payable {}<br/>   <br/>  constructor() public {<br/>      owner = msg.sender;<br/>      minimumBet = 100000000000000;<br/>    }<br/>function kill() public {<br/>      if(msg.sender == owner) selfdestruct(owner);<br/>    }<br/>    <br/>function checkPlayerExists(address payable player) public view returns(bool){<br/>      for(uint256 i = 0; i &lt; players.length; i++){<br/>         if(players[i] == player) return true;<br/>      }<br/>      return false;<br/>    }<br/>function bet(uint8 _teamSelected) public payable {<br/>      //The first require is used to check if the player already exist<br/>      require(!checkPlayerExists(msg.sender));<br/>      //The second one is used to see if the value sended by the player is<br/>      //Higher than the minimum value<br/>      require(msg.value &gt;= minimumBet);<br/>//We set the player informations : amount of the bet and selected team<br/>      playerInfo[msg.sender].amountBet = msg.value;<br/>      playerInfo[msg.sender].teamSelected = _teamSelected;<br/>//then we add the address of the player to the players array<br/>      players.push(msg.sender);<br/>//at the end, we increment the stakes of the team selected with the player bet<br/>      if ( _teamSelected == 1){<br/>          totalBetsOne += msg.value;<br/>      }<br/>      else{<br/>          totalBetsTwo += msg.value;<br/>      }<br/>    }<br/>    // Generates a number between 1 and 10 that will be the winner<br/>    function distributePrizes(uint16 teamWinner) public {<br/>      address payable[1000] memory winners;<br/>      //We have to create a temporary in memory array with fixed size<br/>      //Let's choose 1000<br/>      uint256 count = 0; // This is the count for the array of winners<br/>      uint256 LoserBet = 0; //This will take the value of all losers bet<br/>      uint256 WinnerBet = 0; //This will take the value of all winners bet<br/>      address add;<br/>      uint256 bet;<br/>      address payable playerAddress;<br/>//We loop through the player array to check who selected the winner team<br/>      for(uint256 i = 0; i &lt; players.length; i++){<br/>         playerAddress = players[i];<br/>//If the player selected the winner team<br/>         //We add his address to the winners array<br/>         if(playerInfo[playerAddress].teamSelected == teamWinner){<br/>            winners[count] = playerAddress;<br/>            count++;<br/>         }<br/>      }<br/>//We define which bet sum is the Loser one and which one is the winner<br/>      if ( teamWinner == 1){<br/>         LoserBet = totalBetsTwo;<br/>         WinnerBet = totalBetsOne;<br/>      }<br/>      else{<br/>          LoserBet = totalBetsOne;<br/>          WinnerBet = totalBetsTwo;<br/>      }<br/>//We loop through the array of winners, to give ethers to the winners<br/>      for(uint256 j = 0; j &lt; count; j++){<br/>          // Check that the address in this fixed array is not empty<br/>         if(winners[j] != address(0))<br/>            add = winners[j];<br/>            bet = playerInfo[add].amountBet;<br/>            //Transfer the money to the user<br/>            winners[j].transfer(    (bet*(10000+(LoserBet*10000/WinnerBet)))/10000 );<br/>      }<br/>      <br/>      delete playerInfo[playerAddress]; // Delete all the players<br/>      players.length = 0; // Delete all the players array<br/>      LoserBet = 0; //reinitialize the bets<br/>      WinnerBet = 0;<br/>      totalBetsOne = 0;<br/>      totalBetsTwo = 0;<br/>    }<br/>function AmountOne() public view returns(uint256){<br/>       return totalBetsOne;<br/>    }<br/>function AmountTwo() public view returns(uint256){<br/>       return totalBetsTwo;<br/>    }<br/>}</span></pre><h2 id="d718" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated"><strong class="ak">测试合同</strong></h2><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nh"><img src="../Images/f4a4a6c2b3e3da6a5b05ae822bf025ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V0v5tOhm56bJ3OC5nhLBtA.png"/></div></div></figure><p id="8f42" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在Remix IDE上，进入右边的<strong class="jd hu">运行</strong>选项卡，选择JavaScript VM环境。不要碰气限，输入的数值会用来输入你要赌多少乙醚。不要忘记将其设置为<strong class="jd hu"> ether </strong>以轻松查看平衡变化(值最初在<strong class="jd hu"> wei </strong>)。</p><p id="7d12" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后选择下注合同并点击部署。你的编译器应该像屏幕上显示的那样。</p></div><div class="ab cl ni nj hb nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="hm hn ho hp hq"><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff np"><img src="../Images/620e1fbf4dfc1d36b899f626b01ad2e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x19rbt1tVw3cxKLriW5BKw.png"/></div></div></figure><p id="a2f7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">先用<strong class="jd hu">第一笔账</strong>在<strong class="jd hu">第一队</strong>上下注10 ETH:用10 (ethers，不是wei！)、<strong class="jd hu">以及值为1 </strong>的下注输入(因为我们要赌第一队)。</p><p id="7279" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后点击输入旁边的<strong class="jd hu">下注</strong>按钮，账户余额通常会从99.999升至89.999。</p><p id="ed34" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，让我们转到另一个帐户，通过在下注输入中键入2，在团队2上下注5个乙醚。第二次下注后你的余额应该是94.999 ETH。</p><p id="f920" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在每个团队都有两个更好的，让我们试试distributePrizes函数。至于下注功能，你只需写下你想赢的队的号码，然后点击<strong class="jd hu">分配筹码。</strong></p><p id="71ed" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因为队伍n 2赢了，在队伍2上下注的玩家应该赢回5个乙醚加上来自其他玩家的10个乙醚。他应该有110个乙醚。我鼓励你也尝试一个有很多账户的测试，看看这个思考系统是否有效。</p><h1 id="d952" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">配置Truffle &amp;在测试网络上部署合同</h1><h2 id="56a4" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated">在你的应用程序中写合同</h2><p id="69bd" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">首先，我们将编写我们刚刚在项目中创建的智能合同，所以回到您的应用程序目录，我们称之为bet-eth。打开<br/> <code class="eh mg mh mi mj b">bet-eth/contracts</code>，创建一个名为<code class="eh mg mh mi mj b">Betting.sol</code>的新文件</p><p id="45e7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在保存之前，将合同从Remix复制粘贴到此文件。</p><p id="40d4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后转到<code class="eh mg mh mi mj b">beth-eth/migrations</code>文件夹，创建一个名为<code class="eh mg mh mi mj b">2_deploy_contracts.js</code>的文件。Truffle将使用该文件在区块链网络上迁移智能合同。</p><p id="05eb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们在文件中写一些代码:</p><p id="c261" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在第一行导入智能合同</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="ad81" class="lm kp ht mj b fv mz na l nb nc">var Betting = artifacts.require("./Betting.sol");</span></pre><p id="7525" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后部署合同:</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="5559" class="lm kp ht mj b fv mz na l nb nc">module.exports = function(deployer) {<br/>  deployer.deploy(Betting);<br/>};</span></pre><p id="e671" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这是这个文件中唯一需要的东西，你现在可以保存并关闭它。</p><h1 id="3a40" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">在测试网络上部署应用</h1><p id="058a" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">在编写App前端之前，我们先在一个测试网络上部署一下合约。为什么之前要这么做？因此，我们可以直接将我们的前端部分与合同部署功能联系起来。</p><p id="5ca3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将在Ropsten TestNet上部署我们的合同。</p><h2 id="00d6" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated">创建一个<a class="ae mf" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> Infura </a>账户</h2><p id="4eff" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated"><a class="ae mf" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> Infura </a>允许我们使用Truffle在主网络和测试网络上部署智能合约，因此我们将在我们的应用程序中使用它。</p><p id="9e23" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">创建一个账户，创建一个名为“赌博”的项目(或任何你想要的项目)。选择Ropsten端点，并将端点地址保存在某处。</p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nq"><img src="../Images/a06c27de0c189c298a8ca2cda37e9ed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eiGpKZQxHUVf_ONfKuxdKQ.png"/></div></div></figure><h2 id="b9ab" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated">安装和配置<a class="ae mf" href="https://metamask.io/" rel="noopener ugc nofollow" target="_blank">元掩码</a></h2><p id="4d64" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated"><a class="ae mf" href="https://metamask.io/" rel="noopener ugc nofollow" target="_blank"> Metamask </a>是Chrome &amp; Firefox上的一个扩展，允许用户管理以太坊区块链上的不同账户。<strong class="jd hu">安装并创建账户。</strong>登录后，<strong class="jd hu">选择Ropsten测试网络:</strong></p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div class="fe ff nr"><img src="../Images/bdfd5802da671c2bbadb3dc055cc517f.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*frCIFPbyme70-CObXAbOSg.png"/></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">Select the Ropsten Test Network on Metamask</figcaption></figure><p id="9eaf" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">你将需要一些乙醚，所以点击Metamask上的<strong class="jd hu">购买</strong>按钮，然后点击<strong class="jd hu"> Ropsten测试龙头</strong>。您将进入一个页面，在这里您可以为您的测试帐户申请乙醚，只需点击<strong class="jd hu">请求1乙醚</strong>。找些乙醚，他们会对部署合同和玩我们的应用有用。</p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ns"><img src="../Images/cfcc3ea853dac1ff5b8acdbf2b0a479c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7x3Q2ehtiprNRqUTL5vTFQ.png"/></div></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">Ropsten Ether faucet — Click on the green button to request one ether</figcaption></figure><h2 id="b198" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated">获取您的私钥</h2><p id="65b2" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">要在Ropsten网络上部署智能合同，您将使用刚刚用Metamask创建的帐户。Truffle需要知道您将使用哪个帐户进行部署，这可以通过使用私钥来实现:</p><p id="6e1f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">进入您的元掩码帐户，点击帐户名称旁边的“…”。会出现一个小菜单，点击“导出私钥”:<strong class="jd hu">复制保存你的个人私钥。</strong></p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div class="fe ff nr"><img src="../Images/80d3bcd6936cd310baa7aab28f5ebce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*NuIGEW2OEO78aJRO4J_d9g.png"/></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">Exporting the private key on Metamask</figcaption></figure><h2 id="ac0b" class="lm kp ht bd kq ln lo lp ku lq lr ls ky jm lt lu lc jq lv lw lg ju lx ly lk lz dt translated">块菌配置的最后一步</h2><p id="778e" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">我们快完成了！在本教程的这一部分，您应该已经收集了:</p><ul class=""><li id="3dc8" class="ka kb ht jd b je jf ji jj jm kc jq kd ju ke jy kf kg kh ki dt translated">Infura端点URL</li><li id="c04a" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">Ropsten TestNet上的元掩码帐户上的一些醚</li><li id="6af6" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">该帐户的私钥</li></ul><p id="8323" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果您缺少这些元素中的一个，您将无法部署合同。如果你什么都有了，那你就可以走下去了！</p><p id="214d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在app文件夹中，打开<code class="eh mg mh mi mj b">truffle.js</code>文件，用您自己的私钥和Infura端点复制粘贴下面几行代码。</p><pre class="ml mm mn mo fq mv mj mw mx aw my dt"><span id="aa90" class="lm kp ht mj b fv mz na l nb nc">var WalletProvider = require("truffle-wallet-provider");<br/>const Wallet = require('ethereumjs-wallet');<br/>var ropstenPrivateKey = new Buffer("<strong class="mj hu">COPY-PRIVATE-KEY-HERE</strong>","hex");<br/>var ropstenWallet = Wallet.fromPrivateKey(ropstenPrivateKey);<br/>var ropstenProvider = new WalletProvider(ropstenWallet, "<strong class="mj hu">COPY-INFURA-ENDPOINT-HERE</strong>");</span><span id="bfd1" class="lm kp ht mj b fv ng na l nb nc">module.exports = {<br/>  // See &lt;<a class="ae mf" href="http://truffleframework.com/docs/advanced/configuration" rel="noopener ugc nofollow" target="_blank">http://truffleframework.com/docs/advanced/configuration</a>&gt;<br/>  // to customize your Truffle configuration!<br/>  networks: {<br/>    development: {<br/>      host: "127.0.0.1",<br/>      port: 8545,<br/>      network_id: "*", // Match any network id<br/>    },<br/>    ropsten: {<br/>      provider: ropstenProvider,<br/>      gas: 4600000,<br/>      network_id: 3<br/>    }<br/>  }<br/>};</span></pre><h1 id="4d4b" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">部署合同</h1><p id="80e9" class="pw-post-body-paragraph jb jc ht jd b je ma jg jh ji mb jk jl jm mc jo jp jq md js jt ju me jw jx jy hm dt translated">打开终端，进入bet-eth应用程序目录。</p><p id="96fd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">首先使用<code class="eh mg mh mi mj b">truffle compile</code>来编译你的智能合约。您应该有以下输出，并带有一些小警告。</p><p id="79c7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">注意:如果你在windows上，你可能会遇到一些问题，尝试使用<code class="eh mg mh mi mj b">truffle.cmd compile</code>而不是<code class="eh mg mh mi mj b">truffle</code></p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nt"><img src="../Images/dfbbb0e0b3a53b3bd7025896b41b61ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IyqTb-YtlBfT68LFH_HvlA.png"/></div></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">truffle compile — console output</figcaption></figure><p id="c661" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后使用<code class="eh mg mh mi mj b">truffle migrate --network ropsten</code>命令在Ropsten测试网络上迁移合同</p><p id="781b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这可能需要一段时间，但应该会产生以下输出:</p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nu"><img src="../Images/f18912970d7cb84f538b95c110657c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VdXmoOmvIpN64xu4O6nsiw.png"/></div></div><figcaption class="mp mq fg fe ff mr ms bd b be z ek">truffle migrate — console output</figcaption></figure><p id="59fd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果在这一点上一切顺利，您应该已经在您使用的帐户上失去了一些醚，<strong class="jd hu">并且合同成功部署到Ropsten区块链！</strong></p><p id="a626" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">你实际上可以通过在搜索栏中输入地址来查看etherscan 上的合同，这是我刚刚为教程部署的一个:</p><div class="nv nw fm fo nx ny"><a href="https://ropsten.etherscan.io/tx/0x60af2053596c3eae26b039d95245ec302533d78ac473f9b5bc5e910e851253b2" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab ej"><div class="oa ab ob cl cj oc"><h2 class="bd hu fv z el od eo ep oe er et hs dt translated">Ropsten事务0x 60 af 2053596 C3 EAE 26 b 039d 95245 EC 302533d 78 AC 473 f 9 b5 BC 5 e 910 e 851253 b 2</h2><div class="of l"><h3 class="bd b fv z el od eo ep oe er et ek translated">0 x 60 af 2053596 C3 EAE 26 b 039d 95245 EC 302533d 78 AC 473 f 9 b5 BC 5e 910 e 851253 b 2的Ropsten (ETH)详细交易信息</h3></div><div class="og l"><p class="bd b gc z el od eo ep oe er et ek translated">ropsten.etherscan.io</p></div></div></div></a></div><p id="0d1e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">此时，您的项目文件夹应该如下所示:</p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div class="fe ff oh"><img src="../Images/b8406d66333ce0208c9856e1b1f5d184.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*KBv-n0-DwqTzI5dzvU2IZw.png"/></div></figure><p id="89ee" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们为我们的应用程序部署了smart-contract，现在是时候开发前端:<strong class="jd hu">部分了。本教程的II很快就要来了！</strong></p><figure class="ml mm mn mo fq iu fe ff paragraph-image"><div class="fe ff oi"><img src="../Images/78e754d3c3addebb2d0abc48cf5f99d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*_ssMQAeX-2zBAQlApmEtOw.png"/></div></figure><p id="6849" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="jz">这是我的第一篇文章和教程，我很乐意接受任何关于它的评论或问题，谢谢你的阅读:)</em></p><blockquote class="oj"><p id="e7ec" class="ok ol ht bd om on oo op oq or os jy ek translated">加入Coinmonks <a class="ae mf" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae mf" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae mf" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="lm kp ht bd kq ln ot lp ku lq ou ls ky jm ov lu lc jq ow lw lg ju ox ly lk lz dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="ka kb ht jd b je ma ji mb jm oy jq oz ju pa jy kf kg kh ki dt translated"><a class="ae mf" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae mf" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated"><a class="ae mf" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae mf" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated"><a class="ae mf" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae mf" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="f33b" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated"><a class="ae mf" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae mf" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated"><a class="ae mf" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">开发者最佳加密API</a></li><li id="b359" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">最佳<a class="ae mf" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="3c98" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated"><a class="ae mf" rel="noopener" href="/coinmonks/free-crypto-signals-48b25e61a8da">免费加密信号</a> | <a class="ae mf" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a></li><li id="9487" class="ka kb ht jd b je kj ji kk jm kl jq km ju kn jy kf kg kh ki dt translated">杠杆代币的终极指南</li></ul></div></div>    
</body>
</html>