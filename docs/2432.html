<html>
<head>
<title>Applying Test-Driven Development On Your Truffle Dapp</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在你的Truffle Dapp上应用测试驱动开发</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/applying-test-driven-development-on-your-truffle-dapp-2722c3b6a6c?source=collection_archive---------2-----------------------#2019-10-03">https://medium.com/coinmonks/applying-test-driven-development-on-your-truffle-dapp-2722c3b6a6c?source=collection_archive---------2-----------------------#2019-10-03</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div class="fe ff hr"><img src="../Images/0754f5260c52a410ba4f203188dd70ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*AL2i5dqbmdhzZFx7PNGn4w.jpeg"/></div></figure><div class=""/><p id="40e7" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">测试驱动开发(TDD)是一个软件开发过程，它依赖于一个非常短的开发周期的重复:需求被转化为非常具体的测试用例，然后软件被改进以通过测试。(您在实现特性之前编写测试用例)</p><p id="0953" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">安装松露</p><pre class="jv jw jx jy fq jz ka kb kc aw kd dt"><span id="5179" class="ke kf ia ka b fv kg kh l ki kj">npm i truffle</span></pre><p id="7fd6" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">下载松露盒</p><pre class="jv jw jx jy fq jz ka kb kc aw kd dt"><span id="e455" class="ke kf ia ka b fv kg kh l ki kj">truffle unbox yehia67/HelloWorldBox</span></pre><p id="0c38" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">然后转到test/Simple.test.js</p><p id="c59f" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">你应该会发现这个内容</p><pre class="jv jw jx jy fq jz ka kb kc aw kd dt"><span id="cc84" class="ke kf ia ka b fv kg kh l ki kj">const simple = artifacts.require(‘./Simple.sol’)</span><span id="3092" class="ke kf ia ka b fv kk kh l ki kj">contract(‘Simple’, (accounts) =&gt; {</span><span id="49b0" class="ke kf ia ka b fv kk kh l ki kj">before(async() =&gt; {</span><span id="cceb" class="ke kf ia ka b fv kk kh l ki kj">this.Simple = await simple.deployed()</span><span id="1fa4" class="ke kf ia ka b fv kk kh l ki kj">})</span><span id="e2e1" class="ke kf ia ka b fv kk kh l ki kj">it(‘deploys successfully’, async() =&gt; {</span><span id="2516" class="ke kf ia ka b fv kk kh l ki kj">const address = await this.Simple.address</span><span id="4df3" class="ke kf ia ka b fv kk kh l ki kj">assert.notEqual(address, 0x0)</span><span id="c130" class="ke kf ia ka b fv kk kh l ki kj">assert.notEqual(address, ‘’)</span><span id="b11d" class="ke kf ia ka b fv kk kh l ki kj">assert.notEqual(address, null)</span><span id="86e8" class="ke kf ia ka b fv kk kh l ki kj">assert.notEqual(address, undefined)</span><span id="b6cc" class="ke kf ia ka b fv kk kh l ki kj">})</span><span id="b963" class="ke kf ia ka b fv kk kh l ki kj">it(‘Set Function work well’, async() =&gt; {</span><span id="dedf" class="ke kf ia ka b fv kk kh l ki kj">const simple = await this.Simple.set(“Simple Contract”)</span><span id="a240" class="ke kf ia ka b fv kk kh l ki kj">const Hello = await this.Simple.hello()</span><span id="22bf" class="ke kf ia ka b fv kk kh l ki kj">assert.equal(Hello, “Simple Contract”)</span><span id="04dc" class="ke kf ia ka b fv kk kh l ki kj">})</span><span id="714d" class="ke kf ia ka b fv kk kh l ki kj">it(‘Get Function work well’, async() =&gt; {</span><span id="5d3d" class="ke kf ia ka b fv kk kh l ki kj">const simple = await this.Simple.set(“Simple Contract”)</span><span id="a282" class="ke kf ia ka b fv kk kh l ki kj">const Hello = await this.Simple.get()</span><span id="364a" class="ke kf ia ka b fv kk kh l ki kj">assert.equal(Hello, “Simple Contract”)</span><span id="98b4" class="ke kf ia ka b fv kk kh l ki kj">})</span><span id="287b" class="ke kf ia ka b fv kk kh l ki kj">})</span></pre><p id="95a4" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz ib">代码解释</strong></p><p id="7cfc" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">首先，初始化契约并部署它。怎么会？</p><p id="8c77" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">导入合同:</p><pre class="jv jw jx jy fq jz ka kb kc aw kd dt"><span id="f8cf" class="ke kf ia ka b fv kg kh l ki kj">const simple = artifacts.require(‘./Simple.sol’)</span></pre><p id="93d6" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">使用<code class="eh kl km kn ka b">contract</code>函数部署合同，第一个参数是合同名称，第二个参数是回调函数以导入地址帐户。</p><pre class="jv jw jx jy fq jz ka kb kc aw kd dt"><span id="234f" class="ke kf ia ka b fv kg kh l ki kj">contract(‘Simple’, (accounts) =&gt; {</span><span id="78b7" class="ke kf ia ka b fv kk kh l ki kj">before(async() =&gt; {</span><span id="29f3" class="ke kf ia ka b fv kk kh l ki kj">this.Simple = await simple.deployed()</span><span id="cb90" class="ke kf ia ka b fv kk kh l ki kj">})<br/> //place test cases here</span></pre><p id="1c67" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在我们已经准备好创建我们的测试用例，因为我们有了<code class="eh kl km kn ka b">this.Simple</code>对象，我们可以使用它调用任何函数或变量。例如，如果我们有一个名为<code class="eh kl km kn ka b">myfunction</code>的函数，我们可以这样叫它<code class="eh kl km kn ka b"> await this.Simple.myfunction ()</code></p><p id="94a2" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">为了制作测试用例，我们将使用<code class="eh kl km kn ka b">await</code>关键字。为了使用<code class="eh kl km kn ka b">await</code>，它应该在<code class="eh kl km kn ka b">async</code>函数内部。所以测试用例会是这样的</p><pre class="jv jw jx jy fq jz ka kb kc aw kd dt"><span id="a391" class="ke kf ia ka b fv kg kh l ki kj">// 3 test cases</span><span id="e3d7" class="ke kf ia ka b fv kk kh l ki kj">// Check if contact deployed successfully <br/>it(‘deploys successfully’, async() =&gt; {</span><span id="e60b" class="ke kf ia ka b fv kk kh l ki kj">const address = await this.Simple.address</span><span id="f1a8" class="ke kf ia ka b fv kk kh l ki kj">assert.notEqual(address, 0x0)</span><span id="844d" class="ke kf ia ka b fv kk kh l ki kj">assert.notEqual(address, ‘’)</span><span id="565e" class="ke kf ia ka b fv kk kh l ki kj">assert.notEqual(address, null)</span><span id="41ec" class="ke kf ia ka b fv kk kh l ki kj">assert.notEqual(address, undefined)</span><span id="a6e7" class="ke kf ia ka b fv kk kh l ki kj">})</span><span id="fc55" class="ke kf ia ka b fv kk kh l ki kj">//Check if Set Function working correctly<br/>it(‘Set Function work well’, async() =&gt; {</span><span id="a26c" class="ke kf ia ka b fv kk kh l ki kj">const simple = await this.Simple.set(“Simple Contract”)</span><span id="2998" class="ke kf ia ka b fv kk kh l ki kj">const Hello = await this.Simple.hello() //check hello variable </span><span id="b896" class="ke kf ia ka b fv kk kh l ki kj">assert.equal(Hello, “Simple Contract”)</span><span id="2db2" class="ke kf ia ka b fv kk kh l ki kj">})</span><span id="c7a2" class="ke kf ia ka b fv kk kh l ki kj">//Check if Get Function working correctly</span><span id="8368" class="ke kf ia ka b fv kk kh l ki kj">it(‘Get Function work well’, async() =&gt; {</span><span id="a060" class="ke kf ia ka b fv kk kh l ki kj">const simple = await this.Simple.set(“Simple Contract”)</span><span id="a8b7" class="ke kf ia ka b fv kk kh l ki kj">const Hello = await this.Simple.get()</span><span id="8e10" class="ke kf ia ka b fv kk kh l ki kj">assert.equal(Hello, “Simple Contract”)</span><span id="5904" class="ke kf ia ka b fv kk kh l ki kj">})</span></pre><p id="4232" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在，回到我们的目标，我们将如何应用TDD？在这个简单的例子中，您可以轻松地执行以下操作</p><p id="4398" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">1-决定我要创建多少个合同(在我们的例子中只有一个)</p><p id="1303" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">2-您想要创建多少个函数(只有2个)</p><p id="3b28" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">3-为每个合同创建文件。</p><p id="15a2" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">4-按照上面的例子编写测试用例。</p><p id="f762" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">5-运行该命令<code class="eh kl km kn ka b"> truffle test ./path/to/test/fileName.test.js</code></p><p id="77fb" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">你可以写你的测试用例，然后开发你的联系人，然后测试每一个。希望这有用。谢谢，如果你有任何问题，请随时提问。</p><figure class="jv jw jx jy fq hv fe ff paragraph-image"><a href="https://coincodecap.com"><div class="fe ff ko"><img src="../Images/a06b758bdcc47dca7c2504f298674d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_s6JsD3P0hVj32E7t9EtGg.jpeg"/></div></a></figure><blockquote class="kp"><p id="84c7" class="kq kr ia bd ks kt ku kv kw kx ky ju ek translated"><a class="ae kz" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="lb lc ld le lf hv fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff la"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>