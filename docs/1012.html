<html>
<head>
<title>Regularization of Linear Models with SKLearn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用SKLearn正则化线性模型</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/regularization-of-linear-models-with-sklearn-f88633a93a2?source=collection_archive---------1-----------------------#2018-07-12">https://medium.com/coinmonks/regularization-of-linear-models-with-sklearn-f88633a93a2?source=collection_archive---------1-----------------------#2018-07-12</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/1311fc9b088c8cfb0f03d54d7763cb6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*fbPosZuWyyq_C8CSzATmbw.png"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek">An overfit model</figcaption></figure><p id="2244" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">线性模型通常是训练模型的良好起点。然而，许多数据集并不显示自变量和因变量之间的线性关系。因此，经常需要创建多项式模型。然而，这些模型通常容易过度拟合。减少多项式模型中过拟合的一种方法是通过使用正则化。</p><p id="1401" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们首先构建一个基线模型来确定需要的改进。我们将利用流行的波士顿房屋数据集，该数据集可在Kaggle <a class="ae jz" href="https://www.kaggle.com/c/boston-housing" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><p id="b06d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们导入必要的库并加载我们的训练数据集。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="b818" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们将数据分为训练集和验证集。我们将拿出30%的数据进行验证。我们将使用随机状态使我们的实验可重复。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="4fcc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们通过训练线性回归模型来建立基线。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="8f25" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">上面的模型应该给我们一个大约72%的训练精度和测试精度。我们也应该得到大约4.587的RMSE。我们训练的下一个模型应该比这个模型具有更高的准确度分数和更低的RMSE。</p><p id="179d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们需要设计新的功能。具体来说，我们需要通过将我们的单个特征提升到选定的幂来创建多项式特征。幸运的是，scikit-learn对此有一个实现，我们不需要手动完成它。</p><p id="a946" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们想做的另一件事是标准化我们的数据。这将我们的数据缩小到0和1之间的范围。这是为了让我们在计算幂时，能够使用合理的数字。</p><p id="6b93" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最后，因为我们需要在我们的训练、验证和测试集上执行相同的操作，所以我们将引入一个管道。这将使我们能够对我们的过程进行管道化，从而重复执行相同的步骤。</p><p id="3de6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">总而言之，我们将缩放数据，然后创建多项式特征，然后训练线性回归模型。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="760a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">运行我们的代码后，我们将获得大约94.75%的训练准确率和46.76%的测试准确率。这是过度拟合的标志。这通常不是一个理想的特性，但这正是我们所希望的。</p><p id="5110" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们现在将正则化应用到我们的新数据。</p><h1 id="ac7c" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">l2正则化或岭回归</h1><p id="8d09" class="pw-post-body-paragraph jb jc ht jd b je le jg jh ji lf jk jl jm lg jo jp jq lh js jt ju li jw jx jy hm dt translated">为了理解岭回归，我们需要提醒自己在梯度下降过程中，当我们的模型系数被训练时发生了什么。在训练期间，我们的初始权重根据梯度更新规则使用学习率和梯度进行更新。岭回归增加了更新的代价，结果缩小了权重的大小。这在scikit-learn中实现为一个名为Ridge的类。</p><p id="2c2b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将创建一个新的管道，这一次使用山脊。我们将通过传入参数α来指定正则化强度。这个值可以非常小，比如0.1，也可以是你想要的大小。alpha值越大，模型显示的方差越小。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="3077" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">通过执行代码，我们应该有大约91.8%的训练准确率，以及大约82.87%的测试准确率。这是对我们基线线性回归模型的改进。</p><p id="16a9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们试试别的东西。</p><h1 id="264d" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">l1正则化或套索回归</h1><p id="afdb" class="pw-post-body-paragraph jb jc ht jd b je le jg jh ji lf jk jl jm lg jo jp jq lh js jt ju li jw jx jy hm dt translated">通过创建多项式模型，我们创建了额外的功能。我们需要问自己的问题是，我们的哪些特性与我们的模型相关，哪些不相关。</p><p id="49ed" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">l1正则化试图通过将某些系数的值降低到0来回答这个问题。这消除了我们模型中最不重要的特性。我们将创建一个类似上面的管道，但使用套索。您可以随意使用alpha值，范围从0.1到1。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="e17a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">上面的代码应该给我们84.8%的训练准确率和83%的测试准确率。这是一个比我们之前培训的模型更好的模型。</p><p id="0800" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">此时，您可以通过找到RMSE来评估您的模型。不要忘记阅读我们使用的所有文档。</p><p id="7304" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我希望这个教程对你有用。下次见。</p><blockquote class="lj"><p id="1299" class="lk ll ht bd lm ln lo lp lq lr ls jy ek translated">加入Coinmonks <a class="ae jz" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jz" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jz" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="lt kh ht bd ki lu lv lw km lx ly lz kq jm ma mb ku jq mc md ky ju me mf lc mg dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="mh mi ht jd b je le ji lf jm mj jq mk ju ml jy mm mn mo mp dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae jz" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated"><a class="ae jz" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae jz" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated"><a class="ae jz" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae jz" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="450c" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated"><a class="ae jz" href="https://coincodecap.com/pionex-dual-investment" rel="noopener ugc nofollow" target="_blank"> Pionex双投</a> | <a class="ae jz" href="https://coincodecap.com/advcash-review" rel="noopener ugc nofollow" target="_blank"> AdvCash审核</a> | <a class="ae jz" href="https://coincodecap.com/uphold-review" rel="noopener ugc nofollow" target="_blank">光宗耀祖审核</a></li><li id="4c48" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated"><a class="ae jz" href="https://coincodecap.com/best-cryptocurrency-apis" rel="noopener ugc nofollow" target="_blank">面向开发者的8个最佳加密货币APIs】</a></li><li id="db49" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated"><a class="ae jz" href="https://coincodecap.com/uphold-card-review" rel="noopener ugc nofollow" target="_blank">拥护卡审核</a> | <a class="ae jz" href="https://coincodecap.com/trust-wallet-vs-metamask" rel="noopener ugc nofollow" target="_blank">信任钱包vs MetaMask </a></li><li id="0843" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated"><a class="ae jz" href="https://coincodecap.com/earn-sign-up-bonus" rel="noopener ugc nofollow" target="_blank">赢取注册奖金——10大最佳加密平台</a></li><li id="f33b" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae jz" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">面向开发人员的最佳加密API</a></li><li id="b359" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated">最佳<a class="ae jz" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="mh mi ht jd b je mq ji mr jm ms jq mt ju mu jy mm mn mo mp dt translated">杠杆代币的终极指南</li></ul></div></div>    
</body>
</html>