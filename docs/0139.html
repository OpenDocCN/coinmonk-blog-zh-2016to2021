<html>
<head>
<title>NEO Smart Contracts: Build &amp; Test</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NEO智能合同:构建和测试</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/neo-smart-contracts-build-test-fe83ae42a285?source=collection_archive---------5-----------------------#2018-03-04">https://medium.com/coinmonks/neo-smart-contracts-build-test-fe83ae42a285?source=collection_archive---------5-----------------------#2018-03-04</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk iq ir is it"><div class="bz el l di"><div class="iu iv l"/></div></figure><p id="75bc" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">这是hello world教程帖子的后续帖子，将介绍如何在导入之前快速构建和测试智能合约代码。</p><p id="81f7" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">如果你还没有浏览hello world和dev环境设置教程，我建议你在继续这篇文章之前快速浏览一下。</p><p id="3ca1" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated"><a class="ae ju" rel="noopener" href="/@nickfujita/neo-smart-contracts-tutorial-helloworld-13ecc19b31fe"> Hello World智能合约教程</a></p><p id="88e1" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated"><a class="ae ju" rel="noopener" href="/@nickfujita/neo-dev-environment-setup-tutorial-e495f5364ada">开发环境设置教程</a></p><p id="ec92" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">在hello world教程中，我们讨论了如何单独构建和导入合同文件的步骤。当您将合同代码构建到一个合理的水平，并且想要在您的私有网络上测试它时，这个练习是有用的。然而，有一种更快的方法来测试您的合同代码，甚至不需要导入它！</p><p id="4ee4" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">在neo-python cli中有一个命令<code class="eh jv jw jx jy b">build</code>。我们在hello world教程中调用它是为了将我们的<code class="eh jv jw jx jy b">py</code>文件编译成一个<code class="eh jv jw jx jy b">avm</code>文件，其结构如下:</p><pre class="jz ka kb kc fq kd jy ke kf aw kg dt"><span id="51e4" class="kh ki ht jy b fv kj kk l kl km">build path/to/file.py</span></pre><p id="9d71" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">好消息是这个<code class="eh jv jw jx jy b">build</code>命令还带有额外的参数，它结合了契约<code class="eh jv jw jx jy b">import</code>和<code class="eh jv jw jx jy b">testinvoke</code>。</p><pre class="jz ka kb kc fq kd jy ke kf aw kg dt"><span id="f054" class="kh ki ht jy b fv kj kk l kl km">build {path/to/file.py} test {input_types} {return_type} {needs_storage} {needs_dynamic_invoke} {test_param} ...</span></pre><p id="eae0" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">正如您所看到的，它看起来非常熟悉<code class="eh jv jw jx jy b">contract import</code>命令，但是也允许您将所有参数附加到命令的末尾来运行您的测试。例如:</p><pre class="jz ka kb kc fq kd jy ke kf aw kg dt"><span id="f468" class="kh ki ht jy b fv kj kk l kl km">build smartContracts/helloWorld.py test "" 01 False False</span></pre><p id="b086" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">请注意，该命令引用了。<code class="eh jv jw jx jy b">py</code>文件，而不是<code class="eh jv jw jx jy b">.avm</code>文件。这是因为它将在同一个命令中执行新<code class="eh jv jw jx jy b">.avm</code>的编译和测试调用。</p><p id="af71" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">让我们来看一个稍微有趣一点的字符串连接契约。</p><pre class="jz ka kb kc fq kd jy ke kf aw kg dt"><span id="d728" class="kh ki ht jy b fv kj kk l kl km">from boa.builtins import concat</span><span id="a5ed" class="kh ki ht jy b fv kn kk l kl km">def Main(initialString, args):</span><span id="1104" class="kh ki ht jy b fv kn kk l kl km">    result = initialString</span><span id="d128" class="kh ki ht jy b fv kn kk l kl km">    for word in args:</span><span id="2c53" class="kh ki ht jy b fv kn kk l kl km">        if result == None:</span><span id="524a" class="kh ki ht jy b fv kn kk l kl km">            result = word</span><span id="f06d" class="kh ki ht jy b fv kn kk l kl km">        else:</span><span id="37ce" class="kh ki ht jy b fv kn kk l kl km">            result = concat(result,' ')</span><span id="72f5" class="kh ki ht jy b fv kn kk l kl km">            result = concat(result,word)</span><span id="9024" class="kh ki ht jy b fv kn kk l kl km">        print(result)</span><span id="a334" class="kh ki ht jy b fv kn kk l kl km">    return result</span></pre><p id="bba6" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">这个契约有两个参数，一个初始字符串和一个数组。它遍历数组中的每一项，并将每个值与初始字符串连接起来。这就变成了返回值。为了运行它，我们可以使用以下命令:</p><pre class="jz ka kb kc fq kd jy ke kf aw kg dt"><span id="21f7" class="kh ki ht jy b fv kj kk l kl km">build smartContracts/concat.py test 0710 07 False False sunshine ['hello','world','things','otherthings']</span></pre><p id="e2ea" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">输入有两个参数，一个是String类型的，用<code class="eh jv jw jx jy b">07</code>表示，另一个是Array类型的，用<code class="eh jv jw jx jy b">10</code>表示，返回的类型是String，用<code class="eh jv jw jx jy b">07</code>表示。有关数据类型到字节映射的完整列表，请参见NEO官方文档。</p><p id="6738" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated"><a class="ae ju" href="http://docs.neo.org/en-us/sc/tutorial/Parameter.html" rel="noopener ugc nofollow" target="_blank"> NEO智能合约:参数类型</a></p><p id="0d39" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">既然我们知道了如何使用build命令和test invoke，我们现在可以快速迭代开发和测试新代码，而不必在每一步都导入契约代码！</p><blockquote class="ko"><p id="f60d" class="kp kq ht bd kr ks kt ku kv kw kx jt ek translated"><a class="ae ju" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="kz la lb lc ld it fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff ky"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><p id="8d46" class="pw-post-body-paragraph iw ix ht iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hm dt translated">如果你觉得这个教程有帮助，请在:</p><pre class="jz ka kb kc fq kd jy ke kf aw kg dt"><span id="aded" class="kh ki ht jy b fv kj kk l kl km">NEO/GAS/NEP5 tokens: AR8rRBxgWw5siKsp1dUmfTLy6QQTjcqoqB</span><span id="b6b1" class="kh ki ht jy b fv kn kk l kl km">ETH/ERC20 tokens: 0x575970777095575fDd12d9cD3B105b41D8DD1344</span><span id="0e4e" class="kh ki ht jy b fv kn kk l kl km">NANO/XRB: xrb_3rpmim57tqbrb8hhjfzm1x5uk135yhmgqoj7j7wsufpo53e3ad5k93ggy1cd</span><span id="d116" class="kh ki ht jy b fv kn kk l kl km">LTC: M8nZ7FwJXSMAkAfiGmTKjbB7MWpdwsp52d</span><span id="84a8" class="kh ki ht jy b fv kn kk l kl km">BTC: 3LcA1ztxFjghexRNWPyGXA59VFU3gF4PTz</span><span id="3d28" class="kh ki ht jy b fv kn kk l kl km">BCH: 1LXLiF7SjWGday6gm61hzbYHKbSAMevwXo</span></pre><figure class="jz ka kb kc fq it fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lg"><img src="../Images/8e787f1b56b9029eb972536d5518348b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ryBcd9SNwBnwCg-rD9iwkg.png"/></div></div></figure></div></div>    
</body>
</html>