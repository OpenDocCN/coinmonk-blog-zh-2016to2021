<html>
<head>
<title>Solidity Fundamentals</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">坚固性基础</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/solidity-fundamentals-a71bf54c0b98?source=collection_archive---------3-----------------------#2020-12-24">https://medium.com/coinmonks/solidity-fundamentals-a71bf54c0b98?source=collection_archive---------3-----------------------#2020-12-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><h2 id="64a1" class="hr hs ht bd b gc hu hv hw hx hy hz ek ia translated" aria-label="kicker paragraph">以太坊智能合约开发</h2><div class=""/><div class=""><h2 id="2ee0" class="pw-subtitle-paragraph iz ic ht bd b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ek translated">数据位置和分配行为</h2></div><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff jr"><img src="../Images/a0e9c5141fd3d14675ae2b7356a9b700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3HOdnPhEivRatZ6KYJ6_WA.jpeg"/></div></div></figure></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="753f" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">所有引用类型都有一个额外的注释，即<em class="lg">数据位置</em>，关于它存储的位置。有三个可能的选项:<code class="eh lh li lj lk b">memory</code>、<code class="eh lh li lj lk b">storage</code>和<code class="eh lh li lj lk b">calldata</code>。</p><p id="c5eb" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><code class="eh lh li lj lk b">storage</code>:状态变量存储在区块链上的位置类型，这意味着具有<code class="eh lh li lj lk b">storage</code>位置的类型是持久的。</p><p id="125f" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><code class="eh lh li lj lk b">memory</code>:变量在<code class="eh lh li lj lk b">memory</code>中，它们在函数调用过程中存在，这意味着得到这个位置的变量是临时的，在函数执行完成后，它们就不存在了。</p><p id="4b70" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><code class="eh lh li lj lk b">calldata</code>:存储函数参数的不可修改、非持久的数据位置，其行为很大程度上类似于<code class="eh lh li lj lk b">memory</code>数据位置，并且仅适用于<code class="eh lh li lj lk b">external</code>函数。关于函数类型(<code class="eh lh li lj lk b">external</code>、<code class="eh lh li lj lk b">public</code>、<code class="eh lh li lj lk b">internal</code>、<code class="eh lh li lj lk b">private</code>)的更多内容稍后再说。</p><blockquote class="ll lm ln"><p id="4b31" class="kk kl lg km b kn ko jd kp kq kr jg ks lo ku kv kw lp ky kz la lq lc ld le lf hm dt translated">更改数据位置的赋值或类型转换总是会导致自动复制操作，而同一数据位置内的赋值仅在某些情况下针对存储类型进行复制。</p></blockquote><p id="2218" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">数据集位置不仅对数据的持久性很重要，对赋值的语义也很重要。让我们看看每个行为；</p><ul class=""><li id="7832" class="lr ls ht km b kn ko kq kr kt lt kx lu lb lv lf lw lx ly lz dt translated"><code class="eh lh li lj lk b">storage</code>和<code class="eh lh li lj lk b">memory</code>(或来自<code class="eh lh li lj lk b">calldata</code>)之间的分配总是创建一个独立的副本。</li><li id="c906" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated">从<code class="eh lh li lj lk b">memory</code>到<code class="eh lh li lj lk b">memory</code>的分配仅创建参考。因此，对一个内存变量的更改在引用相同数据的所有其他内存变量中也是可见的。</li><li id="8cc5" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated">从<code class="eh lh li lj lk b">storage</code>到局部<code class="eh lh li lj lk b">storage</code>变量的赋值也只分配一个引用。</li><li id="6ef9" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated">所有其他分配给<code class="eh lh li lj lk b">storage</code>的任务总是创建独立的副本。</li></ul><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="mf mg l"/></div></figure></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="aa29" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">我想提醒你一些关于结构用法的事情。让我们看看下面的例子；</p><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="mf mg l"/></div></figure></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="af98" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">关于引用类型的最后一点说明。如果我们处理引用类型，我们应该非常小心，原因如下。</p><ul class=""><li id="e76c" class="lr ls ht km b kn ko kq kr kt lt kx lu lb lv lf lw lx ly lz dt translated">引用类型不一定适合32字节— 256位。</li><li id="425e" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated">执行过程中消耗的气体量取决于数据位置。从引用类型创建独立的副本是很昂贵的，因此建议我们应该选择在函数内部使用内存数据位置。</li><li id="fa83" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated">当两个或更多不同变量指向同一数据位置时，我们必须小心，因为一个变量的任何变化都会影响其他变量。</li></ul></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="ef39" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">最后，让我们看看在类似契约的契约中，结构、映射和枚举的一些复杂但非常有价值的用法。</p><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="mf mg l"/></div></figure></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="82e2" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">接下来，我们将研究<em class="lg">控制结构</em>。感谢阅读。</p></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="6157" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><strong class="km id">参考文献</strong></p><div class="mh mi fm fo mj mk"><a href="https://docs.soliditylang.org/en/v0.7.4/types.html#reference-types" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab ej"><div class="mm ab mn cl cj mo"><h2 class="bd id fv z el mp eo ep mq er et ic dt translated">类型-坚固性0.7.4文件</h2><div class="mr l"><h3 class="bd b fv z el mp eo ep mq er et ek translated">Solidity是一种静态类型语言，这意味着每个变量(状态和局部)的类型都需要…</h3></div><div class="ms l"><p class="bd b gc z el mp eo ep mq er et ek translated">docs.soliditylang.org</p></div></div></div></a></div></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><h1 id="531d" class="mt mu ht bd mv mw mx my mz na nb nc nd ji ne jj nf jl ng jm nh jo ni jp nj nk dt translated">所有部件正常</h1><ul class=""><li id="633f" class="lr ls ht km b kn nl kq nm kt nn kx no lb np lf lw lx ly lz dt translated"><a class="ae nq" href="https://ferdikurt.medium.com/solidity-fundamentals-88ceb4873064" rel="noopener">合同版面</a></li><li id="6bb5" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated"><a class="ae nq" href="https://ferdikurt.medium.com/solidity-fundamentals-ca824a3ac023" rel="noopener">值类型:第一部分</a></li><li id="d6f5" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated"><a class="ae nq" href="https://ferdikurt.medium.com/solidity-fundamentals-c94460e3be3d" rel="noopener">值类型:第二部分</a></li><li id="505a" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated"><a class="ae nq" rel="noopener" href="/coinmonks/solidity-fundamentals-1fb0e6b3b607">操作员</a></li><li id="623d" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated"><a class="ae nq" rel="noopener" href="/coinmonks/solidity-fundamentals-e4e4660e16c8">参考类型</a></li><li id="fc35" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated"><a class="ae nq" rel="noopener" href="/coinmonks/solidity-fundamentals-a71bf54c0b98">数据位置和赋值行为</a></li><li id="9410" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated"><a class="ae nq" rel="noopener" href="/coinmonks/solidity-fundamentals-1dc2af4b453b">控制结构</a></li><li id="a3fd" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated"><a class="ae nq" rel="noopener" href="/coinmonks/solidity-fundamentals-a95bb6c8ba2a">错误处理:断言、要求、恢复和异常</a></li><li id="7468" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated"><a class="ae nq" rel="noopener" href="/coinmonks/solidity-fundamentals-d2216be1c2c3">功能:第一部分</a></li><li id="0e3b" class="lr ls ht km b kn ma kq mb kt mc kx md lb me lf lw lx ly lz dt translated"><a class="ae nq" href="https://ferdikurt.medium.com/solidity-fundamentals-functions-a7e3d38c1fe5" rel="noopener">功能:第二部分</a></li></ul></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><p id="1352" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">随便问任何问题。</p><p id="11c8" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated">注意安全，做好工作，保持联系！</p><p id="c9da" class="pw-post-body-paragraph kk kl ht km b kn ko jd kp kq kr jg ks kt ku kv kw kx ky kz la lb lc ld le lf hm dt translated"><a class="ae nq" href="https://www.linkedin.com/in/ferdi-kurt-8b910b164/" rel="noopener ugc nofollow" target="_blank">费尔迪科特</a></p></div></div>    
</body>
</html>