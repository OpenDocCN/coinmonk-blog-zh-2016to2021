<html>
<head>
<title>Hierarchical Deterministic Wallets: Ethereum</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分层确定性钱包:以太坊</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/hierarchical-deterministic-wallets-ethereum-589f8a359b81?source=collection_archive---------4-----------------------#2018-08-01">https://medium.com/coinmonks/hierarchical-deterministic-wallets-ethereum-589f8a359b81?source=collection_archive---------4-----------------------#2018-08-01</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/c3662515320d052d6da3f7b92af7823f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*Hp0vwMkf-fE7DQe3.png"/></div><figcaption class="ix iy fg fe ff iz ja bd b be z ek"><a class="ae jb" href="https://www.google.co.in/url?sa=i&amp;source=images&amp;cd=&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwj88IailczcAhVLuo8KHYIpAEoQjxx6BAgBEAI&amp;url=http%3A%2F%2Fwww.sv-veert.de%2Faddress-iphone%2Fdo-i-need-a-cryptocurrency-wallet-buy-icn-crypto-currency%2F&amp;psig=AOvVaw2_e6sptIZm1OAnwiYRtW__&amp;ust=1533223593280178" rel="noopener ugc nofollow" target="_blank">image source</a></figcaption></figure><p id="ef49" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">本文将带您了解如何创建兼容以太坊的层次确定性钱包。这将使您能够为事务生成自己的公私密钥、校验和以及地址。</p></div><div class="ab cl ka kb hb kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hm hn ho hp hq"><p id="770f" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">我们将使用bip39、ethereumjs-tx、ethereumjs-util、hdkey和web3.js。</p><ul class=""><li id="43b7" class="kh ki ht je b jf jg jj jk jn kj jr kk jv kl jz km kn ko kp dt translated"><a class="ae jb" href="https://github.com/iancoleman/bip39" rel="noopener ugc nofollow" target="_blank"> BIP39 </a>:生成助记符</li><li id="6990" class="kh ki ht je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp dt translated"><a class="ae jb" href="https://github.com/ethereumjs/ethereumjs-tx" rel="noopener ugc nofollow" target="_blank"> Ethereumjs-tx </a>:创建事务(设置参数并序列化)</li><li id="d9ed" class="kh ki ht je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp dt translated"><a class="ae jb" href="https://github.com/ethereumjs/ethereumjs-util" rel="noopener ugc nofollow" target="_blank">以太坊-util </a>:利用校验和、私有-公共密钥创建，并将公共密钥转换为地址</li><li id="3887" class="kh ki ht je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp dt translated"><a class="ae jb" href="https://github.com/cryptocoinjs/hdkey" rel="noopener ugc nofollow" target="_blank"> HDkey </a>:构建分层确定性密钥树</li></ul></div><div class="ab cl ka kb hb kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hm hn ho hp hq"><blockquote class="kv"><p id="dbe2" class="kw kx ht bd ky kz la lb lc ld le jz ek translated">还读:<a class="ae jb" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">最佳比特币硬件钱包</a></p></blockquote><h2 id="7e66" class="lf lg ht bd lh li lj lk ll lm ln lo lp jn lq lr ls jr lt lu lv jv lw lx ly lz dt translated">事实上的规则:</h2><ul class=""><li id="f6f0" class="kh ki ht je b jf ma jj mb jn mc jr md jv me jz km kn ko kp dt translated">私钥证明你对以太的所有权。</li><li id="e930" class="kh ki ht je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp dt translated">丢失您的私人钥匙意味着您不再有访问权，并且不能花费被锁住的以太。就当它烧焦了。</li><li id="3921" class="kh ki ht je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp dt translated">地址用于进行和接收交易，而不是公钥。</li><li id="e8ea" class="kh ki ht je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp dt translated">公钥和地址不是同义词。</li><li id="b4e7" class="kh ki ht je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp dt translated">知道了您的公钥或私钥，您就可以重新创建您的地址。</li><li id="983b" class="kh ki ht je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp dt translated">公钥和私钥用于建立数字签名。</li></ul></div><div class="ab cl ka kb hb kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hm hn ho hp hq"><ul class=""><li id="5e0b" class="kh ki ht je b jf jg jj jk jn kj jr kk jv kl jz km kn ko kp dt translated">生成BIP 39兼容助记符:</li></ul><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="dccd" class="lf lg ht mk b fv mo mp l mq mr">const mnemonic = bip39.generateMnemonic();</span></pre><p id="0c85" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">助记符是一组单词，当按照准确的顺序再现时，它们将重新创建您的私钥。记忆术的发展是为了帮助加密货币持有者记住或者更确切地说是找到一种在人类记忆中保留特定信息集的方法，这将使他们能够重新创建他们的私钥。</p><p id="f74e" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">记住单词的顺序要容易得多，比如“<em class="ms">cherry you receive shuffle ski wise your roof shield private shaft shield</em>”而不是“<em class="ms">331 D1 e 7724 a 2784 fa 4d 75 c 96 da 9d 68 f 23321 e 1c d0b 55 a4 d 2377192 bdae 2 f 10 fc</em>”</p><ul class=""><li id="a2be" class="kh ki ht je b jf jg jj jk jn kj jr kk jv kl jz km kn ko kp dt translated">生成主公钥和私钥:</li></ul><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="b1b2" class="lf lg ht mk b fv mo mp l mq mr">const root = hdkey.fromMasterSeed(seed)</span><span id="e3af" class="lf lg ht mk b fv mt mp l mq mr">const masterPrivateKey = root.privateKey.toString('hex');<br/>const masterPubKey = root.publicKey.toString('hex');</span></pre><p id="962a" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">可以从一个主公钥对中生成公钥和私钥的复杂树形结构。<br/>在大多数密码学中，运算都是在字节级进行的。它在这里被转换为十六进制，以便以人类可读的格式轻松验证预期的行为。</p><p id="0132" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">主公钥对是HD树的一个密钥(双关语)部分。</p><p id="a4c4" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">主密钥对的知识将允许该人重建整个密钥树。将主密钥对和主密钥助记符视为主要目标，并以最高优先级保护。</p><ul class=""><li id="24ad" class="kh ki ht je b jf jg jj jk jn kj jr kk jv kl jz km kn ko kp dt translated">从HD树生成密钥对</li></ul><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="b575" class="lf lg ht mk b fv mo mp l mq mr">var path = "m/44'/60'/0'/0/0";</span><span id="003c" class="lf lg ht mk b fv mt mp l mq mr">const addrNode = root.derive(path)<br/>const pubKey = ethUtil.privateToPublic(addrNode._privateKey)</span></pre><p id="0043" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">树本身可以由任意*数量的叶子和节点生成。最终，为了获得一个特定的密钥对，我们需要指定路径来获得它对应的密钥对。</p><p id="47be" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">指定路径后，我们从相应的根中导出一个密钥对。这个过程是确定的。</p><p id="7e1e" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">存在形成分层确定性树结构的一部分的硬化键和扩展键。当需要生成子树时，在端点级别固有地使用强化键和扩展键。</p><figure class="mf mg mh mi fq iu fe ff paragraph-image"><div class="fe ff mu"><img src="../Images/e368b2e7375af9bc924b93a9f55e0bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*lbkNgxUjK3j1OPAoiDF9PA.jpeg"/></div></figure><p id="c206" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">你可以在这里了解更多信息</p><ul class=""><li id="3813" class="kh ki ht je b jf jg jj jk jn kj jr kk jv kl jz km kn ko kp dt translated">生成校验和和地址</li></ul><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="488d" class="lf lg ht mk b fv mo mp l mq mr">const addr = ethUtil.publicToAddress(pubKey).toString('hex');<br/>const address = ethUtil.toChecksumAddress(addr)</span></pre><p id="4d79" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">根据导出的公钥，我们计算校验和，以验证它确实是一个以太坊地址。我相信这是由于<a class="ae jb" href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-55.md" rel="noopener ugc nofollow" target="_blank"> EIP 55 </a>而增加的。</p><ul class=""><li id="642f" class="kh ki ht je b jf jg jj jk jn kj jr kk jv kl jz km kn ko kp dt translated">构建交易:</li></ul><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="1c3c" class="lf lg ht mk b fv mo mp l mq mr">const params = {<br/>  nonce:0x6,<br/>  to: '0x4584159875418ef77D1142bEec0b6648BD8eDb2f',<br/>  value: '0x30000',<br/>  gasPrice: 0x09184e72a000,<br/>  gasLimit: 0x30000,<br/>}</span></pre><p id="ec71" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">事务由说明事务性质的参数组成。</p><p id="a96b" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">Nonce定义了处理来自该地址的事务的顺序。具有相同nonce的两个事务意味着其中一个被拒绝。<br/>至:接收方地址<br/>值:正在交易的乙醚<br/>气价和气限定义了本次交易可以消耗的气</p><ul class=""><li id="45f7" class="kh ki ht je b jf jg jj jk jn kj jr kk jv kl jz km kn ko kp dt translated">签署一项交易</li></ul><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="b668" class="lf lg ht mk b fv mo mp l mq mr">const tx = new ethTx(params);<br/>tx.sign(addrNode._privateKey); // Signing the transaction<br/>const serializedTx = tx.serialize()</span></pre><p id="410d" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">从指定的参数生成事务的新构造函数实例。因此，用来自HD树中先前生成的叶节点的地址的私钥对事务进行签名。</p><p id="6385" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">然后，签名的事务在广播到节点之前被串行化。</p></div><div class="ab cl ka kb hb kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hm hn ho hp hq"><p id="f154" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">这个项目的源代码可以从<a class="ae jb" href="https://github.com/prahaladbelavadi/HD-wallets-ethereum/releases" rel="noopener ugc nofollow" target="_blank">这里</a>下载。<br/>这绝不是生产就绪。这仅仅是一个学习阶段。</p><p id="5909" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">演职员表:<a class="mv mw gr" href="https://medium.com/u/eb493dfa7df5?source=post_page-----589f8a359b81--------------------------------" rel="noopener" target="_blank">普拉蒂克·雷迪</a>和<a class="mv mw gr" href="https://medium.com/u/a214bb5814a1?source=post_page-----589f8a359b81--------------------------------" rel="noopener" target="_blank">比特大陆有限责任公司</a></p><p id="f70a" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">这篇文章是试图理解以太坊交易过程的结果。欢迎提出编辑、建议、更正和反驳。</p><p id="1464" class="pw-post-body-paragraph jc jd ht je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hm dt translated">干杯！</p></div></div>    
</body>
</html>