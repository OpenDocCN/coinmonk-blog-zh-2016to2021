<html>
<head>
<title>Errors when compiling smart contracts with Truffle and solc-js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Truffle和solc-js编译智能合约时出错</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/errors-when-compiling-smart-contracts-with-truffle-and-solc-js-8e3ed3d43208?source=collection_archive---------4-----------------------#2021-06-03">https://medium.com/coinmonks/errors-when-compiling-smart-contracts-with-truffle-and-solc-js-8e3ed3d43208?source=collection_archive---------4-----------------------#2021-06-03</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="66fb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这篇文章是关于使用npm解决Truffle和solc-js错误的。</p><ol class=""><li id="a58a" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">我遇到的第一个问题是关于ERC721函数的一个错误。错误大致如下:</li></ol><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff jx"><img src="../Images/4aed4b2b5cf55e7f87a51d6a4549ad46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8yKj4muDWuVdsjfRRl1rrQ.png"/></div></div></figure><p id="541a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我使用openzeppelin来导入ERC721令牌的代码。当我试图编译我的智能合同时，我一直得到一个关于这个函数的错误:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kj"><img src="../Images/147bc12b4a789f4c9df1e0e3d3097161.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WwegBWNJTEX5WlEw"/></div></div></figure><p id="a5bc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">该功能在ERC721令牌码本身中，与启用合同间的交叉通信有关。</p><p id="13d1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">原来，我对我的松露版本有意见。当您安装Truffle并在控制台中运行truffle version时，您应该会看到类似于以下内容的内容:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kk"><img src="../Images/0acaa67c8479e2b7f87fd93808f2a4dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EPDj1zTsi69XBO3j"/></div></div></figure><p id="88fb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你没有得到truffle、Solidity、Node和Web3的版本，你可能需要卸载Truffle并重新安装。我进入我的电脑文件，手动卸载松露。您可以通过在控制台中键入松露来找到您的松露路径:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div class="fe ff kl"><img src="../Images/06dd9f05fc2e6db0230f3c1808cdc0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/0*1UUCadvbqsM1Mr8S"/></div></figure><p id="28ca" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您也可以尝试以下命令:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div class="fe ff km"><img src="../Images/fa4fb4110dfd6a42c02d46e5b5f8a801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*sYSQjOR5qxRW6RQHcZPGsg.png"/></div></figure><p id="78a5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要全局安装truffle，您可以运行:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div class="fe ff kn"><img src="../Images/57821481b4ff8e0f23046fb7cd750bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*dEAiBdsz7qUjZbyN97cv6g.png"/></div></figure><p id="75aa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">再次检查在你的控制台中键入truffle version是否给出了truffle、Solidity、Node和Web3版本。如果这仍然不能解决问题，尝试将truffle安装到您的本地项目文件夹中。确保您在项目的根目录中，然后运行:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/3914dcd3bb9f44c0136cf6887d7e127e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*rBupi8r50Ycw9YDBmH6J0Q.png"/></div></figure><p id="1b37" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">(记得将node_modules添加到一个. gitignore文件中，以便可以跟踪您的package_lock.json)。再次，检查是否给了你四个版本。</p><p id="7b89" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你是，尝试重新编译你的合同，希望原来的错误消失！在你编译之前，不要忘记进入你的松露控制台，输入:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="fe ff kp"><img src="../Images/0cb8b5039a6271fc1b3fd34b7c0f52e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nUxqc8gT-jVn6c_n4bw_NA.png"/></div></div></figure><p id="7b47" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2.我遇到的另一个问题是我的项目中没有合适的solc-js编译器。这个编译器能够正确地读取solidity。解决办法？在编写合同时，您可以声明solc-js版本的范围:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div class="fe ff kq"><img src="../Images/90490684d0f8c3e50e2ef725bb0c9d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*3Pvh1JDH4LzEUw1RgrfMbQ.png"/></div></figure><p id="6936" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">(PS，SPDX代表软件包数据交换，它是根据为分发指定的许可证的文件格式。许可证不一定是MIT，它可以是您选择的任何许可证，但是该规范现在是在solidity中编写智能合同的一部分，并且与为了导入目的而验证其他合同的合同有关。</p><p id="a3eb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果这不能解决您的问题，您可以检查您的本地项目中有哪个truffle版本。在你的控制台中输入truffle version，你会得到如上所示的truffle、Solidity、Node和Web3版本。如果没有，请按照上述步骤根据您的需要对安装Truffle进行故障排除。</p><p id="bd5c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您已经设置了这四个版本和solidity编译器范围，但是仍然得到一个关于编译器版本的错误，那么您可以在truffle-config.js文件中的一个编译器对象的networks下指定编译器版本。确保版本被指定为字符串。对于我所拥有的Solidity版本，我的文件应该是这样的:</p><figure class="jy jz ka kb fq kc fe ff paragraph-image"><div class="fe ff kr"><img src="../Images/adced637526a03e158a73aedca23d2cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*IcQpPBA7AeDAq9BCHjFB9A.png"/></div></figure><p id="5e12" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">祝你好运！</p></div></div>    
</body>
</html>