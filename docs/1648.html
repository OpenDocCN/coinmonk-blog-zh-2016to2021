<html>
<head>
<title>Continuous Integration with Google Application Engine and Travis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与Google应用引擎和Travis的持续集成</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/continuous-integration-with-google-application-engine-and-travis-d822b751fb47?source=collection_archive---------0-----------------------#2018-10-14">https://medium.com/coinmonks/continuous-integration-with-google-application-engine-and-travis-d822b751fb47?source=collection_archive---------0-----------------------#2018-10-14</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/f390d3663f6b4b1c2731dcee01dc3124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JNWr-JxuPNzcWF6YWA-Vmw.png"/></div></div></figure><p id="2ad3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">本文旨在帮助开发人员将应用程序部署到Google Application Engine，期望如下:</p><ul class=""><li id="bc20" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">Github存储库(在我们的例子中是Typescript express应用程序)</li><li id="f508" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">可以使用Docker在本地构建和运行应用程序</li><li id="e986" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">使用Travis执行PR合并检查(lint/测试)</li><li id="b006" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">使用主==生产和开发==集成的分支策略(目前没有QA或阶段)</li><li id="4bff" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">谷歌云开发账户</li></ul><p id="868a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">带着以上的期望，我们开始吧。</p></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><h2 id="cbde" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">设置和验证</h2><p id="d7bb" class="pw-post-body-paragraph jb jc ht jd b je lp jg jh ji lq jk jl jm lr jo jp jq ls js jt ju lt jw jx jy hm dt translated"><em class="lu">确保你已经安装了</em> <a class="ae lv" href="https://cloud.google.com/sdk/docs/quickstart-macos" rel="noopener ugc nofollow" target="_blank"> <em class="lu">谷歌云SDK </em> </a> <em class="lu">并且功能正常</em></p><p id="98b4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在Google Cloud控制台中创建一个项目，并记下项目id</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lw"><img src="../Images/256d6a1a45b3484ee413b3ab6642cfb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J3xz5amHg1HOZGdTkDw-Uw.png"/></div></div></figure><p id="6cd2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">您将需要派生示例存储库，以便您能够在这个repo的后面触发构建。导航至<a class="ae lv" href="https://github.com/cipherzzz/vertigo-cicd-example" rel="noopener ugc nofollow" target="_blank">https://github.com/cipherzzz/vertigo-cicd-example</a>并点击<em class="lu">分支</em>链接。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mb"><img src="../Images/1b51b42ea4aa81f80f4ff61092d63b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w3pQCBJ3rYkwnQgoUz6_Rw.png"/></div></div></figure><pre class="lx ly lz ma fq mc md me mf aw mg dt"><span id="5aae" class="ku kv ht md b fv mh mi l mj mk"><br/># Clone your forked example application repo<br/>git clone <a class="ae lv" href="https://github.com/cipherzzz/vertigo-cicd-example" rel="noopener ugc nofollow" target="_blank">https://github.com/&lt;git user&gt;/&lt;</a>repo name&gt;</span><span id="b73f" class="ku kv ht md b fv ml mi l mj mk">cd &lt;repo name&gt;</span><span id="340b" class="ku kv ht md b fv ml mi l mj mk">#Verify that everything runs locally<br/>npm install &amp;&amp; npm run build<br/>npm run start</span></pre><p id="b1dd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">转到<a class="ae lv" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>，您应该会看到类似这样的内容</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mm"><img src="../Images/e80f92b777943df6e43e5d2843a722db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QuUEMfiHGg5HFGxX6v6BAA.png"/></div></div></figure><p id="19d8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">继续停止这个革命性的web应用程序，让我们验证我们的docker配置和构建是好的</p><pre class="lx ly lz ma fq mc md me mf aw mg dt"><span id="cbab" class="ku kv ht md b fv mh mi l mj mk"># Locally build and tag<br/>docker build -t local .</span><span id="baad" class="ku kv ht md b fv ml mi l mj mk"># Run locally and verify 'errbody tipsy'<br/>docker run -p 8080:8080 local</span></pre><p id="d879" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">假设上面的一切进展顺利，让我们继续手动部署应用程序的默认版本，作为第一步。</p><p id="e9b7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="lu">这样做可以设置一个服务帐户和一些其他参数，我们必须在谷歌控制台中完成。此外，项目必须有一个名为“default”的服务，作为部署到它的第一个服务。耸肩。</em></p></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><h2 id="b46a" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">默认服务的手动部署</h2><p id="8a74" class="pw-post-body-paragraph jb jc ht jd b je lp jg jh ji lq jk jl jm lr jo jp jq ls js jt ju lt jw jx jy hm dt translated">尽管我们正在为我们的项目设置CI/CD环境，但是部署到我们的App Engine项目的第一个服务必须是name <em class="lu"> default。</em>我们现在就去做，并验证结果。</p><pre class="lx ly lz ma fq mc md me mf aw mg dt"><span id="d1f4" class="ku kv ht md b fv mh mi l mj mk"># Login to Google Cloud from the CLI<br/>gcloud auth login</span><span id="9ffc" class="ku kv ht md b fv ml mi l mj mk"># From our app's home dir<br/>gcloud config set project &lt;project-id(mine: ci-example-218319)&gt;</span><span id="069f" class="ku kv ht md b fv ml mi l mj mk"># Manually deploy the default version per gae's requirement<br/>gcloud app deploy app.yaml</span></pre><p id="55bd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">部署应该需要5-10分钟，在结束时，如果您转到<strong class="jd hu">App Engine =&gt;Services</strong>，您应该会看到如下内容</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mn"><img src="../Images/fad47b3d02417ac3cae5811f493a3881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SeU8LE0z0auzX9tLc_eUsg.png"/></div></div></figure><p id="83a9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="lu">请注意，点击“默认”将打开应用</em></p><p id="1587" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">既然我们已经部署了这个默认服务，并且已经验证了它运行正常，那么我们需要准备使用云部署API。</p></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><ul class=""><li id="87df" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">您需要启用<strong class="jd hu">云构建</strong> API( <em class="lu">搜索‘云构建’</em>)</li><li id="188a" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">您还需要通过转到<strong class="jd hu">IAM&amp;Accounts =&gt;Service Accounts</strong>来验证您是否拥有具有部署功能的<strong class="jd hu">服务帐户</strong></li></ul><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mo"><img src="../Images/bf2b86002c41d1f77c21770bf0b46417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gdkM_j0nnKOViH-e4zO56Q.png"/></div></div></figure><p id="d2b6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在我们已经启用了API，服务账户也开始工作了，我们可以设置我们的<strong class="jd hu">构建触发器</strong>来构建您的分叉库。</p></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><h2 id="4b28" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">设置配置项环境</h2><p id="9bed" class="pw-post-body-paragraph jb jc ht jd b je lp jg jh ji lq jk jl jm lr jo jp jq ls js jt ju lt jw jx jy hm dt translated">我们将设置云部署来监控分支机构，并在提交后开始构建。这是一个非常有用的服务，因为它发生在云实例上，所以您不需要将任何导出的安全密钥放入travis或jenkins实例中。</p><p id="6324" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="lu">有趣的是——我对自己的凭证很宽松，有人用它们购买了150美元的谷歌广告，所以我强烈建议不要部署在谷歌云之外。</em></p><p id="2f90" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">建造触发器</strong></p><ol class=""><li id="cf63" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy mp kf kg kh dt translated">导航到<em class="lu">云构建= &gt;构建触发器= &gt;创建触发器</em></li><li id="a227" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">选择<em class="lu"> Github </em>并完成OAuth过程</li><li id="37a8" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">选择您的分叉存储库</li><li id="d12c" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">输入<em class="lu">名称，</em>选择<em class="lu">分支</em>，输入<em class="lu">主控</em></li><li id="3a40" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">选择<em class="lu"> cloudbuild </em>作为<em class="lu">构建配置</em></li><li id="e182" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">输入<em class="lu">/ci/prod/cloud build . YAML</em>作为位置</li><li id="5c22" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated"><em class="lu">制造</em>的导火索</li></ol><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/39631f111700120b68f990e1270d76bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*mnmDfom7uR8K8vqw-FkGeA.png"/></div></figure><p id="e124" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，在新创建的触发器上点击<em class="lu">运行触发器</em>。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mr"><img src="../Images/1cc1e5842b630cee1b09df0daa4abdf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TXuK9b89WUa0AKEJCsxGiA.png"/></div></div></figure><p id="12fc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">点击<em class="lu">云构建</em>和<em class="lu">链接</em>到你的运行构建。如果您看到如下所示的错误，导航到给定的url，单击<em class="lu"> Enable </em>，并像以前一样再次手动触发构建。</p><pre class="lx ly lz ma fq mc md me mf aw mg dt"><span id="8323" class="ku kv ht md b fv mh mi l mj mk">ERROR: (gcloud.app.deploy) User [615259048819@cloudbuild.gserviceaccount.com] does not have permission to access app [ci-example-218319] (or it may not exist): App Engine Admin API has not been used in project 615259048819 before or it is disabled. Enable it by visiting https://console.developers.google.com/apis/api/appengine.googleapis.com/overview?project=615259048819 then retry. If you enabled this API recently, wait a few minutes for the action to propagate to our systems and retry.</span></pre><p id="6e73" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果您仍然收到类似下面的错误，您需要向您的云构建服务帐户添加应用引擎部署权限。</p><pre class="lx ly lz ma fq mc md me mf aw mg dt"><span id="13e1" class="ku kv ht md b fv mh mi l mj mk">ERROR: build step 0 "gcr.io/cloud-builders/gcloud" failed: exit status 1<br/>ERROR<br/>ERROR: (gcloud.app.deploy) Permissions error fetching application [apps/ci-example-218319]. Please make sure you are using the correct project ID and that you have permission to view applications on the project.</span></pre><p id="8b5e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">导航到IAM &amp; accounts，找到具有<em class="lu">云构建服务帐户</em>角色的帐户。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ms"><img src="../Images/9e10832bb12b18a345bc582f2450b179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DZotAwz5KLF28zMB0kTwzw.png"/></div></div></figure><p id="9711" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">编辑该帐户，并向其添加<em class="lu">应用引擎= &gt;应用引擎管理员</em>角色</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div class="fe ff mt"><img src="../Images/acd68d711db58bf43fccbac3662dfd5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*IVCZ3FIbd1ynedX7vb1-nw.png"/></div></figure><p id="00d1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">再次尝试构建…应该会成功，5-10分钟后，您应该会看到一个新的服务出现。我们有意地检查了这些错误条件，以向您展示如何理解部署api权限问题，这是我自己第一次开始处理这个问题时的一个问题。</p><p id="e3ab" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在我们的构建历史中，我们看到了两件与这个触发的构建相关的事情。我们可以看到创建的工件(docker ),以及部署的应用程序。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mu"><img src="../Images/aea452c8adf3c4ea928e289caf363419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6BN7or9rIo0Y5KE3w8pn5g.png"/></div></div></figure><p id="12d8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里我们看到了来自我们的<em class="lu">主</em>构建触发器的已部署的<em class="lu">产品</em>服务</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mv"><img src="../Images/38d0d2ec1f856928cbe35c0e96fe187d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j-XRNOdOrbL45xD279xAHA.png"/></div></div></figure></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><h2 id="ff0b" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">再做一次</h2><p id="1194" class="pw-post-body-paragraph jb jc ht jd b je lp jg jh ji lq jk jl jm lr jo jp jq ls js jt ju lt jw jx jy hm dt translated">既然我们已经有了主分支的构建和部署，我们需要为开发分支创建另一个构建触发器。</p><ol class=""><li id="3d3d" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy mp kf kg kh dt translated">导航到<em class="lu">云构建= &gt;构建触发器= &gt;创建触发器</em></li><li id="6310" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">选择<em class="lu"> Github </em>并完成OAuth过程</li><li id="ee40" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">选择您的分叉存储库</li><li id="a035" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">输入<em class="lu">名称，</em>选择<em class="lu">分支</em>，输入<em class="lu">制定</em></li><li id="5fda" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">选择<em class="lu"> cloudbuild </em>作为<em class="lu">构建配置</em></li><li id="cca0" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated">输入<em class="lu">/ci/dev/cloud build . YAML</em>作为位置</li><li id="5dec" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy mp kf kg kh dt translated"><em class="lu">创建</em>触发器</li></ol><p id="05da" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，在新创建的触发器上点击<em class="lu">运行触发器</em>。构建成功后，您应该会看到以下内容。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/42b9b1afa01ed810b7a5fb78e53fcec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LtrUpigRJk1Mp7BtWJKDGw.png"/></div></div></figure><h2 id="188d" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">超时…</h2><h2 id="6eb5" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">我们做了什么？</h2><p id="4716" class="pw-post-body-paragraph jb jc ht jd b je lp jg jh ji lq jk jl jm lr jo jp jq ls js jt ju lt jw jx jy hm dt translated">到目前为止，我们已经完成了以下工作:</p><ul class=""><li id="3777" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">安装了Google Cloud SDK，并在我们的应用引擎项目中部署了默认的应用版本</li><li id="b434" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">从我们新创建的构建触发器中手动启动生产和集成构建</li></ul><h2 id="0e4d" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">我们还剩下什么？</h2><p id="d3a9" class="pw-post-body-paragraph jb jc ht jd b je lp jg jh ji lq jk jl jm lr jo jp jq ls js jt ju lt jw jx jy hm dt translated">我们仍然需要做以下工作:</p><ul class=""><li id="ec9a" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">配置我们的<em class="lu"> Github </em>项目来使用<em class="lu"> Travis </em></li><li id="3a88" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">配置我们的<em class="lu"> Github </em>项目，在所有<em class="lu">拉请求(PR) </em>的基础上运行<em class="lu"> Travis </em>构建，作为合并的先决条件</li></ul></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><h2 id="8dda" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">特拉维斯。</h2><figure class="lx ly lz ma fq iu"><div class="bz el l di"><div class="mx my l"/></div></figure><p id="7923" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">帮你自己一个忙，在https://travis-ci.org/<a class="ae lv" href="https://travis-ci.org/" rel="noopener ugc nofollow" target="_blank">为travis创建一个账户</a>。进入主屏幕后，单击<em class="lu">我的存储库</em>旁边的+</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mz"><img src="../Images/7068a16e43b9b84480f4fbba1d209dda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TxHEL9jNFn9xBU8Z8s9EMA.png"/></div></div></figure><p id="c517" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然后找到您的存储库并打开它</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff na"><img src="../Images/ac44ac3300857123f474aa460f62a573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*opNW5V0mUV11bRHCKibUmQ.png"/></div></div></figure><p id="770b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在转到这个回购的新travis构建，手动触发构建来测试它。请注意，它可能需要一段时间才能启动—放松，这是免费的。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nb"><img src="../Images/e151629f46a0fda584fc61fc68789689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPKqqzxtBdfICr3N5PL7CA.png"/></div></div></figure><p id="df87" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们的travis构建检查以下内容:</p><ul class=""><li id="9a2c" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">我们的docker构建是功能性的(应用引擎使用Docker容器，所以这很重要)</li><li id="4c17" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">我们的代码通过了lint检查、编译和测试</li></ul><p id="cb9c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这是我们的<em class="lu"> travis.yml </em></p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nc"><img src="../Images/eacc854038c7fd957f82bc410e820a42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hfp4lI3WkS16IplzCiJmdg.png"/></div></div></figure><p id="a6cb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在我们的仪表板中，一个成功的构建应该是这样的</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nc"><img src="../Images/2c3490bcc991b00453ac658dac185b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PjTtmQIwNs5eX96K9knVaw.png"/></div></div></figure><p id="ec1a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在我们已经配置了travis，让我们配置github项目，在所有PR和merge活动中自动运行travis。</p></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><h2 id="9369" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">开源代码库</h2><p id="12c2" class="pw-post-body-paragraph jb jc ht jd b je lp jg jh ji lq jk jl jm lr jo jp jq ls js jt ju lt jw jx jy hm dt translated">在开发和母版上配置一个类似于下图的规则。您可以根据自己的喜好进行调整，但最终我们希望对我们分支的所有代码更改都经过代码审查。请注意，在底部，我们已经检查了<em class="lu"> Travis CI </em>来运行推送分支和拉取请求。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nd"><img src="../Images/3875341a333cb029e11813f83bd09074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iyJmhIXBFZZDoK-BOM7j9w.png"/></div></div></figure><p id="7f98" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">添加规则后，您应该会看到以下内容:</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ne"><img src="../Images/40448dd2ad03e36ec39b3f96582ab743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8IzE30siMiQkVZ5OSYa6Q.png"/></div></div></figure><p id="d2b7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，从develop中创建一个特性分支，做一个小的改变，并推动特性分支来观察新的行为</p><pre class="lx ly lz ma fq mc md me mf aw mg dt"><span id="215b" class="ku kv ht md b fv mh mi l mj mk">git checkout develop &amp;&amp; git pull origin develop<br/>git checkout -b travis</span><span id="448a" class="ku kv ht md b fv ml mi l mj mk"># Make the logic.ts =&gt; getTestPayload() return 'nobody' instead of 'errbody'</span><span id="2c6b" class="ku kv ht md b fv ml mi l mj mk">git commit -am "small change to test travis"<br/>git push origin travis</span></pre><p id="71f7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，您应该在github repo中看到以下内容</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nf"><img src="../Images/ce725774001f8dbb1f1a75834fe0fb5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zHnLmz8gaezuQESP0u6Xew.png"/></div></div></figure><p id="fc68" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">点击<em class="lu">比较和拉动请求</em>并创建拉动请求。我的travis测试失败了，因为我的代码更新了，但我的测试没有更新。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ng"><img src="../Images/b538560250a5117b1aa13514ea118bd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*24WGzJydLSAq575AjfPLFQ.png"/></div></div></figure><p id="f6cd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">修复<em class="lu">逻辑规格</em>后，PR看起来像这样</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nh"><img src="../Images/7d7775ad2efa5f3f5cabc5b069dc1193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2yyqj0souyb6NpMho4H8Eg.png"/></div></div></figure><p id="a19f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">请注意，我们的travis构建正在通过！我没有任何人可以审查我的公关，所以我将使用我的管理权限，并将其与前一个图像中显示的按钮合并。一旦这种合并发生，我们应该有一个由Google Cloud中监视开发分支的构建触发器启动的集成构建。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ni"><img src="../Images/96144b274d31861f27de53b7a8049052.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DM834nnvIpMPgyPNTTJayg.png"/></div></div></figure><p id="9731" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们做到了！这将最终完成，并添加一个新版本到我们的应用程序引擎上部署的集成服务，没有人会喝醉。</p><figure class="lx ly lz ma fq iu fe ff paragraph-image"><div class="fe ff nj"><img src="../Images/edf05d9227e8c5d93c7c2137276d8092.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*EYHd6H4DGLLwWsq0IHWh_Q.png"/></div></figure></div><div class="ab cl kn ko hb kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hm hn ho hp hq"><h2 id="5843" class="ku kv ht bd kw kx ky kz la lb lc ld le jm lf lg lh jq li lj lk ju ll lm ln lo dt translated">我们学到了什么？</h2><p id="8f96" class="pw-post-body-paragraph jb jc ht jd b je lp jg jh ji lq jk jl jm lr jo jp jq ls js jt ju lt jw jx jy hm dt translated">这是一篇很长的文章，但是我们现在已经有了一个基本的<em class="lu">持续集成/开发</em>管道，包括<em class="lu"> Github、Travis和Google App Engine </em>。希望你已经学到了足够的知识，可以用这些信息来改进你的下一个项目或现有的项目。作为复习，这些是我们学过的高级项目</p><ul class=""><li id="eb24" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">安装了Google Cloud SDK，并在我们的应用引擎项目中部署了默认的应用版本</li><li id="c264" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">在<em class="lu">云部署</em>中为<em class="lu">主</em>和<em class="lu">开发</em>分支创建构建触发器，并手动验证构建</li><li id="5ae6" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">配置我们的Github项目来使用Travis</li><li id="7e83" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">配置我们的<em class="lu"> Github </em>项目，在所有<em class="lu">拉请求(PR) </em>的基础上运行<em class="lu"> Travis </em>构建，作为合并的先决条件</li><li id="0520" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">已验证开发或主控合并是否会触发成功的<em class="lu">云部署</em>构建</li></ul><blockquote class="nk"><p id="7cee" class="nl nm ht bd nn no np nq nr ns nt jy ek translated"><a class="ae lv" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="nv nw nx ny nz iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nu"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>