<html>
<head>
<title>Getting Started with ethereum blockchain development: Part-2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊区块链开发入门:第2部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/getting-started-with-ethereum-blockchain-development-921eb42975e6?source=collection_archive---------4-----------------------#2018-05-31">https://medium.com/coinmonks/getting-started-with-ethereum-blockchain-development-921eb42975e6?source=collection_archive---------4-----------------------#2018-05-31</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/1d193895a3ef57cc13708c4eb97f2b92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3TXtVNSmzrOy7JxAa1QxAw.png"/></div></div></figure><p id="dec8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在第一篇博客<a class="ae jz" href="http://demystifyblockchain.com/2018/06/29/getting-started-with-ethereum-blockchain-development-part-1/" rel="noopener ugc nofollow" target="_blank">以太坊区块链开发入门:第1部分</a>中，我展示了如何创建简单的智能契约并将其部署在ganache-cli上。我还演示了如何为合同编写松露测试。你可以在<a class="ae jz" href="https://github.com/sarveshgs/firstBlockchainApp" rel="noopener ugc nofollow" target="_blank"> Github中找到代码。</a></p><p id="f84a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在本文中，我将演示如何编写交互层来与智能契约交互。我们将使用<a class="ae jz" href="https://www.npmjs.com/package/web3" rel="noopener ugc nofollow" target="_blank"> web3 </a> npm包来编写交互层。本文假设您已经按照本文第1部分<a class="ae jz" href="http://demystifyblockchain.com/2018/06/29/getting-started-with-ethereum-blockchain-development-part-1/" rel="noopener ugc nofollow" target="_blank">中提到的步骤为区块链开发设置了本地机器。</a></p><p id="2a4d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们编写交互层来与'<strong class="jd hu">计数器</strong> ' <a class="ae jz" href="https://github.com/sarveshgs/firstBlockchainApp/blob/master/contracts/Counter.sol" rel="noopener ugc nofollow" target="_blank">契约</a>进行交互。</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="5e89" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在继续之前，让我们再进行一些设置:</p><ol class=""><li id="db36" class="kg kh ht jd b je jf ji jj jm ki jq kj ju kk jy kl km kn ko dt translated"><strong class="jd hu">设置基本代码:</strong>如果您已经完成了第1部分，您可以跳过这一步。否则从github中检查代码。</li></ol><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="87a3" class="ku kv ht kq b fv kw kx l ky kz"><br/><strong class="kq hu"> <em class="la">git clone </em></strong><a class="ae jz" href="https://github.com/sarveshgs/firstBlockchainApp.git" rel="noopener ugc nofollow" target="_blank"><strong class="kq hu"><em class="la">https://github.com/sarveshgs/firstBlockchainApp.git</em></strong><em class="la"><br/></em></a><em class="la"> </em><strong class="kq hu"><em class="la">git checkout tutorial-part-1</em></strong></span></pre><ol class=""><li id="fc3e" class="kg kh ht jd b je jf ji jj jm ki jq kj ju kk jy kl km kn ko dt translated"><strong class="jd hu">初始化节点项目:</strong>使用npm初始化节点项目。</li></ol><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="f9c3" class="ku kv ht kq b fv kw kx l ky kz"><strong class="kq hu"><em class="la"> npm init</em></strong></span></pre><p id="b4cb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">3.<a class="ae jz" href="https://web3js.readthedocs.io/en/1.0/" rel="noopener ugc nofollow" target="_blank"><strong class="jd hu">web 3</strong></a><strong class="jd hu">:</strong>web 3是一个库，它帮助你使用HTTP或IPC连接与本地或远程以太坊节点交互。可以使用npm来安装。</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="263b" class="ku kv ht kq b fv kw kx l ky kz"><strong class="kq hu"><em class="la">npm install web3 — save</em></strong></span></pre></div><div class="ab cl lb lc hb ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hm hn ho hp hq"><h1 id="7a74" class="li kv ht bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me dt translated"><strong class="ak">让我们从一些编码开始</strong></h1><ol class=""><li id="9a01" class="kg kh ht jd b je mf ji mg jm mh jq mi ju mj jy kl km kn ko dt translated"><strong class="jd hu">部署合同:</strong>让我们部署Counter.sol合同，它将创建一个合同地址。Web3需要合同地址来进行交互。</li></ol><p id="979f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">一、运行ganache-cli:通过运行ganache-cli设置以太坊节点。</p><h1 id="0412" class="li kv ht bd lj lk mk lm ln lo ml lq lr ls mm lu lv lw mn ly lz ma mo mc md me dt translated"><strong class="ak"> <em class="mp"> ganache-cli </em> </strong></h1><p id="6f1b" class="pw-post-body-paragraph jb jc ht jd b je mf jg jh ji mg jk jl jm mq jo jp jq mr js jt ju ms jw jx jy hm dt translated">二。解锁帐户:解锁由ganache-cli.a创建的第一个帐户。</p><p id="3be9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">打开松露控制台:</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="6da2" class="ku kv ht kq b fv kw kx l ky kz">  <strong class="kq hu"><em class="la">truffle console</em></strong></span></pre><p id="3c9a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">b.解锁帐户:运行ganache-cli解锁帐户时，使用控制台上打印的第一个帐户地址和私钥。此解锁帐户用于部署合同。</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="a938" class="ku kv ht kq b fv kw kx l ky kz"><strong class="kq hu"><em class="la">web3.personal.unlockAccount(firstAccountAdress,firstPrivateKey,15000)</em></strong></span></pre><p id="84de" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">三。部署契约:你可以使用truffle来部署契约。记下图像中用红线下划线标出的合同地址。</p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="4a2c" class="ku kv ht kq b fv kw kx l ky kz"><em class="la"> </em><strong class="kq hu"><em class="la">truffle migrate</em></strong></span></pre><figure class="ka kb kc kd fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mt"><img src="../Images/addb8abab1c3da226b0c89365abaf581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7WJFF4jl3ao5M3Za."/></div></div></figure><p id="ede6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">2.<strong class="jd hu">编写Js脚本与合同交互:</strong>成功完成第一步后，您现在应该有了合同地址。我们将把这个地址传递给web3，以识别部署在以太坊节点上的契约。</p><p id="94a4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">一、在你的项目结构中创建一个文件夹，在交互文件夹中命名为“<strong class="jd hu">交互</strong>”和“<strong class="jd hu">交互. js </strong>”。</p><p id="4e1f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">二。使web3与本地以太坊节点连接:ganache-cli运行于<a class="ae jz" href="http://localhost:8545" rel="noopener ugc nofollow" target="_blank"><em class="la">http://localhost:8545</em></a></p><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="d4b1" class="ku kv ht kq b fv kw kx l ky kz"><strong class="kq hu">const </strong>Web3 = require('web3');<br/><strong class="kq hu">const </strong>web3 = <strong class="kq hu">new </strong>Web3(<strong class="kq hu">new </strong>Web3.providers.HttpProvider("http://localhost:8545"));</span></pre><p id="e04e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">三。初始化合同:要初始化合同，我们需要两样东西</p><ul class=""><li id="422f" class="kg kh ht jd b je jf ji jj jm ki jq kj ju kk jy mu km kn ko dt translated">合同地址:在步骤1中成功部署合同后，您必须拥有合同地址</li><li id="85d6" class="kg kh ht jd b je mv ji mw jm mx jq my ju mz jy mu km kn ko dt translated">ABI: ABI代表<em class="la">应用二进制接口</em>。基本上，它是json格式的合同元数据。您可以在项目的'<strong class="jd hu"> <em class="la"> build </em> ' </strong>文件夹中找到abi。它是在合同汇编后生成的。</li></ul><pre class="ka kb kc kd fq kp kq kr ks aw kt dt"><span id="4c05" class="ku kv ht kq b fv kw kx l ky kz"><strong class="kq hu">const </strong>metadata = require('../build/contracts/Counter');<br/><strong class="kq hu">const </strong>abi = metadata.abi;<br/><strong class="kq hu">const </strong>contractAddress = "0x42f18096c12db0b85ce999dbe5cceb4316f1e0be";<br/><strong class="kq hu">const </strong>counter = <strong class="kq hu">new </strong>web3.eth.Contract(abi, contractAddress);</span></pre><p id="73b6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">四。调用契约方法:最后，需要做的是调用契约方法。调用合同方法将在以太坊区块链形成交易。一旦交易被执行，它将返回一个交易收据。此收据可用于从方法和事件中检索返回值。</p><p id="feda" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在下面的代码片段中，我们调用'<a class="ae jz" href="https://github.com/sarveshgs/firstBlockchainApp/blob/master/contracts/Counter.sol" rel="noopener ugc nofollow" target="_blank"> incrementCounter </a>'方法，并监听'收到时接收事件'</p><figure class="ka kb kc kd fq iu"><div class="bz el l di"><div class="ke kf l"/></div></figure><p id="998f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">动词 （verb的缩写）运行interaction.js:使用node运行interaction.js。</p><p id="c3bf" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> <em class="la">节点互动/互动. js </em> </strong></p><p id="224a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">很好，你现在知道了，如何使用web3编写智能契约和交互层来与契约方法进行交互。</p><p id="31fa" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">Github上有完整的源代码:<a class="ae jz" href="https://github.com/sarveshgs/firstBlockchainApp" rel="noopener ugc nofollow" target="_blank">sarveshgs/first block chain app</a></p><div class="na nb fm fo nc nd"><a href="https://github.com/sarveshgs/firstBlockchainApp" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab ej"><div class="nf ab ng cl cj nh"><h2 class="bd hu fv z el ni eo ep nj er et hs dt translated">sarveshgs/firstBlockchainApp</h2><div class="nk l"><h3 class="bd b fv z el ni eo ep nj er et ek translated">这是一个简单的区块链应用程序，演示了智能合同和松露框架的用法…</h3></div><div class="nl l"><p class="bd b gc z el ni eo ep nj er et ek translated">github.com</p></div></div><div class="nm l"><div class="nn l no np nq nm nr iz nd"/></div></div></a></div><p id="a28d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">感谢你阅读这两篇博客，我希望它给了你一些关于如何写dapps的基本理解。</p><p id="7ff8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在接下来的几篇博客中，我解释了关于气体消耗和有效的内存管理。</p><h2 id="3619" class="ku kv ht bd lj ns nt nu ln nv nw nx lr jm ny nz lv jq oa ob lz ju oc od md oe dt translated">Solidity中的内存和存储是什么？</h2><p id="fdd2" class="pw-post-body-paragraph jb jc ht jd b je mf jg jh ji mg jk jl jm mq jo jp jq mr js jt ju ms jw jx jy hm dt translated">请继续关注，回复或发表对问题和建议的评论。</p><p id="f58c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">快乐编码:)</p><p id="cd41" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae jz" href="https://www.linkedin.com/in/jainsarvesh/" rel="noopener ugc nofollow" target="_blank">linkedin.com/in/jainsarvesh</a>T28】T29】medium.com/@sarvesh.sgsits</p></div></div>    
</body>
</html>