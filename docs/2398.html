<html>
<head>
<title>Understanding the Handshake Airdrop and Reserved Names</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解握手Airdrop和保留名称</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/understanding-the-handshake-airdrop-and-reserved-names-428d9e90b560?source=collection_archive---------0-----------------------#2019-09-10">https://medium.com/coinmonks/understanding-the-handshake-airdrop-and-reserved-names-428d9e90b560?source=collection_archive---------0-----------------------#2019-09-10</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/d3a38306465a76646c3aea92e17601de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2j9-EjYeri5gBrt31qBv1g.jpeg"/></div></div></figure><div class=""/><p id="73d4" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">深入探究免费赠送的加密过程。</p><h1 id="8509" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">金钱和名字</h1><p id="10e4" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">握手区块链中储存着两种资产:钱和名字。</p><p id="8941" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">金钱在握手中的编码方式与比特币相同:有一组有效的交易输出(UTXOs或“硬币”)，每个输出都有自己的值和锁定脚本。解锁一枚硬币，你可以用等值或等值以下的新硬币替换它。</p><p id="0c04" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">名称在握手中以同样的方式编码。一旦一个名字在<a class="ae ld" href="https://handshake-org.github.io/guides/auctions.html" rel="noopener ugc nofollow" target="_blank">拍卖</a>中胜出，它就被一个UTXO“拥有”。那个UTXO有一个永远不会被花掉的值(它被永久锁定，或者“烧毁”)，并且它有一个锁定脚本。解锁该脚本，您可以将DNS记录添加到名称中，甚至可以使用新的锁定脚本将名称转移到新的UTXO中。</p><h1 id="9482" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">免费的东西</h1><p id="0e00" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">握手项目的一个基本原则是让开源软件社区和互联网的整体基础设施受益。来自<a class="ae ld" href="https://handshake.org/files/handshake.txt" rel="noopener ugc nofollow" target="_blank">的白皮书</a>:</p><blockquote class="le lf lg"><p id="2ef1" class="jb jc jz jd b je jf jg jh ji jj jk jl lh jn jo jp li jr js jt lj jv jw jx jy hm dt translated">正如资本主义在参与者之间创造了一个竞争性的游戏，在这个游戏中竞争的自身利益降低了非垄断的商品环境中的商品价格，握手机制是一个探索类似的并行游戏的项目，以最大化自由/开源软件开发者和公众的所有权。</p><p id="718a" class="jb jc jz jd b je jf jg jh ji jj jk jl lh jn jo jp li jr js jt lj jv jw jx jy hm dt translated">在资本主义市场上，没有哪一个生产者会为了利他主义而降低自己产品的价格，这是通过自利的竞争激励来实现的，“我降低价格，就能赚更多的钱”。类似地,<br/>握手机制正在试验一个过程,“我赚的钱越多，自由/开源软件开发者和全人类得到的礼物就越多”。</p></blockquote><p id="5c59" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">为此，<a class="ae ld" href="https://handshake.org/how-it-works" rel="noopener ugc nofollow" target="_blank"> 70%的硬币供应</a>将分配给开源开发者和非营利组织。Alexa排名前10万的网站中列出的DNS名称将被保留给它们当前的所有者，他们可以使用他们的握手钱包在链上声明这些名称。因此，当这个连锁店开张时，许多社区成员将会有免费的钱，许多主要的互联网资源提供商将会有他们自己的名字。这项计划也将防止像“脸书”这样的名字被恶意使用或抢注。</p><h1 id="b86b" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">收集钥匙</h1><p id="1268" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">过去的加密货币空投通常涉及拍摄当前网络UTXO集的快照，并从那里生成新的(不兼容的)区块链。无论谁持有原始链上的硬币，都可以使用相同的钥匙来解锁新链上的那些硬币的副本。握手项目不资助其他加密货币利益相关者，但是，它资助开源开发者——那么我们如何让他们得到他们的硬币？我们不知道他们的公钥…或者我们知道吗？</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="773d" class="lt kb ie lp b fv lu lv l lw lx">$ curl <a class="ae ld" href="https://api.github.com/users/pinheadmz/gpg_keys" rel="noopener ugc nofollow" target="_blank">https://api.github.com/users/pinheadmz/gpg_keys</a><br/>[<br/>  {<br/>    ...<br/>    "public_key": "xsFNBFtrHssBEADlPQQ+eaXmIg/lDxCUuwJDnF0BXVoTKeqDIrDLx/2qFA6Dj6AcUWsrVNPxvvSMr2i5LgMFrFvjbrXoo7jsZO5a4AUuXragJzI6UKaKD5HxQR/6L6zXsOmGHhLMCAUwaIyl7wqOUrDaJbAbmr/S38yEhEkztVuxN8YbrZ6WpgEVMPfZsNdyUPEOEHUcRSwJGVGnn2CEPdUavFYIGYgGFxJBhy/xcRtgDrKyMhXa8qdj5IPksfGiSGC69PkbG2vT6Dy+Lmc2QhSv3cRn+rYnY8jdN9ADKY7um4XKwvlzkVld6MGDYJG/EB53Q+rAu+qbUhPrGOKRdC7hnangsALi6dwEq1XDk1n/Snp4/WR3oADFxo5WAGls+i+vxtQul3U+h67xyPRBaW/FZjgN8gNL97nIqMPa7HHDxBsobmrVYnbNnhiA84qXHDc/vgcSFlMjJ9il05m6JIvwpMCN+QaR2s5G0MW6lhY6qmBezBMwyy7eSMvRiAGpUg/KDTzqKj+x87VkYPb6YMoa/FHkV+dne/1Alb1Kp9+tvGe/FSjPBOPbXK+F1uRMC46O2lOpsAPo0DntI85c7/RlXUBlXk8En+FYies/a+vBNgEtZsmBVxGD77i+ThM7MOk+oGY8yON25OQOYXIoBT8FLGzUofM/LF5yERtcIf5lm48XNBOWhQr+xQARAQAB"<br/>  }<br/>]</span></pre><p id="2280" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">GitHub API为上传它们的用户返回公共PGP和SSH密钥。然而，GitHub的API文档明确指出:</p><blockquote class="le lf lg"><p id="4398" class="jb jc jz jd b je jf jg jh ji jj jk jl lh jn jo jp li jr js jt lj jv jw jx jy hm dt translated">在<code class="eh ly lz ma lp b">public_key</code>响应字段中返回的数据不是GPG格式的关键字。当用户上传GPG密钥时，会对其进行解析，并提取和存储加密公钥。这个密钥是由这个页面上的API返回的。这个键不适合被像GPG这样的程序直接使用。</p></blockquote><p id="b13b" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">但我会告诉你一个小秘密。OpenPGP报文和包格式在<a class="ae ld" href="https://tools.ietf.org/html/rfc4880" rel="noopener ugc nofollow" target="_blank"> RFC4880 </a>中有规定，可以被<a class="ae ld" href="https://github.com/bcoin-org/bcrypto" rel="noopener ugc nofollow" target="_blank"> bcrypto </a>解码:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="64a4" class="lt kb ie lp b fv lu lv l lw lx">$ node</span><span id="776f" class="lt kb ie lp b fv mb lv l lw lx">&gt; const {PGPMessage} = require('bcrypto/lib/pgp')<br/>&gt; PGPMessage.fromBase64('xsFNBFtrHssBEADlPQQ+eaXmIg/lDxCUuwJD...')</span><span id="6572" class="lt kb ie lp b fv mb lv l lw lx">{ packets: [ { type: 'PUBLIC_KEY', body: [Object] } ] }</span></pre><p id="a46a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">通过这种方式，从流行的开源贡献者那里为空投收集了数万个公钥。</p><p id="32b4" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">还有一个水龙头网站，任何人都可以通过提供由<a class="ae ld" href="https://github.com/handshake-org/faucet-tool" rel="noopener ugc nofollow" target="_blank">水龙头工具生成的mainnet握手地址来提交空投硬币的申请。</a>电子邮件地址是必需的，已经收到GitHub按键空投的用户被从水龙头中移除。</p><h1 id="97c6" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">摇钱树</h1><p id="b284" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">对于这个演示，我们将使用<a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commits/guide" rel="noopener ugc nofollow" target="_blank">修改</a> <code class="eh ly lz ma lp b"><a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commits/guide" rel="noopener ugc nofollow" target="_blank">hs-airdrop</a></code> <a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commits/guide" rel="noopener ugc nofollow" target="_blank">存储库的一个分支。</a>该存储库包含接收者可以用来在链上收集他们的硬币的脚本，但是它还包含握手开发者用来在mainnet启动之前将他们收集的所有公钥插入到区块链共识机制中的脚本。</p><p id="742f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">长话短说，所有的接收者公钥都被加载到一个Merkle树中，这个树有一个一致性关键根<a class="ae ld" href="https://github.com/handshake-org/hsd/blob/cc35dc2a351eecd6adfae94b981a2d85277ecbb5/lib/primitives/airdropproof.js#L22" rel="noopener ugc nofollow" target="_blank">存储在hsd客户端</a>中。兑换空投硬币需要证明一个公钥存在于Merkle树中，然后用它签署一个特殊类型的交易。还有一个非常酷的加密匿名层，可以防止airdrop交易直接与GitHub用户<a class="ae ld" href="https://github.com/handshake-org/goosig#goosig" rel="noopener ugc nofollow" target="_blank"> Goosig </a>联系起来。</p><p id="eb66" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在长话短说，我们将创建全新的GPG键，制作我们自己的树，在regtest模式下将根插入hsd，并兑换一个airdrop！</p><p id="f61a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们生成一个新的GPG私钥，并<a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commit/212b9de41d8bbd94046f4135ebdd205609a72819" rel="noopener ugc nofollow" target="_blank">将其导出到本地文件</a>:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="03b9" class="lt kb ie lp b fv lu lv l lw lx">$ gpg --quick-generate-key Alice rsa4096<br/>$ gpg --armor --output alice_pub.asc --export Alice<br/>$ gpg --armor --output alice_prv.asc --export-secret-keys Alice</span></pre><p id="1193" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">接下来，我们将使用bcrypto中的PGP模块来<a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/blob/212b9de41d8bbd94046f4135ebdd205609a72819/regtest/pgp/extract-publickey" rel="noopener ugc nofollow" target="_blank">从ASCII编码的文件中提取原始公钥</a>，并返回一个base64字符串，就像GitHub的用户API一样:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="1e7b" class="lt kb ie lp b fv lu lv l lw lx">$ ./extract-publickey alice_pub.asc</span><span id="1d5b" class="lt kb ie lp b fv mb lv l lw lx">Key ID:<br/>351d404712461946</span><span id="0bf3" class="lt kb ie lp b fv mb lv l lw lx">Public key (base64):<br/>BF1keZABEAD2++nDebPDr9M4HpJB+cf5Sn6GEXOej8PZ6D3k3wY3MQxlNkBW6caADsMVsDT1hSNJPzUVY+p+cRA5Aou34NWvRd+OtDDJyHfXy9tbMCMxjV0FDweMfGWinbhfV3WKTl6xecKNBapBzgyKz5ZJK048U/zPXd8cEihmEPsnMiHno8m3uH2XQSusWp6SqYKvBh6Bi3zuWIx7uzuRyS1pwOOe7Go76bU189O7OA9S2rh/6xhX2Fp0WyJiGds7L2Fy1+e43YHB529HhYhFw8jPmPHc1HVP19OSW5YT4BnZDfkhydPLICZwrwYpNxnB/mj7mEu447+/ahFBV7YnH2KBmk/4azePkk1ItqvVP9I1TEYrF7H5wtYsSmqK7/LAG/18sUI17d8F40ZlsPvWq5yr67AikbMaItrSq+eoedbZPWB+AQk1kKCXG1MEVLH3zejHboxXVzqAOen7shrG0TGfjn6N48pLJnkCqOtmI5XMkSibKT1JWH1Vgmm0Z36XwSaeG+d4ryCnZDsPhb3d3UPvvvAy3BHGAyyV8VqCWnmQaqKbLgVnltY8omDIwkz9AYs/d7rhP8Ld6DGbrkcZMNbxu8idwjokhiHr+VBGgkWJxQdfT/ndwIbWedpSAF+19MuhfM9x2VuIEpAYGmA1PEKt6r4+XM3qnA4D+/39n1UAYRFIuQARAQAB</span></pre><p id="d20a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commit/3156398c6e6ff34c252b8b5c9aacaa79ffd8e0a9" rel="noopener ugc nofollow" target="_blank">我们还可以生成一个水龙头地址</a>。水龙头地址和空投键被嵌入到两个独立的树中，但它们是链接的，因为重复的用户被删除了。两个树根都在hsd客户端中提交。</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="60f3" class="lt kb ie lp b fv lu lv l lw lx">$ faucet-tool createaddress -n regtest</span><span id="2681" class="lt kb ie lp b fv mb lv l lw lx">...<br/><br/>Address:<br/>rs1qk2hh6xrmmnpsc8pt08tr8uwdqdxp0yuyv6hzsu</span></pre><p id="f546" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">好吧！这就足够入门了。请记住，我们还向其他一些来源查询了空投中包含的密钥，包括<a class="ae ld" href="https://en.wikipedia.org/wiki/Web_of_trust#Strong_set" rel="noopener ugc nofollow" target="_blank">信任网“强集”</a>和黑客新闻用户。除了GPG密钥，SSH密钥也是从GitHub上刮下来的。</p><p id="3f6a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">为了构建一个握手空投树，<a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commit/0b9726cc936d88c500dddbe9ef948c1eb05d8a3b" rel="noopener ugc nofollow" target="_blank">我们需要创建一些json文件</a>。有几个我们将留空，但它们仍然是必需的，否则脚本会抛出:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="9bdb" class="lt kb ie lp b fv lu lv l lw lx">$ echo "[]" &gt; sponsors.json<br/>$ echo "[]" &gt; creators.json<br/>$ echo "[]" &gt; hn-keys.json<br/>$ echo "" &gt; strongset.asc</span></pre><p id="a04a" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们没有任何SSH密钥，但是我们仍然需要为我们的GitHub用户“Alice”填充一个条目，她有一个GPG密钥:</p><p id="1621" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if"> github-ssh.json </strong></p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="9b84" class="lt kb ie lp b fv lu lv l lw lx">[<br/>  [<br/>    1,          // GitHub User ID #<br/>    "Alice",    // GitHub username<br/>    []          // No SSH keys for Alice<br/>  ]<br/>]</span></pre><p id="47bc" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最后，我们可以用实际的钥匙做点什么:</p><p id="ca6c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if"> github-pgp.json </strong></p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="4f56" class="lt kb ie lp b fv lu lv l lw lx">[<br/>  [<br/>    1,        // GitHub User ID #<br/>    "Alice",  // GitHub username<br/>    [<br/>      [<br/>        1,                                // User ID #<br/>        -1,                               // Parent Key ID<br/>        "351d404712461946",               // Key ID<br/>        "BF1keZABEAD2++nDebPDr9M4Hp...",  // Raw key as PGP packet<br/>        [["<a class="ae ld" href="mailto:alice@alice.com" rel="noopener ugc nofollow" target="_blank">alice@alice.com</a>", 1]]          // Email, verified (bool)<br/>      ]<br/>    ]<br/>  ]<br/>]</span></pre><p id="00ce" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最后，我们将添加我们生成的水龙头地址，并将其分配给不同的用户名和电子邮件，这样它就不会被重复删除。</p><p id="de7c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">水龙头. json </strong></p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="2cc4" class="lt kb ie lp b fv lu lv l lw lx">[<br/>  {<br/>    "email": "<a class="ae ld" href="mailto:bob@bob.com" rel="noopener ugc nofollow" target="_blank">bob@bob.com</a>",<br/>    "github": "Bob"<br/>    "address": "rs1qk2hh6xrmmnpsc8pt08tr8uwdqdxp0yuyv6hzsu",<br/>    "shares": 1<br/>  }<br/>]</span></pre><h1 id="4592" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">哈希哈希哈希哈希</h1><p id="59bc" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">让我们运行脚本来生成树，并把根还给我们！这是一个只需要为mainnet运行一次的过程。脚本需要json文件所在的目录作为参数。<a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commit/118ec6a9c08561165814dfdfe04432679b0f9fa0" rel="noopener ugc nofollow" target="_blank">我们从空投树开始:</a></p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="8ee9" class="lt kb ie lp b fv lu lv l lw lx">$ scripts/merkelize-airdrop regtest/json</span><span id="b467" class="lt kb ie lp b fv mb lv l lw lx">Valid github users: 1<br/>Valid github keys: 2<br/>Invalid github users: 0<br/>Invalid github keys: 0<br/>Valid strongset members: 0<br/>Invalid strongset members: 0<br/>Valid hackernews users: 0<br/>Invalid hackernews users: 0<br/>Wrote buckets (size=0.0004901885986328125mb).<br/>Wrote merkle tree with 2 keys and 1 leaves.<br/>Checksum: fb92f890ab91ad36dda17f28f114f771ecb76b0cae0b154f2415a4a2b1be68b7<br/>Tree Root: ee8bff349dec24a8378f38fbed35bba5cd0ebde2d5f256101ffbadac93920744<br/>Leaves: 1<br/>Keys: 2<br/>Max Keys: 2<br/>Depth: 0<br/>Subdepth: 1<br/>Faucet: 1<br/>Shares: 1<br/>Reward: 476000000000000</span></pre><p id="ae67" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">注意这个脚本如何在<code class="eh ly lz ma lp b">build/</code>和<code class="eh ly lz ma lp b">etc/</code>中生成一些输出。文件<code class="eh ly lz ma lp b">etc/tree.json</code>实际上将由merkelize-水龙头脚本导入，否则将包含256个随机数文件的校验和，这些随机数文件将在<code class="eh ly lz ma lp b">build/nonces</code>中输出。这256个“桶”最终将包含所有大约80，000个抓取的密钥的加密随机数。在Goosig构造中使用随机数来创建零知识证明，以保持空投赎回的匿名性。</p><p id="b1c6" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commit/8369e3a79072dea781074821948e24a5500c2de7" rel="noopener ugc nofollow" target="_blank">现在让我们生成水龙头树根:</a></p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="1e6c" class="lt kb ie lp b fv lu lv l lw lx">$ scripts/merkelize-faucet regtest/json</span><span id="bad0" class="lt kb ie lp b fv mb lv l lw lx">Valid sponsor addresses: 0<br/>Valid creator addresses: 0<br/>Valid participant addresses: 1<br/>Wrote merkle tree with 1 leaves.<br/>Checksum: 06d55ac651d4c5b2264ad62c60c9633079709c9bbfff1ffd6e0172616964be32<br/>Tree Root: 1d592d73c49f0aa50b2ef857c343700be0d00ebe13167a7cebd633d3bae682d8<br/>Leaves: 1<br/>Depth: 0<br/>Participants: 1<br/>Faucet Total: 476000000000000<br/>Shares: 1<br/>Sponsors: 0<br/>Creators: 0<br/>External Total: 0</span></pre><p id="c3bf" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这个脚本还会输出一个文件<code class="eh ly lz ma lp b">build/proof.json</code>。<a class="ae ld" href="https://github.com/handshake-org/hs-tree-data/blob/master/proof.json" rel="noopener ugc nofollow" target="_blank">你可以在GitHub上看到这个文件的mainnet版本。</a></p><h1 id="7c80" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">证明它</h1><p id="6ab2" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">现在开始变得有趣了。在上面的json输出中，我们有两个标记为<code class="eh ly lz ma lp b">Tree Root</code>的字段。<a class="ae ld" href="https://github.com/pinheadmz/hsd/commit/28dca2c4e05630d7fe01740324660a8a81481a29" rel="noopener ugc nofollow" target="_blank">让我们将这些根插入到hsd客户端</a>中，并在regtest模式下运行它(仅限本地)，这样我们就可以兑换airdrops了。请记住，这是对共识关键参数的修改！一旦我们做出这一更改，我们的客户端将不会在任何其他网络上同步。我们还需要<a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commit/2e7e126ab3dacc7566f3a2eb0a97503d8f42393e" rel="noopener ugc nofollow" target="_blank">修改hs-airdrop脚本</a>，以便根据我们的新数据创建证明。</p><p id="7ec4" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这是一个水龙头收件人将如何要求他们的硬币。首先，为水龙头地址生成空投证明:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="cb1d" class="lt kb ie lp b fv lu lv l lw lx">$ bin/hs-airdrop rs1qk2hh6xrmmnpsc8pt08tr8uwdqdxp0yuyv6hzsu</span><span id="2f56" class="lt kb ie lp b fv mb lv l lw lx">Attempting to create proof.<br/>This may take a bit...<br/>Creating proof from leaf...</span><span id="9850" class="lt kb ie lp b fv mb lv l lw lx">JSON:<br/>{<br/>  "index": 0,<br/>  "proof": [],<br/>  "subindex": 0,<br/>  "subproof": [],<br/>  "key": {<br/>    "type": "ADDRESS",<br/>    "version": 0,<br/>    "address": "b2af7d187bdcc30c1c2b79d633f1cd034c179384",<br/>    "value": 476000000000000,<br/>    "sponsor": false<br/>  },<br/>  "version": 0,<br/>  "address": "b2af7d187bdcc30c1c2b79d633f1cd034c179384",<br/>  "fee": 100000000,<br/>  "signature": ""<br/>}</span><span id="5075" class="lt kb ie lp b fv mb lv l lw lx">Base64 (pass this to $ hsd-rpc sendrawairdrop):<br/>AAAAAAAAACAEABSyr30Ye9zDDBwredYz8c0DTBeThADA6WLrsAEAAAAUsq99GHvcwwwcK3nWM/HNA0wXk4T+AOH1BQA=</span></pre><p id="dcfd" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">还有救赎！</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="6b2d" class="lt kb ie lp b fv lu lv l lw lx">$ hsd-rpc --network=regtest sendrawairdrop AAAAAAAAACAEABSyr30Ye9zDDBwredYz8c0DTBeThADA6WLrsAEAAAAUsq99GHvcwwwcK3nWM/HNA0wXk4T+AOH1BQA=</span><span id="6863" class="lt kb ie lp b fv mb lv l lw lx">9a2771031b305533b1015f2b1860079daa6243c873a51abf4735621c4c16007e</span></pre><p id="d260" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，我们将为“爱丽丝”GPG密钥生成空投证明。这个调用比较复杂，需要兑换者指定自己的GPG私钥文件，<a class="ae ld" href="https://handshake-org.github.io/api-docs/#generate-receiving-address" rel="noopener ugc nofollow" target="_blank">自己的握手钱包地址</a>，以及一笔矿工费。请注意，水龙头赎回有<a class="ae ld" href="https://github.com/handshake-org/hsd/blob/cc35dc2a351eecd6adfae94b981a2d85277ecbb5/lib/primitives/airdropproof.js#L18-L19" rel="noopener ugc nofollow" target="_blank">硬编码费率</a>……你能猜到为什么吗？🤔</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="c85b" class="lt kb ie lp b fv lu lv l lw lx">$ bin/hs-airdrop regtest/pgp/alice_prv.asc 351d404712461946 <!-- -->rs1qy9uplxpt5cur32rw3zmyf8e7tp87w8slly2fms<!-- --> 0.5</span><span id="6066" class="lt kb ie lp b fv mb lv l lw lx">Attempting to create proof.<br/>This may take a bit...<br/>Decrypting nonce...<br/>Finding merkle leaf...<br/>Creating proof from leaf...</span><span id="234d" class="lt kb ie lp b fv mb lv l lw lx">JSON:<br/>{<br/>  "index": 0,<br/>  "proof": [],<br/>  "subindex": 1,<br/>  "subproof": [<br/>  "9de514887afa96c585e8a27161c7bba420703e25a280aa67c57ffc8980816311"<br/>  ],<br/>  "key": {<br/>    "type": "GOO",<br/>    "C1": "0f6d9..."<br/>  },<br/>  "version": 0,<br/>  "address": "21781f982ba63838a86e88b6449f3e584fe71e1f",<br/>  "fee": 500000,<br/>  "signature": "4933fd82aa8aa7fb900a2..."<br/>}</span><span id="3769" class="lt kb ie lp b fv mb lv l lw lx">Base64 (pass this to $ hsd-rpc sendrawairdrop):<br/>AAAAAAABAZ3lFIh6+pbFheiicWHHu6QgcD4looCqZ8V//ImAgWMR/QEBA...</span></pre><p id="40f5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">赎回来！</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="0e82" class="lt kb ie lp b fv lu lv l lw lx">$ hsd-rpc --network=regtest sendrawairdrop AAAAAAABAZ3lFIh6+pb...</span></pre><h1 id="d28e" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">确认</h1><p id="f9b8" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">关于空投证明要注意的最后一件奇怪的事情是，它们并不是真正的交易。它们被广播、转发并存储在矿工的内存池中，但与普通交易的方式不同。事实上，空投证明作为额外的输入(包含见证中的证明数据)和输出被添加到块的coinbase事务中。现在，我们已经“发送”了两个空投证明，让我们生成一个块，并验证我们确实凭空创造了钱:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="9869" class="lt kb ie lp b fv lu lv l lw lx">$ hsd-rpc --network=regtest generatetoaddress 1 rs1q30ppv5gyrwpy4wyk0v6uzawxygdtvrpux8yrg2</span><span id="70bf" class="lt kb ie lp b fv mb lv l lw lx">[<br/>  "022882f6566671742c524cb485109a4d8ef51861e09f286d651d927cfe6630ee"<br/>]</span><span id="bb4a" class="lt kb ie lp b fv mb lv l lw lx">$ hsd-cli --network=regtest block 022882f6566671742c524cb485109a4d8ef51861e09f286d651d927cfe6630ee</span><span id="3af9" class="lt kb ie lp b fv mb lv l lw lx">...<br/>"outputs": [<br/>    {<br/>      "value": 2100500000,<br/>      "address": "rs1q30ppv5gyrwpy4wyk0v6uzawxygdtvrpux8yrg2",<br/>      "covenant": {<br/>        "type": 0,<br/>        "action": "NONE",<br/>        "items": []<br/>      }<br/>    },<br/>    {<br/>      "value": 475999900000000,<br/>      "address": "rs1qk2hh6xrmmnpsc8pt08tr8uwdqdxp0yuyv6hzsu",<br/>      "covenant": {<br/>        "type": 0,<br/>        "action": "NONE",<br/>        "items": []<br/>      }<br/>    },<br/>    {<br/>      "value": 4370322008,<br/>      "address": "rs1qy9uplxpt5cur32rw3zmyf8e7tp87w8slly2fms",<br/>      "covenant": {<br/>        "type": 0,<br/>        "action": "NONE",<br/>        "items": []<br/>      }<br/>    }<br/>  ]<br/>...</span></pre><p id="00d0" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">看那个！一个有三个输出的coinbase事务！第一个是矿工的补贴和奖励，另外两个是<em class="jz">免费的钱</em>空投输出给开源社区的成员！</p></div><div class="ab cl mc md hb me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hm hn ho hp hq"><h1 id="8ef6" class="ka kb ie bd kc kd mj kf kg kh mk kj kk kl ml kn ko kp mm kr ks kt mn kv kw kx dt translated">保留名称</h1><p id="662e" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">记住握手时的名字就像硬币一样存储在UTXOs中。因此，为了让排名前10万的网站在握手区块链上获得自己的名字，他们需要将其与他们控制的握手钱包地址相关联。然后，他们必须向网络提交所有权证明，这将允许他们生成一个UTXO，将他们的名字锁定到他们的私钥(或赎回脚本)。</p><p id="16fd" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这个所有权证明是基于一个名为<a class="ae ld" href="https://en.wikipedia.org/wiki/Domain_Name_System_Security_Extensions" rel="noopener ugc nofollow" target="_blank"> DNSSEC </a>的DNS记录子集。DNSSEC记录不是通常的<code class="eh ly lz ma lp b">name -&gt; IP address</code>类型的DNS记录。相反，它们像区域的公钥一样存储数据。然后，这些密钥可用于签署和验证该区域中的其他记录。它们也可以用于签署属于<em class="jz">子</em>区域的公钥。你知道这是怎么回事吗？</p><p id="f0db" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">DNSSEC从一个单一的中央密钥开始，这个密钥是由ICANN在一个<a class="ae ld" href="https://www.iana.org/dnssec/ceremonies/33" rel="noopener ugc nofollow" target="_blank">精心制作的、超正式的、高度审查的仪式中生成的</a>(这正是握手旨在颠覆和分散的东西！).这个密钥就是<strong class="jd if">根区域密钥签名密钥，</strong>我们都应该在它令人敬畏的力量面前颤抖。ICANN KSK广为人知，<a class="ae ld" href="https://github.com/chjj/bns/blob/master/lib/constants.js#L984-L985" rel="noopener ugc nofollow" target="_blank">存储在</a>我们自己的DNS解析器包<a class="ae ld" href="https://github.com/chjj/bns" rel="noopener ugc nofollow" target="_blank"> bns </a>中。</p><p id="0521" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ICANN使用这个密钥来签署根区域文件<a class="ae ld" href="https://en.wikipedia.org/wiki/Zone_file" rel="noopener ugc nofollow" target="_blank">，其中包括对顶级域名<code class="eh ly lz ma lp b">.com</code>的KSK的承诺。反过来，<code class="eh ly lz ma lp b">.com</code>域的管理者使用他们的密钥为像<code class="eh ly lz ma lp b">google.com</code>和<code class="eh ly lz ma lp b">bitcoin.com</code>这样的域签署ksk。最后，<em class="jz">那些</em>域管理员在他们自己的区域中签署记录，包括域名服务器、地址和文本记录。</a></p><p id="45da" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">因此，如果<code class="eh ly lz ma lp b">bitcoin.com</code>的所有者想要在握手时声明他们的名字，我们期望看到这个签名链:<em class="jz">“众所周知的</em> <code class="eh ly lz ma lp b"><em class="jz">root</em></code> <em class="jz">区域密钥签署一个</em> <code class="eh ly lz ma lp b"><em class="jz">.com</em></code> <em class="jz">区域密钥，该区域密钥签署一个</em> <code class="eh ly lz ma lp b"><em class="jz">bitcoin.com</em></code> <em class="jz">密钥，该密钥签署一个握手地址。”</em></p><p id="bd93" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">通常，<a class="ae ld" href="https://github.com/chjj/bns/blob/master/bin/bns-prove" rel="noopener ugc nofollow" target="_blank">握手名称声明脚本</a>会进行实际的DNS查询，以获得生成证明所需的密钥链。但是，既然我们要一起黑掉我们自己的DNSSEC连锁店，我们就必须在方法上更有创造性。</p><h1 id="6f08" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">看看我，我现在是ICANN了</h1><p id="91eb" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">在接下来的演示中，我们将使用<a class="ae ld" href="https://www.isc.org/bind/" rel="noopener ugc nofollow" target="_blank">绑定</a>，我可以用<code class="eh ly lz ma lp b">brew install bind</code>将它安装在OSX上。这将给我们三个我们需要继续的实用程序:<code class="eh ly lz ma lp b"><a class="ae ld" href="https://linux.die.net/man/8/dnssec-keygen" rel="noopener ugc nofollow" target="_blank">dnssec-keygen</a></code>、<code class="eh ly lz ma lp b"><a class="ae ld" href="https://linux.die.net/man/8/dnssec-dsfromkey" rel="noopener ugc nofollow" target="_blank">dnssec-dsfromkey</a></code>和<code class="eh ly lz ma lp b"><a class="ae ld" href="https://linux.die.net/man/8/dnssec-signzone" rel="noopener ugc nofollow" target="_blank">dnssec-signzone</a></code>。</p><p id="822f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">首先，我们将使用握手钱包来生成对域名<code class="eh ly lz ma lp b">bitcoin</code>的声明。该命令将生成一个TXT记录，其中包括钱包地址和一些其他元数据:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="524c" class="lt kb ie lp b fv lu lv l lw lx">$ hsw-rpc --network=regtest createclaim bitcoin</span><span id="675a" class="lt kb ie lp b fv mb lv l lw lx">{<br/>  "name": "bitcoin",<br/>  "target": "bitcoin.com.",<br/>  "value": 566471548,<br/>  "size": 5120,<br/>  "fee": 25600,<br/>  "address": "rs1q7ywfylsgt3fj4n6fz7q8k8j0wz43lcws2ee2ya",<br/>  "txt": "hns-regtest:aakpchespyefyuzkz5erpad3dzhxbky74hip2adei6z7736u6qcacthqpeg2ncko7nnwpepv76f6sn3ywjlerdorw7dacaaaadrg5xku"<br/>}</span></pre><p id="a3e4" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在我们将创建<code class="eh ly lz ma lp b">bitcoin.com</code>区域文件。首先生成两个密钥:一个区域签名密钥(ZSK)和一个密钥签名密钥(KSK)。无论在哪里运行，这些命令都将输出公钥和私钥文件:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="c074" class="lt kb ie lp b fv lu lv l lw lx">$ dnssec-keygen -f KSK -a RSASHA256 -n ZONE bitcoin.com</span><span id="8d07" class="lt kb ie lp b fv mb lv l lw lx">Generating key pair...<br/>Kbitcoin.com.+008+37177</span><span id="4991" class="lt kb ie lp b fv mb lv l lw lx">$ dnssec-keygen -a RSASHA256 -n ZONE bitcoin.com</span><span id="59f2" class="lt kb ie lp b fv mb lv l lw lx">Generating key pair...<br/>Kbitcoin.com.+008+27510</span></pre><p id="2847" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在创建一个区域文件模板，包括密钥和握手证明:</p><p id="78c3" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">bitcoin.com.zone</strong></p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="c2cb" class="lt kb ie lp b fv lu lv l lw lx">$ORIGIN bitcoin.com.<br/>$TTL 172800<br/>@ IN SOA com. admin.email ( 2007120710 1d 2h 4w 1h )</span><span id="0658" class="lt kb ie lp b fv mb lv l lw lx">$INCLUDE /work/guide/keys/Kbitcoin.com.+008+37177.key<br/>$INCLUDE /work/guide/keys/Kbitcoin.com.+008+27510.key</span><span id="0daa" class="lt kb ie lp b fv mb lv l lw lx">bitcoin.com. IN TXT "hns-regtest:aakpchespyefyuzkz5erpad3dzhxbky74hip2adei6z7736u6qcacthqpeg2ncko7nnwpepv76f6sn3ywjlerdorw7dacaaaadrg5xku"</span></pre><p id="fa1d" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">签署区域文件:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="b2d5" class="lt kb ie lp b fv lu lv l lw lx">$ dnssec-signzone -o bitcoin.com bitcoin.com.zone</span></pre><p id="8d10" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这将生成一个包含签名记录的新文件<code class="eh ly lz ma lp b">bitcoin.com.zone.signed</code>，如下所示:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="6bd0" class="lt kb ie lp b fv lu lv l lw lx">172800 TXT "hns-regtest:aakpchespyefyuzkz5erpad3dzhxbky74hip2adei6z7736u6qcacthqpeg2ncko7nnwpepv76f6sn3ywjlerdorw7dacaaaadrg5xku"<br/>172800 RRSIG TXT 8 2 172800 (<br/>     20190926203106 20190827203106 17421 bitcoin.com.<br/>     wE/Ky5yH9bG2DAmOp1d0oSOA2OpsrmxQjv8w<br/>     OvnNkYC65Vo38eBDj64wSU2x1tgO91TBepj1<br/>     rLj3Df2owMYv3A+Ciu/qXXCRSM/2krcltXis<br/>     guV7tLltBQLsiPtVs1wEr8vCWcaZP4yd1lo4<br/>     1Bmvi0YajOsxV7NNWJloTPJfdNM= )</span></pre><p id="4efd" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在我们需要以类似的方式再创建两个区域文件(用于<code class="eh ly lz ma lp b">.com</code>和<code class="eh ly lz ma lp b">root</code>)。每个父区域需要包括其子区域的KSK的<a class="ae ld" href="https://www.cloudflare.com/learning/dns/dns-records/dnskey-ds-records/" rel="noopener ugc nofollow" target="_blank"> ds记录</a>(即<code class="eh ly lz ma lp b">.com</code>区域需要<code class="eh ly lz ma lp b">bitcoin.com</code>键的DS记录)。我们像这样创建该记录，并将其添加到<strong class="jd if"> com.zone </strong>模板文件中:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="a3a1" class="lt kb ie lp b fv lu lv l lw lx">$ dnssec-dsfromkey -2 Kbitcoin.com.+008+37177.key</span><span id="37f7" class="lt kb ie lp b fv mb lv l lw lx">bitcoin.com. IN DS 17421 8 2 78D60AF13E97693AC2F32B591FD3D60D34E151016F8692475617FBCD03CDCBE1</span></pre><p id="9d3c" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们将重复生成密钥的过程，将它们添加到<a class="ae ld" href="https://github.com/pinheadmz/hsd-regtest-claim/tree/master/zone-files" rel="noopener ugc nofollow" target="_blank">区域文件</a>，并且<a class="ae ld" href="https://github.com/pinheadmz/hsd-regtest-claim/tree/master/signed-zone-files" rel="noopener ugc nofollow" target="_blank">为<code class="eh ly lz ma lp b">.com</code>和<code class="eh ly lz ma lp b">root</code>区域文件签署文件</a>。</p><p id="3640" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">最后，我们将一起粉碎所有三个区域文件。我们不需要包括像SOA和NSEC这样的每个区域的所有记录，只需要包括ds、DNSKEY、TXT和RRSIG。你可以在这里看到我完整的所有权证明。</p><p id="8b29" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">当然，为了使这些有效，我们需要在Handshake中插入我们随意自制的根区域KSK。<a class="ae ld" href="https://github.com/pinheadmz/bns/commit/df201590b013849e853aafef9aaa6905ad954fb6" rel="noopener ugc nofollow" target="_blank">我们通过生成一个DS记录并将其添加到bns </a>中的信任锚来实现这一点(bns是hsd的一个依赖项，因此它位于我们的<code class="eh ly lz ma lp b">node_modules</code>目录中)。</p><h1 id="49b8" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">要求那个名字</h1><p id="d863" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">好了，你准备好拥有握手时的名字<code class="eh ly lz ma lp b">bitcoin</code>了吗？我们还有一个小技巧要完成:我们需要将证明编译成base64字符串。这可以通过使用bns在nodejs REPL中使用两行代码来完成:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="8c51" class="lt kb ie lp b fv lu lv l lw lx">$ node</span><span id="50ce" class="lt kb ie lp b fv mb lv l lw lx">&gt; const bns = require('bns')</span><span id="17c0" class="lt kb ie lp b fv mb lv l lw lx">undefined</span><span id="fe35" class="lt kb ie lp b fv mb lv l lw lx">&gt; bns.Ownership.Proof.fromString(<br/>    fs.readFileSync('/work/guide/zones/ownership-bitcoin.zone')<br/>    .toString('ascii')<br/>  ).toBase64()</span><span id="7786" class="lt kb ie lp b fv mb lv l lw lx">'AwMAADAAAQACowAAiAEAAwgDAQABnt9Z4x3v0DvnkBY0Hx17RTi3Ac...'</span></pre><p id="875b" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，我们可以使用那个巨大的base64 blob(包含整个DNSSEC签名系列)来声明我们的链上保留名称:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="e2ff" class="lt kb ie lp b fv lu lv l lw lx">hsd-rpc --network=regtest sendrawclaim AwMAADAAAQACowAAiAEAAwgD...</span></pre><h1 id="1e22" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">确认</h1><p id="b6f7" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">与airdrop赎回一样，保留名称声明也包含在块的coinbase事务中:</p><pre class="lk ll lm ln fq lo lp lq lr aw ls dt"><span id="a4d5" class="lt kb ie lp b fv lu lv l lw lx">$ hsd-rpc --network=regtest generatetoaddress 1 rs1q30ppv5gyrwpy4wyk0v6uzawxygdtvrpux8yrg2</span><span id="bb72" class="lt kb ie lp b fv mb lv l lw lx">[<br/>  "908eb35fab448ec928126dc7b451b27798b5f611bc50b5bfc081a7d18add04e0"<br/>]</span><span id="eb32" class="lt kb ie lp b fv mb lv l lw lx">$ hsd-cli --network=regtest block 908eb35fab448ec928126dc7b451b27798b5f611bc50b5bfc081a7d18add04e0</span><span id="5e9a" class="lt kb ie lp b fv mb lv l lw lx">...<br/>  "outputs": [<br/>    {<br/>      "value": 2000025600,<br/>      "address": "rs1q30ppv5gyrwpy4wyk0v6uzawxygdtvrpux8yrg2",<br/>      "covenant": {<br/>        "type": 0,<br/>        "action": "NONE",<br/>        "items": []<br/>      }<br/>    },<br/>    {<br/>      "value": 566445948,<br/>      "address": "rs1q7ywfylsgt3fj4n6fz7q8k8j0wz43lcws2ee2ya",<br/>      "covenant": {<br/>        "type": 1,<br/>        "action": "CLAIM",<br/>        "items": [<br/>"f82f54fe3a9daa86316dc706e74b31d57ce6b21a12104cdfbd3f90b627847105",<br/>          "0c000000",<br/>          "626974636f696e",<br/>          "01",          "47b3ffefd4f404014cf0790da6894efb5b6791f5ff8be93778b256488dd1b7c6",<br/>          "01000000"<br/>        ]<br/>      }<br/>    }<br/>  ]<br/>...</span></pre><p id="202b" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">瞧啊。第二个事务输出是我们的<code class="eh ly lz ma lp b">CLAIM</code>，它将<code class="eh ly lz ma lp b">bitcoin</code>名称的控制权分配给我们生成的钱包地址。我们能够通过伪造<code class="eh ly lz ma lp b">.com</code>和<code class="eh ly lz ma lp b">root</code>区域的密钥，并在regtest模式下恶意地将它们插入我们自己的hsd客户端来实现这一点。</p><h1 id="ac83" class="ka kb ie bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">🍺结论🍺</h1><p id="02a9" class="pw-post-body-paragraph jb jc ie jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">你有没有弄清楚为什么水龙头证明有硬编码的费用？第一个在<code class="eh ly lz ma lp b">matthew@purse.io</code>将正确答案发邮件给我的人，我会给你5美元的比特币。如果在握手mainnet启动之前我没有得到正确的答案，我可以用<a class="ae ld" href="https://github.com/handshake-org/hsd/blob/master/lib/protocol/consensus.js#L25" rel="noopener ugc nofollow" target="_blank"> dollarydoos </a>送你5美元！</p></div><div class="ab cl mc md hb me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hm hn ho hp hq"><p id="adf5" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="jz">本次演示使用的文件&amp;已修改，原件:</em></p><p id="148f" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if"> hs-airdrop </strong> : ( <a class="ae ld" href="https://github.com/handshake-org/hs-airdrop" rel="noopener ugc nofollow" target="_blank">原</a> ) ( <a class="ae ld" href="https://github.com/pinheadmz/hs-airdrop/commits/guide" rel="noopener ugc nofollow" target="_blank">改</a> ) <br/>用于生成空投树，为钥匙持有者和水龙头接收者创建凭证，以在区块链领取他们的硬币。</p><p id="b76e" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if"> hsd: </strong> ( <a class="ae ld" href="https://github.com/handshake-org/hsd" rel="noopener ugc nofollow" target="_blank">原创</a> ) ( <a class="ae ld" href="https://github.com/pinheadmz/hsd/commit/28dca2c4e05630d7fe01740324660a8a81481a29" rel="noopener ugc nofollow" target="_blank">修改</a> ) <br/>握手参考客户。验证区块链并审核所有交易的协议合规性。</p><p id="49a6" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if"> bns: </strong> ( <a class="ae ld" href="https://github.com/chjj/bns" rel="noopener ugc nofollow" target="_blank">原</a> ) ( <a class="ae ld" href="https://github.com/pinheadmz/bns/commit/df201590b013849e853aafef9aaa6905ad954fb6" rel="noopener ugc nofollow" target="_blank">修改</a>)<br/>node . js的递归DNS服务器和解析器，作为hsd的依赖项包含在内，是处理DNSSEC所必需的。</p><p id="bb44" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">HSD-regtest-claim:</strong>(<a class="ae ld" href="https://github.com/pinheadmz/hsd-regtest-claim" rel="noopener ugc nofollow" target="_blank">原件仅用于本指南</a> ) <br/>用于为保留名称声明创建“有效”DNSSEC证明的密钥和区域文件。</p><p id="8ae1" class="pw-post-body-paragraph jb jc ie jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd if">龙头-工具:</strong> ( <a class="ae ld" href="https://github.com/handshake-org/faucet-tool" rel="noopener ugc nofollow" target="_blank">原文</a> ) <br/>生成BIP39助记短语、私钥和mainnet hns地址。用于申请水龙头空投。</p><blockquote class="mo"><p id="6b8e" class="mp mq ie bd mr ms mt mu mv mw mx jy ek translated"><a class="ae ld" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="mz na nb nc nd hv fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff my"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>