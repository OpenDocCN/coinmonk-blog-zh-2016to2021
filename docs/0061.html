<html>
<head>
<title>Nano Deterministic Account Addresses</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">纳米确定性帐户地址</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/raiblocks-deterministic-keys-8cb869cc6046?source=collection_archive---------0-----------------------#2018-01-10">https://medium.com/coinmonks/raiblocks-deterministic-keys-8cb869cc6046?source=collection_archive---------0-----------------------#2018-01-10</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="92ce" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在进入Nano(当时的RaiBlocks)之后，我决定开发自己的iOS轻型钱包。我开发的第一个功能是从raiwallet.com生成的种子中获得相同的Nano帐户地址。在编写自己的Swift实现时，我参考了raiwallet.com的源代码和T2的轻量级Python钱包。</p><p id="aef6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">从种子到纳米地址:</p><ul class=""><li id="07cb" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx dt translated">从种子生成密钥</li><li id="9216" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated">从秘密密钥导出公开密钥</li><li id="6873" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated">从公钥中导出Nano帐户地址</li></ul><p id="cea2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我注意到至少有几次，在公钥和帐户地址之间的区别上有些混淆。为了清楚起见，以下是我的定义:</p><p id="425b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">种子:</strong>一个随机的32字节值。这可以是任何随机数据。通常被视为64个字符的十六进制字符串。保密！</p><p id="c2cb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">秘钥:</strong>也叫私钥。Keyp也是这个密钥的秘密，因为它负责签名块。</p><p id="95b8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">公钥:</strong>您的帐户地址所源自的密钥。公钥是可以共享的。</p><p id="0cac" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">账户地址:</strong>从公钥导出的地址。Base-32编码，带有校验和，前面有“xrb_”。</p><h1 id="3ab0" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">图书馆</h1><ul class=""><li id="69ad" class="jp jq ht is b it lb ix lc jb ld jf le jj lf jn ju jv jw jx dt translated"><a class="ae jo" href="https://github.com/nebyark/libsodium" rel="noopener ugc nofollow" target="_blank">利钠盐</a>(氯化钠)</li><li id="7aee" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated"><a class="ae jo" href="https://github.com/nebyark/swift-sodium" rel="noopener ugc nofollow" target="_blank">斯威夫特钠</a></li></ul><h1 id="f554" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">生成密钥</h1><p id="b344" class="pw-post-body-paragraph iq ir ht is b it lb iv iw ix lc iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">这个上下文中的密钥只是一个32字节十六进制值(您的种子)和一个4字节种子索引值的Blake2b散列。我花了令人沮丧的几秒钟想知道为什么我的密钥在散列种子和索引后出现了不同——结果是我的索引字节数是32而不是4 lol。</p><p id="4c0f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">种子索引应该从0开始，并且应该在每次用户使用相同的种子创建新的帐户地址时递增。使用无符号32位整数，可以生成2 -1个唯一的密钥对。</p><figure class="lj lk ll lm fq ln"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="7b84" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">注意:swift-sodium的genericHash类在引擎盖下使用Blake2b。</p><h1 id="abb0" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">从秘密衍生出公开</h1><h2 id="6b30" class="lq ke ht bd kf lr ls lt kj lu lv lw kn jb lx ly kr jf lz ma kv jj mb mc kz md dt translated">修改Ed25519</h2><p id="759e" class="pw-post-body-paragraph iq ir ht is b it lb iv iw ix lc iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">Nano使用带有Blake2b内部哈希的Ed25519密钥对/签名函数，这与libna的内部SHA512不同。</p><p id="3c5a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我为lib Nair的keypair.c添加了一个额外的函数，以便能够从一个秘密密钥中导出public:</p><figure class="lj lk ll lm fq ln"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="7c53" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在Swift中调用它:</p><figure class="lj lk ll lm fq ln"><div class="bz el l di"><div class="lo lp l"/></div></figure><h1 id="bfb6" class="kd ke ht bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la dt translated">XRB帐户地址</h1><p id="afd3" class="pw-post-body-paragraph iq ir ht is b it lb iv iw ix lc iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">XRB账户地址由3部分组成:</p><ul class=""><li id="a405" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx dt translated">xrb_ '</li><li id="4acf" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated">编码公钥</li><li id="0237" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx dt translated">编码校验和</li></ul><p id="773a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><encoded public="" key="">xrb _ '<encoded checksum=""/></encoded></p><h2 id="d8d2" class="lq ke ht bd kf lr ls lt kj lu lv lw kn jb lx ly kr jf lz ma kv jj mb mc kz md dt translated">编码</h2><p id="4d8f" class="pw-post-body-paragraph iq ir ht is b it lb iv iw ix lc iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">整数中的每个5位块是32个字母编码字母表'<em class="me">13456789 abcdefghijkmnopqrstuwxyz '</em>中的一个字符的索引。您可以创建一个编码查找表，其中数字00000–11111(0–31)映射到字母表中的一个字母:</p><figure class="lj lk ll lm fq ln fe ff paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="fe ff mf"><img src="../Images/c944a24630fed46fe7b3fae76b5e13b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mk50pZSDLsH-nhEDLuOm0Q.png"/></div></div><figcaption class="mm mn fg fe ff mo mp bd b be z ek">encoding lookup table that was shared in the Nano discord (slight error with ‘00110’ and ‘00111’, they should be ‘8’ and ‘9’ respectively)</figcaption></figure><figure class="lj lk ll lm fq ln"><div class="bz el l di"><div class="lo lp l"/></div></figure><p id="3120" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">对整数(或位数组)进行编码需要以5位为单位进行解析:</p><figure class="lj lk ll lm fq ln"><div class="bz el l di"><div class="lo lp l"/></div></figure><h2 id="7158" class="lq ke ht bd kf lr ls lt kj lu lv lw kn jb lx ly kr jf lz ma kv jj mb mc kz md dt translated">公开密钥</h2><p id="5412" class="pw-post-body-paragraph iq ir ht is b it lb iv iw ix lc iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">从公钥字节数组创建一个位数组，并用4个额外的位(256 -&gt; 260位)填充它。因为公钥的前4位是零填充的，所以帐户地址的第一个字母只能是“1”或“3”(00000:“1”，00001:“3”)。</p><h2 id="c140" class="lq ke ht bd kf lr ls lt kj lu lv lw kn jb lx ly kr jf lz ma kv jj mb mc kz md dt translated">校验和</h2><p id="5f0a" class="pw-post-body-paragraph iq ir ht is b it lb iv iw ix lc iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">获取一个5字节摘要大小的公钥Blake2b哈希，并对结果哈希执行字节交换。将结果编码。</p><p id="eb8e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将所有3个连接起来，您将得到一个类似于下面的地址:</p><p id="30ef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="me">xrb _ 1 SF 5 f 67 NW 56 ts 998 bsrnjhp 4 po 3y 9 ky 57mg 6 c 4534 rqbz 96 sczotn 4 nu fhf 7</em></p><blockquote class="mq"><p id="a1a5" class="mr ms ht bd mt mu mv mw mx my mz jn ek translated"><a class="ae jo" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="nb nc nd ne nf ln fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff na"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>