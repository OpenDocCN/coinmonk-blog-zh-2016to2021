<html>
<head>
<title>A Security Token — Harbor’s R-Token</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一种安全令牌——Harbor的R令牌</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/a-security-token-harbors-r-token-c147ba9557b4?source=collection_archive---------0-----------------------#2018-12-21">https://medium.com/coinmonks/a-security-token-harbors-r-token-c147ba9557b4?source=collection_archive---------0-----------------------#2018-12-21</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="3dd6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在本文中，我们将研究Harbor的安全令牌实现，R-Token。我们将看看他们产品的高层架构，然后深入一些代码，以了解底层实现的具体细节。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff jo"><img src="../Images/eebe8dec0e3ada7faa267570445536fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*H-R0M7UcAiSAPfvSyYLFOg.png"/></div></figure><h2 id="5b2b" class="jw jx ht bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq dt translated">三万英尺</h2><p id="654f" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hm dt translated">Harbor有一个很棒的信息图，它有助于划分从交换到链的安全令牌的责任区域。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="fe ff kw"><img src="../Images/3623a0ee8cd26324563da9e70713c435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BfpLlmXAAZCiyiUPNIUvaQ.png"/></div></div><figcaption class="lb lc fg fe ff ld le bd b be z ek">Credit — Harbor</figcaption></figure><ul class=""><li id="1926" class="lf lg ht is b it iu ix iy jb lh jf li jj lj jn lk ll lm ln dt translated"><strong class="is hu"> Exchange </strong> —这不在本文讨论范围之内，但是Harbor需要将参与其R-Token生态系统的每个Exchange列入白名单。</li><li id="d1b3" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated"><strong class="is hu">协议</strong>——不在范围内，但我确实希望Harbor包括像0x和Airswap这样的流动性提供商。这是一种前瞻性思维，对他们的客户来说是一种好处，可以让他们的投资避免陷入流动性孤岛。</li><li id="1c9d" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated"><strong class="is hu">合规</strong> —这是Harbor价值主张的核心，值得注意的是他们如何将合规逻辑与令牌本身分离开来。至少可以说，安全令牌行业正准备进行监管改革，因此这是一个非常好的主意。在本文的后面，我们将看看他们是如何在技术上实现这一点的。</li><li id="477b" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated"><strong class="is hu">令牌</strong> — Harbor拥有他们的R-令牌，这是一种自定义的ERC-20令牌，支持他们的合规协议。它们覆盖了几个将成功/失败推迟到它们的法规遵从性服务的事务性方法。即。如果用户</li><li id="fae1" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated"><strong class="is hu">区块链</strong> — Harbor希望成为区块链不可知论者，这很有趣。安全令牌的价值不是来自于它所部署的链，而是来自于它的底层资产。虽然区块链是不可改变的，但这并不意味着它会永远保持下去，更好的链会出现。Harbor的愿景是允许客户将令牌迁移到不同的链，这在我看来是该平台的另一个优势。</li></ul></div><div class="ab cl lt lu hb lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hm hn ho hp hq"><h2 id="7488" class="jw jx ht bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq dt translated">再深一点</h2><p id="75a6" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hm dt translated">Harbor的核心是一个协议或协议层，它提供了遵从性的“要求”,正如他们的首席技术官和联合创始人Bob Remeika在本文中所引用的那样。</p><blockquote class="mc md me"><p id="d015" class="iq ir mb is b it iu iv iw ix iy iz ja mf jc jd je mg jg jh ji mh jk jl jm jn hm dt translated">我们将这些要求概括为符合性的<em class="ht">谁</em>、<em class="ht">什么</em>和<em class="ht">哪里</em>:</p><p id="45d1" class="iq ir mb is b it iu iv iw ix iy iz ja mf jc jd je mg jg jh ji mh jk jl jm jn hm dt translated"><strong class="is hu"> <em class="ht">谁是</em> </strong>买方和卖方</p><p id="009e" class="iq ir mb is b it iu iv iw ix iy iz ja mf jc jd je mg jg jh ji mh jk jl jm jn hm dt translated"><strong class="is hu"> <em class="ht">什么是</em> </strong>贸易</p><p id="97db" class="iq ir mb is b it iu iv iw ix iy iz ja mf jc jd je mg jg jh ji mh jk jl jm jn hm dt translated"><strong class="is hu"><em class="ht"/></strong>交易发生在哪里</p></blockquote><p id="9512" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Harbor使用“谁、什么、为什么”输入来批准或拒绝请求的交易。这个逻辑包含在一个链外解决方案中，由Harbor自己集中和维护。请务必注意这一区别以及潜在的明显原因，即美国的安全令牌受SEC监管。也就是说，R-token被锁定在海港平台上，如果您决定离开海港生态系统，您需要重新发行新的token。这是新兴的EIP-1400标准希望解决的部分问题，因为这些令牌及其底层合规功能将有一个开放的标准。</p><p id="77ff" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt mi translated"><span class="l mj mk ml bm mm mn mo mp mq di">我</span>真的很希望看到R-Token成为符合EIP-1400提案，如果它曾经看到了白天。在这一点上，Harbor在提供合规性逻辑的同时，允许代币客户来来去去，这仍然是一项了不起的业务。</p><p id="77c0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你读了我的文章<a class="ae ma" rel="noopener" href="/coinmonks/a-security-token-revealed-5da9de3345bb">一个安全令牌-透露</a>，有一些安全令牌的其他属性，我们也应该回顾一下Harbor的处理</p><ul class=""><li id="b17d" class="lf lg ht is b it iu ix iy jb lh jf li jj lj jn lk ll lm ln dt translated">持有期——我假设Harbor的中央oracle正在从代币本身混淆这一点，并且正在管理投资者持有的代币“份额”,并在适当的时候释放它们。</li><li id="a7cf" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated">股息——基于所有权上限表的股息支付更像是一个链外功能，但如果Harbor处理或允许第三方提供相关信息，我会很感兴趣。我看到有人提到了用于投资组合管理和税务服务的Lumina，但现在还不清楚它是否已经集成。</li><li id="6bd7" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated">文档/托管—这是一个大问题，我很高兴听到Harbor提到<a class="ae ma" href="https://www.bitgo.com/" rel="noopener ugc nofollow" target="_blank"> Bitgo </a>作为托管解决方案，但我不清楚通过Harbor平台部署令牌的客户是否可以访问这些服务。除了令牌的保管之外，底层的安全文档应该存储在某个地方，作为另一种形式的所有权证明。我假设Harbor充当了此类服务的中介，以便于证明基础资产的所有权。像EIP-1400引用的那样，有一种将文档与onchain令牌链接起来的方法是很好的，但是我在R-Token实现中没有看到这种方法。</li></ul></div><div class="ab cl lt lu hb lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hm hn ho hp hq"><h2 id="ea5e" class="jw jx ht bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq dt translated">具体细节</h2><p id="2300" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hm dt translated">Harbor的<em class="mb">受管制令牌</em>或<em class="mb"> R-Token </em>在其github库<a class="ae ma" href="https://github.com/harborhq/r-token/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">自述文件</a>中有很好的记录，如果您有任何进一步的问题，我建议您浏览一下。</p><p id="568b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Harbor设计的根本是将合规逻辑与R-Token功能分离。这是通过部署三个独立的契约来提供间接层来实现的。</p><ul class=""><li id="6733" class="lf lg ht is b it iu ix iy jb lh jf li jj lj jn lk ll lm ln dt translated">监管机构服务—该智能合约与链外合规oracle接口，以获得交易的最终发言权。</li><li id="c293" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated">服务注册中心—此智能合同包含对监管机构服务的可更新引用。这允许我们在合规逻辑发生变化时部署新的监管机构服务，并更新其在本合同中的引用。</li><li id="c019" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated">R-Token —此令牌智能合约包含对服务注册中心的不可变引用，该注册中心通过允许监管者服务可更新而面向未来。</li></ul><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="fe ff mr"><img src="../Images/5c0f3fa090e1bf417394dc374271da51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OsGUp71l1vVT83w-.png"/></div></div><figcaption class="lb lc fg fe ff ld le bd b be z ek"><a class="ae ma" href="https://github.com/harborhq/r-token" rel="noopener ugc nofollow" target="_blank">https://github.com/harborhq/r-token</a></figcaption></figure><p id="97e0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">总的流程是</p><ul class=""><li id="c6eb" class="lf lg ht is b it iu ix iy jb lh jf li jj lj jn lk ll lm ln dt translated">用户尝试将令牌转移到特定地址(用户或合同)</li><li id="5c48" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated">R-Token通过给定的地址检索对服务注册契约的引用，并请求调节器服务。</li><li id="8491" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated">服务注册中心返回注册到它的Regulator服务，RToken通过其覆盖的传输方法运行符合性检查。</li><li id="bcd4" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated">如果监管机构允许转让，那么交易应该很快就会出现在交易链上</li><li id="f2e0" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated">如果传输被调节器服务拒绝，调节器服务应该返回某种类型的状态，指出原因。</li><li id="5d39" class="lf lg ht is b it lo ix lp jb lq jf lr jj ls jn lk ll lm ln dt translated">如果拒绝的原因已被纠正，则必须再次执行转移。我不相信有任何默认的“重试”逻辑，所以如果你需要，这将内置到你的应用程序中。</li></ul></div><div class="ab cl lt lu hb lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hm hn ho hp hq"><h2 id="a2a1" class="jw jx ht bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq dt translated">调节器服务</h2><p id="dfb6" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hm dt translated">RegulatorService通常不会像这个示例所示的那样在链上具有其遵从性逻辑，但作为一个简单的示例来说，这是一个不错的例子。通常，<em class="mb"> RegulatorService </em>会查询一个oracle。请注意，<a class="ae ma" href="https://github.com/harborhq/r-token/blob/master/contracts/TestRegulatorService.sol" rel="noopener ugc nofollow" target="_blank"> TestRegulatorService.sol </a>中的逻辑完全由交易量驱动。</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="ms mt l"/></div></figure><h2 id="4574" class="jw jx ht bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq dt translated">服务注册表</h2><p id="0116" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hm dt translated"><a class="ae ma" href="https://github.com/harborhq/r-token/blob/master/contracts/ServiceRegistry.sol" rel="noopener ugc nofollow" target="_blank"><em class="mb">service registry . sol</em></a>有一个构造函数，你可以在其中设置已部署的<em class="mb"> RegulatorService </em>或者替换它，如下图所示。</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="ms mt l"/></div></figure><h2 id="171e" class="jw jx ht bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq dt translated">受管制令牌</h2><p id="3e51" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hm dt translated"><a class="ae ma" href="https://github.com/harborhq/r-token/blob/master/contracts/RegulatedToken.sol" rel="noopener ugc nofollow" target="_blank"><em class="mb">regulated token . sol</em></a>有一个接受典型的ERC-20属性和<em class="mb"> ServiceRegistry </em>地址的构造函数</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="ms mt l"/></div></figure><p id="c54d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">它还重写了transfer和transferFrom方法来处理符合性检查</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="ms mt l"/></div></figure><p id="f88d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">正如我之前说过的，Harbor的R-Token在它的github知识库<a class="ae ma" href="https://github.com/harborhq/r-token/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"> README </a>中有很好的文档记录，它们比我在实际的开发者文档和相关的truffle项目中做得更好。这是下一步的必读书目。</p></div><div class="ab cl lt lu hb lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hm hn ho hp hq"><h2 id="5b01" class="jw jx ht bd jy jz ka kb kc kd ke kf kg jb kh ki kj jf kk kl km jj kn ko kp kq dt translated">摘要</h2><p id="00dc" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hm dt translated">希望这篇文章能够提供丰富的信息，让您大致了解Harbor在R-Token和相关合规协议方面的尝试。作为安全令牌生态系统的领导者，我对这个项目的成功寄予厚望。似乎Harbor已经为他们的成功和不可避免的变化设计了他们的软件，这些变化将在不久的将来在这个领域传播开来。如果任何人对本文的内容有任何问题、澄清或错误/遗漏，请告诉我！</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><a href="http://bit.ly/2G71Sp7"><div class="fe ff mu"><img src="../Images/449450761cd76f44f9ae574333f9e9af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKX2mtg7p1lOs7JmosPLsA.png"/></div></a></figure><blockquote class="mv"><p id="6aa3" class="mw mx ht bd my mz na nb nc nd ne jn ek translated"><a class="ae ma" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="ng nh ni nj nk jt fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nf"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>