# 使用 Python 进行深度学习

> 原文：<https://medium.com/coinmonks/deep-learning-with-python-15e4fa47c609?source=collection_archive---------6----------------------->

这个帖子是针对深度学习初学者的。我写了我对《用 Python 进行深度学习》这本书的体验，以及我从中学到的东西。

这本书是弗朗索瓦·乔莱写的，也是《喀拉斯》的作者。

# 回顾

这本书适合任何想开始深度学习生涯或对深度学习感兴趣的人。它涵盖了深度学习领域的所有问题类别和解决方案。读完这本书后，你将具备分类图像、预测天气、生成文本等技能。

我一周前开始读这本书。我学过一些机器学习课程，但深度学习对我来说完全是新的。我想为一个大学项目理解神经网络。所以，我搜索了神经网络，找到了许多课程和学习资料。但最后，我找到了这本完美的书，开始了我对深度学习的学习。

作者擅长用词和写作方式。他解释复杂的问题轻而易举。晚上找到这本书，看了一晚上。有趣的是先了解应用程序，然后再实现它们。它让你对进一步阅读充满信心和兴趣。我对这个领域感兴趣。但看完这本书，我对成为一名数据科学家充满热情。我想探索这个领域。我想了解更多。我想为这个领域做出贡献。

感谢 Francois Chollet 写这本书。

# 这本书里面有什么？

这本书分为两部分:

1.  深度学习的基础
2.  实践中的深度学习

第一部分是为了建立深度学习的坚实基础，并回答一些重要的问题，如“什么是深度学习？”、‘它与人工智能和机器学习有什么不同？’、‘深度学习能做什么，不能做什么？等等。

# 第 1 章)什么是深度学习？

“深度学习，机器学习，人工智能……”，突然大家都在谈论他们。大多数人不知道这些术语之间的区别。这是到处都在讨论的热门话题。你对这些术语有清晰的理解吗？

如果前一个问题的答案是否定的，那么，这一章是为你准备的。本章解释了这些术语以及与它们相关的历史等。

# 人工智能:

我们能制造一台会思考的机器吗？这个想法诞生于 20 世纪 50 年代。这是一个象征性人工智能的时代。方法是给机器一些数据和一套规则。输出是答案。直到 20 世纪 80 年代，每个人都试图建立一套最好的规则来获得更好的结果。20 世纪 80 年代，人们将注意力转移到另一种方法上。这是机器学习时代的开始。

# 机器学习:

给机器足够的数据和答案，让机器来制定规则。通过这种方法，机器学习的新时代在 20 世纪 80 年代开始了。机器学习是人工智能的一个子领域。深度学习是机器学习的一个子领域。

# 深度学习:

深度学习是机器学习的一个古老子领域。但是，每个人现在都在谈论它，因为这些原因:

1.  五金器具
2.  资料组
3.  算法

近年来，可用数据大幅增长，硬件性能和算法不断进步。

当其他机器学习方法在大数据上达到饱和时，深度学习通过每时每刻产生大量数据来提供更好的结果。

在其他机器学习方法中需要大量的特征工程。这些方法只能学习 1-2 层表示。所以，这些方法也被称为浅层学习。

深度学习几乎不需要特征工程，它可以学习多层表示。神经网络用于学习这些表示。

深度学习在以下方面显示出更好的结果:

1.  图像分类
2.  语音识别
3.  机器翻译
4.  自然语言处理等。

这一章给出了更多关于传统机器学习方法和深度学习未来的细节。为了使帖子简短，我不打算在这里讨论这些。

# 第 2 章)在我们开始之前:神经网络的数学基础。

本章讨论神经网络的数学部分。你是一个好奇的人吗？你想知道机器是如何学习的吗？

如果是，这一章是给你的。

你听说过张量、微分、梯度下降等术语吗？

如果答案是否定的，不要担心。这一章解释了从基础到高级的这些术语。你也将第一次看到神经网络。

Keras 库和 MNIST 数据集用于建立和训练本书中的第一个神经网络。

**Q.** 什么是神经网络？

**俺们。**神经网络是一种数学模型。术语“神经”来自神经生物学。有人说神经网络类似于我们的大脑。但是，这本书抛弃了这个类比。

**问**神经网络的组成部分是什么？

**Ans。**任何神经网络的核心构建块都是层。该层可被视为从数据中提取代表性特征的过滤器。这些层由许多称为神经元的亚单位组成。

一开始可能看起来很难，但我保证在理解其背后的基本数学之后，神经网络对于您和您在处理任何机器学习问题时的第一选择来说将是超级简单的。

在训练我们的模型之前，我们需要再选择三样东西。这些是:

1.  损失函数
2.  优化器
3.  监控培训和测试的指标。

让我帮助你对神经网络有一个直觉。

想象一个球。把这个球想象成一个神经元。假设我们有 16 个神经元。像这样把它们排成 4 列。

0 0 0

0 0

0 0 0 0

0 0

0 0 0

0 0

这些列被称为层。每层可以有任意数量的神经元。第一层称为输入层，最后一层称为输出层。输入层和输出层之间的层称为隐藏层。神经网络可以具有任意数量的层，并且任意层可以具有任意数量的神经元。

这是神经网络的基本架构。接下来，想象两个连续层的任意两个神经元之间有一根线。任何两个连续层的任何两个神经元之间的这种连接线被称为权重。一层中的每一个神经元都连接到前一层和下一层的每一个神经元。这些重量是数字。例如，第 2 层的神经元 2 通过权重 0.4 连接到第 3 层的神经元 5

想象这样一种情况，你为一份工作参加了一场由 3 个部分(物理、化学和数学)组成的竞争性考试。物理 30 分，化学 70 分，数学 50 分。如果三者的加权和大于 50，则通过。

现在，如果所有三个主题具有相同的权重，那么加权和将是(0.33)* 30+(0.33)* 70+(0.33)* 50 = 49.5

你没通过考试。

但是，如果没有人通过考试呢？考试机构不得不改变及格标准。现在，他们给化学 50%的权重，给数学 30%的权重，给物理 20%的权重。

现在，你的加权和是(0.2)*30 + (0.5)*70 + (0.3)*50 = 56。

恭喜你，你通过了考试。检查机构是神经网络中的优化器。它改变权重和障碍值，以允许或阻止任何特征通过神经元。每个神经元都有一个偏差值，这个偏差值决定了什么样的值可以通过它。

即使你通过了考试，得到了工作。但是，公司发现你没有足够的工作技能。这将是公司的损失。神经网络的“损失函数”也是如此。

损失函数是预测值与实际所需值的偏差。优化器的工作是通过改变权重和偏差值来最小化损失函数。

为每一层设置另一个称为“激活”的功能。激活只是一个数学函数，它根据设定的函数转换一个层的输出。示例:“Relu”激活会将所有负输出转换为零。

如果你对这些函数背后的数学感兴趣，你可以浏览这一章。另外，我们有一个强大的库 Keras，它负责所有的后台编码，我们只需要根据我们的问题选择几个超参数。

对于应用程序，您必须遵循以下几个简单的步骤:

1.  通过选择层数、神经元数和激活数来构建模型架构。
2.  通过选择损失函数、优化器和指标来编译模型。
3.  根据您的数据训练模型。
4.  根据测试数据进行预测。

这是一个简单的神经网络。但是，这就是我们使用 Keras 构建基线模型所需的全部内容。

如果你想对神经网络有深入而清晰的了解，请浏览这一章。

# 第 3 章)神经网络入门

本章介绍了 Keras 和神经网络的组成部分。

# 使用神经网络可以解决哪些问题？

问题类别:

1.  分类
2.  回归

分类问题可以进一步分为 3 种类型:

1.  二元分类
2.  多类分类
3.  多标签分类

*二元分类*当我们只需要在两个选项之间进行分类时。例子:狗 vs 猫。

*多类分类*当我们需要从众多可用选项中选择一个选项时。示例:数字(0–9)

*多标签分类*当我们需要选择多个选项时。例如:卫星图像中的河流、农场、山脉等。

*回归*就是预测一个浮点数。例如:房子的价格。

你可以看看 Keras 文档，这也是本章的内容。

[https://keras.io](https://keras.io/)

在介绍了 Keras 和神经网络之后。在这一章中解决了一个二元分类问题。

数据集 IMDB 查看数据集

问题——将审核分为正面或负面。

之后，一个多类分类问题就解决了。

数据集—路透社数据集

问题——将路透社的新闻专线分为 46 个互相排斥的主题。

之后，一个回归问题就解决了。

数据集-波士顿住房

问题—波士顿房价预测。

你可以根据你的需要看到具体的例子。

# 第 4 章)机器学习的基础

机器学习可以分为 4 个分支:

1.  监督学习
2.  无监督学习
3.  自我监督学习
4.  强化学习

# 监督学习

标签必须从已知的目标中选择。示例:手写数字分类，其中标签只能是 0–9 之间的任何数字。已知的目标通常由人类标注。监督学习是学习输入数据和已知目标之间的映射。

# 无监督学习

没有向模型提供要学习的目标。相反，该模型为我们提供了有趣的数据转换，可用于数据可视化、聚类、降维等。

# 自我监督学习

这是受监督的学习，但是标签不是由人类标注的。使用启发式算法从输入数据中生成标签。

# 强化学习

目前还在研究阶段。模特们试图在从环境中学习的同时获得最大的回报。它已经被用来下围棋了。

# 培训、验证和测试集

在拟合模型之前，必须将数据分成 3 组；训练、验证和测试集。

**问**为什么要验证设置？为什么我们不能只使用测试集来检查模型性能？

Ans。在构建和训练任何模型时，有两种类型的变量；参数和超参数。

从训练数据中模拟学习参数，如权重和偏差。但是，超参数是由人类设定的。为了设置超参数，我们使用一个验证集。如果我们使用测试集来选择超参数，那么我们会将一些关于测试数据的信息泄露到模型中。所以，最好使用三套:

训练集:用于训练参数

验证集:用于选择超参数

测试集:用于评估最终模型的性能。

# 数据预处理

对于神经网络来说，映射原始数据和标签之间的关系有点困难。在将数据拟合到模型中之前，最好进行一些特征工程。我们可以进行矢量化、标准化、处理缺失值和特征提取。

## …向量化…

神经网络只接受具有浮点值的张量形式的数据和目标。图像，文本或任何东西，我们需要把它转换成向量。

## 正常化

如果所有特性的值都不在同一范围内，那么模型可能会对某些特性产生偏差。最好将 0 到 1 之间的所有值标准化。

## 处理缺失值

我们可以用 0 替换丢失的值，因为 0 不用于任何其他用途。

# 特征工程

对输入数据进行一些简单的转换，可以简化到目标值的映射。在将数据拟合到模型中之前进行这些转换。很多时候，如果给定原始数据，模型无法找到这些简单的转换。

# 过度拟合和欠拟合

过度拟合是导致测试数据集性能不佳的任何模型的主要问题。过度拟合可以使用一些技术来解决，例如:

1.  缩小网络规模
2.  增加重量调整
3.  添加辍学

# 机器学习的通用工作流程

1.  定义问题和组装数据集
2.  选择成功的专业
3.  决定评估协议
4.  准备数据
5.  开发一个比基线更好的模型
6.  向上扩展:开发一个过度拟合的模型
7.  正则化模型和调整超参数

为模型选择最后一层激活和损失函数

**问题类型-最后一层激活-损失函数**

分类

1.  二元——sigmoid——二元交叉熵
2.  多类，单标签 softmax 分类 _ 交叉熵
3.  多类、多标签— sigmoid —二元交叉熵

回归-无或 sigmoid-MSE

至此，我们结束了本书的第一部分。

# 第 5 章)计算机视觉的深度学习

这一章处理像图像分类这样的计算机视觉问题。

代替完全连接的密集层模型，卷积神经网络(CNN)被用于计算机视觉问题。

# Convnets

从应用的角度来说，不需要深入了解 convent 是如何工作的。但是，如果你有兴趣，你可以看看这个视频:

【https://www.youtube.com/watch?v=FmpDIaiMIeA】T2&t = 105s

## 利用一个训练有素的修道院

我们可以使用像 ImageNet 这样经过预先训练的 CNN，而不是使用我们从头开始制作的 CNN。ImageNet 已经训练了超过 140 万个带标签的图像和 1000 个不同的类。我们使用特征提取来提取已经学习过的 ImageNet 的特征。

为计算机视觉问题建立最佳模型的步骤:

1.  提取预训练 CNN 的特征。
2.  解冻 CNN 的一些输出侧层，对其进行训练。
3.  使用数据扩充来防止过度拟合。
4.  微调超参数。

这一章也形象化了 CNN 所学的，我们可以形象化中间激活。这有助于理解正在发生的事情并进行微调。

# 第 6 章)文本和序列的深度学习

递归神经网络(RNN)和 1-D convnet 在处理文本或序列数据时非常有用。

# 使用文本数据

正如我们之前讨论的，神经网络只接受张量作为输入。文本数据在提供给神经网络之前也需要转换成向量。文本的矢量化有多种方式:

将文本分割成单词，并将每个单词转换成向量。
将文本分割成字符，并将每个字符转换成向量。
提取单词或字符的 n 元文法，将每个 n 元文法转换成向量。
这些不同的片段可以是单词、字符、n-grams，称为*令牌*。将文本分解成记号称为*记号化*。连接令牌和向量的两种主要方式是一键编码和令牌嵌入。

# 一键编码

我们可以用一个例子来理解。我们有一篇包含 1000 个不同单词的课文。我们可以把它们从 1 数到 1000。现在，每个单词都有一个 1000*1 的向量。它仅在一个位置取值 1，在所有其他位置取值 0。因此，所有单词都有一个唯一的向量。

# 单词嵌入

单词嵌入是低维密集向量，其值从数据中学习。它类似于任何神经网络的权重矩阵。我们可以在将数据输入 RNN 之前，使用一个单独的神经网络来学习单词嵌入，或者我们可以在 RNN 之前使用一个嵌入层。

# 递归神经网络和长短期记忆(LSTM)

正如我为 CNN 说的，你不需要深入研究应用 RNN 的方法论。但是，如果你有兴趣，你可以看看这个视频:

[https://www.youtube.com/watch?v=WCUNPb-5EYI](https://www.youtube.com/watch?v=WCUNPb-5EYI)

此外，本章还解决了一个温度预报问题。

数据集-耶拿气候

如果您正在处理时间序列数据或文本序列，可以通读本章。

# 第 7 章)推进深度学习最佳实践

本章主要是为了研究的目的。本章将介绍高级网络体系结构。还介绍了 TensorBoard，用于分析模型和微调。

我们可以使用 keras API 构建多输入多输出模型。

这一章已经深入到深度学习了。如果你理解了这之前的所有章节，那么你可以试试这一章。我没有完全理解这一章，但它让我接触到可以学习的先进技术。

# 第 8 章)生成性深度学习

我们看到了一些经典问题，比如分类和回归。但是，深度学习也可以用来生成艺术品。它可以用来写剧本，创作绘画，创作歌曲等等。

# 使用 LSTM 生成文本

有没有看新闻说一个神经网络给《王座的游戏》下一季写了剧本？

是的，一些研究人员做到了。他们使用以前的小说作为数据来生成系列中的下一部。

我个人觉得深度学习的这个应用最有意思。本节使用 LSTM 创建了一个文本生成模型。阅读和应用它是很有趣的。

# 深梦

谷歌在 2015 年发布了它。这是一种艺术图像修改技术，使用 CNN 学习表示。

谷歌一下。你会看到一些非常酷的图片。示例:

![](img/28ec5914998da7d95e1c29226c690c0c.png)

# 神经类型转移

画一些像梵高的作品怎么样？你可以用神经风格转移来做到这一点。它基本上是从一幅图像中提取内容，从另一幅图像中提取样式，从而得到一幅组合图像。如果你用过 PRISMA，那么你就可以把它联系起来。

再次，谷歌一些很酷的例子。其中之一是:

![](img/217dfbbaf7c172ee1846beefad34d46b.png)

在解释了这两种情况下的编码部分后，本章还解释了使用振动自动编码器生成图像。它可用于图像编辑和生成。如果您对图像生成或图像编辑感兴趣，那么您可以浏览这一部分。

# 生成对抗网络

这是一个先进的网络生成一个相当现实的图像。它需要强大的计算能力。

这个概念是用两个神经网络一起工作。生成器网络产生图像，而对手网络给出关于图像真实性的反馈。两个网络都试图克服对方，从而产生相当真实的图像。

# 第 9 章)结论

简要描述书中涉及的所有内容。此外，讨论深度学习的未来、局限性和风险。

进一步阅读

arXiv 理智保护者([http://arxiv-sanity.com](http://arxiv-sanity.com/))
Keras 在线文档( [https://keras.io](https://keras.io) )

Keras 源代码([https://github.com/fchollet/keras](https://github.com/fchollet/keras))