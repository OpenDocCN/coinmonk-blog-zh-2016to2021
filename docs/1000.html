<html>
<head>
<title>How to Make a Q&amp;A Chatbot With Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用机器学习制作问答聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-make-a-q-a-chatbot-with-machine-learning-1c90207bde7b?source=collection_archive---------0-----------------------#2018-07-11">https://medium.com/coinmonks/how-to-make-a-q-a-chatbot-with-machine-learning-1c90207bde7b?source=collection_archive---------0-----------------------#2018-07-11</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="070b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这篇文章将教你如何编写自己的Slack聊天机器人，使用一些基本的机器学习工具来回答简单的问题。创建机器学习模型背后的大多数围绕自然语言处理和数学的更复杂的东西大多被抽象出来，为我们在相当短的时间内轻松构建成品留下了空间。如果你正在寻找一种简单有效的方法让一个半智能机器人快速回答Slack上的问题，那么这个指南就是适合你的。</p><p id="72e7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你想跳到完成的代码，请点击这里或文章末尾的Github repo <a class="ae jo" href="https://github.com/Nirespire/FAQBot" rel="noopener ugc nofollow" target="_blank">链接。</a></p><blockquote class="jp jq jr"><p id="6013" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated">2019年10月27日编辑</p><p id="f72d" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated">因为我使用的库(Botkit)有一些严重的安全漏洞，我不能让最新版本的库工作，我切换到了<a class="ae jo" href="https://slack.dev/node-slack-sdk/rtm-api" rel="noopener ugc nofollow" target="_blank"> Slack RTM API </a>。下面的代码示例应该可以正常工作，但是如果你有兴趣使用最新版本的代码，请查看底部的示例repo。<a class="ae jo" href="https://github.com/Nirespire/FAQBot/pull/2" rel="noopener ugc nofollow" target="_blank">链接到所有代码更改的拉请求</a>。</p></blockquote><h1 id="4348" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">一些设置</h1><p id="ea9f" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">本指南假设您对节点开发有基本的了解，因为这将是我们用来构建的主要工具。您还需要在您的机器上安装并运行以下软件。我通常在类似unix的终端环境中工作效率最高，也就是bash。以下是你还需要的东西:</p><ol class=""><li id="0189" class="kz la ht is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh dt translated">使用npm软件包管理器安装NodeJS。当我写这篇文章的时候，我使用了Node v10.1.0和npm v6.1.0，但是任何相对较新的版本都可以工作(比如v6和更高版本)。</li><li id="7432" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh dt translated">您拥有管理权限的宽松工作区。如果找不到，就<a class="ae jo" href="https://slack.com/get-started#create" rel="noopener ugc nofollow" target="_blank">做一个新的</a>。这是我们将开发和测试机器人能力的操场。</li><li id="18e5" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh dt translated">代码编辑器。我是<a class="ae jo" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VS代码</a>的忠实粉丝。</li></ol><p id="05b0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">打开松弛工作空间后，进入任意频道，点击设置齿轮图标。我们将向工作区添加一个应用程序。</p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff ln"><img src="../Images/56e29d305f6d1ef5d363ce6950dfbd8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byGuMKAATI6kEB-rGHIG-g.png"/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">How to add an integration to a Slack workspace</figcaption></figure><p id="4f6c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">搜索bot并添加bot集成。</p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff md"><img src="../Images/61062bfa9c0009a4570306a31402ba04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U6y3jGXnT0v9Qvat7osdTw.png"/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">Searching for the “Bots” integration in Slack</figcaption></figure><p id="4e8c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">添加配置，并给它一个您喜欢的名称。这基本上会在您的工作区中创建一个特殊类型的用户，您可以向其发送消息，就像任何其他用户一样。您可以稍后更改bot的名称和图标，但是我们现在需要的是get生成的<strong class="is hu"> API令牌</strong>值。<strong class="is hu"> <em class="js">一定要对这个值保密</em> </strong>。如果有人可以访问此内容，他们就可以免费在您的工作区中阅读和发布消息。</p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff me"><img src="../Images/288368e5051d3b6e90c5df7a9b3bce2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ez3ze-YKqbuLvlCsAqpwxA.png"/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">Copy the API token generated on this page (blacked out in this picture)</figcaption></figure><p id="aa54" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将该值放在手边。当我们开始写一些代码的时候，我们将会用到它。</p><h1 id="6d2e" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">编码时间到了</h1><h2 id="0b46" class="mf jx ht bd jy mg mh mi kc mj mk ml kg jb mm mn kk jf mo mp ko jj mq mr ks ms dt translated">基本机器人设置</h2><p id="285e" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">为了进行一些设置，让我们从一些样板代码开始。下面的npm命令应该可以完成基本的设置。</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="054e" class="mf jx ht mu b fv my mz l na nb"># Starting in the directory where your code is going</span><span id="8ba2" class="mf jx ht mu b fv nc mz l na nb">npm init -f<br/>npm i --save natural botkit@0.7.4 dotenv</span></pre><p id="e513" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">请注意我们将使用的三个库。</p><ul class=""><li id="9efe" class="kz la ht is b it iu ix iy jb lb jf lc jj ld jn nd lf lg lh dt translated">n<a class="ae jo" href="https://github.com/NaturalNode/natural" rel="noopener ugc nofollow" target="_blank">natural</a>:提供基本的文本处理和分类功能</li><li id="cf31" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated">b<a class="ae jo" href="https://github.com/howdyai/botkit" rel="noopener ugc nofollow" target="_blank">ot kit</a>:Slack API的包装器，可以轻松编写与Slack集成的程序</li><li id="b15e" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated">让我们在一个文件中管理环境变量，用于本地开发和测试</li></ul><p id="3a22" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">从那里我们可以开始写一些代码。让我们首先确保我们可以使用之前设置的API令牌连接到Slack。创建一个名为<code class="eh ne nf ng mu b">.env</code>的文件并粘贴以下内容，用您的API令牌替换<code class="eh ne nf ng mu b">=</code>之后的部分。</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="0965" class="mf jx ht mu b fv my mz l na nb">SLACK_API_TOKEN=</span></pre><blockquote class="jp jq jr"><p id="b684" class="iq ir js is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hm dt translated">如果你使用git之类的东西来维护你的代码变更，确保将<code class="eh ne nf ng mu b">.env</code>添加到你的<code class="eh ne nf ng mu b">.gitignore</code>文件中，这样你就不会不小心把它推到别人可以看到的地方！</p></blockquote><p id="60cc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来让我们来看看真正的代码。我们将从一些简单的设置开始，以确保我们可以使用API令牌并在botkit库的帮助下连接到我们的Slack工作区。我们可以从这样一个<code class="eh ne nf ng mu b">index.js</code>文件开始:</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="e741" class="mf jx ht mu b fv my mz l na nb">const botkit = require('botkit)</span><span id="2f9b" class="mf jx ht mu b fv nc mz l na nb">// Load our environment variables from the .env file<br/>require('dotenv').config();</span><span id="b2d1" class="mf jx ht mu b fv nc mz l na nb">// What are the types of chats we want to consider<br/>// In this case, we only care about chats that come directly to the bot<br/>const scopes = [<br/>    'direct_mention',<br/>    'direct_message',<br/>    'mention'<br/>];</span><span id="7fc3" class="mf jx ht mu b fv nc mz l na nb">// Get our Slack API token from the environment<br/>const token = process.env.SLACK_API_TOKEN;</span><span id="88b4" class="mf jx ht mu b fv nc mz l na nb">// Create a chatbot instance using Botkit<br/>const Bot = BotKit.slackbot({<br/>    debug: true,<br/>    storage: undefined<br/>});</span><span id="4b4f" class="mf jx ht mu b fv nc mz l na nb">// Function to handle an incoming message<br/>// In this example function the bot will just reply with "got it"<br/>function handleMessage(speech, message) {<br/>    console.log(speech, message);<br/>    speech.reply(message, "got it");<br/>}</span><span id="223f" class="mf jx ht mu b fv nc mz l na nb">// Configure the bot<br/>// .* means match any message test<br/>// The scopes we pass determine which kinds of messages we consider (in this case only direct message or mentions)<br/>// handleMessage is the function that will run when the bot matches a message based on the text and scope criteria<br/>Bot.hears('.*', scopes, handleMessage);</span><span id="fb24" class="mf jx ht mu b fv nc mz l na nb">// Instantiate a chatbot using the previously defined template and API <br/>// Open a connection to Slack's real time API to start messaging<br/>Bot.spawn({<br/>    token: token<br/>}).startRTM();</span></pre><p id="ade8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">上面的代码应该足够简单，可以让你的机器人启动并运行。你只需要执行<code class="eh ne nf ng mu b">node index.js</code>，你的bot应该连接到Slack API，并在你的工作区显示为“Active”。如果你给它发信息，它应该回复“收到”。您还可以修改代码，让机器人以您喜欢的任何方式进行响应。</p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff nh"><img src="../Images/abde03e59db3cb9c7b76ffeba93acdcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tzZ91By6WcIg-Fh8X11oPw.png"/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">It’s alive!</figcaption></figure><h2 id="c414" class="mf jx ht bd jy mg mh mi kc mj mk ml kg jb mm mn kk jf mo mp ko jj mq mr ks ms dt translated">加入一些机器学习</h2><p id="380f" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">现在我们已经完成了基本的设置，我们可以开始给我们的机器人添加一些智能。因为我们的目标是让我们的机器人回答问题，我们需要采取一点开放式的方法。不是每个人都用同样的方式提问。因此，我们需要一种方法来将不同的问题或短语与它们相关的主题相匹配，然后给出适当的答案。</p><p id="784f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">就像我可能会问:“几点了？”而你可以通过输入“给我当前时间”来问同样的问题这两个短语都可以匹配“当前时间”的主题，所以我们不能在代码中只使用严格的等式。我们将采用一些机器学习来完成这种模糊匹配。</p><p id="b879" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为此，我们首先需要一个训练数据集，其中包含一组预先填充的短语、相关标签和适当的响应或答案。训练数据格式将是JSON，它概述了一些代表一种问题类型的短语和关键字，以及当机器人看到类似这些短语或关键字的问题时应该做出响应的单个答案。例如，这里有一个只有两个主题的训练数据集，每个主题都有一组可能的短语和一个适当的响应:</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="9f80" class="mf jx ht mu b fv my mz l na nb">{<br/>    "self": {<br/>        "questions": [<br/>            "introduce yourself",<br/>            "sup",<br/>            "hi",<br/>            "hello"<br/>        ],<br/>        "answer": "Hello! I'm a chatbot tasked with answering your questions! `Beep, Boop` :robot_face:"<br/>    },<br/>    "world": {<br/>        "questions": [<br/>            "what is the world",<br/>            "answer to the universe and everything"<br/>        ],<br/>        "answer": "42"<br/>    }<br/>}</span></pre><p id="f5dd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将它放在项目根目录下名为<code class="eh ne nf ng mu b">trainingData.json</code>的文件中。</p><p id="810f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">每组问题和答案都有一个标签。这就是我们的机器人将如何尝试分类它收到的所有输入，并找出如何响应。</p><p id="dd53" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在，让我们添加一些代码来消耗数据并训练一个分类器，我们稍后可以使用它来智能地匹配和响应问题。我们可以创建一个简单的函数来读取我们的<code class="eh ne nf ng mu b">trainingData.json</code>文件，并将其转换成我们可以读取的JavaScript对象。</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="0928" class="mf jx ht mu b fv my mz l na nb">/**<br/> * Function to easily parse a given json file to a JavaScript Object<br/> * <br/> * <a class="ae jo" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> {String} filePath <br/> * <a class="ae jo" href="http://twitter.com/returns" rel="noopener ugc nofollow" target="_blank">@returns</a> {Object} Object parsed from json file provided<br/> */<br/>function parseTrainingData(filePath) {<br/>    const trainingFile = fs.readFileSync(filePath);<br/>    return JSON.parse(trainingFile);<br/>}</span></pre><p id="1427" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后我们可以像这样使用函数加载我们的训练数据。</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="e6d9" class="mf jx ht mu b fv my mz l na nb">// Load our training data<br/>const trainingData = parseTrainingData('./trainingData.json');</span></pre><p id="5f32" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来是创建一个所谓的分类器来消耗我们的训练数据，并创建一个机器学习模型，以便稍后根据它所学习的内容对传入的问题做出决策。基本上，给定我们提供的一组短语和响应，模型应该能够推断出对它认为与它以前见过的短语相似的短语提供什么响应。如果你想更多地了解机器学习中的分类器到底是什么，<a class="ae jo" href="https://www.udacity.com/course/intro-to-machine-learning--ud120" rel="noopener ugc nofollow" target="_blank">看看这个</a>。</p><p id="099b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将为此使用一个图书馆。因此，首先导入我们之前安装的<code class="eh ne nf ng mu b">natural</code>库，并在文件顶部创建一个新的<code class="eh ne nf ng mu b">LogisticRegressionClassifier</code>。</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="2abb" class="mf jx ht mu b fv my mz l na nb">const NLP = require('natural');<br/>// Create a new classifier to train<br/>const classifier = new NLP.LogisticRegressionClassifier();</span></pre><p id="29c7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来，我们需要一个分类器能够摄取训练样本的功能。在这种情况下:什么问题(短语)符合给定的答案类型(标签)。</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="c40f" class="mf jx ht mu b fv my mz l na nb">/**<br/> * Will add the phrases to the provided classifier under the given label.<br/> * <br/> * <a class="ae jo" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> {Object} classifier<br/> * <a class="ae jo" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> {String} label<br/> * <a class="ae jo" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> {Array.String} phrases<br/> */<br/>function trainClassifier(classifier, label, phrases) {<br/>    console.log('Teaching set', label, phrases);<br/>    phrases.forEach((phrase) =&gt; {<br/>        console.log(`Teaching single ${label}: ${phrase}`);<br/>        classifier.addDocument(phrase.toLowerCase(), label);<br/>    });<br/>}</span></pre><p id="19f9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我们有了一种方法让我们的机器人学习一些它可能看到的短语的例子，并对它们进行适当的分类，我们需要一种方法让它处理发送回一个适当的回复。</p><p id="b6eb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">由于我们的训练数据包括一个标签下的一组示例短语的答案，我们可以使用它让机器人发送回相同的回复。因此，如果我们的聊天机器人看到一条看起来像“sup”的传入消息，根据我们的训练数据，它应该用标签“self”对其进行分类，并发回与该标签相关联的答案:“Hello！我是负责回答你问题的聊天机器人！`哔，Boop` :robot_face:"。如果你需要再看一遍那个例子，回头看看<code class="eh ne nf ng mu b">trainingData.json</code>。</p><p id="a184" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">它考虑的一件事是，我们的分类器的猜测通常不会是完美的。每个猜测将具有与其相关联的不同置信度值，该置信度值对应于分类器将标签匹配到所提供的短语的置信度。因此，我们需要放入一些逻辑，只有当分类器非常确定它对如何标记输入短语有正确的猜测时才给出响应。如果没有，我们基本上会回答“\_(ツ)_/不知道你在说什么。我没有受过这方面的训练。”</p><p id="e114" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">解释了很多，让我们看看我们解释输入文本的函数是什么样子的。</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="3020" class="mf jx ht mu b fv my mz l na nb">/**<br/> * Uses the trained classifier to give a prediction of what<br/> * labels the provided pharse belongs to with a confidence<br/> * value associated with each and a a guess of what the actual<br/> * label should be based on the minConfidence threshold.<br/> * <br/> * <a class="ae jo" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> {String} phrase <br/> * <br/> * <a class="ae jo" href="http://twitter.com/returns" rel="noopener ugc nofollow" target="_blank">@returns</a> {Object}<br/> */<br/>function interpret(phrase) {<br/>    console.log('interpret', phrase);<br/>    const guesses = classifier.getClassifications(phrase.toLowerCase());<br/>    console.log('guesses', guesses);<br/>    const guess = guesses.reduce((x, y) =&gt; x &amp;&amp; x.value &gt; y.value ? x : y);<br/>    return {<br/>        probabilities: guesses,<br/>        guess: guess.value &gt; (0.7) ? guess.label : null<br/>    };<br/>}</span></pre><p id="08b2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">注意我们在哪里检查<code class="eh ne nf ng mu b">guess.value &gt; 0.7</code>。这意味着，如果我们的分类器不匹配置信度至少为70%的标签，那么我们说我们没有找到匹配。无论收到什么消息，都不匹配我们训练分类器响应的任何消息，所以我们返回<code class="eh ne nf ng mu b">null</code>和我们的\_(ツ)_/响应。</p><p id="7807" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这就像有人问你“几点了？”你确切地知道如何回答，因为你知道那个问题意味着什么，以及如何得到答案。如果有人在游戏中说“布拉根·弗洛斯特·比格巴”,你可能永远也不知道如何回应，所以你可能会吐出一个\_(ツ)_/。</p><p id="5f6f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">所以现在我们需要一个函数来匹配这个标签和对应于这个标签的答案。让我们修改我们的<code class="eh ne nf ng mu b">handleMessage</code>函数来做这件事。让我们<code class="eh ne nf ng mu b">interpret</code>消息是什么，然后使用我们的分类器生成的标签，根据我们的训练数据提供适当的答案，而不是对所有事情都发送相同的回复。如果我们解释消息的尝试没有产生结果，机器人可以简单地回答它不理解。</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="89cb" class="mf jx ht mu b fv my mz l na nb">/**<br/> * Callback function for BotKit to call. Provided are the speech<br/> * object to reply and the message that was provided as input.<br/> * Function will take the input message, attempt to label it <br/> * using the trained classifier, and return the corresponding<br/> * answer from the training data set. If no label can be matched<br/> * with the set confidence interval, it will respond back saying<br/> * the message was not able to be understood.<br/> * <br/> * <a class="ae jo" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> {Object} speech <br/> * <a class="ae jo" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> {Object} message <br/> */<br/>function handleMessage(speech, message) {<br/>    const interpretation = interpret(message.text);<br/>    console.log('InternChatBot heard: ', message.text);<br/>    console.log('InternChatBot interpretation: ', interpretation);</span><span id="af45" class="mf jx ht mu b fv nc mz l na nb">if (interpretation.guess &amp;&amp; trainingData[interpretation.guess]) {<br/>        console.log('Found response');<br/>        speech.reply(message, trainingData[interpretation.guess].answer);<br/>    } else {<br/>        console.log('Couldn\'t match phrase')<br/>        speech.reply(message, 'Sorry, I\'m not sure what you mean');<br/>    }<br/>}</span></pre><p id="1bba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，让我们通过调用我们刚刚创建的所有函数和现有的函数来让我们的机器人启动并运行。注意底部的代码基本上是一样的，除了我们这次修改了<code class="eh ne nf ng mu b">handleMessage</code>函数，使其更加智能。</p><pre class="lo lp lq lr fq mt mu mv mw aw mx dt"><span id="0f81" class="mf jx ht mu b fv my mz l na nb">// For each of the labels in our training data,<br/>// train and generate the classifier<br/>var i = 0;<br/>Object.keys(trainingData).forEach((element, key) =&gt; {<br/>    trainClassifier(classifier, element, trainingData[element].questions);<br/>    i++;<br/>    if (i === Object.keys(trainingData).length) {<br/>        classifier.train();<br/>        const filePath = './classifier.json';<br/>        classifier.save(filePath, (err, classifier) =&gt; {<br/>            if (err) {<br/>                console.error(err);<br/>            }<br/>            console.log('Created a Classifier file in ', filePath);<br/>        });<br/>    }<br/>});</span><span id="0f2b" class="mf jx ht mu b fv nc mz l na nb">// Configure the bot<br/>// .* means match any message test<br/>// The scopes we pass determine which kinds of messages we consider (in this case only direct message or mentions)<br/>// handleMessage is the function that will run when the bot matches a message based on the text and scope criteria<br/>Bot.hears('.*', scopes, handleMessage);</span><span id="943d" class="mf jx ht mu b fv nc mz l na nb">// Instantiate a chatbot using the previously defined template and API token<br/>// Open a connection to Slack's real time API to start messaging<br/>Bot.spawn({<br/>    token: token<br/>}).startRTM();</span></pre><h1 id="69e7" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">带它去兜风</h1><p id="bac4" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">让我们看看我们的机器人能做什么！继续运行控制台中项目目录根目录下的<code class="eh ne nf ng mu b">node index.js</code>。如果一切按计划进行，您应该看到您的机器人注入您的训练数据示例，并开始等待输入。</p><p id="9d58" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">回到Slack，试着让它介绍一下自己！</p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff ni"><img src="../Images/3e39aa7d7eff3276d92510996d9f32ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*03cYxuxELUoIsE5_5Zp5sg.png"/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">It’s alive! (and a little intelligent)</figcaption></figure><p id="f9a1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">问它一些你训练它去回应的事情！</p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff nj"><img src="../Images/256d32c4431cdcb2548320b38f1fd849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dbtx99vit0Q19INdUgh_lg.png"/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">Such wisdom</figcaption></figure><p id="5707" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你问它一些它没有被训练过的问题，期待一个合适的回答。</p><figure class="lo lp lq lr fq ls fe ff paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="fe ff nk"><img src="../Images/a2df7a92c5844bab639617115fb77ba2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uYcyfVwukojbgSxPPDfztw.png"/></div></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">But not magic</figcaption></figure><p id="4bfa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">但是你可以通过将它添加到你的训练数据中来训练机器人对此做出反应！只需创建一个新标签，并添加一些问题和您希望机器人回复的答案。</p><h1 id="6376" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dt translated">结论</h1><p id="4ceb" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">我本来打算写一些额外的东西，关于如何在某个地方部署机器人以及潜在的增强想法，但是这篇文章已经比我预期的要长了。我计划把这些想法写在后续的帖子里，并链接到这里。同时，请提出您的反馈意见。跟着走够容易吗？您在节点开发或ML概念方面的技能水平如何？也不要忘记分享你创造的酷机器人！</p><h2 id="64e1" class="mf jx ht bd jy mg mh mi kc mj mk ml kg jb mm mn kk jf mo mp ko jj mq mr ks ms dt translated">其他资源</h2><p id="e570" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">此处提供完整的代码示例:</p><div class="nl nm fm fo nn no"><a href="https://github.com/Nirespire/FAQBot" rel="noopener  ugc nofollow" target="_blank"><div class="np ab ej"><div class="nq ab nr cl cj ns"><h2 class="bd hu fv z el nt eo ep nu er et hs dt translated">Nirespire/FAQBot</h2><div class="nv l"><h3 class="bd b fv z el nt eo ep nu er et ek translated">FAQBot -一个Slackbot，用于使用基本的机器学习来回答问题</h3></div><div class="nw l"><p class="bd b gc z el nt eo ep nu er et ek translated">github.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc lx no"/></div></div></a></div><p id="08dc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Udacity机器学习简介:<a class="ae jo" href="https://www.udacity.com/course/intro-to-machine-learning--ud120" rel="noopener ugc nofollow" target="_blank">机器学习简介- ud120 </a></p><blockquote class="od"><p id="0893" class="oe of ht bd og oh oi oj ok ol om jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jo" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="mf jx ht bd jy mg on mi kc mj oo ml kg jb op mn kk jf oq mp ko jj or mr ks ms dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="kz la ht is b it ku ix kv jb os jf ot jj ou jn nd lf lg lh dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae jo" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated"><a class="ae jo" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae jo" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated"><a class="ae jo" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="450c" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated"><a class="ae jo" href="https://coincodecap.com/pionex-dual-investment" rel="noopener ugc nofollow" target="_blank"> Pionex双重投资</a> | <a class="ae jo" href="https://coincodecap.com/advcash-review" rel="noopener ugc nofollow" target="_blank"> AdvCash审查</a> | <a class="ae jo" href="https://coincodecap.com/uphold-review" rel="noopener ugc nofollow" target="_blank">光宗耀祖审查</a></li><li id="4c48" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated"><a class="ae jo" href="https://coincodecap.com/best-cryptocurrency-apis" rel="noopener ugc nofollow" target="_blank">面向开发者的8个最佳加密货币API</a></li><li id="db49" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated"><a class="ae jo" href="https://coincodecap.com/uphold-card-review" rel="noopener ugc nofollow" target="_blank">维护卡审核</a> | <a class="ae jo" href="https://coincodecap.com/trust-wallet-vs-metamask" rel="noopener ugc nofollow" target="_blank">信任钱包vs MetaMask </a></li><li id="0843" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated"><a class="ae jo" href="https://coincodecap.com/earn-sign-up-bonus" rel="noopener ugc nofollow" target="_blank">赢取注册奖金——10大最佳加密平台</a></li><li id="f33b" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae jo" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">面向开发人员的最佳加密API</a></li><li id="b359" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated">最佳<a class="ae jo" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="kz la ht is b it li ix lj jb lk jf ll jj lm jn nd lf lg lh dt translated">杠杆代币的终极指南</li></ul></div></div>    
</body>
</html>