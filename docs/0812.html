<html>
<head>
<title>Integrating physical devices with IOTA — WiFi edition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将物理设备与IOTA集成— WiFi版</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/integrating-physical-devices-with-iota-wifi-edition-9de749bc22f5?source=collection_archive---------3-----------------------#2018-06-21">https://medium.com/coinmonks/integrating-physical-devices-with-iota-wifi-edition-9de749bc22f5?source=collection_archive---------3-----------------------#2018-06-21</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="2331" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">关于将物理设备与IOTA协议集成的初学者教程系列的第二部分。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/9920aaada1d0c2e33f9d91b0e48561ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YF5cHGzDgGuKgIvJZRGFIQ.jpeg"/></div></div></figure><h1 id="cde2" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">介绍</h1><p id="24f9" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">这是初学者教程系列的第二部分，我们将探索如何将物理设备与IOTA协议集成在一起。在本教程中，我们基本上是在重现第一个教程中的用例。然而，这一次，我们将使用低成本的WiFi模块向继电器发送信号，而不是将我们的继电器模块硬连线到Raspberry PI。</p><p id="bdac" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你还没有阅读本系列的<a class="ae ld" rel="noopener" href="/@hugogregersen/integrating-physical-devices-with-iota-83f4e00cc5bb">第一教程</a>，你应该在继续之前阅读它，因为它反映了我们试图在第二教程中重现的相同的基本用例。</p><h1 id="3581" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">使用案例</h1><p id="90b2" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">现在，我们的前倾酒店老板已经安装了他的新IOTA驱动的冰箱支付系统，并按照<a class="ae ld" rel="noopener" href="/@hugogregersen/integrating-physical-devices-with-iota-83f4e00cc5bb">第一教程</a>中的描述工作，他开始注意到一些使解决方案不太理想的问题。首先，为每台冰箱配备一个专用的树莓酱是非常昂贵的，因为每个树莓酱大约要30-40美元。其次，如果他想修改Python代码，或者甚至更改IOTA支付地址，他必须访问每个PI并逐个手动更新它们。</p><p id="ef82" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这些问题的一个解决方案是拥有一个多通道继电器，一个中央Raspberry PI作为所有冰箱的公共控制单元，如第一篇教程<a class="ae ld" rel="noopener" href="/@hugogregersen/integrating-physical-devices-with-iota-83f4e00cc5bb">所述。坏消息是，他将不得不在中央PI和酒店的每台冰箱之间提供物理布线。此外，根据他的Raspberry PI上可用的GIO pin的数量，他可以管理的冰箱(继电器)的数量也是有限的。</a></p><p id="2bc3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在为这个问题绞尽脑汁几天后，他想出了一个显而易见的解决办法；如果他可以使用某种类型的无线通信来打开/关闭继电器，同时让他的Python代码在中央服务器上运行以方便更新和维护，会怎么样？</p><p id="8b84" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">幸运的是，这正是我们在第二节课要做的。</p><h1 id="a907" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">令人惊叹的ESP8266</h1><p id="bbb7" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">ESP8266是一款低成本WiFi微芯片，具有完整的TCP/IP堆栈和微控制器功能，可以使用Arduino IDE进行编程。基于ESP8266芯片，已经开发了大量不同形状和大小的不同WiFi模块，并且现在可以以非常低的成本在市场上获得，一个例子是ESP-01。带有内部可编程IO引脚的ESP-01非常适合简单的低成本WiFi项目。ESP8266还能够运行自己的web服务器，我们将在本项目中使用该服务器与WiFi模块进行通信。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff le"><img src="../Images/f8ef3731b09e392dc59c4833d0092686.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*G5op1P-JgKjvKoKFvXFhvQ.jpeg"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">The ESP-01</figcaption></figure><p id="93c4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">请注意，您甚至可以获得集成了ESP-01的继电器模块，以实现紧凑安装和最少布线。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff le"><img src="../Images/549a4318aa55271e8659b9e22e230f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*iomjofzeJupRK5RFJ7kAfA.jpeg"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">Relay module with integrated ESP-01</figcaption></figure><p id="7643" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="lj">注意！<br/>如上所述，市场上有大量基于ESP8266芯片的不同WiFi模块，其中大多数可能同样适用于我们的项目。ESP-01因其低成本和小外形而备受关注。但是，应该注意的是，ESP-01没有集成的USB端口，用于将我们的Arduino代码/固件上传到微控制器。没有一个内置的USB端口使得这个初学者教程有点复杂(特别是没有ESP-01接口模块)。因此，而不是使用ESP-01我会使用我信任的WeMos D1无线板通过这个教程，因为它已经有一个内置的USB端口，电源插座等。使它基本上即插即用。</em></p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/6863d088584f3a30e4fbb2b0ddf71767.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*8XkemkA0i2wP3cvuF-V_Wg.jpeg"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">The WeMos D1 WiFi board</figcaption></figure><h1 id="dac8" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">Arduino IDE</h1><p id="7733" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">对ESP8266编程最简单的方法是使用Arduino IDE。在ide中，您只需选择您拥有的ESP8266板的类型，就可以编译代码并上传到MCU。Arduino IDE中使用的编程语法是一种类似C++的编程语言，用于在流行的Arduino原型和开发平台上进行编程。Arduino IDE可以在这里免费下载<a class="ae ld" href="https://www.arduino.cc/en/Main/Software?" rel="noopener ugc nofollow" target="_blank">。要了解有关使用Arduino IDE配置和编程您的ESP8266板的更多信息，您应该查看特定ESP8266板附带的文档。</a></p><h1 id="88a7" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">成分</h1><p id="f69a" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">在这一节中，我们将看看构建项目所需的组件。假设你已经拥有一台能够运行Pyhon的电脑，你应该能够在大多数电子商店或EBAY/AMAZON上以低于20美元的价格获得它们。计算机将充当我们的中央控制单元，与IOTA tangle通信，并向我们的ESP8266 WiFi模块发送HTTP请求。如果你遵循了第一个教程<a class="ae ld" rel="noopener" href="/@hugogregersen/integrating-physical-devices-with-iota-83f4e00cc5bb">的话</a>你可能还拥有一个树莓派，在这个教程中它可以作为中央电脑。</p><p id="2913" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">启用ESP8266的WiFi模块</strong> <br/>启用ESP8266的WiFi模块用于无线通信，并使用其内置的IO引脚对我们的继电器进行开/关切换。市场上有许多WiFi模块的变体，其中任何一个都应该适用于我们的项目。我建议你选择一个有内置USB接口的模块，因为它会让你上传代码(arduino草图)更容易。在本教程的其余部分，我将使用我的WeMos D1无线板。点击<a class="ae ld" href="http://cyaninfinite.com/tutorials/getting-started-with-the-wemos-d1-esp8266-wifi-board/" rel="noopener ugc nofollow" target="_blank">此处</a>了解更多关于使用带Arduino IDE的WeMos D1 WiFi板的信息。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/6863d088584f3a30e4fbb2b0ddf71767.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*8XkemkA0i2wP3cvuF-V_Wg.jpeg"/></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">The WeMos D1 WiFi board</figcaption></figure><p id="e01e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">继电器</strong> <br/>继电器用于打开/关闭我们的电源电路，从而打开/关闭我们的设备(在这种情况下是LED)。为了简化我们的电路，我们将使用一个继电器模块(屏蔽)，该模块内置了所有必需的组件、引脚和连接器。请注意，您可以购买带有多个继电器(通道)的模块，这些继电器可以单独打开/关闭。如前所述，这在需要管理多个设备的情况下非常有用。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff le"><img src="../Images/6cfbc93732237e23bdf57bef3fe2c372.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*4ktyvSuyTd6_jlAmj2ZaOQ.jpeg"/></div></figure><p id="ee05" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">试验板</strong> <br/>试验板用于连接我们的电路，无需任何焊接，便于组装和拆卸。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ll"><img src="../Images/12a2d7b42ff18495711f7915aa9ab076.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*Igi0Nd93Vu08Sb4N_jEV9Q.jpeg"/></div></figure><p id="b29e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">发光二极管(LED)</strong><br/>LED通电后会亮起，代表我们在这个项目中的物理设备(冰箱)。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff le"><img src="../Images/a5f93ed7f19ef6871f7705e3e0b2e726.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*7yFEMtUvCuieBwPzlCmQpA.jpeg"/></div></figure><p id="6a64" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">电阻器(330欧姆)</strong> <br/>电阻器用于限制发送到我们LED的电流。如果没有电阻器，您可能会损坏LED和/或树莓PI。您应该使用的电阻类型取决于LED的类型和您提供给电路的电压量。在我的情况下，我使用9V电池，所以330欧姆电阻应该没问题。我建议你根据你的项目版本中使用的元件来研究你应该使用什么类型的电阻。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lm"><img src="../Images/eb6b9bc3cdf6d0993c8b16eb5e541a4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*WmcyYVlVm0IJtKlvjSO7cQ.jpeg"/></div></figure><p id="e094" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">电池</strong> <br/>电池是用来给我们的电源电路提供电力的。在我的情况下，我使用9V电池。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ln"><img src="../Images/0c59c5adfcd7d8fefc5403492d600abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*KR1UwBURPs_TN9ISPwmH2A.jpeg"/></div></figure><p id="6502" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">电线我们还需要一些电线把它们连接起来。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff le"><img src="../Images/858201d526239d9d30cbf006c45322d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*zJ5LOJ-NyWiUYlMq-8s1tw.jpeg"/></div></figure><p id="6e51" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">二维码</strong> <br/>如果您想使用IOTA移动钱包支付LED，打印的IOTA支付地址二维码非常方便。使用IOTA钱包生成新地址或在<a class="ae ld" href="https://thetangle.org" rel="noopener ugc nofollow" target="_blank">https://thetangle.org</a>搜索现有地址时，您会发现一个二维码</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lo"><img src="../Images/23692931ed04f877e40ee1d0642725f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:326/format:webp/1*0Birfy2lGcfHKVHgxvEEPQ.png"/></div></figure><p id="ac8b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">一台计算机</strong> <br/>一台能够运行Python的计算机，用于与IOTA tangle通信，并向我们的WiFi模块发送HTTP请求。你基本上可以使用任何联网的电脑，包括Raspberry PI。</p><h1 id="37b6" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">为项目布线</h1><p id="a633" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">现在，让我们看看如何连接这个项目中使用的电路。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff lp"><img src="../Images/eca2a4e242da7a25b6e913b86fed0208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AdokhyEJbRnaQymSbbcE8A.png"/></div></div><figcaption class="lf lg fg fe ff lh li bd b be z ek">Wiring the project</figcaption></figure><p id="6c81" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">按照以下方式连接电路:</p><ol class=""><li id="12dc" class="lq lr ht is b it iu ix iy jb ls jf lt jj lu jn lv lw lx ly dt translated">将5伏电压从WeMos D1连接到继电器模块上的VCC引脚。</li><li id="0f4e" class="lq lr ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated">将GND从WeMos D1连接到继电器模块上的GND引脚。</li><li id="bd07" class="lq lr ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated">将WeMos D1上的D14/SDA/D4连接到继电器模块上的IN(信号)引脚。</li><li id="a242" class="lq lr ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated">将继电器模块上的COM端子连接到蓄电池的正极(+)。</li><li id="f533" class="lq lr ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated">将继电器模块上的NO端子连接到LED的阳极(+)侧，中间有电阻器。</li><li id="d8e4" class="lq lr ht is b it lz ix ma jb mb jf mc jj md jn lv lw lx ly dt translated">将电池的负极(-)连接到LED的正极(-)侧。</li></ol><p id="846f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="lj">注意！<br/>请注意LED上的两个引脚长度不同。短引脚代表LED的阴极(-)侧，长引脚代表阳极(+)侧。</em></p><h1 id="6383" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">所需的软件和库</h1><p id="80a9" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">与我们在Raspberry PI上运行所有软件的第一个教程相反，我们现在需要将代码分成几个部分，在中央控制单元上运行一些Python代码，这些代码与IOTA tangle交互，并向我们的WiFi模块发送HTTP请求。我们还需要一些运行在WiFi模块上的Arduino代码，用于监听HTTP请求和处理WiFi模块上的IO引脚。</p><p id="0287" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你还没有并且需要在中央电脑上安装Python，你可以在这里找到:<a class="ae ld" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">https://www.python.org/downloads/</a></p><p id="59bc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您还需要在中央计算机上安装PyOTA API库，这将允许我们使用Python编程语言访问IOTA tangle。包含安装说明的PyIOTA API库可以在这里找到:<a class="ae ld" href="https://github.com/iotaledger/iota.lib.py" rel="noopener ugc nofollow" target="_blank">https://github.com/iotaledger/iota.lib.py</a></p><p id="e723" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了使用Python发送HTTP请求，您还需要在中央计算机上安装httplib2库。带有安装说明的httplib2可以在这里找到:<a class="ae ld" href="https://github.com/httplib2/httplib2" rel="noopener ugc nofollow" target="_blank">https://github.com/httplib2/httplib2</a></p><h1 id="26f3" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">Arduino代码</h1><p id="dc5d" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">首先，让我们看看将在我们的ESP8266 WiFi模块上运行的Arduino代码。这里发生的事情是，我们首先定义用于向继电器模块发送信号的引脚。其次，我们使用提供的ssid和密码连接到WiFi网络，因此<strong class="is hu">使用您的WiFi凭据更新代码很重要</strong>。接下来，我们启动允许我们监听HTTP请求的HTTP服务器，最后我们开始监听传入的HTTP请求，相应地将中继引脚设置为高或低。</p><p id="e326" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="lj">注意！<br/>在现实生活中，您可能希望为WiFi模块分配一个静态IP地址，防止它在断电等情况下获得新的IP地址。在本教程中，我不打算分配静态IP地址，只需注意，WiFi模块使用的实际IP地址会在Arduino串行监视器中显示出来，这是在该模块加电或复位时显示的。记下这个IP地址，因为我们稍后将在Python代码中使用它。</em></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="0b62" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个项目的Arduino源代码可以在<a class="ae ld" href="https://gist.github.com/huggre/aed0baaef3dc7cf8dd80d925da2b8482" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="391f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要将上述代码上传到您的WiFi模块，您首先必须安装Arduino IDE，并确保您能够使用USB电缆与WiFi模块正确通信。我不会详细介绍如何使用Arduino IDE设置和配置您的主板，因为这因主板而异。我建议你面对与你的特定董事会相关的文件。当您的主板在Arduino IDE下正常工作时，您只需下载上面的代码，在Arduino IDE中打开代码，然后按下上传按钮。</p><h1 id="1887" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">Python代码</h1><p id="f5d7" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">现在，让我们看看在我们的中央计算机上运行的Python代码。好消息是代码和我们在第一个教程中的代码差不多。唯一的区别是，我们现在向WiFi模块发送HTTP请求，让它负责打开/关闭中继，而不是将Raspberry PI GIO引脚设置为高或低。<strong class="is hu">确保使用WiFi模块的IP地址更新url_on和url_off变量。当启动或重置WiFi模块时，您会在Arduino IDE串行监视器中看到此IP地址。</strong></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="f7c0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个项目的Python源代码可以在<a class="ae ld" href="https://gist.github.com/huggre/08090b9f5ad06707c91b2c0eeba990be" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p><h1 id="0a92" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">运行项目</h1><p id="6b0d" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">要运行该项目，您首先需要启动WiFi模块，以便它开始侦听来自中央计算机的HTTP请求。</p><p id="e711" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">其次，您需要在中央服务器上启动Python程序。</p><p id="5f0a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">注意Python程序文件使用。py扩展名，所以我们先把Python文件保存为<strong class="is hu"><em class="lj">let _ there _ light _ wifi . py</em></strong>在电脑上。</p><p id="613a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要执行该程序，只需启动一个新的终端窗口，导航到您保存<em class="lj">let _ there _ be _ light _ wifi . py</em>的文件夹，然后键入:</p><p id="6cb9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">python let _ there _ be _ light _ wifi . py</strong></p><p id="3006" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在，您应该可以在终端窗口中看到正在执行的代码，显示您当前的光余额，并每10秒钟检查一次LED的IOTA地址余额，以获得新的资金。</p><h1 id="1962" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">支付光</h1><p id="10b7" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">要打开LED，您只需使用您最喜欢的IOTA钱包，并将一些IOTA转移到LED的IOTA地址。一旦IOTA tangle确认了交易，LED就会亮起，并一直亮着，直到根据您传输的IOTA的数量，余额用完为止。在我的例子中，我将1秒钟的光的IOTA/光比率设置为1 IOTA。</p><p id="d020" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="lj">注意！<br/>如果使用手机钱包支付电费，您可以考虑打印一个二维码，方便您随时扫描支付电费。</em></p></div><div class="ab cl mg mh hb mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hm hn ho hp hq"><h1 id="d297" class="ka kb ht bd kc kd mn kf kg kh mo kj kk kl mp kn ko kp mq kr ks kt mr kv kw kx dt translated">下一步是什么？</h1><p id="01a0" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">你可以在这里找到这个系列下一个教程的链接</p></div><div class="ab cl mg mh hb mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hm hn ho hp hq"><h1 id="2f1a" class="ka kb ht bd kc kd mn kf kg kh mo kj kk kl mp kn ko kp mq kr ks kt mr kv kw kx dt translated">贡献</h1><p id="aedb" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">如果你想对本教程有所贡献，你可以在这里找到一个Github库<a class="ae ld" href="https://github.com/huggre/pay_the_light_wifi" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl mg mh hb mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hm hn ho hp hq"><h1 id="7564" class="ka kb ht bd kc kd mn kf kg kh mo kj kk kl mp kn ko kp mq kr ks kt mr kv kw kx dt translated">捐款</h1><p id="e10a" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">如果您喜欢本教程，并希望我继续制作其他教程，请随意向Python代码中使用的IOTA地址捐款。此外，在构建和测试您的项目版本时，请随意使用相同的IOTA地址，这样，每当我(和您)的LED灯亮起时，它都会很好地提醒我(我们)有人正在使用本教程。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff ms"><img src="../Images/f898855aa9f02c497078a9bdbee25534.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*j2ENIzmDzXcGSgAdY4w-Jw.png"/></div></figure><p id="01d6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">nyzbhovsmdwabxsacajttwjoqrvvawlbsfqvsjswwbjjlsqknzfc 9 xcrpqsvfqzpbjcjrannpvmmezqjrqsvvgz</p></div></div>    
</body>
</html>