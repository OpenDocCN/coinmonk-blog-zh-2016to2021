<html>
<head>
<title>Predicting Bitcoin prices using linear regression and gradient descent.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用线性回归和梯度下降预测比特币价格。</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/predicting-bitcoin-prices-using-linear-regression-and-gradient-descent-b1ec122ed5ee?source=collection_archive---------1-----------------------#2018-08-10">https://medium.com/coinmonks/predicting-bitcoin-prices-using-linear-regression-and-gradient-descent-b1ec122ed5ee?source=collection_archive---------1-----------------------#2018-08-10</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/7c2ea24a80249bf99c2ddba5b976724b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Lt-aAsJDXg3cunlreamsQ.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="f785" class="pw-subtitle-paragraph jb id ie bd b jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ek translated">在这篇文章中，我将使用比特币价格及其在谷歌上的搜索次数作为数据，展示梯度下降与线性回归的结合是如何工作的。</h2></div><p id="8e24" class="pw-post-body-paragraph jt ju ie jv b jw jx jf jy jz ka ji kb kc kd ke kf kg kh ki kj kk kl km kn ko hm dt translated">让我们假设比特币在谷歌上被搜索的次数与其价格之间存在关系，如果我们绘制一张图表，其中x<em class="kp">-轴</em>是搜索次数，<em class="kp"> y </em>是价格，我们可以注意到比特币获得更多搜索时价格上涨的线性模式。</p><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff kq"><img src="../Images/b787e0735ce3a74092d9f4aa2253363c.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*5Tczeg1ZkDqdTvlRr2EaNQ.png"/></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">y-axis is the price in US$ and x is the number of searches.</figcaption></figure><blockquote class="kz la lb"><p id="4b66" class="jt ju kp jv b jw jx jf jy jz ka ji kb lc kd ke kf ld kh ki kj le kl km kn ko hm dt translated"><em class="ie">这篇文章的重点是展示梯度下降是如何工作的。</em> <strong class="jv if"> <em class="ie">没有一个准确的比特币价格预测。</em>T9】</strong></p></blockquote><p id="1e49" class="pw-post-body-paragraph jt ju ie jv b jw jx jf jy jz ka ji kb kc kd ke kf kg kh ki kj kk kl km kn ko hm dt translated">我们可以沿着线性模式画一条线，但是为了有一个准确的预测，这条线必须靠近数据点。</p><h1 id="fe45" class="lf lg ie bd lh li lj lk ll lm ln lo lp jk lq jl lr jn ls jo lt jq lu jr lv lw dt translated">用等式画线:</h1><pre class="kr ks kt ku fq lx ly lz ma aw mb dt"><span id="a386" class="mc lg ie ly b fv md me l mf mg">y = mx + b</span></pre><p id="c0b1" class="pw-post-body-paragraph jt ju ie jv b jw jx jf jy jz ka ji kb kc kd ke kf kg kh ki kj kk kl km kn ko hm dt translated">其中<em class="kp"> m </em>是直线斜率，而<em class="kp"> b </em>是直线与y轴相交的位置。然而，我们如何为它们找到最佳值呢？有一种叫做梯度下降的技术可以帮助我们找到最优值。</p><h2 id="5603" class="mc lg ie bd lh mh mi mj ll mk ml mm lp kc mn mo lr kg mp mq lt kk mr ms lv mt dt translated">什么是梯度下降</h2><p id="afbf" class="pw-post-body-paragraph jt ju ie jv b jw mu jf jy jz mv ji kb kc mw ke kf kg mx ki kj kk my km kn ko hm dt translated">梯度下降是一种优化技术，有助于减少由误差函数产生的误差，这里的误差函数是误差平方的<a class="ae mz" href="https://www.wikiwand.com/en/Residual_sum_of_squares" rel="noopener ugc nofollow" target="_blank">和<strong class="jv if">。</strong></a></p><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff na"><img src="../Images/1ecaffa8bbc664e638437065cff341b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/0*jCmg2-pnyTnRwxKU.JPG"/></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">Imagine this line was drawn with guessed values for `m` and `b`. The error is the sum of the distance from the points to the line squared and divided by the number of points</figcaption></figure><h2 id="cc9c" class="mc lg ie bd lh mh mi mj ll mk ml mm lp kc mn mo lr kg mp mq lt kk mr ms lv mt dt translated">我们怎样才能减少误差？</h2><p id="baeb" class="pw-post-body-paragraph jt ju ie jv b jw mu jf jy jz mv ji kb kc mw ke kf kg mx ki kj kk my km kn ko hm dt translated">我们可以盲目猜测m<em class="kp">和b</em>和<em class="kp">T21的值，并检查误差是否减小，然而这种方法是不合理的。如果我们计算偏导数，我们将知道误差值移动得有多快，因此我们可以灵活地更新这些值。想象一个向下移动的球，底部是我们想要到达的地方，导数会告诉我们如何更新值以接近底部。</em></p><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff nb"><img src="../Images/9f33d313516db052d1214e0dbfc327a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*MsjIMWTVdgqcbPJi.jpg"/></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">In our case the x-axis is `m` or `b` <strong class="bd nc">not w</strong>.</figcaption></figure></div><div class="ab cl nd ne hb nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="hm hn ho hp hq"><h1 id="7f3a" class="lf lg ie bd lh li nk lk ll lm nl lo lp jk nm jl lr jn nn jo lt jq no jr lv lw dt translated">用Python和numpy查找m和b。</h1><h2 id="b6c4" class="mc lg ie bd lh mh mi mj ll mk ml mm lp kc mn mo lr kg mp mq lt kk mr ms lv mt dt translated">我们要做的是:</h2><ol class=""><li id="806f" class="np nq ie jv b jw mu jz mv kc nr kg ns kk nt ko nu nv nw nx dt translated">提取比特币价格和谷歌搜索次数。</li><li id="9da6" class="np nq ie jv b jw ny jz nz kc oa kg ob kk oc ko nu nv nw nx dt translated">将价格与搜索日期匹配。</li><li id="3fd5" class="np nq ie jv b jw ny jz nz kc oa kg ob kk oc ko nu nv nw nx dt translated">设置超级参数:<em class="kp"> m </em>和<em class="kp"> b </em>的历元、学习率和初始值。</li><li id="0ecd" class="np nq ie jv b jw ny jz nz kc oa kg ob kk oc ko nu nv nw nx dt translated">计算误差来检查我们的算法学习。</li><li id="93d2" class="np nq ie jv b jw ny jz nz kc oa kg ob kk oc ko nu nv nw nx dt translated">计算梯度:<em class="kp"> m </em>的导数和<em class="kp"> b </em>的导数。</li><li id="6120" class="np nq ie jv b jw ny jz nz kc oa kg ob kk oc ko nu nv nw nx dt translated">乘以学习率，并用当前<em class="kp"> m </em>和<em class="kp"> b </em>的差值进行更新。</li></ol></div><div class="ab cl nd ne hb nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="hm hn ho hp hq"><h2 id="0764" class="mc lg ie bd lh mh mi mj ll mk ml mm lp kc mn mo lr kg mp mq lt kk mr ms lv mt dt translated">提取比特币价格、谷歌搜索次数，并将价格与搜索日期匹配..</h2><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="od oe l"/></div></figure><h2 id="6c6a" class="mc lg ie bd lh mh mi mj ll mk ml mm lp kc mn mo lr kg mp mq lt kk mr ms lv mt dt translated">设置超级参数:<em class="of"> m </em>和<em class="of"> b </em>的纪元、学习率和初始值。</h2><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="od oe l"/></div></figure><h2 id="65bf" class="mc lg ie bd lh mh mi mj ll mk ml mm lp kc mn mo lr kg mp mq lt kk mr ms lv mt dt translated">计算误差来检查我们的算法学习。</h2><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="od oe l"/></div></figure><h2 id="ee9c" class="mc lg ie bd lh mh mi mj ll mk ml mm lp kc mn mo lr kg mp mq lt kk mr ms lv mt dt translated">计算梯度:对<em class="of"> m </em>的偏导数和对<em class="of"> b的偏导数，然后m </em>乘以学习率，并用当前<em class="of"> m </em>和<em class="of"> b </em>的差值进行更新。</h2><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="od oe l"/></div></figure><h1 id="97f4" class="lf lg ie bd lh li lj lk ll lm ln lo lp jk lq jl lr jn ls jo lt jq lu jr lv lw dt translated">把所有东西放在一起</h1><figure class="kr ks kt ku fq hv"><div class="bz el l di"><div class="od oe l"/></div></figure><h1 id="08a6" class="lf lg ie bd lh li lj lk ll lm ln lo lp jk lq jl lr jn ls jo lt jq lu jr lv lw dt translated">画一条最符合我们数据的线</h1><figure class="kr ks kt ku fq hv fe ff paragraph-image"><div class="fe ff kq"><img src="../Images/7009c24f28bf05a94c137ca72c25a2cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*pIfAcho1Y7GviupbWG4nAA.png"/></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">With optimal values of `m` and `b` we can draw a line that is closer to the points.</figcaption></figure><p id="5c42" class="pw-post-body-paragraph jt ju ie jv b jw jx jf jy jz ka ji kb kc kd ke kf kg kh ki kj kk kl km kn ko hm dt translated">由于梯度下降，我们能够在我们想要的方向上更新值，并降低了误差率，从而得到符合我们数据的线。你可以在github 上找到完整的笔记本。</p><h1 id="31c9" class="lf lg ie bd lh li lj lk ll lm ln lo lp jk lq jl lr jn ls jo lt jq lu jr lv lw dt translated">参考资料:</h1><ul class=""><li id="36c6" class="np nq ie jv b jw mu jz mv kc nr kg ns kk nt ko og nv nw nx dt translated"><a class="ae mz" href="https://github.com/llSourcell/linear_regression_live" rel="noopener ugc nofollow" target="_blank">https://github.com/llSourcell/linear_regression_live</a></li><li id="ff94" class="np nq ie jv b jw ny jz nz kc oa kg ob kk oc ko og nv nw nx dt translated"><a class="ae mz" href="https://www.wikiwand.com/en/Linear_regression" rel="noopener ugc nofollow" target="_blank">https://www.wikiwand.com/en/Linear_regression</a></li></ul></div></div>    
</body>
</html>