<html>
<head>
<title>Bitcoin Price Prediction — How to Compare Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比特币价格预测——如何比较模型</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/bitcoin-price-prediction-how-to-compare-models-e81aa31bd7a0?source=collection_archive---------3-----------------------#2020-02-21">https://medium.com/coinmonks/bitcoin-price-prediction-how-to-compare-models-e81aa31bd7a0?source=collection_archive---------3-----------------------#2020-02-21</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/e6de076e1c47422acd805cd6494b31c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xLCecur8U9b0ZXlOxtl6Uw.jpeg"/></div></div></figure><p id="318a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们如何选择比特币价格预测的最佳方法？在这篇文章中，我们用不同的机器学习方法来解释我们在2019年发表的<a class="ae jz" href="https://ieeexplore.ieee.org/abstract/document/8963009" rel="noopener ugc nofollow" target="_blank">篇文章</a>对比特币价格的预测。探讨的技术有LSTM、韦弗内特、ARIMA、SVM和随机森林。</p><p id="0b26" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们如何确定选择的模型是不是最好的？模型比较问题可能是数据科学家/机器学习工程的主要关注点之一。在价格预测领域，有一堆科学家通常遵循的方法。我们将列出一些方法来更好地比较模型，并提供其操作的直观性。</p><h1 id="c60e" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">滚动窗</h1><p id="6697" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">在机器学习实验中，将数据集分为训练、验证和测试部分是一个标准过程。通过这种划分，可以对模型进行训练，并在训练阶段进行评估，以找到更好地概括问题的模型，从而避免过度拟合。最后，对模型进行测试，并生成误差度量，以便与其他模型进行比较。</p><p id="e685" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">同样常见的是使用k倍交叉验证技术来提供误差分布，从而可以推断模型之间是否不同。</p><p id="8cf2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">例如，如果我们训练一个模型来预测时间序列的未来价格，我们将生成一系列预测值，这些预测值将与原始值集进行比较。然后，错误源自许多可用错误度量(例如，MAPE、MPE、RMSE、MSE)中的一个。</p><p id="dfba" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">然而，唯一的问题是偏向测试集的选择。有可能所使用的测试集明显更适合该模型，从而导致它具有异常的性能。</p><p id="6c6c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果我们提供的不是一个测试集的误差度量，而是相同误差度量在不同测试集上的分布，那么避免测试偏差是可能的。k倍方法可以产生这种分布。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ld"><img src="../Images/259562bb55c9585603533d5b61e048d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EU7hSJ8oHcgoaomr.png"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">k-fold representation — <a class="ae jz" href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)" rel="noopener ugc nofollow" target="_blank">Wikipedia </a>Figure</figcaption></figure><p id="5b2c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">k-fold主要做的是将数据集分成许多训练集和测试集，以便我们可以获得所选误差度量的分布。有了误差分布，就有可能计算出均值和标准差，所以我们有了一个更好的概念模型在不同的时间序列制度下的行为。</p><p id="db68" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">k-fold提出的形式不一定适合于时间序列预测问题。有一个假设是，训练集必须具有连续性，必须在测试集之前，以最大限度地提高性能。因此，滚动窗口方法作为一种不同的k倍激增。</p><p id="e501" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">通过将训练集、验证集和测试集移动预定的大小，可以获得保持连续性的不同集，并且训练集在测试集之前。这种技术也被称为<a class="ae jz" href="https://en.wikipedia.org/wiki/Walk_forward_optimization" rel="noopener ugc nofollow" target="_blank">向前走测试</a>。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff lm"><img src="../Images/cce482b8bd87a25f9e46e9a204b7980b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*ZIC2z_sh59JFjtRnfSamxg.png"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Rolling Window visualization</figcaption></figure><h1 id="b90f" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">超参数搜索</h1><p id="8661" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">一个重要的方面是超参数对模型比较的影响，这个方面通常不被视为对不同出版物的偏见。</p><p id="dee9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">首先，我们如何定义什么是超参数？一个直接的定义是，超参数是一个参数，其值在学习过程开始之前设置。在训练阶段，只有模型参数将被修改以适合函数，而不是超参数。</p><p id="8ee3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在我们的<a class="ae jz" href="https://ieeexplore.ieee.org/abstract/document/8963009" rel="noopener ugc nofollow" target="_blank">出版的著作</a> k中，我们探索了所有比较算法的超参数的随机搜索优化(在此检查使用<a class="ae jz" rel="noopener" href="/@cjl2fv/an-intro-to-hyper-parameter-optimization-using-grid-search-and-random-search-d73b9834ca0a">随机搜索</a>的论证)。这种方法避免了超参数偏差。对于小样本的超参数，新算法测试可能比其他算法具有更好的性能。然而，对于所有可能的结果，新算法并不是更好。</p><p id="1e8f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">可以应用许多不同的超参数优化方法，但是它们应该足够简单，以便用于所有比较的模型。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ln"><img src="../Images/44d55661d974f65745d6f70f9e10d06a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qzN6CSwP62xgU9UC.png"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Image Source: Bergstra, J., Bengio, Y.: Random search for hyper-parameter optimization. Journal of Machine Learning Research 13, 281–305 (2012)</figcaption></figure><h1 id="0cd6" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">差异的统计显著性</h1><p id="df5d" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">既然建立了最佳超参数组合的误差分布，就有可能发现对于所有的机器学习算法，我们如何能确定分布的均值是不同的？</p><p id="8760" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">有许多统计测试可以用来比较两种不同的分布。下图给出了一个令人惊叹的总结:</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lo"><img src="../Images/f07cea29d05b4ced8dce23784ce06281.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bIXoaJ4T5OtSKWUo.gif"/></div></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Source: Waning B, Montagne M: Pharmacoepidemiology: Principles and Practice: <a class="ae jz" href="http://acesspharmacy.com" rel="noopener ugc nofollow" target="_blank">http://acesspharmacy.com</a></figcaption></figure><p id="feaa" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">从上图可以得出结论，我们有一些基本问题，例如:</p><p id="0098" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我的数据是连续的还是离散的？通常，对于比特币时间序列，我们分析的是价格历史，这是连续的数据，预测也可以是连续的，如未来价格或未来回报。通过对价格是上涨还是下跌进行分类，可以将连续数据转化为离散预测。输入也可以是离散数据，例如新闻的NLP分析的情感或与资产相关联的任何一般分类数据。</p><p id="a2ce" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">对于只有一个变量的连续数据，一个重要的检验是正态性检验。科尔莫戈罗夫-斯米尔诺夫检验或T2夏皮罗-维尔克检验可以验证正态性。如果有一个以上的自变量，你应该使用卡方检验、G检验、费雪精确检验或二项式检验。下图显示了要遵循的另一个决策流程(抱歉使用了这种语言)。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff lp"><img src="../Images/6c3f13ab6610cfeb260c8b2da7d3df5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/0*oJzXeY031kAKpej1"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Source: Marco Mello (http://marcoarmello.wordpress.com)</figcaption></figure><h1 id="448d" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">最后评论和结论</h1><p id="5611" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">为了公平地比较模型，有许多可能的方法，这里只探讨了其中的几个，没有进入细节。统一它并处理所有潜在的偏见和问题有时会在计算上很昂贵。出于学术目的，所用的方法很大程度上取决于你要在哪里发表论文和问题的类型。</p><p id="1cf9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在应用了所有的方法之后，我们可以生成结果，如我们的<a class="ae jz" href="https://ieeexplore.ieee.org/abstract/document/8963009" rel="noopener ugc nofollow" target="_blank">文章</a>所示。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff lq"><img src="../Images/d21e4265c9f62f4fbce8fad556dffbcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*PLvb_yQ-2IlEI5hJmVLvWg.png"/></div><figcaption class="li lj fg fe ff lk ll bd b be z ek">Table from our published article</figcaption></figure><p id="3aa1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这些结果超过了比特币的时间序列预测。ARIMA和SVR甚至在应用了前面描述的所有方法之后仍具有最佳性能。这项研究的一个主要问题是使用绝对价格值，而不是回报率，这可能会影响模型拟合。</p></div><div class="ab cl lr ls hb lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hm hn ho hp hq"><p id="28e6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">为了将来的参考和更多的细节，你可以访问原始出版物:<a class="ae jz" href="https://ieeexplore.ieee.org/abstract/document/8963009" rel="noopener ugc nofollow" target="_blank">https://ieeexplore.ieee.org/abstract/document/8963009</a></p><p id="e8f9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">此外，对于测试和复制，所有代码都可以在<a class="ae jz" href="https://github.com/leokan92/model_comparison" rel="noopener ugc nofollow" target="_blank"> GitHub </a>中获得</p><blockquote class="ly"><p id="9613" class="lz ma ht bd mb mc md me mf mg mh jy ek translated"><a class="ae jz" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="mi mj mk ml mm iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff lp"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mn"><img src="../Images/e9dbce386c4f90837b5db529a4c87766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fZu_SfnNF6m_BGbXlsl-A@2x.png"/></div></div></figure></div></div>    
</body>
</html>