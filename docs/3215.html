<html>
<head>
<title>Deploy Ethereum Smart Contract With Constructor Parameters Using NodeJs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NodeJs部署带有构造函数参数的以太坊智能合约</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/deploy-ethereum-smart-contract-with-constructor-parameters-using-nodejs-3771f2b1c539?source=collection_archive---------0-----------------------#2020-07-30">https://medium.com/coinmonks/deploy-ethereum-smart-contract-with-constructor-parameters-using-nodejs-3771f2b1c539?source=collection_archive---------0-----------------------#2020-07-30</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/38ef028e50796b388222c1eb53da15b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pGm6-Ptr7DLX2tUfTrvEwQ.png"/></div></div></figure><p id="7f6b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">今天，我们有足够的资源来开始区块链、以太坊、智能合约，开发基于区块链的应用程序。</p><p id="cfc0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们有时需要在旅途中从我们的应用程序部署契约。例如，在创建具有独立属性的新报价的情况下。这篇文章是关于我在部署带有构造函数参数的契约时所面临的问题之一，以及我解决它的方法。</p><p id="52f8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">作为先决条件，最好先了解Solidity、NodeJs以及Truffle和Web3之类的工具。</p><p id="a143" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们一起经历所有的步骤。</p></div><div class="ab cl jz ka hb kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hm hn ho hp hq"><h1 id="2ba5" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">初始化NPM软件包并安装依赖项:</h1><p id="082e" class="pw-post-body-paragraph jb jc ht jd b je le jg jh ji lf jk jl jm lg jo jp jq lh js jt ju li jw jx jy hm dt translated">首先，我们需要初始化npm包(如果尚未完成)并安装所需的依赖项。</p><h2 id="fc72" class="lj kh ht bd ki lk ll lm km ln lo lp kq jm lq lr ku jq ls lt ky ju lu lv lc lw dt translated">依赖关系:</h2><figure class="ly lz ma mb fq iu fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/aa902672cca8b3ae8d260e79b0a5b26c.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*GQca2HkHDZzZ3fy23DAZCQ.png"/></div></figure><p id="e268" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">要初始化NPM软件包，请运行:</p><pre class="ly lz ma mb fq mc md me mf aw mg dt"><span id="2d63" class="lj kh ht md b fv mh mi l mj mk">npm init</span></pre><p id="9b9d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">要安装npm软件包依赖项，请运行:</p><pre class="ly lz ma mb fq mc md me mf aw mg dt"><span id="18d7" class="lj kh ht md b fv mh mi l mj mk">npm install --save ethereum-js solc web3</span></pre><p id="cd3f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这将安装<code class="eh ml mm mn md b">ethereum-js</code>、<code class="eh ml mm mn md b">solc</code>和<code class="eh ml mm mn md b">web3</code> npm软件包。</p></div><div class="ab cl jz ka hb kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hm hn ho hp hq"><h2 id="f790" class="lj kh ht bd ki lk ll lm km ln lo lp kq jm lq lr ku jq ls lt ky ju lu lv lc lw dt translated">生成合同字节码</h2><p id="6661" class="pw-post-body-paragraph jb jc ht jd b je le jg jh ji lf jk jl jm lg jo jp jq lh js jt ju li jw jx jy hm dt translated">对于本教程，我将采用这个简单的<strong class="jd hu">文档</strong>契约。假设你已经熟悉以太坊智能合约的可靠性编程。</p><figure class="ly lz ma mb fq iu"><div class="bz el l di"><div class="mo mp l"/></div></figure><p id="6414" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在这个简单的文档注册契约中，我们有一个构造函数，它将在契约部署时执行。构造函数接受两个参数，文档的标题和URL。</p><p id="fe26" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">使用下面的代码片段，我们可以生成合同字节码。确保将<code class="eh ml mm mn md b">&lt;CONTRACT_NAME&gt;</code>替换为您的实际合同名称。</p><figure class="ly lz ma mb fq iu"><div class="bz el l di"><div class="mo mp l"/></div></figure><p id="402d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">注:</strong>将<code class="eh ml mm mn md b">contractBytecode.js</code>文件放入，以便通过<code class="eh ml mm mn md b">fs</code>阅读时可以访问合同。</p><p id="97a9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里，我们利用<code class="eh ml mm mn md b">solc</code> npm包来编译合同，并提取合同的原始字节码。您可以随意探索该包输出的其他参数。</p><p id="548a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">通过执行上面的代码，我们得到了文档契约字节码。这没有考虑契约参数，因此当我们使用它部署契约时，我们将无法使用文档的标题和URL来初始化契约。</p></div><div class="ab cl jz ka hb kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hm hn ho hp hq"><h1 id="c130" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">用构造函数参数生成字节码</h1><p id="dca1" class="pw-post-body-paragraph jb jc ht jd b je le jg jh ji lf jk jl jm lg jo jp jq lh js jt ju li jw jx jy hm dt translated">使用下面的代码片段，我们可以在考虑契约参数的情况下生成契约字节码。确保用正确的值替换<code class="eh ml mm mn md b">&lt;CONTRACT_NAME&gt;</code>、<code class="eh ml mm mn md b">&lt;DOCUMENT_TITLE&gt;</code>、<code class="eh ml mm mn md b">&lt;DOCUMENT_URL&gt;</code>和<code class="eh ml mm mn md b">&lt;WEB3_PROVIDER_URL&gt;</code>。</p><figure class="ly lz ma mb fq iu"><div class="bz el l di"><div class="mo mp l"/></div></figure><p id="4da2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里我们进一步利用由<code class="eh ml mm mn md b">web3</code>提供的<code class="eh ml mm mn md b">encodeParameters</code>来编码两个构造函数参数。参数类型和值可以作为数组添加。为了获得完整的字节码，我们只需要将它添加到先前生成的原始契约字节码中。</p><p id="fdb4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">常量变量<code class="eh ml mm mn md b">bytecodeWithEncodedParameters</code>将有完整的字节码，也考虑了构造函数参数。</p></div><div class="ab cl jz ka hb kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hm hn ho hp hq"><h1 id="4c97" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">部署合同:</h1><p id="c7e5" class="pw-post-body-paragraph jb jc ht jd b je le jg jh ji lf jk jl jm lg jo jp jq lh js jt ju li jw jx jy hm dt translated">使用下面的代码片段，我们现在可以考虑合约参数来部署合约。确保用正确的值替换<code class="eh ml mm mn md b">&lt;CONTRACT_NAME&gt;</code>、<code class="eh ml mm mn md b">&lt;DOCUMENT_TITLE&gt;</code>、<code class="eh ml mm mn md b">&lt;DOCUMENT_URL&gt;</code>、<code class="eh ml mm mn md b">&lt;WEB3_PROVIDER_URL&gt;</code>、<code class="eh ml mm mn md b">&lt;ACCOUNT_ADDRESS&gt;</code>和<code class="eh ml mm mn md b">&lt;PRIVATE_KEY&gt;</code>。</p><figure class="ly lz ma mb fq iu"><div class="bz el l di"><div class="mo mp l"/></div></figure><p id="b0d1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在上一节中，我们已经生成了完整的契约字节码。现在，我们可以利用来自<code class="eh ml mm mn md b">ethereum-js</code>的<code class="eh ml mm mn md b">sign</code>函数和<code class="eh ml mm mn md b">web3</code>提供的<code class="eh ml mm mn md b">sendSignedTransaction</code>函数来部署合同。</p><p id="fc42" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">恭喜你。！！现在，我们已经成功地完成了部署带有构造函数参数的智能契约的所有步骤，这可以在我们需要随时部署此类契约的DApps中使用。</p></div><div class="ab cl jz ka hb kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hm hn ho hp hq"><p id="33af" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">感谢阅读。希望这能对你构建基于以太坊的分散式应用有所帮助。这甚至可能对您有所帮助，如果</p><p id="4ea9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">完整的代码可以在<a class="ae mq" href="https://github.com/jayeshbairagi/contract-deployment-with-constructor" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="bc6e" class="lj kh ht bd ki lk ll lm km ln lo lp kq jm lq lr ku jq ls lt ky ju lu lv lc lw dt translated">另外，阅读</h2><ul class=""><li id="09cf" class="mr ms ht jd b je le ji lf jm mt jq mu ju mv jy mw mx my mz dt translated"><a class="ae mq" rel="noopener" href="/coinmonks/defi-future-10-promising-projects-in-the-defi-world-ff2b697ab006">顶级DeFi项目</a></li><li id="0bc7" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" rel="noopener" href="/coinmonks/whats-the-best-crypto-trading-bot-in-2020-top-8-bitcoin-trading-bot-c16adeb13317">最佳加密交易机器人</a></li><li id="51e2" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated">最好的比特币<a class="ae mq" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069?source=friends_link&amp;sk=324dd9ff8556ab578d71e7ad7658ad7c">硬件钱包</a></li><li id="69bb" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated">最好的<a class="ae mq" rel="noopener" href="/coinmonks/best-crypto-tax-tool-for-my-money-72d4b430816b">加密税务软件</a></li><li id="7c4f" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" rel="noopener" href="/coinmonks/the-best-crypto-trading-platforms-in-2020-the-definitive-guide-updated-c72f8b874555">最佳加密交易平台</a></li><li id="3524" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" rel="noopener" href="/coinmonks/best-wallets-to-use-uniswap-e91a6385d9e8">unis WAP最佳钱包</a></li><li id="97a4" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated">最佳<a class="ae mq" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">加密贷款平台</a></li><li id="cfcc" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" href="https://blog.coincodecap.com/bitsgap-review" rel="noopener ugc nofollow" target="_blank"> Bitsgap评论</a>——一个轻松赚钱的加密交易机器人</li><li id="2401" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" href="https://blog.coincodecap.com/quadency-review-a-crypto-trading-automation-platform" rel="noopener ugc nofollow" target="_blank"> Quadency Review </a> -专为专业人士打造的加密交易机器人</li><li id="2791" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" href="https://blog.coincodecap.com/3commas-review-an-excellent-crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"> 3commas Review </a> |一款优秀的密码交易机器人</li><li id="4582" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" rel="noopener" href="/coinmonks/cryptohopper-vs-3commas-vs-shrimpy-a2c16095b8fe"> 3Commas vs Cryptohopper </a></li><li id="eb27" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated">Bitmex的<a class="ae mq" rel="noopener" href="/coinmonks/the-idiots-guide-to-margin-trading-on-bitmex-dbbd7742c6fc?source=friends_link&amp;sk=7bfa99d2a181142510c8442c8ddb0786">保证金交易指南</a></li><li id="aaab" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" rel="noopener" href="/coinmonks/the-definitive-guide-to-crypto-swing-trading-7e4af6496d4d?source=friends_link&amp;sk=70448050bd9323b42f63bfc0bb1e60d1">加密摇摆交易权威指南</a></li><li id="cfc6" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" rel="noopener" href="/coinmonks/bitmex-advanced-margin-trading-guide-2270c195ce25?source=friends_link&amp;sk=1d986cca731f5084b9a2db4a4bc4a7ad"> Bitmex高级保证金交易指南</a></li><li id="6e2e" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">开发人员的最佳加密API</a></li><li id="b037" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated"><a class="ae mq" rel="noopener" href="/coinmonks/crypto-arbitrage-guide-how-to-make-money-as-a-beginner-62bfe5c868f6">加密套利</a>指南:新手如何赚钱</li><li id="b46f" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated">顶级<a class="ae mq" href="https://blog.coincodecap.com/bitcoin-node-solutions" rel="noopener ugc nofollow" target="_blank">比特币节点</a>提供商</li><li id="0966" class="mr ms ht jd b je na ji nb jm nc jq nd ju ne jy mw mx my mz dt translated">最佳<a class="ae mq" rel="noopener" href="/coinmonks/what-are-the-best-charting-platforms-for-cryptocurrency-trading-85aade584d80">加密制图工具</a></li></ul><blockquote class="nf"><p id="b751" class="ng nh ht bd ni nj nk nl nm nn no jy ek translated"><a class="ae mq" href="https://coincodecap.com?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="nq nr ns nt nu iu fe ff paragraph-image"><a href="https://coincodecap.com?utm_source=coinmonks"><div class="fe ff np"><img src="../Images/160ce73bd06d46c2250251e7d5969f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*BoDnKUyK8p4hitHAJZ5Pdw.png"/></div></a></figure></div></div>    
</body>
</html>