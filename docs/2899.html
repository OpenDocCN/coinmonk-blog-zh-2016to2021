<html>
<head>
<title>How I integrated Django with Blockchain and built a Decentralized Application(DAPP)?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何将Django与区块链融合，构建去中心化应用(DAPP)的？</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-i-integrated-django-with-blockchain-and-built-a-decentralized-application-dapp-f104ae551e12?source=collection_archive---------0-----------------------#2020-04-06">https://medium.com/coinmonks/how-i-integrated-django-with-blockchain-and-built-a-decentralized-application-dapp-f104ae551e12?source=collection_archive---------0-----------------------#2020-04-06</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="2c70" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">Python开发者开始区块链开发之旅的有效指南。</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/cb0b99e82505ce34474befee42b1e088.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pSqNcl1sJHhepsn2EntGAw.jpeg"/></div></div></figure><p id="c449" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">不可否认的事实是，在使用DAPP development的时候，最大的挑战之一就是将智能合同与网站的前端连接起来。</p><p id="6d67" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">最有效的方法无疑是使用Web3(Python或Javascript)库来完成这项工作。虽然对于Javascript开发人员来说，完成这一部分可能容易得多(因为互联网上充斥着<a class="ae kq" rel="noopener" href="/coinmonks/simplest-way-to-connect-your-smart-contracts-to-the-front-end-react-with-web3-js-1e75702ea36a?source=your_stories_page---------------------------"> Web3.js教程】</a>，但是对于Python开发人员来说，完成同样的任务可能同样麻烦。</p><p id="89ac" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kr">应该选择</em> Web3.py吗？</strong></p><blockquote class="ks"><p id="bd3b" class="kt ku ht bd kv kw kx ky kz la lb kp ek translated">尽管不用说，Web3.js社区是迄今为止最大的一个，但另一方面，Web3.py在<a class="ae kq" href="https://github.com/ethereum/web3.py" rel="noopener ugc nofollow" target="_blank"> Github上有超过1.5k个明星，</a> 133个贡献者，并且正在使用一些非常引人注目的以太坊API，已经足够成熟，毫无疑问可以投入生产。</p></blockquote><p id="bc55" class="pw-post-body-paragraph ju jv ht jw b jx lc iu jz ka ld ix kc kd le kf kg kh lf kj kk kl lg kn ko kp hm dt translated">这仅仅意味着Python开发者是时候用Web3.py开始他们基于区块链的DAPP开发之旅了。</p><p id="6d7c" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">然而，初始阶段可能是最困难的部分，因为除了官方文档(字面上很有帮助)，例如<a class="ae kq" href="https://web3py.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">https://web3py.readthedocs.io/en/stable/</a>，没有足够的在线帮助让Python开发者使用Web3.py构建一个去中心化的应用程序。</p><p id="3675" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">因此，如果你也是一名Python开发者，并希望使用Python开发区块链上的分散应用程序，那么这将是你的必读文章。</p><p id="0e91" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">话虽如此，我们还是开始吧。</p><h1 id="9ce0" class="lh li ht bd lj lk ll lm ln lo lp lq lr iz ls ja lt jc lu jd lv jf lw jg lx ly dt translated">所需工具</h1><p id="ce75" class="pw-post-body-paragraph ju jv ht jw b jx lz iu jz ka ma ix kc kd mb kf kg kh mc kj kk kl md kn ko kp hm dt translated">在开始之前，让我们了解一下我是如何将Django与区块链集成并构建一个去中心化应用程序(DAPP)的？我们将需要这个项目。</p><ol class=""><li id="c472" class="me mf ht jw b jx jy ka kb kd mg kh mh kl mi kp mj mk ml mm dt translated"><strong class="jw hu"> <em class="kr"> Remix IDE: </em> </strong> Remix是一款开源工具，不仅可以让你编写自己的智能合约，还支持智能合约的测试、调试以及部署。阅读官方文件了解更多信息:【https://remix-ide.readthedocs.io/en/latest/<a class="ae kq" href="https://remix-ide.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">。<strong class="jw hu">图片</strong></a></li><li id="d0bb" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp mj mk ml mm dt translated"><strong class="jw hu"> <em class="kr"> Infura: </em> </strong> Infura无疑是让我们的生活变得简单很多的工具。更简单地说，它由一套工具组成，允许任何人与以太坊区块链进行交互(否则这将是一项非常麻烦的任务。)</li></ol><p id="8cb5" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">3.<strong class="jw hu"> <em class="kr"> Django 3.0: </em> </strong>嗯，这就是我们将要着手的Python框架。</p><blockquote class="ms mt mu"><p id="0abe" class="ju jv kr jw b jx jy iu jz ka kb ix kc mv ke kf kg mw ki kj kk mx km kn ko kp hm dt translated">安装:$ python -m pip install Django</p></blockquote><p id="d289" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">4.<strong class="jw hu"> <em class="kr"> Web3.py: </em> </strong>这是允许我们与智能合约对话并调用其功能的工具。阅读官方文档了解更多信息:<a class="ae kq" href="https://web3py.readthedocs.io/en/stable/quickstart.html" rel="noopener ugc nofollow" target="_blank">https://web3py.readthedocs.io/en/stable/quickstart.html</a></p><blockquote class="ms mt mu"><p id="8fa7" class="ju jv kr jw b jx jy iu jz ka kb ix kc mv ke kf kg mw ki kj kk mx km kn ko kp hm dt translated">安装:$ pip3安装web3</p></blockquote><h1 id="5c2b" class="lh li ht bd lj lk ll lm ln lo lp lq lr iz ls ja lt jc lu jd lv jf lw jg lx ly dt translated">让我们连线区块链</h1><p id="13e8" class="pw-post-body-paragraph ju jv ht jw b jx lz iu jz ka ma ix kc kd mb kf kg kh mc kj kk kl md kn ko kp hm dt translated">首先，将Remix上的环境更改为<strong class="jw hu"><em class="kr">Injected web 3</em></strong><em class="kr"/>，如下图所示，并连接到Metamask上的<strong class="jw hu"> Ropsten网络。</strong></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff my"><img src="../Images/ec8d29d9db7142f7f10aa6f74c486317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sU9y111Li5VNz8FfoHRNQ.jpeg"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Remix IDE for contract deployment on ROPSTEN Network</figcaption></figure><p id="1af1" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在开始实际的web3.py交互之前，让我们先建立一个与区块链的安全可靠的连接。</p><p id="e0d6" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">如果没有Infura，想这么做简直就是一场噩梦。然而，在目前的场景中是相当简单的，因为您所需要的只是一个Infura API密钥。<em class="kr">按照以下步骤获取API密钥- </em> <a class="ae kq" href="https://ethereumico.io/knowledge-base/infura-api-key-guide/" rel="noopener ugc nofollow" target="_blank"> <em class="kr">获取infura API密钥</em> </a></p><p id="11c9" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">一旦你得到了API密匙和上面提到的所有要求，我们就为下一步做好了准备。</p><blockquote class="ms mt mu"><p id="8244" class="ju jv kr jw b jx jy iu jz ka kb ix kc mv ke kf kg mw ki kj kk mx km kn ko kp hm dt translated">注意:为了跟进这个项目，您可能需要为<strong class="jw hu"> <em class="ht"> ROPSTEN网络获取一个Infura密钥。</em> </strong></p></blockquote><h2 id="f03a" class="nd li ht bd lj ne nf ng ln nh ni nj lr kd nk nl lt kh nm nn lv kl no np lx nq dt translated">连接到WEB3。PY并开始互动</h2><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/9a4751ee3ea552340a7e292fd17cf70e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g__Vm0x1rBFhAug1UD52kg.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Basic Set Up for Proper Interaction with Web3</figcaption></figure><p id="1fce" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">虽然这段代码已经很容易理解了，但是这里没有什么需要理解的。这只是一个基本的设置，其中我采用了一些必要的因素，</p><p id="a4fe" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><em class="kr"> a .签名交易的私钥和公钥</em></p><p id="1ed3" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><em class="kr"> b .为web3创建一个http provider</em></p><p id="2e88" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">存储合同的ABI和地址。</p><p id="4fc2" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><em class="kr"> d .通过将ABI和地址作为参数传递来创建合同实例。</em></p><p id="289c" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">好吧！现在，我们有了一个可靠的智能合约设置。然而，在了解如何对智能合约进行调用之前，让我们首先了解我们可能在第一时间进行什么类型的调用。</p><h2 id="e56f" class="nd li ht bd lj ne nf ng ln nh ni nj lr kd nk nl lt kh nm nn lv kl no np lx nq dt translated">你想从智能合同中得到什么？</h2><p id="f025" class="pw-post-body-paragraph ju jv ht jw b jx lz iu jz ka ma ix kc kd mb kf kg kh mc kj kk kl md kn ko kp hm dt translated">虽然人们可以做的功能范围很广，但您可能希望从<a class="ae kq" href="https://blog.coincodecap.com/tag/smart-contact/" rel="noopener ugc nofollow" target="_blank">智能合同</a>中获得的5件最重要的事情如下。</p><h2 id="cf39" class="nd li ht bd lj ne nf ng ln nh ni nj lr kd nk nl lt kh nm nn lv kl no np lx nq dt translated">a.从契约中调用Getter函数(长时间):</h2><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/9705670065a06116af823ed18ef7ddd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3zC1TrCESDaGI2tXaGy-6Q.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Calling a getter function from the contract</figcaption></figure><p id="e3f3" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">虽然这看起来有点复杂，但这就是我们从契约中调用任何getter函数的方式。</p><p id="5e3d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">虽然这看起来是一个非常冗长的过程，但是您可以使用下面提到的调用getter函数的简单方法。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/428475d3f9eeeadf5820264efde3f331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bkrE_lZADVs7h41WEDT8zQ.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Function that returns total number of posts</figcaption></figure><p id="afee" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> b .调用一个简单的只读函数(简单的方法):</strong></p><p id="74a7" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">契约中的read_only函数可以看作是一个在被调用时只返回特定数据的函数。</p><p id="f17f" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">例如，这个带有<strong class="jw hu"> <em class="kr">视图</em> </strong>关键字的get_count函数，在被调用时只返回帖子的总数。</p><blockquote class="ms mt mu"><p id="f659" class="ju jv kr jw b jx jy iu jz ka kb ix kc mv ke kf kg mw ki kj kk mx km kn ko kp hm dt translated"><em class="ht">坚固性代码:</em></p><p id="3390" class="ju jv kr jw b jx jy iu jz ka kb ix kc mv ke kf kg mw ki kj kk mx km kn ko kp hm dt translated"><strong class="jw hu">函数get _ count()view public returns(uint){<br/>return post count；<br/> } </strong></p></blockquote><p id="1059" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">为了调用这样的函数，我们需要实现一行简单的代码。</p><p id="f476" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">这很简单，这就是我们需要做的。</p><p id="6253" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> c .使用功能进行交易</strong></p><p id="4f9a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">因为我们已经知道了只读函数，所以在你的契约中可能有其他函数会要求一些参数，然后执行一些函数。</p><p id="b9fc" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">用技术术语来说，调用这样的函数被视为进行交易，因为这些类型的函数调用包括天然气价格。</p><p id="a2be" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">让我们考虑智能合约中的这个函数:</p><blockquote class="ms mt mu"><p id="9f98" class="ju jv kr jw b jx jy iu jz ka kb ix kc mv ke kf kg mw ki kj kk mx km kn ko kp hm dt translated">坚固性代码:</p><p id="7a29" class="ju jv kr jw b jx jy iu jz ka kb ix kc mv ke kf kg mw ki kj kk mx km kn ko kp hm dt translated">函数create post(string memory _ content)public</p><p id="d69d" class="ju jv kr jw b jx jy iu jz ka kb ix kc mv ke kf kg mw ki kj kk mx km kn ko kp hm dt translated">{ <br/>要求(字节(_内容)。长度&gt;0)；<br/>post count++；<br/>posts[Post count]= Post(Post count，_content，0，msg . sender)；<br/> emit PostCreated(postCount，_content，0，msg . sender)；<br/> }</p></blockquote><p id="dfee" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">现在这段代码从用户那里获取参数<em class="kr">内容</em>，然后将其添加到帖子列表中。现在调用这样的事务需要一些时间，因为用户试图更新区块链上的特定数据。因此，我们最终达成了交易。</p><p id="ae3f" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kr">那么如何进行这笔交易呢？</em> </strong></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/3dfae12e03817e8a1beca24875f47932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-x8REiKB7nCVQUvUqmhWw.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Function for writing post on Blockchain</figcaption></figure><p id="4928" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">这个问题很复杂。所以我们来分解一下。</p><p id="5666" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">如第259行所示，我们没有调用函数<em class="kr"> createPost </em>，而是构建了一个事务。然而，正如您所见，<strong class="jw hu"><em class="kr">build transaction</em></strong>函数将数据字典作为一个参数，这是非常需要理解的。</p><p id="9a52" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kr"> chainId </em> </strong> <em class="kr"> : </em>简单表示我们连接的网络号，因为每个以太坊网络都有自己的链Id。在这种情况下，3代表Ropsten网络。</p><p id="9088" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kr"> gas: </em> </strong>由于我们已经知道每个事务都需要gas来执行。这个参数简单地表示我们愿意为执行交易支付的最高汽油量。</p><p id="b6b6" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kr">气价:</em> </strong>气价表示每单位气所支付的气价，单位为魏</p><p id="5d19" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kr"> nonce: </em> </strong>这只是保存用户以前进行的交易的计数。</p><p id="1dcb" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">一旦我们按照我们的选择建立了这个交易并填充了所有参数，现在是时候用<strong class="jw hu"><em class="kr">sign transaction</em></strong>函数本身签署这个交易了。<em class="kr">此函数将交易和私钥作为参数。</em></p><p id="454e" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">最后，当我们使用<strong class="jw hu"><em class="kr">waitForTransactionReceipt</em></strong>函数收到交易收据时，我们知道交易已经完成。一旦我们收到收据，我们可以确保记录已被成功添加到区块链。</p><p id="2a55" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> d .用乙醚付款</strong></p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/a6b7a296e68702c0ae83a12f64e9d4a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tdCQ-mli5UMS3GGTgRKhyg.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Function for sending ether</figcaption></figure><p id="a15d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">将以太网发送到合同或不同的帐户涉及类似的步骤，如前所述，如建立交易、用私钥签名以及获得确认收据。</p><p id="847e" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">然而，它确实涉及两个额外的领域，</p><p id="984c" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kr">至:</em> </strong> <em class="kr">象征付款的接收方</em></p><p id="88e9" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kr">值:</em> </strong> <em class="kr">这是要转账的金额。</em></p><p id="1927" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">嗯，这就是把资金从一个账户转到另一个账户所需要做的一切。</p><p id="644a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> e .调用事件</strong></p><p id="7910" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">首先，什么是事件？</p><p id="79cd" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><em class="kr">Solidity中的事件可以被视为交易日志形式的实时记录，这些记录不仅存储在区块链，还可以在合同地址的帮助下随时访问。</em></p><p id="e7b2" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">虽然，我没有在我的代码中使用任何事件，但是Web3.py 的<a class="ae kq" href="https://web3py.readthedocs.io/en/stable/contracts.html#events" rel="noopener ugc nofollow" target="_blank">官方文档显示了调用事件的清晰过程。</a></p><pre class="jj jk jl jm fq ns nt nu nv aw nw dt"><span id="4c89" class="nd li ht nt b fv nx ny l nz oa">myContract = web3.eth.contract(address=contract_address, abi=contract_abi)<br/>tx_hash = myContract.functions.myFunction().transact()<br/>receipt = web3.eth.getTransactionReceipt(tx_hash)<br/>myContract.events.myEvent().processReceipt(receipt)</span></pre><p id="cfea" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">好吧。这些是您在与智能合约交互时可能想要使用的最必要的调用。</p><p id="837d" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated"><strong class="jw hu"> <em class="kr">虽然我们已经非常清楚地理解了使用web3.py与契约交互并调用特定函数的推荐过程，但是还有最后一件事需要理解，即在契约响应回来之后我们该做什么？</em>T51】</strong></p><p id="0a98" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">因为我们正在使用Django Web框架，所以我们非常需要了解如何处理契约的响应，并根据我们的需要使用它。</p><h1 id="a9fa" class="lh li ht bd lj lk ll lm ln lo lp lq lr iz ls ja lt jc lu jd lv jf lw jg lx ly dt translated">在Django处理合同回复</h1><p id="5193" class="pw-post-body-paragraph ju jv ht jw b jx lz iu jz ka ma ix kc kd mb kf kg kh mc kj kk kl md kn ko kp hm dt translated">合同可能会以两种方式做出回应。</p><blockquote class="ks"><p id="0fe0" class="kt ku ht bd kv kw kx ky kz la lb kp ek translated">首先，你可能进行了一次交易(在区块链上添加了一些东西或进行了支付)。在这种情况下，您将简单地取回一张交易收据。因为它只是确认您的交易已经执行，所以您不需要再做什么了。</p><p id="a310" class="kt ku ht bd kv kw kx ky kz la lb kp ek translated">第二，你可以调用一个函数来返回数据列表。这才是我们真正感兴趣的。</p></blockquote><p id="bafc" class="pw-post-body-paragraph ju jv ht jw b jx lc iu jz ka ld ix kc kd le kf kg kh lf kj kk kl lg kn ko kp hm dt translated">所以让我们借助我写的一些处理类似情况的代码来理解第二种情况。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/f079465c882e15710d842e489583db50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9M-cdrMsWX6gxJYQ7h3wYQ.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Function To pass posts_data to the template</figcaption></figure><p id="fa04" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">这确实是一个简单的函数，不是吗？</p><p id="da0a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">在这里，我们实际做的只是调用get_posts_from_contract()函数。这个函数做什么？虽然这是不言自明的，但是你自己看看吧。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/9734b5d3738178ead3257b6925a5274e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t-sm37ulc5QYMgLv038I2w.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Function To Call <strong class="bd ob">posts </strong>array from contract</figcaption></figure><p id="422c" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">我们的智能合同有一组数据，包含用户的所有帖子、他们的小费金额以及作者的地址。在这个函数中，我们简单地调用数组并返回它。</p><p id="8022" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">因此，当posts()函数调用get_post_from_smart_contract()函数时，它基本上会获得一个类似于下面这样的嵌套数据列表。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/6ded0c7e7039b096b0696e7ed1a77dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fi_2A7Ct_2QzuRBVdow-_Q.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Nested List Returned By WEB3.py</figcaption></figure><p id="7f78" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">很丑，对吧？</p><p id="96a0" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">现在出现的最关键的问题是，<strong class="jw hu"> <em class="kr">我们如何在模板中处理这个列表？</em>T5】</strong></p><h2 id="40f1" class="nd li ht bd lj ne nf ng ln nh ni nj lr kd nk nl lt kh nm nn lv kl no np lx nq dt translated">让我们转到Django中的模板部分</h2><p id="14b2" class="pw-post-body-paragraph ju jv ht jw b jx lz iu jz ka ma ix kc kd mb kf kg kh mc kj kk kl md kn ko kp hm dt translated">由于契约中的数据是一个嵌套列表，在Django模板中处理数据列表的效果是:</p><pre class="jj jk jl jm fq ns nt nu nv aw nw dt"><span id="51de" class="nd li ht nt b fv nx ny l nz oa">{% for data in data_from_views.py %}<br/><br/>...<br/>&lt;h1&gt;{{ data.0 }}&lt;/h2&gt;</span><span id="3d0e" class="nd li ht nt b fv oc ny l nz oa">&lt;h1&gt;{{ data.1 }}&lt;/h2&gt;...<br/><br/>{% endfor %}</span></pre><p id="f14a" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">这正是我在模板中处理它的方式。代码如下所示:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/c5f4a544aff1a8a4cd9df434db36dca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TE0iDuVF7EbJ2XfFaULTPw.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">Template Handling all the posts from the list</figcaption></figure><h1 id="7527" class="lh li ht bd lj lk ll lm ln lo lp lq lr iz ls ja lt jc lu jd lv jf lw jg lx ly dt translated">让我们结束吧</h1><p id="d84a" class="pw-post-body-paragraph ju jv ht jw b jx lz iu jz ka ma ix kc kd mb kf kg kh mc kj kk kl md kn ko kp hm dt translated">好了，您已经学习了整个过程，不仅与Python的智能契约进行交互，还以我们想要的方式处理它的响应。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/75ae9ad2a534b4a510ccd807ffac0384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-HR0DeRfCJ5GGhbgRk0rFA.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">My Front-End Skill Sucks</figcaption></figure><p id="5717" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">一旦你运行开发服务器，上述模板将被渲染，你可以有一个完整的网站，不仅可以与区块链互动，而且还可以让你在上面写作以及支付。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nr"><img src="../Images/745881f24b1b5b117737b3c52524d201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r6S3H-qLIt_MzMDxLR9hwg.png"/></div></div><figcaption class="mz na fg fe ff nb nc bd b be z ek">All the posts from Blockchain</figcaption></figure><p id="fb45" class="pw-post-body-paragraph ju jv ht jw b jx jy iu jz ka kb ix kc kd ke kf kg kh ki kj kk kl km kn ko kp hm dt translated">太好了！所以现在我们完成了，你可以喝杯咖啡，自己重新尝试一下。</p><h1 id="40d7" class="lh li ht bd lj lk ll lm ln lo lp lq lr iz ls ja lt jc lu jd lv jf lw jg lx ly dt translated">关于我自己</h1><h2 id="8287" class="nd li ht bd lj ne nf ng ln nh ni nj lr kd nk nl lt kh nm nn lv kl no np lx nq dt translated">我是谁？🙋🏻‍♂️</h2><p id="062c" class="pw-post-body-paragraph ju jv ht jw b jx lz iu jz ka ma ix kc kd mb kf kg kh mc kj kk kl md kn ko kp hm dt translated">𝙃𝙞, 𝙄 𝙖𝙢 𝙕𝙖𝙧𝙮𝙖𝙗 👋🏻<br/>我是一名精通区块链和智能合同的工程师，我的愿景是用Web3去中心化和保护传统Web。主要从事智能合约工作，在开发和智能合约安全方面都有丰富的经验。</p><h2 id="3554" class="nd li ht bd lj ne nf ng ln nh ni nj lr kd nk nl lt kh nm nn lv kl no np lx nq dt translated">我做什么🧑🏼‍💻</h2><ul class=""><li id="08d2" class="me mf ht jw b jx lz ka ma kd od kh oe kl of kp og mk ml mm dt translated">我撰写安全和优化的智能合同</li><li id="d014" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated">我对智能合同进行安全审计，并提高EVM连锁店智能合同的整体安全性</li><li id="14a8" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated">我撰写和谈论Web3和智能合约&amp;为扩展Web3的边界贡献我的一份力量。</li></ul><h2 id="8ffa" class="nd li ht bd lj ne nf ng ln nh ni nj lr kd nk nl lt kh nm nn lv kl no np lx nq dt translated">打声招呼，保持联系🤝</h2><p id="66b6" class="pw-post-body-paragraph ju jv ht jw b jx lz iu jz ka ma ix kc kd mb kf kg kh mc kj kk kl md kn ko kp hm dt translated"><a class="ae kq" href="https://www.linkedin.com/in/zaryab-afser-97085b157/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>。| <a class="ae kq" href="https://twitter.com/zaryab_eth" rel="noopener ugc nofollow" target="_blank">推特</a>。| <a class="ae kq" href="https://github.com/zaryab2000" rel="noopener ugc nofollow" target="_blank"> Github </a>。| <a class="ae kq" href="https://zaryab2000.notion.site/Invite-me-to-your-Next-Web3-Event-78bcd204b866426687e1afbcdc61c5c7" rel="noopener ugc nofollow" target="_blank">邀请我参加Web3活动</a></p><blockquote class="ks"><p id="2a09" class="kt ku ht bd kv kw kx ky kz la lb kp ek translated">加入Coinmonks <a class="ae kq" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae kq" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae kq" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="nd li ht bd lj ne oh ng ln nh oi nj lr kd oj nl lt kh ok nn lv kl ol np lx nq dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="me mf ht jw b jx lz ka ma kd od kh oe kl of kp og mk ml mm dt translated"><a class="ae kq" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae kq" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated"><a class="ae kq" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae kq" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated"><a class="ae kq" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae kq" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="450c" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated"><a class="ae kq" href="https://coincodecap.com/pionex-dual-investment" rel="noopener ugc nofollow" target="_blank"> Pionex双投</a> | <a class="ae kq" href="https://coincodecap.com/advcash-review" rel="noopener ugc nofollow" target="_blank"> AdvCash审核</a> | <a class="ae kq" href="https://coincodecap.com/uphold-review" rel="noopener ugc nofollow" target="_blank">支持审核</a></li><li id="4c48" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated"><a class="ae kq" href="https://coincodecap.com/best-cryptocurrency-apis" rel="noopener ugc nofollow" target="_blank">面向开发者的8个最佳加密货币API</a></li><li id="db49" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated"><a class="ae kq" href="https://coincodecap.com/uphold-card-review" rel="noopener ugc nofollow" target="_blank">维护卡审核</a> | <a class="ae kq" href="https://coincodecap.com/trust-wallet-vs-metamask" rel="noopener ugc nofollow" target="_blank">信任钱包vs元掩码</a></li><li id="0843" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated"><a class="ae kq" href="https://coincodecap.com/earn-sign-up-bonus" rel="noopener ugc nofollow" target="_blank">赢取注册奖金——10大最佳加密平台</a></li><li id="f33b" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated"><a class="ae kq" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae kq" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">最佳加密交易所</a></li><li id="47a8" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated">面向开发者的最佳加密API</li><li id="b359" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated">最佳<a class="ae kq" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="me mf ht jw b jx mn ka mo kd mp kh mq kl mr kp og mk ml mm dt translated"><a class="ae kq" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币的终极指南</a></li></ul></div></div>    
</body>
</html>