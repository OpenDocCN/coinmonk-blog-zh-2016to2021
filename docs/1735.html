<html>
<head>
<title>Oyster “Hack” and What We Can Learn From It</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">牡蛎“黑客”及其对我们的启示</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/oyster-hack-and-what-we-can-learn-from-it-87f786eec97f?source=collection_archive---------4-----------------------#2018-10-31">https://medium.com/coinmonks/oyster-hack-and-what-we-can-learn-from-it-87f786eec97f?source=collection_archive---------4-----------------------#2018-10-31</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/bdeec1452f6d8a873d8f3a0fd13b5d93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hn6DhAbVOKYIhutmuoca3g.jpeg"/></div></div></figure><h1 id="ad0f" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">发生了什么事？</h1><p id="a7a3" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">在2018年10月29日，约400万枚PRL代币从代币合同中铸造出来，并被送往KuCoin兑现，随后导致价格暴跌和代币交易暂停。这种“入侵”只能由团队成员完成</p><h1 id="c803" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">牡蛎连接是一个内部工作</h1><p id="25de" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">嗯，我不能说我了解团队结构或产品，这也不是重点。可以说，这可能发生在任何人身上，我愿意将怀疑的好处扩展到团队，并将此称为由持有导演地址私钥的单个恶意演员进行的行为。无论如何，人们不应该如此轻率地挥舞“S”字。</p><h1 id="e831" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">一个适合大老鼠的小洞</h1><p id="a17b" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">首先，让我们看一下代码，好吗？</p><p id="f331" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">代码可以在这里找到:<a class="ae lc" href="https://etherscan.io/address/0x1844b21593262668b7248d0f57a220caaba46ab9#code" rel="noopener ugc nofollow" target="_blank">https://ethers can . io/address/0x 1844 b 21593262668 b 7248d 0 f 57 a 220 ca ABA 46 ab 9 #代码</a></p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff ld"><img src="../Images/14a09feb8814686afb88a16c30917a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/0*bADL-LcbS38fkWng"/></div></figure><p id="b957" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">上面我们可以看到<strong class="kb hu"> closeSale </strong>和<strong class="kb hu"> openSale </strong>都使用了<strong class="kb hu"> onlyDirector </strong>函数修饰符。<strong class="kb hu"> onlyDirector </strong>函数修饰符里面是什么？</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff li"><img src="../Images/b52c934670dccd425d43be1c392c8c34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/0*ztr9ID3MwTgfNTI6"/></div></figure><p id="6257" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">似乎只有<strong class="kb hu">director</strong>被另一个名为<strong class="kb hu"> directorLock的布尔值控制。</strong></p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff lj"><img src="../Images/b5c3ecfd891debb1ec3a6a523b013d6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/0*JyxYF6chqPDYDfRq"/></div></figure><p id="8599" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">好的，看起来当调用<strong class="kb hu"> selfLock </strong>时<strong class="kb hu"> directorLock </strong>将被设置为真。</p><p id="1d39" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">什么是<strong class="kb hu"> onlyDirectorForce </strong>？让我们看看它用在哪里。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff lk"><img src="../Images/6f80fd3d60d3c91a824d169d8078ec27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/0*qix87Gz3WaomDcdm"/></div></figure><p id="efe6" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">看来<strong class="kb hu">只有导演力</strong>才能<strong class="kb hu">调动导演</strong>和<strong class="kb hu">撤资</strong>又名乙醚。</p><p id="3092" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">一切似乎都很好，让我检查一下令牌合同中的变量。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div class="fe ff ll"><img src="../Images/bc2cf0550330f5b5dda7f69989379a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/0*iv_pgyYsirm52t72"/></div></figure><p id="cff6" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">啊哦。</p><h1 id="e454" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">下雨时，倾盆大雨</h1><p id="3b3d" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">因此，我们知道，由于<strong class="kb hu"> selfLock </strong>从未被调用，所以控制器从未被锁定，<strong class="kb hu"> openSale </strong>仍然可以被所有者调用。我们还可以看到<strong class="kb hu"> transferDirector </strong>是开放的，供Director账户随时调用。</p><p id="8dac" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">我们这个恶毒的小知情人，我以后称他为虫尾巴，首先开了一个账户，并在里面装满了乙醚。不是很多，但也足够了。</p><p id="739a" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">问题地址<a class="ae lc" href="https://etherscan.io/address/0x0001ee57bb28415742248d946d35c7f87cfd5a54" rel="noopener ugc nofollow" target="_blank">https://ethers can . io/address/0x 0001 ee 57 bb 28415742248d 946d 35 c 7 f 87 cf D5 a 54</a></p><p id="2a6a" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">然后，虫尾巴使用原来的董事钱包调用<strong class="kb hu"> transferDirector </strong>，并用以太将董事职位转移到他的地址..<a class="ae lc" href="https://etherscan.io/tx/0x1ea00178c70ca6c1cc2d020939831d1393ac5fcf6154495395a074e19e0e70f9" rel="noopener ugc nofollow" target="_blank">https://ethers can . io/tx/0x1ea 00178 c 70 ca 6 C1 cc 2d 020939831d 1393 a5 fcf 6154495395 a 074 e 19 e 0 e 70 f 9</a></p><p id="a861" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">凭借他新获得的权力，虫尾巴现在调用<strong class="kb hu">openSale</strong><a class="ae lc" href="https://etherscan.io/tx/0x2321e305c20f45429f11045b9235e9bbd66b17bacede173ca86144ac5533d3bf" rel="noopener ugc nofollow" target="_blank">https://ethers can . io/tx/0x 2321 e 305 c 20 f 45429 f 11045 b 9235 e 9 bbd 66 b 17 BAC ede 173 ca 86144 AC 5533d 3 BF</a>并允许任何向合同发送乙醚的人以5000PRL/ETH的价格接收令牌。</p><p id="99a4" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">所以现在虫尾巴发送乙醚到合同，得到5000 PRL，然后调用<strong class="kb hu"> withdrawFunds </strong>将资金撤回到他的地址，重复这个过程多次。与此同时，他把多余的PRL送到交易所，卖给瑞士联邦理工学院，撤回BTC(也许还有瑞士联邦理工学院)，并(可能)改变他的战利品袋，在任何人准备好与他的卑鄙行径作斗争之前确保他的利润。<a class="ae lc" href="https://etherscan.io/txs?a=0x0001ee57bb28415742248d946d35c7f87cfd5a54" rel="noopener ugc nofollow" target="_blank">https://etherscan.io/txs?a = 0x 0001 e 57 bb 28415742248d 946d 35 c 7 f 87 cf d5a 54</a></p><p id="1c96" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">虫尾巴从中赚了多少钱？仅这个恶意地址就铸造了大约400万个PRL令牌，这还没有考虑到他可能有其他帐户(也可能没有)。这大约是400万枚免费铸造给虫尾巴的代币。如果他能以0.25美元的价格卖掉他所有的代币，那就接近150万美元，假设他能收回代币(很可能不能，必须考虑到市场下滑)。下面的链接确实说明了他在停职前只能提取大约30万美元)。你可以在这里阅读更多关于团队和交换的故事<a class="ae lc" href="https://oysterprotocol.com/oyster-update/" rel="noopener ugc nofollow" target="_blank">https://oysterprotocol.com/oyster-update/</a></p><h1 id="2551" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">犯错是人之常情；坚持错误是愚蠢的。</h1><p id="ab6b" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">如果你不从中吸取教训，错误只是错误。下一次有抱负的智能合同程序员可以做些什么来避免这种情况？</p><ol class=""><li id="65a8" class="lm ln ht kb b kc kx kg ky kk lo ko lp ks lq kw lr ls lt lu dt translated">类似总监的职能和类似管理员的职能的角色应该分开，这样就不会有一个人控制整个合同。这也可以通过管理销售和跟踪的多个智能合同来实现，这些合同可能由其他帐户拥有。</li><li id="064d" class="lm ln ht kb b kc lv kg lw kk lx ko ly ks lz kw lr ls lt lu dt translated">董事职位可以委托给另一个smart合同，以确保实际的权力下放。在执行任何董事职能之前，新的智能合同将需要多个签名。</li><li id="0af9" class="lm ln ht kb b kc lv kg lw kk lx ko ly ks lz kw lr ls lt lu dt translated">directorLock 不应该完全依赖于<strong class="kb hu"> selfLock </strong>，而应该是另一个由时间戳控制的修饰符。(例如，6个月后自动锁定)。</li><li id="d5f7" class="lm ln ht kb b kc lv kg lw kk lx ko ly ks lz kw lr ls lt lu dt translated">在PRL的特殊情况下，众筹合同不应重新启动。这也可以用时间戳等来管理。</li></ol><p id="8fb1" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">我们可以看到这并不是一个真正的bug。正是董事职位从未被锁定的事实导致了这种情况的发生。一个逻辑和假设上的错误。不幸的是，还需要董事职位来控制智能合约中的跟踪机制，这使得它太重要了，不能禁用。这个代码有一个糟糕的设计，后来被它的创造者利用来快速赚钱。</p><p id="7cad" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">代码是故意恶意设计的吗？也许吧。谁知道虫尾巴在想什么？</p><p id="cbef" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">也许最大的错误是认为不管环境如何，人类都是廉洁的。在一个充满骗局的空间里，当成千上万的美元在他们眼前晃来晃去的时候，我们没有奢侈去假设其他人的良好意图。极其高效的资金流动、巧合的时间安排以及行动的果断性，都表明这是一个预谋好的精心策划的计划，早在几周前就已经计划好了，几个月前就已经构思好了。</p><p id="78f0" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">这是项目可能发生的最糟糕的事情吗？不，说实话远非如此。如果PRL是一个合法的项目，我认为该团队可以从事件中反弹和恢复，尽管品牌名称本身不会没有一点损伤。</p><p id="f824" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">"要有一个好的敌人，选择一个朋友:他知道在哪里打击."</p><h1 id="ff82" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">词汇表</h1><p id="1cba" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">原导演地址:0x2da 59901939682 eab 8887 EDB 0 FD 1c e 4299072265</p><p id="5af2" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">令牌合同地址:0x 1844 b 21593262668 b 7248 d0f 57 a 220 ca ABA 46 ab 9</p><p id="78b7" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">恶意导演转移tx hash:0 x1ea 00178 c 70 ca 6 C1 cc 2d 020939831d 1393 C5 fcf 6154495395 a 074 e 19 E0 e 70 f 9</p><p id="166a" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">恶意钱包:0x 0001 ee 57 bb 28415742248d 946d 35 c 7 f 87 cf D5 a 54</p><h1 id="be80" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">放弃</h1><p id="877e" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">我在牡蛎珍珠没有投资，这篇文章纯粹是出于教育目的，我绝不是在宽恕剥削者的所作所为，我也不是说这个项目是一个骗局，我也不是想FUD你心爱的项目。做好自己的尽职调查。</p><h1 id="f8d4" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">链接</h1><p id="5d28" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">牡蛎网站:【https://oysterprotocol.com/ T4】</p><p id="e096" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">团队更新:<a class="ae lc" href="https://oysterprotocol.com/oyster-update/" rel="noopener ugc nofollow" target="_blank">https://oysterprotocol.com/oyster-update/</a></p><p id="2867" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">这篇文章最初发布在<a class="ae lc" href="https://celebrusadvisory.com/oyster-pearl-hack-tiny-hole-for-a-big-rat/" rel="noopener ugc nofollow" target="_blank">https://celebrus advisory . com/oyster-pearl-hack-tiny-hole-for-a-big-rat/</a>上，点击这里阅读更多区块链相关文章。</p><blockquote class="ma"><p id="5221" class="mb mc ht bd md me mf mg mh mi mj kw ek translated"><a class="ae lc" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="ml mm mn mo mp iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff mk"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>