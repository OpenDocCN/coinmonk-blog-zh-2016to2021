<html>
<head>
<title>ARCore, Sceneform &amp; Augmented Images #3 Android AR app</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ARCore，Sceneform和增强图像#3 Android AR应用程序</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/arcore-sceneform-augmented-images-3-android-ar-app-2c0990f65df2?source=collection_archive---------2-----------------------#2018-08-20">https://medium.com/coinmonks/arcore-sceneform-augmented-images-3-android-ar-app-2c0990f65df2?source=collection_archive---------2-----------------------#2018-08-20</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="6319" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用Sceneform创建Android AR应用</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/c3310afff9375d770f972cdfa121cbba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KV3lq1ssjHg4Jf1xSzUXaQ.jpeg"/></div></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">credits : Google</figcaption></figure><p id="3a49" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在接下来的系列中，我们已经了解了ar、ARCore和Sceneform的基础知识。你可以跟着这里的<strong class="is hu">走:</strong></p><ul class=""><li id="8aee" class="ke kf ht is b it iu ix iy jb kg jf kh jj ki jn kj kk kl km dt translated"><a class="ae kn" rel="noopener" href="/coinmonks/arcore-and-sceneform-1-android-augmented-reality-2580e7446748">第1部分—AR和ARCore概述</a></li><li id="e97f" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated"><a class="ae kn" rel="noopener" href="/@neerajmoudgil/arcore-and-sceneform-2-android-augmented-reality-8108451cd484">第2部分Sceneform增强图像及其核心API概述</a></li><li id="b3a7" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">第3部分—使用Sceneform构建ARCore应用程序</li></ul><h1 id="ab77" class="kt ku ht bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">我的AR应用</h1><p id="64c1" class="pw-post-body-paragraph iq ir ht is b it lr iv iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hm dt translated">我们将建立一个AR应用程序，它将检测汽车图像，并在其上放置一个3D模型，用户应该能够转换和旋转。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/5e215effd70aa476d2cbe920b5b9f0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/1*AjiY9IGT9PFBuqsvZMHROg.gif"/></div></figure><p id="33c3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们开始用这个酷东西弄脏我们的手吧——AR</p><h2 id="c254" class="lx ku ht bd kv ly lz ma kz mb mc md ld jb me mf lh jf mg mh ll jj mi mj lp mk dt translated">步骤1:导入3D资源</h2><p id="3a80" class="pw-post-body-paragraph iq ir ht is b it lr iv iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hm dt translated">你可以使用谷歌的<a class="ae kn" href="https://poly.google.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">聚</strong> </a>网站下载所需资产。还有其他网站也可以下载3D对象。</p><p id="6ec8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您可以搜索汽车对象并下载型号为<strong class="is hu"> OBJ </strong>的文件。</p><h2 id="71c3" class="lx ku ht bd kv ly lz ma kz mb mc md ld jb me mf lh jf mg mh ll jj mi mj lp mk dt translated">步骤2:配置Sceneform和Sceneform插件</h2><p id="3eaa" class="pw-post-body-paragraph iq ir ht is b it lr iv iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hm dt translated">我们将在Android Studio中创建一个新项目，并设置<code class="eh ml mm mn mo b">minimunSDK as version 7.0 (API level 24).</code></p><p id="901e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">注</strong>:使用的Android Studio版本应为版本<code class="eh ml mm mn mo b">3.1 or higher</code></p><p id="bc62" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在gradle(应用程序级别)中，将sceneform插件依赖项添加为</p><pre class="jp jq jr js fq mp mo mq mr aw ms dt"><span id="0d20" class="lx ku ht mo b fv mt mu l mv mw">classpath <strong class="mo hu">'com.google.ar.sceneform:plugin:1.4.0'</strong></span></pre><p id="080a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来我们需要将ARCore和Sceneform添加到我们的项目中。将以下库添加到gradle文件(项目级)</p><pre class="jp jq jr js fq mp mo mq mr aw ms dt"><span id="0c2c" class="lx ku ht mo b fv mt mu l mv mw"><em class="mx">//arcore<br/></em>implementation <strong class="mo hu">'com.google.ar:core:1.4.0'<br/></strong>implementation <strong class="mo hu">"com.google.ar.sceneform:core:1.4.0"<br/></strong>implementation <strong class="mo hu">"com.google.ar.sceneform.ux:sceneform-ux:1.4.0"</strong></span></pre><p id="fbba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将此添加到渐变底部以应用场景格式</p><pre class="jp jq jr js fq mp mo mq mr aw ms dt"><span id="b6a4" class="lx ku ht mo b fv mt mu l mv mw">apply <strong class="mo hu">plugin</strong>: <strong class="mo hu">'com.google.ar.sceneform.plugin'</strong></span></pre><h2 id="b1e9" class="lx ku ht bd kv ly lz ma kz mb mc md ld jb me mf lh jf mg mh ll jj mi mj lp mk dt translated"><strong class="ak">第三步:将3D资产导出到项目— Sceneform工具插件</strong></h2><p id="ba38" class="pw-post-body-paragraph iq ir ht is b it lr iv iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hm dt translated">Android studio为我们提供了插件<strong class="is hu"> Google Sceneform tools </strong>，它将帮助我们将资产导出到项目中。您可以在以下位置找到它:</p><p id="6d57" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">【T2&gt;<code class="eh ml mm mn mo b">Plugins</code>&gt;<code class="eh ml mm mn mo b">Browse Repositories</code></p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff my"><img src="../Images/4dfdd8fa4d7ffe5982d0688f90cf4e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DlVN8JtPBE5C3wtNoUXjow.png"/></div></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">adding sceneform plugin to android studio</figcaption></figure><p id="a325" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我们已经安装了下载的3D模型和插件，我们可以利用这个插件来创建<code class="eh ml mm mn mo b">sfb</code>文件并将3D模型导出到我们的项目中。为此，请遵循以下步骤:</p><ul class=""><li id="128f" class="ke kf ht is b it iu ix iy jb kg jf kh jj ki jn kj kk kl km dt translated">我们将把下载的3D模型保存到Android Studio提供的<code class="eh ml mm mn mo b">sampledata</code>文件夹中<code class="eh ml mm mn mo b">rightclick app &gt; new sample directory.</code>这里存储的数据不会捆绑到apk中，而是仅用于开发目的。将下载的<code class="eh ml mm mn mo b">.obj</code>和<code class="eh ml mm mn mo b">.mtl</code>文件复制到此。</li><li id="492d" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">要导出模型，<code class="eh ml mm mn mo b">right click on obj &gt; Import sceneform asset.</code></li><li id="a796" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">以上步骤将创建两个文件<code class="eh ml mm mn mo b">.sfa</code> (Sceneform资产定义)和<code class="eh ml mm mn mo b"> .sfb</code> (Sceneform二进制资产)文件。。sfa文件是人类可读的定义。sfb文件。它指向3D资源中的模型、材质定义和纹理。它是json格式的，你可以改变某些值来改变你的资产的外观和感觉。更多信息你可以点击这里查看<a class="ae kn" href="https://developers.google.com/ar/develop/java/sceneform/sfa" rel="noopener ugc nofollow" target="_blank">官方文件</a></li><li id="fa9c" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">Gradle build在这个过程中发生，构建中的必要更改由这个工具自动完成。</li></ul><p id="60a6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你看到成功的gradle同步，并且可以看到指定路径中的<code class="eh ml mm mn mo b">.sfb</code>文件，那么是的！我们已完成将3D模型导入项目。接下来，我们将研究启动AR片段。</p><h2 id="7ae6" class="lx ku ht bd kv ly lz ma kz mb mc md ld jb me mf lh jf mg mh ll jj mi mj lp mk dt translated">步骤4-配置特定于ARCore应用程序的AndroidManifest.xml文件</h2><p id="a8b6" class="pw-post-body-paragraph iq ir ht is b it lr iv iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hm dt translated">接下来，我们需要配置项目的Android清单，以添加ARCore应用程序所需的一些元数据</p><pre class="jp jq jr js fq mp mo mq mr aw ms dt"><span id="f0ae" class="lx ku ht mo b fv mt mu l mv mw">//camera permission<br/>&lt;<strong class="mo hu">uses-permission android:name="android.permission.CAMERA" </strong>/&gt; <br/>// application requires Arcore<br/>&lt;<strong class="mo hu">uses-feature<br/>    android:name="android.hardware.camera.ar"<br/>    android:required="true" </strong>/&gt;</span><span id="38f5" class="lx ku ht mo b fv mz mu l mv mw">//inside application tag adds this<br/>&lt;<strong class="mo hu">meta-data<br/>    android:name="com.google.ar.core"<br/>    android:value="required" </strong>/&gt;</span></pre><p id="6e5a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这些配置确保AR应用程序仅在支持ARCore的设备上运行，并指定所需的权限和功能。</p><h2 id="14a8" class="lx ku ht bd kv ly lz ma kz mb mc md ld jb me mf lh jf mg mh ll jj mi mj lp mk dt translated"><strong class="ak">步骤5—初始化ArFragment </strong></h2><p id="9eb0" class="pw-post-body-paragraph iq ir ht is b it lr iv iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hm dt translated">将Arfragment添加到主活动布局文件中</p><pre class="jp jq jr js fq mp mo mq mr aw ms dt"><span id="f5af" class="lx ku ht mo b fv mt mu l mv mw">&lt;FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:tools="http://schemas.android.com/tools"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"<br/>   &gt;<br/>  &lt;fragment android:name="com.google.ar.sceneform.ux.ArFragment"<br/>      android:id="@+id/ar_fragment"<br/>      android:layout_width="match_parent"<br/>      android:layout_height="match_parent" /&gt;<br/>&lt;/FrameLayout&gt;</span></pre><p id="5dc0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后，您可以在您的主活动java文件中引用这个片段</p><pre class="jp jq jr js fq mp mo mq mr aw ms dt"><span id="9480" class="lx ku ht mo b fv mt mu l mv mw"><strong class="mo hu">arFragment</strong>= (ArFragment)  getSupportFragmentManager().findFragmentById(R.id.<strong class="mo hu"><em class="mx">ar_fragment</em></strong>);<br/><br/><em class="mx">// hiding the plane discovery<br/></em><strong class="mo hu">arFragment</strong>.getPlaneDiscoveryController().hide();<br/><strong class="mo hu">arFragment</strong>.getPlaneDiscoveryController().setInstructionView(<strong class="mo hu">null</strong>);</span></pre><p id="187d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们隐藏了平面检测，因为默认情况下它是真实的，对于我们正在做的特定示例，我们不需要检测平面，而是我们将在检测到的图像上渲染3D模型。我将在其他帖子中解释飞机上的渲染模型。</p><h2 id="cbb4" class="lx ku ht bd kv ly lz ma kz mb mc md ld jb me mf lh jf mg mh ll jj mi mj lp mk dt translated">跑去试试</h2><p id="e6bf" class="pw-post-body-paragraph iq ir ht is b it lr iv iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hm dt translated">在AR支持的设备或模拟器中保存并运行应用程序。</p><p id="f67d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你已经完成了这些步骤，那么你应该能够看到相机权限弹出窗口(注意，我们没有编写任何代码来处理权限，因为它是由<code class="eh ml mm mn mo b">ArFragment</code>在内部处理的)。在这之后，你应该看到相机饲料在你的手机上运行。</p><h1 id="88fc" class="kt ku ht bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">摘要</h1><ul class=""><li id="d605" class="ke kf ht is b it lr ix ls jb na jf nb jj nc jn kj kk kl km dt translated">我们能够添加插件，将3D模型导出到Android studio中</li><li id="106f" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">我们已经向gradle文件添加了必要的库和依赖项</li><li id="9e7a" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">我们对AndroidManifest.xml进行了必要的配置更改</li><li id="212c" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">初始化ArFragment</li></ul><h1 id="d7b4" class="kt ku ht bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq dt translated">下一步是什么？</h1><p id="2022" class="pw-post-body-paragraph iq ir ht is b it lr iv iw ix ls iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hm dt translated">接下来，我们将编写代码来完成剩余的步骤。</p><ul class=""><li id="506b" class="ke kf ht is b it iu ix iy jb kg jf kh jj ki jn kj kk kl km dt translated">初始化增强图像数据库并将图像添加到数据库中</li><li id="9b02" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">检测<a class="ae kn" href="https://developers.google.com/ar/develop/java/augmented-images/" rel="noopener ugc nofollow" target="_blank">增强图像</a></li><li id="d4e2" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">在中心位置创建锚节点</li><li id="97be" class="ke kf ht is b it ko ix kp jb kq jf kr jj ks jn kj kk kl km dt translated">渲染模型</li></ul><div class="nd ne fm fo nf ng"><a rel="noopener follow" target="_blank" href="/@neerajmoudgil/arcore-sceneform-augmented-images-4-android-ar-app-2a4890a9bb09"><div class="nh ab ej"><div class="ni ab nj cl cj nk"><h2 class="bd hu fv z el nl eo ep nm er et hs dt translated">ARCore，Sceneform和增强图像#4 Android AR应用程序</h2><div class="nn l"><h3 class="bd b fv z el nl eo ep nm er et ek translated">使用ARCore和Sceneform构建AR应用程序</h3></div><div class="no l"><p class="bd b gc z el nl eo ep nm er et ek translated">medium.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu jy ng"/></div></div></a></div><p id="0c83" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">感谢阅读。如果你觉得这篇文章有帮助，用掌声鼓励我。传播并帮助他人学习。</strong></p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff nv"><img src="../Images/1fe26383361acfff51f623aa906e2165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*99sn8aeNAlBH62kbql9E7Q.gif"/></div></figure><blockquote class="nw"><p id="fd06" class="nx ny ht bd nz oa ob oc od oe of jn ek translated"><a class="ae kn" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="oh oi oj ok ol jt fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff og"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>