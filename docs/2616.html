<html>
<head>
<title>Voting on a Blockchain: Voting DApp Code Walk-through</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">区块链投票:投票DApp代码演练</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/voting-on-a-blockchain-voting-dapp-code-walk-through-362e74cf3980?source=collection_archive---------3-----------------------#2019-12-26">https://medium.com/coinmonks/voting-on-a-blockchain-voting-dapp-code-walk-through-362e74cf3980?source=collection_archive---------3-----------------------#2019-12-26</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="84a1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是我写的5篇文章的最后一篇，解释以太坊上的端到端投票系统是如何工作的。在这一部分，我将解释DApp投票模块背后的代码。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/e7bcbc4557295ba880e8da1619835fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iekePGBqFHTPy7JY6YY2zw.jpeg"/></div></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">Photo by <a class="ae ke" href="https://unsplash.com/@michael75?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Michael</a> on <a class="ae ke" href="https://unsplash.com/s/photos/vote?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9dd7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">1.<a class="ae ke" rel="noopener" href="/coinmonks/voting-on-a-blockchain-how-it-works-3bb41582f403">区块链投票:它是如何工作的</a> <br/> 2。<a class="ae ke" rel="noopener" href="/coinmonks/voting-on-a-blockchain-solidity-contract-codes-explained-c677996d94f2">区块链投票:Solidity合约代码详解</a> <br/> 3。<a class="ae ke" rel="noopener" href="/coinmonks/voting-on-a-blockchain-dapp-demonstration-dfb5944a0c9e">区块链投票:DApp演示</a> <br/> 4。<a class="ae ke" rel="noopener" href="/coinmonks/voting-on-a-blockchain-ballot-management-dapp-code-walk-through-11d7d287d82e">区块链投票:选票管理DApp代码走查</a> <br/> 5。<a class="ae ke" rel="noopener" href="/@jacksonngtech/voting-on-a-blockchain-voting-dapp-code-walk-through-362e74cf3980">区块链投票:投票DApp代码遍历</a></p><p id="c11e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">今年5月，我受邀为新加坡一个名为“<a class="ae ke" href="https://www.meetup.com/Singapore-Futurists/" rel="noopener ugc nofollow" target="_blank">新加坡未来学家</a>”的团体做了一个关于区块链在民主社会中的作用的<a class="ae ke" href="https://www.meetup.com/Singapore-Futurists/events/260805558/" rel="noopener ugc nofollow" target="_blank">演讲。我决定不只是谈论它，也许我应该演示一下区块链上的投票是如何工作的。这个演讲最终变成了这一系列的文章和一个我在我的</a><a class="ae ke" href="https://www.tp.edu.sg/courses/part-time-courses/skillsfuture/SkillsFuture-Series/finance-services-governance/beginners-introduction-to-blockchain-technology-with-ethereum-solidity-smart-contracts" rel="noopener ugc nofollow" target="_blank">区块链研讨会</a>中经常使用的现场演示。</p><p id="edc3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">重述</strong></p><p id="ca98" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">选票DApp的投票模块让投票者为主席的提议投票。这个模块的完整源代码可以在我的<a class="ae ke" href="https://github.com/jacksonng77/ballot" rel="noopener ugc nofollow" target="_blank"> Github库</a>中找到</p><p id="3126" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">设置</strong></p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="5aa5" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">var</strong> web3 = <strong class="kg hu">new</strong> Web3();<br/><strong class="kg hu">var</strong> accountaddress;<br/><strong class="kg hu">var</strong> ballotContract;<br/><strong class="kg hu">var</strong> ballotByteCode;<br/><strong class="kg hu">var</strong> Ballot;<br/><strong class="kg hu">var</strong> ballotABI = [{"constant":false,"inputs":[],..."voteDone","type":"event"}];<br/>        <br/>$( document ).ready(<strong class="kg hu">function</strong>() {<br/>    $('#panels_contract').hide();<br/>});</span></pre><p id="a938" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">DApp首先设置将在整个投票生命周期中使用的全局变量，即:</p><ol class=""><li id="2208" class="kq kr ht is b it iu ix iy jb ks jf kt jj ku jn kv kw kx ky dt translated"><code class="eh kz la lb kg b">accountaddress</code>:这是管理投票过程的主席的以太坊账号。该地址在执行智能投票合同时使用。</li><li id="67dc" class="kq kr ht is b it lc ix ld jb le jf lf jj lg jn kv kw kx ky dt translated"><code class="eh kz la lb kg b">ballotContract</code>:存储投票人将提供的选票智能契约的地址。主席将在启动投票流程后，向投票人提供选票智能合同的地址。</li><li id="4bbb" class="kq kr ht is b it lc ix ld jb le jf lf jj lg jn kv kw kx ky dt translated"><code class="eh kz la lb kg b">Ballot</code>:这个变量在我们执行和监控投票对象时存储它。</li><li id="6cd2" class="kq kr ht is b it lc ix ld jb le jf lf jj lg jn kv kw kx ky dt translated"><code class="eh kz la lb kg b">ballotABI</code>:(我在上面的代码片段中截断了它)这是选票智能合约的ABI。</li></ol><p id="ec94" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当页面加载时，我将<code class="eh kz la lb kg b">panels_contract</code>隐藏起来，因为此时投票者还没有提供他的钱包地址，投票的DApp没有义务告诉他提案是什么。</p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="ea9b" class="kk kl ht kg b fv km kn l ko kp">window.addEventListener('load', async () =&gt; {<br/>     <em class="lh">// Modern dapp browsers...</em><br/>  	<strong class="kg hu">if</strong> (window.ethereum) {<br/>     	    window.web3 = <strong class="kg hu">new</strong> Web3(ethereum);<br/>       		<strong class="kg hu">try</strong> {<br/>       		    <em class="lh">// Request account access if needed</em><br/>       		    await ethereum.enable();<br/>       		    <em class="lh">// Acccounts now exposed</em><br/>       		    accountaddress = web3.givenProvider.selectedAddress;<br/>                ballotContract = <strong class="kg hu">new</strong> web3.eth.Contract(ballotABI);        		    <br/>      		} <strong class="kg hu">catch</strong> (error) {<br/>       			<em class="lh">// User denied account access...</em><br/>       		}<br/>       	}<br/>       	<em class="lh">// Legacy dapp browsers...</em><br/>       	<strong class="kg hu">else</strong> <strong class="kg hu">if</strong> (window.web3) {<br/>       		    window.web3 = <strong class="kg hu">new</strong> Web3(web3.currentProvider);<br/>       		    <em class="lh">// Acccounts always exposed</em><br/>       		    web3.eth.sendTransaction({<em class="lh">/* ... */</em>});<br/>       	}<br/>       	<em class="lh">// Non-dapp browsers...</em><br/>       	<strong class="kg hu">else</strong> {<br/>       			console.log('Non-Ethereum browser detected. You should consider trying MetaMask!');<br/>       	}<br/>});</span></pre><p id="50dd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当页面加载时，这段代码检查浏览器是否带有以太坊钱包，如<a class="ae ke" href="https://metamask.io/" rel="noopener ugc nofollow" target="_blank"> MetaMask </a>。一旦找到，我们就将钱包的活动地址加载到<code class="eh kz la lb kg b">accountaddress </code>变量中。我们还将投票合同的ABI加载到<code class="eh kz la lb kg b">ballotContract</code>变量中。</p><p id="4b02" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您的用户在没有以太坊钱包插件的浏览器中运行此DApp，它会在您的浏览器控制台中弹出一条消息，告诉您它不能运行DApp。在实时实现中，您可能希望将这些用户重定向到下载数字钱包的页面。</p><p id="5933" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">展示提案</strong></p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="c551" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">getContract</strong>(_ballotContractAddress){<br/>     Ballot = <strong class="kg hu">new</strong> web3.eth.Contract(ballotABI, _ballotContractAddress);<br/>     Ballot.methods.ballotOfficialName().call().then((result) =&gt; {<br/>         $("#lbl_officialname").html("&lt;b&gt;Ballot Official Name: &lt;/b&gt;" + result);<br/>     });<br/>     Ballot.methods.proposal().call().then((result) =&gt; {<br/>         $("#lbl_proposal").html("&lt;b&gt;Proposal: &lt;/b&gt;" + result);<br/>     });<br/>            <br/>     loadFinalResult(Ballot);<br/>     loadState(Ballot);<br/>            <br/>     watchVoteStarted(); <em class="lh">//start watching for events</em><br/>     watchVoteEnd(); <em class="lh">//start watching for vote end</em><br/>     watchVoteDone(); <em class="lh">//start watching for vote done</em><br/>            <br/>     $('#panels_contract').show();<br/>     $("#loader").hide();<br/>     $("#section_voting").hide();<br/>}</span></pre><p id="c9d3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当投票人提供投票合同地址并按下[Go]按钮时，调用<code class="eh kz la lb kg b">getContract</code>函数。在这里，将加载投票合同，并显示投票官方名称和提案详细信息。</p><p id="286b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">它执行<code class="eh kz la lb kg b">loadFinalResult()</code>来显示投票结果(如果投票已经完成)。它还执行<code class="eh kz la lb kg b">loadState()</code>来显示投票过程的当前状态——是处于创建、投票还是结束状态。</p><p id="fa00" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kz la lb kg b">watchVoteStarted()</code>、<code class="eh kz la lb kg b">watchVoteEnd()</code>和<code class="eh kz la lb kg b">watchVoteDone() </code>函数将等待并观察投票智能合约触发这些事件。这些事件在投票过程中的不同点被触发。</p><p id="d524" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">看着……看着</strong></p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="7516" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">watchVoteEnd</strong>(){<br/>     Ballot.events.voteEnded({<br/>     }, (error, event) =&gt; { <br/>         console.log(event.returnValues.finalResult);<br/>         loadState(Ballot);<br/>         loadFinalResult(Ballot);<br/>     })<br/>     .on('data', (event) =&gt; {<br/>     })<br/>     .on('changed', (event) =&gt; {<br/>     })<br/>     .on('error', console.error)                      <br/> }</span></pre><p id="a578" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kz la lb kg b">watchVoteEnd()</code>等待投票智能合约触发<code class="eh kz la lb kg b">voteEnded</code>事件。当这种情况发生时，意味着主席已经结束了投票过程。<code class="eh kz la lb kg b">loadState()</code>执行以在用户界面中显示一条消息，告知投票人投票已经结束。<code class="eh kz la lb kg b">loadFinalResult()</code>执行向投票者显示结果。</p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="d391" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">watchVoteStarted</strong>(){<br/>     Ballot.events.voteStarted({<br/>     }, (error, event) =&gt; { })<br/>     .on('data', (event) =&gt; {<br/>         console.log(event.event); <br/>         loadState(Ballot);<br/>     })<br/>     .on('changed', (event) =&gt; {<br/>     })<br/>     .on('error', console.error)<br/> }</span></pre><p id="7b5a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kz la lb kg b">watchVoteStarted() </code>等待投票智能合约触发<code class="eh kz la lb kg b">voteStarted</code>事件。当这种情况发生时，意味着主席已经开始投票程序。<code class="eh kz la lb kg b">loadState() </code>在用户界面中显示一条消息，告诉投票人投票已经开始。</p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="baa3" class="kk kl ht kg b fv km kn l ko kp"><strong class="kg hu">function</strong> <strong class="kg hu">watchVoteDone</strong>(){<br/>    Ballot.events.voteDone({<br/>    }, (error, event) =&gt; { <br/>        <strong class="kg hu">var</strong> strEventAddress = event.returnValues.voter.toString().toLowerCase();<br/>        <strong class="kg hu">var</strong> strAccountAddress = accountaddress.toString().toLowerCase();<br/>                <br/>        console.log(strEventAddress);<br/>        console.log(strAccountAddress);<br/>        console.log(strEventAddress.valueOf() == strAccountAddress.valueOf())<br/>                <br/>        <strong class="kg hu">if</strong> (strEventAddress.valueOf() == strAccountAddress.valueOf()) {<br/>            $("#loaderChoice").hide();<br/>            loadState(Ballot);<br/>         }<br/>    })<br/>    .on('data', (event) =&gt; {<br/>    })<br/>    .on('changed', (event) =&gt; {<br/>    })<br/>    .on('error', console.error)           <br/>}</span></pre><p id="0baa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kz la lb kg b">watchVoteDone()</code>等待<code class="eh kz la lb kg b">voteDone</code>事件被触发。<code class="eh kz la lb kg b">voteDone</code>是选民投票时触发的。由于<code class="eh kz la lb kg b">voteDone</code>是在每次选民登记中的任何一个选民投票时触发的，所以代码会检查这个<code class="eh kz la lb kg b">voteDone</code>事件是否是由这个选民自己触发的，而不是碰巧同时投票的另一个选民。然后用<code class="eh kz la lb kg b">loadState()</code>重新加载投票状态，隐藏【是】和【否】按钮。</p><p id="5bd6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">加载选票信息</strong></p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="bba6" class="kk kl ht kg b fv km kn l ko kp">async <strong class="kg hu">function</strong> <strong class="kg hu">loadFinalResult</strong>(myBallot){<br/>    myBallot.methods.finalResult().call().then((result) =&gt; {<br/>        $("#lbl_result").html("&lt;b&gt;Result: &lt;/b&gt;" + result);<br/>    });<br/>}</span></pre><p id="c1ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kz la lb kg b">loadFinalResult()</code>从选票智能合约中获取最终投票结果，并将其显示在投票DApp的用户界面中。</p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="f650" class="kk kl ht kg b fv km kn l ko kp">async <strong class="kg hu">function</strong> <strong class="kg hu">loadState</strong>(myBallot){<br/>    myBallot.methods.state().call().then((result) =&gt; {<br/>        <strong class="kg hu">if</strong> (result == 0){<br/>            $("#lbl_state").addClass("label label-primary");<br/>            $("#lbl_state").html("Created"); <br/>        }<br/>        <strong class="kg hu">else</strong> <strong class="kg hu">if</strong> (result == 1){<br/>            $("#lbl_state").addClass("label label-success");<br/>            $("#lbl_state").html("Voting"); <br/>        }                <br/>        <strong class="kg hu">else</strong> <strong class="kg hu">if</strong> (result == 2){<br/>            $("#lbl_state").addClass("label label-danger");<br/>            $("#lbl_state").html("Ended");                    <br/>        } <br/>        loadVoter(myBallot, accountaddress, result);<br/>        <strong class="kg hu">return</strong> result;<br/>    });<br/>}</span></pre><p id="337a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kz la lb kg b">loadState()</code>找出智能投票合同的当前状态，并在投票DApp的用户界面中显示“已创建”、“投票”或“已结束”。</p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="5267" class="kk kl ht kg b fv km kn l ko kp">async <strong class="kg hu">function</strong> <strong class="kg hu">loadVoter</strong>(myBallot, _myVoterAddress, _state){<br/>    myBallot.methods.voterRegister(_myVoterAddress).call().then((result) =&gt; {<br/>        <strong class="kg hu">if</strong> (result.voterName != "" &amp;&amp; _state == 1) {<br/>            $("#loaderChoice").hide();<br/>            $("#section_voting").show();<br/>                    <br/>            $("#lbl_voter").html("&lt;b&gt;Your Name: &lt;/b&gt;" + result.voterName);<br/>            console.log(result.voted);<br/>            <strong class="kg hu">if</strong> (result.voted){<br/>                $("#btnYes").hide();<br/>                $("#btnNo").hide(); <br/>                $("#lblVoted").html("&lt;span class='label label-primary'&gt;Voted&lt;/span&gt;");<br/>            }<br/>            <strong class="kg hu">else</strong> {<br/>                $("#btnYes").show();<br/>                $("#btnNo").show();                        <br/>            }<br/>        }<br/>        <strong class="kg hu">else</strong>{<br/>            $("#btnYes").hide();<br/>            $("#btnNo").hide();                     <br/>        }<br/>    } );<br/>}</span></pre><p id="338d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh kz la lb kg b">loadVoter() </code>检查选票智能合约上的选民登记册，查看该选民的钱包地址是否已注册为选民。如果他不是，那他就没有资格投票。[是]和[否]按钮被隐藏。</p><p id="ed6f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">它还检查投票智能契约的当前状态是否允许投票。如果是，则打开[是]和[否]按钮供投票人按下。</p><p id="aafc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，它检查投票人之前是否已经投票。如果有，则[是]和[否]按钮被隐藏，投票只看到“已投票”通知。</p><p id="bb76" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">按钮</strong></p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="04e9" class="kk kl ht kg b fv km kn l ko kp">$("#btnYes").click(async <strong class="kg hu">function</strong>(){<br/>    $("#loaderChoice").show();<br/>            <br/>    <em class="lh">//estimate first</em><br/>    <strong class="kg hu">var</strong> mygas;<br/>   	Ballot.methods.doVote(true).estimateGas({from: accountaddress})<br/>    .then(<strong class="kg hu">function</strong>(gasAmount){<br/>    mygas = gasAmount;<br/>    })<br/>            <br/>   	Ballot.methods.doVote(true).send({<br/>        from: accountaddress,<br/>        gas: mygas, <br/>        gasPrice: web3.eth.gasPrice      	    <br/>   	})<br/>    .on('transactionHash', (hash) =&gt; {</span><span id="f705" class="kk kl ht kg b fv li kn l ko kp">    })<br/>    .on('receipt', (receipt) =&gt; {<br/>        console.log("done");<br/>    })<br/>    .on('confirmation', (confirmationNumber, receipt) =&gt; {</span><span id="1094" class="kk kl ht kg b fv li kn l ko kp">     })<br/>    .on('error', console.error);<br/>});</span><span id="25a1" class="kk kl ht kg b fv li kn l ko kp">$("#btnNo").click(async <strong class="kg hu">function</strong>(){<br/>    $("#loaderChoice").show();<br/>    <em class="lh">//estimate first</em><br/>    <strong class="kg hu">var</strong> mygas;<br/>   	Ballot.methods.doVote(false).estimateGas({from: accountaddress})<br/>    .then(<strong class="kg hu">function</strong>(gasAmount){<br/>        mygas = gasAmount;<br/>    })<br/>            <br/>  	Ballot.methods.doVote(false).send({<br/>        from: accountaddress,<br/>        gas: mygas, <br/>        gasPrice: web3.eth.gasPrice       	    <br/>   	})<br/>    .on('transactionHash', (hash) =&gt; {</span><span id="12f8" class="kk kl ht kg b fv li kn l ko kp">     })<br/>    .on('receipt', (receipt) =&gt; {<br/>        console.log("done");<br/>    })<br/>    .on('confirmation', (confirmationNumber, receipt) =&gt; {</span><span id="c2d5" class="kk kl ht kg b fv li kn l ko kp">    })<br/>    .on('error', console.error);<br/>});</span></pre><p id="222d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">[是]和[否]按钮将执行选票智能合同上的<code class="eh kz la lb kg b">Ballot.methods.doVote(true)</code>和<code class="eh kz la lb kg b">Ballot.methods.doVote(false)</code>对提案进行投票。</p><pre class="jp jq jr js fq kf kg kh ki aw kj dt"><span id="4596" class="kk kl ht kg b fv km kn l ko kp">$("#btnGo").click(async <strong class="kg hu">function</strong>() {	<br/>    $("#loader").show();<br/>    <strong class="kg hu">var</strong> _ballotAddress = $("#txtBallotAddress").val();<br/>    getContract(_ballotAddress);<br/>});</span></pre><p id="9032" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">用户按下[Go]按钮加载选票智能合同。它执行<code class="eh kz la lb kg b">getContract()</code>让投票人看到提案并投票。</p><p id="6fa7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">回顾过去</strong></p><p id="1cd9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这就完成了对区块链的<em class="lh">投票。我非常喜欢开发投票DApp及其附带的这一系列文章。请务必将您的反馈发送给我。如果你发现了一个bug，或者你已经分叉了我的代码，并从中构建了一些很酷的东西，请让我知道它如何变得更好。</em></p><p id="98f6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您喜欢本教程，也许您也希望阅读:</p><ul class=""><li id="32cf" class="kq kr ht is b it iu ix iy jb ks jf kt jj ku jn lj kw kx ky dt translated">最小可行以太坊移动钱包:我为需要移动以太坊钱包的项目构建的基于React Native的模板。</li><li id="fe00" class="kq kr ht is b it lc ix ld jb le jf lf jj lg jn lj kw kx ky dt translated"><a class="ae ke" rel="noopener" href="/coinmonks/deploy-a-private-ethereum-blockchain-in-10-minutes-with-kaleido-73c21a26d5bb">使用Kaleido </a>在10分钟内部署一个私有以太坊区块链:瞬间启动并运行一个私有以太坊区块链。</li><li id="df47" class="kq kr ht is b it lc ix ld jb le jf lf jj lg jn lj kw kx ky dt translated"><a class="ae ke" rel="noopener" href="/coinmonks/smart-contract-explained-by-demonstration-93b06e938474">通过演示解释智能合约</a>:托管服务智能合约DApp的演示——在我看来，这是向外行人解释区块链是什么的最快方式。</li><li id="73ed" class="kq kr ht is b it lc ix ld jb le jf lf jj lg jn lj kw kx ky dt translated"><a class="ae ke" rel="noopener" href="/coinmonks/internet-of-trusted-things-ethereum-kid-grounding-device-part-1-how-it-works-3cb1e8dd7db0">以太坊IOT Kid Grounding Device </a>:我将区块链与物联网结合的尝试。</li><li id="5bd1" class="kq kr ht is b it lc ix ld jb le jf lf jj lg jn lj kw kx ky dt translated"><a class="ae ke" rel="noopener" href="/coinmonks/lottery-as-a-smart-contract-the-business-logic-3bd22d3a6c4e">彩票作为智能合约</a>:分布式彩票，在以太坊区块链上构建彩票系统的尝试。</li></ul><blockquote class="lk"><p id="e816" class="ll lm ht bd ln lo lp lq lr ls lt jn ek translated"><a class="ae ke" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="lv lw lx ly lz jt fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff lu"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><figure class="jp jq jr js fq jt fe ff paragraph-image"><a href="https://coincodecap.com"><div class="fe ff ma"><img src="../Images/a06b758bdcc47dca7c2504f298674d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_s6JsD3P0hVj32E7t9EtGg.jpeg"/></div></a></figure></div></div>    
</body>
</html>