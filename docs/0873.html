<html>
<head>
<title>Predicting a Startups Profit/Success Rate using Multiple Linear Regression in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python中的多元线性回归预测创业公司的利润/成功率</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/predicting-a-startups-profit-success-rate-using-multiple-linear-regression-in-python-3ceb91650b24?source=collection_archive---------1-----------------------#2018-06-27">https://medium.com/coinmonks/predicting-a-startups-profit-success-rate-using-multiple-linear-regression-in-python-3ceb91650b24?source=collection_archive---------1-----------------------#2018-06-27</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/ec974f79677dde4221db0115a131ee0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1cwTUXwgKU-sOoyGsCyTyw.jpeg"/></div></div></figure><blockquote class="jb jc jd"><p id="bcad" class="je jf jg jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">在使用多元线性回归建立这个模型时，我们处理了一个包含50家初创公司详细信息的数据集，并根据某些特征预测了一家新初创公司的利润。对于风险资本家来说，这可能是一个福音，他们是否应该投资于某个特定的创业公司。假设你为一家风险投资公司工作，你的公司聘请你作为数据科学家来获得对数据的洞察力，并帮助他们预测投资某家初创公司是否安全。<br/>我们还可以通过实际观察在特定的州启动一家初创公司会有什么不同，来获得对数据的有用见解。或者，哪家初创公司最终表现更好，是因为他们在营销上花了更多的钱，还是因为他们出色的研发部门让他们获得了巨额利润，进而获得了巨大的声誉和成功。</p></blockquote></div><div class="ab cl kd ke hb kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hm hn ho hp hq"><h1 id="0f73" class="kk kl ht bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">那么这篇文章的读者是谁呢？</h1><p id="1497" class="pw-post-body-paragraph je jf ht jh b ji li jk jl jm lj jo jp lk ll js jt lm ln jw jx lo lp ka kb kc hm dt translated">你可以是刚刚完成机器学习MOOC的人，也可以是正在寻找基于机器学习的更实用/动手项目的初露头角的数据科学家。</p><p id="76f2" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">如果你想将一些商业方面与机器学习结合起来，这也是相关的。</p><h1 id="0e33" class="kk kl ht bd km kn lq kp kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh dt translated">我们还在等什么？我们开始吧！！</h1><p id="844d" class="pw-post-body-paragraph je jf ht jh b ji li jk jl jm lj jo jp lk ll js jt lm ln jw jx lo lp ka kb kc hm dt translated">我将要提到的可能更多的是机器学习的理论方面，但是一点理论知识也没有坏处！:P <br/>在继续建立线性回归模型之前，有一些假设应该是正确的… <br/> 1)线性度<br/> 2)同态方差<br/> 3)多元正态性<br/> 4)误差的独立性<br/> 5)缺乏多重共线性<br/>我不会讨论所有这些事情，但是如果我们将来将线性回归作为我们的最大似然算法，我们必须尝试并跟踪它们。有兴趣的人可以自己研究一下！！</p><h1 id="2882" class="kk kl ht bd km kn lq kp kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh dt translated">第1部分—数据预处理</h1><p id="18cc" class="pw-post-body-paragraph je jf ht jh b ji li jk jl jm lj jo jp lk ll js jt lm ln jw jx lo lp ka kb kc hm dt translated">正在导入库…</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="82f4" class="me kl ht ma b fv mf mg l mh mi"><em class="jg">import </em>numpy <em class="jg">as </em>np<br/><em class="jg">import </em>matplotlib.pyplot <em class="jg">as </em>plt<br/><em class="jg">import </em>pandas <em class="jg">as </em>pd</span></pre><p id="fbe5" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">导入数据集</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="1a72" class="me kl ht ma b fv mf mg l mh mi">dataset = pd.read_csv('50_Startups.csv')</span></pre><p id="cbc4" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">这就是数据集的样子…</p><figure class="lv lw lx ly fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mj"><img src="../Images/ff14daa0225fc5bee8a82cea28f4a369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zgxb864ZvBuqsmVx2S2Oww.png"/></div></div></figure><p id="777b" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">数据集包含以下特征(独立变量):— <br/> ……..1)R&amp;D Spend——初创公司在研发上花费的资金总额。<br/> ……..2)管理-初创公司在管理上花费的资金总额。<br/> ……..3)营销支出-初创公司在营销上花费的资金总额。<br/> ……..4)州-创业公司启动或运营的州或地区。</p><p id="f8c1" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">为了在X中存储特征，我们使用…</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="711f" class="me kl ht ma b fv mf mg l mh mi">X = dataset.iloc[:, :-1].values</span></pre><p id="4fea" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">因变量利润告诉你创业公司获得的利润。</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="bfb1" class="me kl ht ma b fv mf mg l mh mi">y = dataset.iloc[:, 4].values</span></pre><blockquote class="jb jc jd"><p id="82fe" class="je jf jg jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">如果我们看一下我们的数据集，我们可以清楚地看到状态是一个字符串类型的变量，就像我们已经讨论过的那样，我们不能将字符串类型的变量输入到我们的机器学习模型中，因为它只能处理数字。为了克服这个问题，我们使用标签编码器对象，并使用OneHotEncoder对象创建虚拟变量… <br/>假设我们的数据集中只有纽约州和加利福尼亚州这两个州，那么我们的OneHotEncoder将只有2列… <br/>类似地，对于n个不同的州，它将有n列，每个州将由一系列0和1表示，其中所有列都为0 <br/>，除了该特定州的列。<br/>举个例子:- <br/>如果A，B，C是3个状态，那么A=100，B=010，C=001 <br/>我想现在你可能明白我的意思了，关于OneHotEncoder是如何工作的…</p></blockquote><h2 id="f90d" class="me kl ht bd km mk ml mm kq mn mo mp ku lk mq mr ky lm ms mt lc lo mu mv lg mw dt translated">编码分类数据</h2><p id="5578" class="pw-post-body-paragraph je jf ht jh b ji li jk jl jm lj jo jp lk ll js jt lm ln jw jx lo lp ka kb kc hm dt translated">将标签编码器类与OneHotEncoder一起导入</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="1527" class="me kl ht ma b fv mf mg l mh mi"><em class="jg">from </em>sklearn.preprocessing <em class="jg">import </em>LabelEncoder, OneHotEncoder</span></pre><p id="f0f1" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">创建标签编码器类的对象</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="3f5d" class="me kl ht ma b fv mf mg l mh mi">labelencoder = LabelEncoder()</span></pre><p id="8c04" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">很明显，唯一的分类数据是存储在数据集中第三个索引处的州名，因此我们对该列进行了编码！</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="44f9" class="me kl ht ma b fv mf mg l mh mi">X[:, 3] = labelencoder.fit_transform(X[:, 3])<br/>onehotencoder = OneHotEncoder(categorical_features = [3])<br/>X = onehotencoder.fit_transform(X).toarray()</span></pre><h1 id="1c6e" class="kk kl ht bd km kn lq kp kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh dt translated">避免虚拟变量陷阱</h1><p id="67ba" class="pw-post-body-paragraph je jf ht jh b ji li jk jl jm lj jo jp lk ll js jt lm ln jw jx lo lp ka kb kc hm dt translated">线性回归方程看起来像这样—&gt; y = b(0)+b(1)x(1)+b(2)x(2)+b(3)x(3)+b(4)D(1)+b(5)D(2)+b(6)D(3)…b(n+3)D(m-1)<br/>这里D(1)…D(m-1)是m个虚拟变量，我们之前在LabelEncoder和OneHotEncoder <br/>中定义过！</p><p id="2671" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">从包含OneHotEncoded值之一的数据集中删除第一列…</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="e99e" class="me kl ht ma b fv mf mg l mh mi">X = X[:, 1:]</span></pre><h2 id="e06f" class="me kl ht bd km mk ml mm kq mn mo mp ku lk mq mr ky lm ms mt lc lo mu mv lg mw dt translated"><strong class="ak">将数据集分为训练集和测试集</strong></h2><p id="e4d9" class="pw-post-body-paragraph je jf ht jh b ji li jk jl jm lj jo jp lk ll js jt lm ln jw jx lo lp ka kb kc hm dt translated">导入库并应用交叉验证，80%的数据作为训练数据，20%作为测试数据。</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="fabb" class="me kl ht ma b fv mf mg l mh mi"><em class="jg">from </em>sklearn.model_selection <em class="jg">import </em>train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)</span></pre><h1 id="929c" class="kk kl ht bd km kn lq kp kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh dt translated">第2部分—拟合我们的线性回归模型</h1><h2 id="bcc4" class="me kl ht bd km mk ml mm kq mn mo mp ku lk mq mr ky lm ms mt lc lo mu mv lg mw dt translated">将多元线性回归拟合到训练集</h2><p id="d0c5" class="pw-post-body-paragraph je jf ht jh b ji li jk jl jm lj jo jp lk ll js jt lm ln jw jx lo lp ka kb kc hm dt translated">线性回归方程看起来像这样—&gt; y = b(0)+b(1)x(1)+b(2)x(2)+b(3)x(3)+b(4)D(1)+b(5)D(2)+b(6)D(3)…b(n+3)D(m-1)</p><p id="fecd" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">导入线性回归类</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="f1c0" class="me kl ht ma b fv mf mg l mh mi"><em class="jg">from </em>sklearn.linear_model <em class="jg">import </em>LinearRegression</span></pre><p id="c38e" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">创建线性回归类的对象</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="b627" class="me kl ht ma b fv mf mg l mh mi">regressor = LinearRegression()</span></pre><p id="e1ec" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">使创建的对象适合我们的训练集</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="e930" class="me kl ht ma b fv mf mg l mh mi">regressor.fit(X_train, y_train)</span></pre><h1 id="e3c3" class="kk kl ht bd km kn lq kp kq kr lr kt ku kv ls kx ky kz lt lb lc ld lu lf lg lh dt translated">第3部分—预测测试集结果</h1><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="eb11" class="me kl ht ma b fv mf mg l mh mi">y_pred = regressor.predict(X_test)</span></pre><p id="4ef2" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">打印预测值</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="1f70" class="me kl ht ma b fv mf mg l mh mi">print(y_pred)</span></pre><p id="e63b" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">为了查看预测结果和实际结果的差异，我们还将打印测试值</p><pre class="lv lw lx ly fq lz ma mb mc aw md dt"><span id="2c2e" class="me kl ht ma b fv mf mg l mh mi">print(y_test)</span></pre><blockquote class="jb jc jd"><p id="43a0" class="je jf jg jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">你认为这实际上是我们刚刚建立的最佳模型吗？我们的模型包含了所有的特征，其中一些特征对我们的预测在统计上是不重要的。我们需要做的是找到一组对我们的预测有实际帮助的独立变量。<br/>为此，我们使用了另一种叫做<strong class="jh hu">逆向淘汰</strong>的方法来建立一个最优模型……<br/>但这是另一个故事，需要一篇自己的文章:P敬请关注！！</p></blockquote><p id="b30c" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">Yayyy！！所以你刚刚建立了一个多元线性回归模型来预测一个新成立的公司的利润。雇佣你作为数据科学家的风险投资家现在能够做出明智的决定，他是否需要投资一个特定的创业公司！</p><p id="0690" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">我希望你喜欢我的教程！我将github(现在是Gitlab :P)链接附加到代码和数据集上。</p><div class="mx my fm fo mz na"><a href="https://github.com/Sid-darthvader/Predicting_Startup_Profits_using_Multiple_Linear_Regression" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab ej"><div class="nc ab nd cl cj ne"><h2 class="bd hu fv z el nf eo ep ng er et hs dt translated">sid-Darth Vader/Predicting _ Startup _ Profits _ using _ Multiple _ Linear _ Regression</h2><div class="nh l"><h3 class="bd b fv z el nf eo ep ng er et ek translated">predicting _ Startup _ Profits _ using _ Multiple _ Linear _ Regression-这包含了我们如何预测利润的模型…</h3></div><div class="ni l"><p class="bd b gc z el nf eo ep ng er et ek translated">github.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no iz na"/></div></div></a></div><p id="00c3" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">谁知道你的模式可能会成为下一个谷歌的资金来源；P </p><p id="4ef9" class="pw-post-body-paragraph je jf ht jh b ji jj jk jl jm jn jo jp lk jr js jt lm jv jw jx lo jz ka kb kc hm dt translated">参考文献-机器学习课程，作者:基里尔·叶列缅科和哈德琳·德·庞特维斯</p></div></div>    
</body>
</html>