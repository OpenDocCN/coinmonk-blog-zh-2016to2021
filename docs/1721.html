<html>
<head>
<title>Smart Contract Escrow DApp — Seller View</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">智能合同托管DApp-卖方视图</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/smart-contract-escrow-dapp-seller-view-f244b4a557fd?source=collection_archive---------6-----------------------#2018-10-28">https://medium.com/coinmonks/smart-contract-escrow-dapp-seller-view-f244b4a557fd?source=collection_archive---------6-----------------------#2018-10-28</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/b38c8f7c3cfc06e2a86953843ca41f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GiGCEN99FAOx_hlFVBYbJQ.jpeg"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">Photo by <a class="ae jf" href="https://unsplash.com/photos/kzhHEkQa4BQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Alex Person</a> on <a class="ae jf" href="https://unsplash.com/search/photos/seller?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d230" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这是2部分文章中的第一部分，解释了由演示解释的<a class="ae jf" rel="noopener" href="/coinmonks/smart-contract-explained-by-demonstration-93b06e938474">智能合约背后的代码，对于想要学习如何编写基于Web3的</a><a class="ae jf" href="https://ethereum.stackexchange.com/questions/383/what-is-a-dapp" rel="noopener ugc nofollow" target="_blank">Dapp</a>作为Solidity智能合约的前端用户界面的开发人员来说，这将会很有意义。特别是，本文解释了以下方法:</p><ol class=""><li id="5f9a" class="ke kf ht ji b jj jk jn jo jr kg jv kh jz ki kd kj kk kl km dt translated">在JavaScript中执行智能合同功能</li><li id="32d8" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated">写作和阅读来自<a class="ae jf" href="https://ipfs.io/" rel="noopener ugc nofollow" target="_blank"> IPFS </a></li></ol><p id="223b" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在开发这个DApp时，我使用了几个第三方库，即:</p><ol class=""><li id="d19b" class="ke kf ht ji b jj jk jn jo jr kg jv kh jz ki kd kj kk kl km dt translated"><a class="ae jf" href="https://datatables.net/" rel="noopener ugc nofollow" target="_blank"> jQuery数据表</a></li><li id="d24a" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated"><a class="ae jf" href="https://jquery.com/" rel="noopener ugc nofollow" target="_blank"> jQuery </a></li><li id="f2ae" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated"><a class="ae jf" href="https://github.com/ethereum/web3.js/" rel="noopener ugc nofollow" target="_blank"> Web3 </a></li><li id="92d2" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated"><a class="ae jf" href="https://github.com/ipfs/js-ipfs-api" rel="noopener ugc nofollow" target="_blank"> IPFS </a></li></ol><p id="2015" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在这一部分中，我将关注销售者的UI。</p><p id="d53d" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">Dapp使用的StartEscrow智能合同可以在这里找到<a class="ae jf" href="https://github.com/jacksonng77/StartEscrow/blob/master/Solidity/StartEscrowV2.sol" rel="noopener ugc nofollow" target="_blank">这里</a>我以前写过一篇关于它如何工作的文章<a class="ae jf" rel="noopener" href="/coinmonks/creating-smart-contracts-with-smart-contract-d54e21d26e00">这里</a>。</p><p id="02e1" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">你可以在我的Github库<a class="ae jf" href="https://github.com/jacksonng77/StartEscrow/blob/master/Web3/index.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到完整的卖方源代码。在接下来的部分中，我将引用我在Github中的代码的行号。</p><p id="660a" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">初始化</strong></p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="11a5" class="lb lc ht kx b fv ld le l lf lg"><strong class="kx hu">if</strong> (<strong class="kx hu">typeof</strong> web3 !== 'undefined') { <br/>     web3 = <strong class="kx hu">new</strong> Web3(web3.currentProvider); <br/>} <br/><strong class="kx hu">else</strong> <br/>{ <br/>     // set the provider you want from Web3.providers <br/>     web3 = <strong class="kx hu">new</strong> Web3(<strong class="kx hu">new</strong> Web3.providers.HttpProvider("http://localhost:8545")); <br/>}</span></pre><p id="5a8e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">第91到96行初始化web3。这里，web3库检查UI是否是从具有web3提供者的web浏览器执行的。如果你在Chrome浏览器上安装了<a class="ae jf" href="https://metamask.io/" rel="noopener ugc nofollow" target="_blank"> MetaMask </a>或者在<a class="ae jf" href="https://status.im/" rel="noopener ugc nofollow" target="_blank">状态</a>下运行这个页面，Dapps的移动应用程序就会运行。否则，web3将试图在您的机器中寻找一个正在运行的Web3提供程序来使用。</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="9ff0" class="lb lc ht kx b fv ld le l lf lg">ipfs = <strong class="kx hu">new</strong> window.IpfsApi('ipfs.infura.io', '5001', { protocol: 'https' }); <br/>ipfs.id(function(err, res) { <br/>     <strong class="kx hu">if</strong> (err) <strong class="kx hu">throw</strong> err <br/>              console.log("Connected to IPFS node!", res.id, res.agentVersion, res.protocolVersion); <br/>}); <br/>web3.eth.defaultAccount = web3.eth.accounts[0]; <br/>var Buffer = window.IpfsApi().Buffer;</span></pre><p id="b1e9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">第98到104行初始化IPFS，销售者的产品图像将被存储在这里。这里，我们在<a class="ae jf" href="https://infura.io/" rel="noopener ugc nofollow" target="_blank"> Infura </a>上使用一个公共IPFS实例。要了解更多关于IPFS的信息，你可以参考我之前写的文章，这篇文章展示了IPFS如何与Solidity和JavaScript一起工作。</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="7c8e" class="lb lc ht kx b fv ld le l lf lg">web3.eth.defaultAccount = web3.eth.accounts[0];</span></pre><p id="688f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">第106行说这个Dapp将使用你的Web3提供者中的默认帐户。例如，如果你使用MetaMask和Chrome来运行这个Dapp，并且有几个钱包，它将使用你的第一个钱包中的ETH。</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="76e8" class="lb lc ht kx b fv ld le l lf lg">var PurchaseContract = web3.eth.contract( <br/>     [ <br/>        { "constant": true, <br/>          "inputs": [], <br/>          "name": "seller", <br/>          "outputs": [<br/>            ..... <br/>      ]<br/> );</span></pre><p id="68da" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在<a class="ae jf" href="https://github.com/jacksonng77/StartEscrow/blob/master/Solidity/StartEscrowV2.sol" rel="noopener ugc nofollow" target="_blank"> StartEscrow.sol </a>中有2个智能合约。第108到204行陈述了第一个智能合同——purchase Contract的<a class="ae jf" href="https://ethereum.stackexchange.com/questions/234/what-is-an-abi-and-why-is-it-needed-to-interact-with-contracts" rel="noopener ugc nofollow" target="_blank">应用程序二进制接口(ABI) </a>。智能合约的ABI可以通过将智能合约代码复制并粘贴到<a class="ae jf" href="https://remix.ethereum.org/" rel="noopener ugc nofollow" target="_blank"> Remix </a>并编译您的合约来获得。</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="bed1" class="lb lc ht kx b fv ld le l lf lg">var StartEscrowContract = web3.eth.contract( <br/>      [ <br/>          { "constant": false, <br/>            "inputs": <br/>            [<br/>               ...... <br/>      ] <br/>);</span></pre><p id="aa87" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">第242到348行说明了第二个智能合同的ABI—<code class="eh lh li lj kx b">StartEscrowContract</code>。</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="3c92" class="lb lc ht kx b fv ld le l lf lg">var StartEscrow = StartEscrowContract.at('0x05525d0692794ee5a19fa8b259f1100358ffc882');</span></pre><p id="92d0" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">第349行说明了我正在运行的StartEscrowContract的地址。您可以将该地址复制并粘贴到<a class="ae jf" href="https://ropsten.etherscan.io/" rel="noopener ugc nofollow" target="_blank"> Etherscan Ropsten </a>中进行查看。这个DApp允许我们启动尽可能多的<code class="eh lh li lj kx b">PurchaseContract</code>实例。</p><p id="6e0a" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">检索采购合同</strong></p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="5b36" class="lb lc ht kx b fv ld le l lf lg">//retrieve all the contracts from the blockchain first <br/>StartEscrow.getContractCount(function(error, result){ <br/>      <strong class="kx hu">if</strong>(!error){ <br/>               console.log(JSON.stringify(result)); <br/>               var contractCount = Number(result); <br/>               var t = $("#contractTable").DataTable(); t.clear(); <br/>               <strong class="kx hu">for</strong> (var i = 0; i&lt;contractCount; i++){ <br/>                           StartEscrow.contracts(i,function(error, result){ <br/>                                         <strong class="kx hu">if</strong>(!error){ <br/>                                               t.row.add([result]).draw(false); <br/>                                               console.log(JSON.stringify(result)); <br/>                                         } <strong class="kx hu">else</strong>{ <br/>                                               console.error(error); <br/>                                         } <br/>                           }); <br/>              } <br/>     } <br/>    <strong class="kx hu">else</strong>{ <br/>              console.error(error); <br/>     } <br/>});</span></pre><p id="f7be" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">第353到374行检索所有由StartEscrow启动的购买合同。它初始化数据表，读取采购合同的每个实例，并将它们的地址添加到表中。你可以在下面的“所有合同”部分看到一个例子。</p><figure class="ks kt ku kv fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lk"><img src="../Images/3f23fbe5b47e8efa612db524963e21e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y1M7I90ryRnH4FoZ.png"/></div></div></figure><p id="06c9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">发布待售商品</strong></p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="c471" class="lb lc ht kx b fv ld le l lf lg">$("#file-upload").change(function() { <br/>     $("#loader").show(); <br/>     var reader = <strong class="kx hu">new</strong> FileReader(); <br/>     reader.onload = function() { <br/>          mybuffer = Buffer.from(<strong class="kx hu">this</strong>.result); <br/>          ipfs.files.add(mybuffer, function(err, result){ <br/>               <strong class="kx hu">if</strong> (err) { <br/>                    console.log("Error"); <br/>               } <br/>               <strong class="kx hu">else</strong> { <br/>                    ipfsHash = result[0].hash; <br/>                    StartEscrow.newPurchase(ipfsHash, {value: $("#price").val()*1000000000000000000, gas: 1000000, gasPrice: web3.toWei(2, 'gwei')}, <br/>                    function(error, result){ <br/>                           <strong class="kx hu">if</strong>(!error){ <br/>                                   console.log(JSON.stringify(result)); <br/>                           } <br/>                           <strong class="kx hu">else</strong>{ <br/>                                   console.error(error); <br/>                           } <br/>                      }); <br/>                } <br/>             }); <br/>    } <br/>    reader.readAsArrayBuffer(<strong class="kx hu">this</strong>.files[0]); <br/>})</span></pre><p id="dcc7" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><code class="eh lh li lj kx b">("#file-upload").change(); </code>是在用户从他的机器上选择一张图片并输入物品的售价后执行的。</p><p id="1459" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">上面的第400到425行读取图像，将它转换成一个缓冲区，并将其添加到IPFS文件系统。IPFS文件系统根据文件上传的内容生成哈希代码。<code class="eh lh li lj kx b">StartEscrow.newPurchase</code>通过提供IPFS散列、该项目的销售价格和天然气价格来执行，以作为运行合同的参数。</p><figure class="ks kt ku kv fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lk"><img src="../Images/dc33b2d8691b829231a983054f83b8d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gJQ6uWdDUZ7TbRQd.png"/></div></div></figure><figure class="ks kt ku kv fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ll"><img src="../Images/755fda19d9ed19bfee16d18236201a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EpWxwXo7Ewxf3Gyx.png"/></div></div></figure><p id="7403" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">关注采购合同的成功执行</strong></p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="f7fb" class="lb lc ht kx b fv ld le l lf lg">var newPurchaseContractEvent = StartEscrow.newPurchaseContract();<br/>    	newPurchaseContractEvent.watch(function(error, result){<br/>            <strong class="kx hu">if</strong> (!error)<br/>                {<br/>                    $("#loader").hide();<br/>                    $("#contractaddress").html("Contract: " + result.args.contractAddress);<br/>                	loadContractDetail(result.args.contractAddress);<br/>                	var t = $("#contractTable").DataTable();<br/>                    t.row.add([result.args.contractAddress]).draw(false);<br/>                    <br/>                    ipfs.pin.add(ipfsHash, function (err) {<br/>                    	<strong class="kx hu">if</strong> (err){<br/>							console.log("cannot pin");<br/>                        }<br/>                    	<strong class="kx hu">else</strong>{<br/>                        	console.log("pin ok");<br/>                        }<br/>                    });<br/>                    <br/>                } <strong class="kx hu">else</strong> {<br/>                    $("#loader").hide();<br/>                    console.log(error);<br/>                }<br/>        });</span></pre><p id="2e8d" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">第375到398行等待和观察购买合同的执行。一旦采购合同生效，它将:</p><ol class=""><li id="207e" class="ke kf ht ji b jj jk jn jo jr kg jv kh jz ki kd kj kk kl km dt translated">用此合同的详细资料更新合同详细资料部分</li><li id="dae1" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated">将合同的地址添加到数据表中。</li><li id="e343" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated">将映像固定到IPFS，以便将其永久写入文件系统。</li></ol><figure class="ks kt ku kv fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lm"><img src="../Images/34843dfb77ca3d853fa626d1118e20ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sIXEKHJSPvzMv6O-.png"/></div></div></figure><p id="3263" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">点击采购合同地址</strong></p><p id="4fe0" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">卖方DApp允许卖方监控他已经执行的购买合同。为此，请点击表格中的地址并阅读合同详情。</p><figure class="ks kt ku kv fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ln"><img src="../Images/2748edfb40e3478ff1836274e44764ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZdKZIlHmUBiAmiAe.png"/></div></div></figure><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="f7f4" class="lb lc ht kx b fv ld le l lf lg">$(document).ready( function () {<br/>    		var table = $('#contractTable').DataTable();<br/>           	$('#contractTable tbody').on( 'click', 'tr', function () {<br/>        		<strong class="kx hu">if</strong> ( $(<strong class="kx hu">this</strong>).hasClass('selected') ) {<br/>            		$(<strong class="kx hu">this</strong>).removeClass('selected');<br/>        		}<br/>        		<strong class="kx hu">else</strong> {<br/>            		table.$('tr.selected').removeClass('selected');<br/>            		$(<strong class="kx hu">this</strong>).addClass('selected');<br/>        		}<br/>    		} );<br/> <br/>			$('#contractTable tbody').on('click', 'tr', function () {<br/>				var data = table.row( <strong class="kx hu">this</strong> ).data();<br/>            	$("#contractaddress").html("Contract: " + data[0]);<br/>				loadContractDetail(data[0]);<br/>			} );<br/>		} );</span></pre><p id="3803" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">第72到89行初始化数据表。它还说明了当用户单击数据表中的一个合同地址时会发生什么情况— <code class="eh lh li lj kx b">loadContracDetails() </code>将执行以在合同细节部分加载该采购合同的细节。</p><pre class="ks kt ku kv fq kw kx ky kz aw la dt"><span id="93d8" class="lb lc ht kx b fv ld le l lf lg">function loadContractDetail(address){<br/>    	var Purchase = PurchaseContract.at(address);<br/>    <br/>    	Purchase.value(function(error, result){<br/>   			<strong class="kx hu">if</strong>(!error){<br/>            	console.log(JSON.stringify(result));<br/>       			$("#itemvalue").html("Price: " + Number(result)/1000000000000000000);<br/>            }<br/>   			<strong class="kx hu">else</strong>{<br/>       			console.error(error);<br/>            }<br/>		})/18;<br/>    <br/>    	Purchase.seller(function(error, result){<br/>   			<strong class="kx hu">if</strong>(!error){<br/>            	console.log(JSON.stringify(result));<br/>       			$("#seller").html("Seller: " + result);<br/>            }<br/>   			<strong class="kx hu">else</strong>{<br/>       			console.error(error);<br/>            }<br/>		});<br/>    <br/>        Purchase.buyer(function(error, result){<br/>   			<strong class="kx hu">if</strong>(!error){<br/>            	console.log(JSON.stringify(result));<br/>       			$("#buyer").html("Buyer: " + result);<br/>            }<br/>   			<strong class="kx hu">else</strong>{<br/>       			console.error(error);<br/>            }<br/>		});<br/>        Purchase.ipfsHash(function(error, result){<br/>   			<strong class="kx hu">if</strong>(!error){<br/>            	console.log(JSON.stringify(result));<br/>       			$("#ipfshash").html("IPFS Hash: " + result);<br/>       			$("#ipfsimage").html("&lt;img src=https://gateway.ipfs.io/ipfs/" + result + " width='400'&gt;");<br/>            }<br/>   			<strong class="kx hu">else</strong>{<br/>       			console.error(error);<br/>            }<br/>		});<br/>    <br/>        Purchase.state(function(error, result){<br/>   			<strong class="kx hu">if</strong>(!error){<br/>            	console.log(JSON.stringify(result));<br/>            	<strong class="kx hu">if</strong> (Number(result) === 0){<br/>                	$("#state").html('&lt;span class="badge progress-bar-success"&gt;Created&lt;/span&gt;');<br/>                }<br/>            	<strong class="kx hu">else</strong> <strong class="kx hu">if</strong> (Number(result) === 1){<br/>                	$("#state").html('&lt;span class="badge progress-bar-info"&gt;Locked&lt;/span&gt;');<br/>                }<br/>            	<strong class="kx hu">else</strong> {<br/>                	$("#state").html('&lt;span class="badge progress-bar-danger"&gt;Inactive&lt;/span&gt;');                <br/>                }<br/>            }<br/>   			<strong class="kx hu">else</strong>{<br/>       			console.error(error);<br/>            }<br/>		});<br/>    }</span></pre><p id="b777" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">第427到488行定义了<code class="eh lh li lj kx b">loadContractDetail()</code> does。<code class="eh lh li lj kx b">loadContractDetails() </code>接受采购合同的地址作为参数。然后，它调用相应的智能合同函数来检索合同详细信息部分，并用相关值填充该部分:</p><ol class=""><li id="184b" class="ke kf ht ji b jj jk jn jo jr kg jv kh jz ki kd kj kk kl km dt translated"><code class="eh lh li lj kx b">Purchase.value()</code> -这个物品的价值。</li><li id="7e56" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated"><code class="eh lh li lj kx b">Purchase.seller()</code>——卖家的地址。</li><li id="bc6a" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated"><code class="eh lh li lj kx b">Purchase.buyer()</code> -买方的地址。</li><li id="1fd1" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated"><code class="eh lh li lj kx b">Purchase.ipfsHash()</code> -项目图像的哈希值。</li><li id="f799" class="ke kf ht ji b jj kn jn ko jr kp jv kq jz kr kd kj kk kl km dt translated"><code class="eh lh li lj kx b">Purchase.state()</code> -该采购智能合同的当前状态</li></ol><p id="9296" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu">接下来是什么？</strong></p><p id="cf07" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在下一部分中，我将研究买方Dapp背后的代码。</p><p id="1efa" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><a class="ae jf" href="https://unsplash.com/photos/kzhHEkQa4BQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Alex Person </a>在<a class="ae jf" href="https://unsplash.com/search/photos/seller?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p><blockquote class="lo"><p id="493c" class="lp lq ht bd lr ls lt lu lv lw lx kd ek translated"><a class="ae jf" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="lz ma mb mc md iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff ly"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>