<html>
<head>
<title>NEO Smart Contract: Caller Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NEO智能合同:呼叫者验证</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/neo-smart-contract-caller-validation-58d99f21232a?source=collection_archive---------6-----------------------#2018-03-04">https://medium.com/coinmonks/neo-smart-contract-caller-validation-58d99f21232a?source=collection_archive---------6-----------------------#2018-03-04</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="7a6c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在许多情况下，如果不是所有情况，您可能想要验证调用您的契约代码的地址是否真的是他们所说的那个人。</p><figure class="jo jp jq jr fq js"><div class="bz el l di"><div class="jt ju l"/></div></figure><p id="ad54" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">幸运的是，我们提供了以下验证方法:</p><pre class="jo jp jq jr fq jv jw jx jy aw jz dt"><span id="8f9e" class="ka kb ht jw b fv kc kd l ke kf">boa.blockchain.vm.Neo.Runtime.CheckWitness</span></pre><p id="eceb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">该方法接受单个参数，该参数表示您希望根据用于调用协定代码的地址进行验证的地址。</p><p id="6e96" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">所提供的输入值可以是以下任何一种格式，可用于识别调用者地址:</p><pre class="jo jp jq jr fq jv jw jx jy aw jz dt"><span id="62f7" class="ka kb ht jw b fv kc kd l ke kf">#\xba\'\x03\xc52c\xe8\xd6\xe5"\xdc2 39\xdc\xd8\xee\xe9</span><span id="1259" class="ka kb ht jw b fv kg kd l ke kf">AK2nJJpJr6o664CWJKi1QRXjqeic2zRp8y</span><span id="6629" class="ka kb ht jw b fv kg kd l ke kf">031a6c6fbbdf02ca351745fa86b9ba5a9452d785ac4f7fc2b7548ca2a46c4fcf4a</span></pre><p id="f6ae" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">运行以下命令时，这些都可以在neo-python cli中找到:</p><pre class="jo jp jq jr fq jv jw jx jy aw jz dt"><span id="4f21" class="ka kb ht jw b fv kc kd l ke kf">wallet</span></pre><figure class="jo jp jq jr fq js fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff kh"><img src="../Images/b2a62af0272ff0f27182d8ea939ac683.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sXbvSxMIcqdMaWuXt-vPsg.png"/></div></div></figure><p id="c86a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了测试这一点，我们可以使用以下示例合同代码:</p><pre class="jo jp jq jr fq jv jw jx jy aw jz dt"><span id="1203" class="ka kb ht jw b fv kc kd l ke kf">from boa.blockchain.vm.Neo.Runtime import CheckWitness</span><span id="1f89" class="ka kb ht jw b fv kg kd l ke kf">def Main(caller):</span><span id="5349" class="ka kb ht jw b fv kg kd l ke kf">    isCaller = CheckWitness(caller)</span><span id="f670" class="ka kb ht jw b fv kg kd l ke kf">    if isCaller:<br/>        return True</span><span id="820c" class="ka kb ht jw b fv kg kd l ke kf">    return False</span></pre><p id="3636" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这将简单地验证为<strong class="is hu"> <em class="ko">调用者</em> </strong>提供的输入是否与用于调用契约的地址相匹配。</p><blockquote class="kp"><p id="f9ff" class="kq kr ht bd ks kt ku kv kw kx ky jn ek translated"><a class="ae kz" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="lb lc ld le lf js fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff la"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><p id="b48c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我们的neo-python cli中，我们可以使用下面的任何查询，通过我们的<a class="ae kz" href="https://youtu.be/L0al2gttTEs" rel="noopener ugc nofollow" target="_blank">构建&amp;测试方法</a>对此进行测试。</p><p id="4080" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">地址:</p><pre class="jo jp jq jr fq jv jw jx jy aw jz dt"><span id="cce4" class="ka kb ht jw b fv kc kd l ke kf">build smartContracts/callerValidation.py test 07 01 False False AK2nJJpJr6o664CWJKi1QRXjqeic2zRp8y</span></pre><p id="b343" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">公钥:</p><pre class="jo jp jq jr fq jv jw jx jy aw jz dt"><span id="4e36" class="ka kb ht jw b fv kc kd l ke kf">build smartContracts/callerValidation.py test 07 01 False False 031a6c6fbbdf02ca351745fa86b9ba5a9452d785ac4f7fc2b7548ca2a46c4fcf4a</span></pre><p id="eccd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">地址的脚本哈希:</p><pre class="jo jp jq jr fq jv jw jx jy aw jz dt"><span id="9bd2" class="ka kb ht jw b fv kc kd l ke kf">build smartContracts/callerValidation.py test 07 01 False False #\xba\'\x03\xc52c\xe8\xd6\xe5"\xdc2 39\xdc\xd8\xee\xe9</span></pre><p id="a87c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您运行的是为专用网络提供的主wallet，那么运行这些应该都会得到true。如果您正在运行自己的实例或从另一个wallet调用，只需从<strong class="is hu"> <em class="ko"> wallet </em> </strong>命令的结果中复制所需的值。如果您使用不是您的钱包的值运行测试执行，执行将返回<strong class="is hu"> <em class="ko"> False </em> </strong>。例如:</p><pre class="jo jp jq jr fq jv jw jx jy aw jz dt"><span id="9997" class="ka kb ht jw b fv kc kd l ke kf">build smartContracts/callerValidation.py test 07 01 False False BF3nJJpJr6o664CWJKi1QRXjqeic2zRaaa</span></pre><p id="f57c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">有关更深入的示例，请参考<a class="ae kz" href="https://github.com/nickfujita/hasty-ogre-name-service/blob/master/smartContract/hons-ico.py" rel="noopener ugc nofollow" target="_blank"> Hasty Ogre名称服务合同代码</a>。</p><p id="f326" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你觉得这个教程有帮助，请在:</p><pre class="jo jp jq jr fq jv jw jx jy aw jz dt"><span id="b697" class="ka kb ht jw b fv kc kd l ke kf">NEO/GAS/NEP5 tokens: AR8rRBxgWw5siKsp1dUmfTLy6QQTjcqoqB</span><span id="d665" class="ka kb ht jw b fv kg kd l ke kf">ETH/ERC20 tokens: 0x575970777095575fDd12d9cD3B105b41D8DD1344</span><span id="fe64" class="ka kb ht jw b fv kg kd l ke kf">NANO/XRB: xrb_3rpmim57tqbrb8hhjfzm1x5uk135yhmgqoj7j7wsufpo53e3ad5k93ggy1cd</span><span id="9901" class="ka kb ht jw b fv kg kd l ke kf">LTC: M8nZ7FwJXSMAkAfiGmTKjbB7MWpdwsp52d</span><span id="3585" class="ka kb ht jw b fv kg kd l ke kf">BTC: 3LcA1ztxFjghexRNWPyGXA59VFU3gF4PTz</span><span id="0f11" class="ka kb ht jw b fv kg kd l ke kf">BCH: 1LXLiF7SjWGday6gm61hzbYHKbSAMevwXo</span></pre><figure class="jo jp jq jr fq js fe ff paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="fe ff lg"><img src="../Images/8ec9e312db7811d5263c9e49ec41678b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UZrXPJNHt26dnDxVM2DWOQ.png"/></div></div></figure></div></div>    
</body>
</html>