<html>
<head>
<title>Adding Action to EOS Smart Contracts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向EOS智能合同添加操作</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/adding-action-to-eos-smart-contracts-85f6dcf2c841?source=collection_archive---------9-----------------------#2018-06-20">https://medium.com/coinmonks/adding-action-to-eos-smart-contracts-85f6dcf2c841?source=collection_archive---------9-----------------------#2018-06-20</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/3d872ee2a2a54c4d87f2f1edecc4f318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2N3vYCnxUsGdUHnYoHp_Q.png"/></div></div></figure><p id="ebea" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在各种开发者社区中有许多人进入区块链世界，他们经常说EOS手册很难理解。本文将介绍如何在Hello World上使用智能契约操作的基础知识。</p><p id="0b92" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在智能合约中，动作是对智能合约的调用，它决定如何操作它。在EOS中，智能合同可以根据各种动作来执行。</p><pre class="jz ka kb kc fq kd ke kf kg aw kh dt"><span id="6f07" class="ki kj ht ke b fv kk kl l km kn">#include &lt;eosiolib/eosio.hpp&gt;</span><span id="95b6" class="ki kj ht ke b fv ko kl l km kn">#include &lt;eosiolib/print.hpp&gt;</span><span id="116e" class="ki kj ht ke b fv ko kl l km kn">using namespace eosio;</span><span id="6f25" class="ki kj ht ke b fv ko kl l km kn">class hello : public eosio::contract {<br/>  public:<br/>      using contract::contract;</span><span id="e9f1" class="ki kj ht ke b fv ko kl l km kn">/// <a class="ae kp" href="http://twitter.com/abi" rel="noopener ugc nofollow" target="_blank">@abi</a> action <br/>      void hi( account_name user ) {<br/>         print( "Hello, World", name{user} );<br/>      }<br/>};</span><span id="7663" class="ki kj ht ke b fv ko kl l km kn">EOSIO_ABI( hello, (hi) )</span></pre><p id="a11a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">首先，输入基本代码。使用上一篇文章中的<em class="kq">Hello . CPP</em>(<a class="ae kp" rel="noopener" href="/coinmonks/printing-hello-world-with-eos-smart-contract-50fbe873d1b4">用EOS智能合约打印Hello World】)。</a></p><pre class="jz ka kb kc fq kd ke kf kg aw kh dt"><span id="a002" class="ki kj ht ke b fv kk kl l km kn">#eosiocpp -o hello.wast hello.cpp</span><span id="835d" class="ki kj ht ke b fv ko kl l km kn">#eosiocpp -g hello.abi hello.cpp</span></pre><p id="67dc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">编译、上传合同并运行合同。</p><pre class="jz ka kb kc fq kd ke kf kg aw kh dt"><span id="43c1" class="ki kj ht ke b fv kk kl l km kn"># cleos set contract usersc /root/sc/hello<br/>Reading WAST/WASM from /root/sc/hello/hello.wasm...<br/>Using already assembled WASM...<br/>Publishing contract...<br/>executed transaction: b491479802da43cd99e2a389331521b436d558d6d23398658db1368496fd65c8  1800 bytes  404 us</span><span id="0123" class="ki kj ht ke b fv ko kl l km kn">#         eosio &lt;= eosio::setcode               {"account":"usersc","vmtype":0,"vmversion":0,"code":"0061736d01000000013b0c60027f7e006000017e60027e7...</span><span id="400e" class="ki kj ht ke b fv ko kl l km kn">#         eosio &lt;= eosio::setabi                {"account":"usersc","abi":"0e656f73696f3a3a6162692f312e30000102686900010475736572046e616d65010000000...<br/>warning: transaction executed locally, but may not be confirmed by the network yet</span><span id="f0e9" class="ki kj ht ke b fv ko kl l km kn"># cleos push action usersc hi '["usera"]' -p usersc<br/>executed transaction: 6bfbfba6e0ff1ab3179052bfdc4f7da4f6d838a2797aaa2e6ec0b6dbe8b456d0  104 bytes  204 us</span><span id="c3fa" class="ki kj ht ke b fv ko kl l km kn">#        usersc &lt;= usersc::hi                   {"user":"usera"}<br/>warning: transaction executed locally, but may not be confirmed by the network yet</span></pre><p id="8433" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，让我们加入行动。</p><pre class="jz ka kb kc fq kd ke kf kg aw kh dt"><span id="38f2" class="ki kj ht ke b fv kk kl l km kn">#include &lt;eosiolib/eosio.hpp&gt;</span><span id="e501" class="ki kj ht ke b fv ko kl l km kn">#include &lt;eosiolib/print.hpp&gt;</span><span id="7e0a" class="ki kj ht ke b fv ko kl l km kn">using namespace eosio;</span><span id="d259" class="ki kj ht ke b fv ko kl l km kn">class hello : public eosio::contract {<br/>  public:<br/>      using contract::contract;</span><span id="478e" class="ki kj ht ke b fv ko kl l km kn">/// <a class="ae kp" href="http://twitter.com/abi" rel="noopener ugc nofollow" target="_blank">@abi</a> action <br/>      void hi( account_name user ) {<br/>         print( "Hello, World ", name{user} );<br/>      }</span><span id="7264" class="ki kj ht ke b fv ko kl l km kn">void bye( account_name user ) {<br/>         print( "bye, World ", name{user} );<br/>      }<br/>};</span><span id="811f" class="ki kj ht ke b fv ko kl l km kn">EOSIO_ABI( hello, (hi) (bye) )</span></pre><p id="35d2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">修改源代码，编译并上传智能合同。</p><pre class="jz ka kb kc fq kd ke kf kg aw kh dt"><span id="7a86" class="ki kj ht ke b fv kk kl l km kn"># cleos push action usersc hi '['hiuser']' -p usersc</span><span id="edc4" class="ki kj ht ke b fv ko kl l km kn">executed transaction: 40a57f6ab85ad929da730409d5badfec98f6e0a854e1085f8e5d7230aa38fb57  104 bytes  268 us</span><span id="acb5" class="ki kj ht ke b fv ko kl l km kn">#        usersc &lt;= usersc::hi                   {"user":" hiuser "}</span><span id="0fe6" class="ki kj ht ke b fv ko kl l km kn">&gt;&gt; Hello, World! hiuser test</span><span id="beb9" class="ki kj ht ke b fv ko kl l km kn">warning: transaction executed locally, but may not be confirmed by the network yet</span><span id="7309" class="ki kj ht ke b fv ko kl l km kn"># cleos push action usersc bye '['hiuser']' -p usersc<br/>executed transaction: fc22d0f414ca02a329141eff81ae596a68ba344d01ad0d74180779ce0bccb362  104 bytes  237 us</span><span id="99b5" class="ki kj ht ke b fv ko kl l km kn">#        usersc &lt;= usersc::bye                  {"user":"hiuser"}</span><span id="7d5a" class="ki kj ht ke b fv ko kl l km kn">&gt;&gt; bye, World hiuser</span><span id="fbbe" class="ki kj ht ke b fv ko kl l km kn">warning: transaction executed locally, but may not be confirmed by the network yet</span></pre><p id="f4b5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">检查添加的<em class="kq">再见</em>动作是否工作。</p><p id="a14a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">上例中使用的<em class="kq"> hiuser </em>不存在。让我们通过使用eosio提供的一个单独的函数来改进这个例子。</p><pre class="jz ka kb kc fq kd ke kf kg aw kh dt"><span id="93b2" class="ki kj ht ke b fv kk kl l km kn">#include &lt;eosiolib/eosio.hpp&gt;</span><span id="b979" class="ki kj ht ke b fv ko kl l km kn">#include &lt;eosiolib/print.hpp&gt;</span><span id="1590" class="ki kj ht ke b fv ko kl l km kn">using namespace eosio;</span><span id="e1eb" class="ki kj ht ke b fv ko kl l km kn">class hello : public eosio::contract {<br/>  private:<br/>    bool ishi=false;<br/>  <br/>  public:<br/>    using contract::contract;</span><span id="eb51" class="ki kj ht ke b fv ko kl l km kn">void hi( account_name user ) {<br/>      ishi=true;<br/>      chkuser(user);<br/>    }</span><span id="26ba" class="ki kj ht ke b fv ko kl l km kn">void bye( account_name user ) {<br/>      ishi=false;<br/>      chkuser(user);<br/>    }</span><span id="8aa5" class="ki kj ht ke b fv ko kl l km kn">void chkuser(account_name user)<br/>    {<br/>      if(is_account(user))<br/>      {<br/>        if(ishi)<br/>        {<br/>          print( "Hello, World! ", name{user} , " test" );<br/>        }<br/>        else<br/>        {<br/>          print( "bye, World ", name{user} );<br/>        }<br/>      }<br/>      else<br/>      {<br/>        print( "no user to sayhello" );<br/>      }<br/>    }<br/>};</span><span id="5ccf" class="ki kj ht ke b fv ko kl l km kn">EOSIO_ABI( hello, (hi) (bye) )</span></pre><p id="689b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果您编译、上传并调用合同</p><pre class="jz ka kb kc fq kd ke kf kg aw kh dt"><span id="7956" class="ki kj ht ke b fv kk kl l km kn">[root@test hello]# cleos push action usersc hi '['hiuser']' -p usersc</span><span id="d12e" class="ki kj ht ke b fv ko kl l km kn">executed transaction: be2816019d0cd3b09c393acb300e763d72f17a0f33752e302359df0ec7e152e3  104 bytes  312 us</span><span id="338d" class="ki kj ht ke b fv ko kl l km kn">#        usersc &lt;= usersc::hi                   {"user":"hiuser"}</span><span id="f329" class="ki kj ht ke b fv ko kl l km kn">&gt;&gt; no user to sayhello</span><span id="a755" class="ki kj ht ke b fv ko kl l km kn">warning: transaction executed locally, but may not be confirmed by the network yet</span><span id="96bf" class="ki kj ht ke b fv ko kl l km kn">[root@test hello]# cleos push action usersc hi '['usera']' -p usersc</span><span id="e83a" class="ki kj ht ke b fv ko kl l km kn">executed transaction: 9528239c4c33c99f6277861dc94464f3166c0ab7d942936f3e0aae82a5f7fdc7  104 bytes  242 us</span><span id="7433" class="ki kj ht ke b fv ko kl l km kn">#        usersc &lt;= usersc::hi                   {"user":"usera"}</span><span id="045b" class="ki kj ht ke b fv ko kl l km kn">&gt;&gt; Hello, World! usera test</span><span id="2e61" class="ki kj ht ke b fv ko kl l km kn">warning: transaction executed locally, but may not be confirmed by the network yet</span><span id="8b4d" class="ki kj ht ke b fv ko kl l km kn">[root@test hello]# cleos push action usersc bye '['usera']' -p usersc</span><span id="135e" class="ki kj ht ke b fv ko kl l km kn">executed transaction: ab3e43ea7ccd950cd64157005eb9b7e6530f3a1bed8eb35580b3cd335354e2f1  104 bytes  241 us</span><span id="ad85" class="ki kj ht ke b fv ko kl l km kn">#        usersc &lt;= usersc::bye                  {"user":"usera"}</span><span id="890b" class="ki kj ht ke b fv ko kl l km kn">&gt;&gt; bye, World usera</span><span id="65ca" class="ki kj ht ke b fv ko kl l km kn">warning: transaction executed locally, but may not be confirmed by the network yet</span></pre><p id="c662" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">您应该会看到类似上面的内容。</p><p id="1ded" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">另一个组件是通用的C++语法，没什么特别的。这是EOS DAPP开发的诸多优势之一。</p><p id="968e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">EOS提供的<em class="kq"> is_account() </em>函数用于验证用户是否为区块链用户。参考EOS提供的功能参考手册就好了。</p><p id="904f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">关注ITAM网络获取最新信息。</p><p id="af48" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果您在Telegram上关注ITAM网络的公开聊天，您可以与ITAM网络分享和讨论EOS开发及更多内容。点击下面的链接！</p><p id="e3a1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">网址:<a class="ae kp" href="http://itam.games" rel="noopener ugc nofollow" target="_blank"> http://itam.games </a></p><p id="2bd0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">电报:<a class="ae kp" href="https://t.me/itamnetwork" rel="noopener ugc nofollow" target="_blank">https://t.me/itamnetwork</a></p></div></div>    
</body>
</html>