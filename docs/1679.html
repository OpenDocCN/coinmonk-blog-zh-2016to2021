<html>
<head>
<title>Bitcoin Peer to Peer networking &amp; Improvement Proposals</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比特币点对点网络及改进建议</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/bitcoin-peer-to-peer-networking-improvement-proposals-70841fdd572f?source=collection_archive---------0-----------------------#2018-10-20">https://medium.com/coinmonks/bitcoin-peer-to-peer-networking-improvement-proposals-70841fdd572f?source=collection_archive---------0-----------------------#2018-10-20</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="29c8" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">比特币点对点网络工作原理概述及解决其缺点的改进建议</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff ji"><img src="../Images/e83ceaf84f6e4f1a2b812a34df939e4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/0*O1H38DUDAM1YhDAX.png"/></div><figcaption class="jq jr fg fe ff js jt bd b be z ek">Source: <a class="ae ju" href="https://portaldobitcoin.com/transacoes-nao-confirmadas-bitcoin-batem-recorde-e-chegam-155mil/" rel="noopener ugc nofollow" target="_blank">https://portaldobitcoin.com/transacoes-nao-confirmadas-bitcoin-batem-recorde-e-chegam-155mil/</a></figcaption></figure><p id="4e50" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">本文旨在概述比特币点对点网络的工作原理。本文由三个不同的部分组成，讨论比特币P2P网络的不同功能</p><ul class=""><li id="055b" class="kr ks ht jx b jy jz kb kc ke kt ki ku km kv kq kw kx ky kz dt translated">连接到网络中的节点</li><li id="b6fd" class="kr ks ht jx b jy la kb lb ke lc ki ld km le kq kw kx ky kz dt translated">检测网络中的其他节点</li><li id="3dc8" class="kr ks ht jx b jy la kb lb ke lc ki ld km le kq kw kx ky kz dt translated">接收事务或块数据</li></ul><h1 id="1bea" class="lf lg ht bd lh li lj lk ll lm ln lo lp iz lq ja lr jc ls jd lt jf lu jg lv lw dt translated">连接到网络中的节点</h1><p id="6cc1" class="pw-post-body-paragraph jv jw ht jx b jy lx iu ka kb ly ix kd ke lz kg kh ki ma kk kl km mb ko kp kq hm dt translated">当您在计算机上安装比特币节点时，配置中会出现一些硬编码的比特币节点地址，这些地址充当种子节点。他们是你在比特币网络中连接的第一批同行。</p><p id="2cfa" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">下面是您可以找到的一个种子地址，使用dig命令查看您可以连接的比特币节点的不同IP地址列表。</p><pre class="jj jk jl jm fq mc md me mf aw mg dt"><span id="302d" class="mh lg ht md b fv mi mj l mk ml">$ dig seed.btc.petertodd.org</span></pre><p id="c697" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">在连接到比特币网络中的远程节点之前，您的本地比特币节点向它想要连接的远程节点发送一个“<strong class="jx hu"> PING </strong>，它应该以“<strong class="jx hu"> PONG </strong>响应。但是如果该节点拒绝响应(可能它是离线的)，那么该节点被“<strong class="jx hu">触发</strong>，即断开连接</p><p id="b657" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">在成功连接到网络上的比特币节点后，您执行初始“<strong class="jx hu">握手</strong>”，这涉及到本地节点启动连接，首先发送版本消息，远程对等体发送回其版本消息，然后启动对等体发送“<strong class="jx hu"> Verack </strong>”消息，确认远程对等体版本&amp;远程对等体也这样做。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="fe ff mm"><img src="../Images/a526c8dcdee26db506bd18c80dd98a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMZKrXa_0GeZUDXp5-aNMg.png"/></div></div><figcaption class="jq jr fg fe ff js jt bd b be z ek">Bitcoin Initial Connection &amp; Handshake</figcaption></figure><p id="9610" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">远程对等体在收到版本消息之前不会发送任何数据。“<strong class="jx hu">版本</strong>”消息包含您正在运行的比特币节点的版本。</p><h1 id="41fb" class="lf lg ht bd lh li lj lk ll lm ln lo lp iz lq ja lr jc ls jd lt jf lu jg lv lw dt translated">检测网络中的其他节点</h1><p id="2e0c" class="pw-post-body-paragraph jv jw ht jx b jy lx iu ka kb ly ix kd ke lz kg kh ki ma kk kl km mb ko kp kq hm dt translated">你了解网络中其他比特币节点的方式是通过发送“<strong class="jx hu"> <em class="mr"> getaddr </em> </strong>”消息。与远程节点成功连接后，您可以向远程节点&amp;发送“<strong class="jx hu"> <em class="mr"> getaddr </em> </strong>”消息，远程节点将响应您可以连接的其他远程节点的IP地址示例列表。此外，它还会不断向您发送已连接节点的IP地址。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="fe ff ms"><img src="../Images/e5280664153dde72ddd9c0f756062852.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8KnqlIxm8d2tO2yDKmk5w.png"/></div></div><figcaption class="jq jr fg fe ff js jt bd b be z ek">Bitcoin Node detection fllow</figcaption></figure><h1 id="6e88" class="lf lg ht bd lh li lj lk ll lm ln lo lp iz lq ja lr jc ls jd lt jf lu jg lv lw dt translated">接收事务或块数据</h1><p id="b0e2" class="pw-post-body-paragraph jv jw ht jx b jy lx iu ka kb ly ix kd ke lz kg kh ki ma kk kl km mb ko kp kq hm dt translated">在远程节点从比特币网络中的其他对等体接收到块或交易数据后，它会向其连接对等体发送“<strong class="jx hu"> <em class="mr"> inv </em> </strong>”消息，以检查它们是否已经有交易或块。如果连接对等体没有，它会向远程节点&amp;发送一个“<strong class="jx hu"> <em class="mr"> getdata </em> </strong>”响应，并以事务或块的详细信息进行响应。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="fe ff mt"><img src="../Images/6b805047f74b1a1602c629e03b0bf322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jbPDk4VdkNXFuiC9KfbjA.png"/></div></div><figcaption class="jq jr fg fe ff js jt bd b be z ek">Bitcoin Data Request flow</figcaption></figure><h1 id="ce69" class="lf lg ht bd lh li lj lk ll lm ln lo lp iz lq ja lr jc ls jd lt jf lu jg lv lw dt translated">比特币P2P网络改进建议</h1><p id="12ef" class="pw-post-body-paragraph jv jw ht jx b jy lx iu ka kb ly ix kd ke lz kg kh ki ma kk kl km mb ko kp kq hm dt translated">有各种各样的比特币改进建议(<strong class="jx hu"> BIP </strong>)来提高比特币P2P网络的性能。我们将在下面回顾其中的一些。</p><h2 id="70e1" class="mh lg ht bd lh mu mv mw ll mx my mz lp ke na nb lr ki nc nd lt km ne nf lv ng dt translated">BIP 152 — <a class="ae ju" href="https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki" rel="noopener ugc nofollow" target="_blank">紧凑型</a></h2><p id="d695" class="pw-post-body-paragraph jv jw ht jx b jy lx iu ka kb ly ix kd ke lz kg kh ki ma kk kl km mb ko kp kq hm dt translated">这旨在减少比特币网络上节点之间的块中继期间使用的带宽。</p><p id="cea8" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">该协议旨在以两种方式使用，取决于对等体和可用带宽。“高带宽”和“低带宽”模式。在低带宽模式下，对等体发送新的块通知和通常的inv/headers通知。并且不支持紧凑块的节点仍然可以使用传统的块中继协议。</p><p id="3bcd" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">紧凑块包含块中事务id的缩短版本。当接收到<em class="mr"> cmpctblock </em>消息时，节点将计算其内存池中所有事务的缩短txids。它从内存池中检索具有匹配的缩短的txids的事务，以便重建整个块。如果它找不到一个事务，它将从向它发送<em class="mr"> cmpctblock </em>消息的对等点请求它。这样，块被中继，而不需要在块被中继时实际发送该块的所有数据；块中的大多数(如果不是全部)事务可能会在节点的mempool中找到，并且可以从那里重建。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="fe ff nh"><img src="../Images/a5d9aba106a42a98f32faf91182f8a83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fHIG_BmfTWM9K6OBNy2OFQ.png"/></div></div><figcaption class="jq jr fg fe ff js jt bd b be z ek">Source: <a class="ae ju" href="https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki" rel="noopener ugc nofollow" target="_blank">https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki</a></figcaption></figure><p id="7225" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">这已经在比特币核心代码库中实现和合并。对比特币核心代码库的拉取请求可以在这里找到<a class="ae ju" href="https://github.com/bitcoin/bitcoin/pull/8068" rel="noopener ugc nofollow" target="_blank">https://github.com/bitcoin/bitcoin/pull/8068</a>T10】https://github.com/bitcoin/bitcoin/pull/8393</p><h2 id="0336" class="mh lg ht bd lh mu mv mw ll mx my mz lp ke na nb lr ki nc nd lt km ne nf lv ng dt translated">石墨烯——阻碍传播</h2><p id="3605" class="pw-post-body-paragraph jv jw ht jx b jy lx iu ka kb ly ix kd ke lz kg kh ki ma kk kl km mb ko kp kq hm dt translated">石墨烯是一种新颖且高效的块传输协议(由<em class="mr"> A. Pinar Ozisik、Gavin Andresen </em>等开发)，该协议提出使用布隆过滤器从本地内存池(简称<em class="mr">内存池</em>，这是网络中等待验证并要包含在块中的所有比特币交易的集合)中识别块内的交易。</p><p id="366b" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">这是对BIP 152(紧凑型)的改进。它结合了bloom filters和可逆Bloom Lookup Tables (IBLTs ),以降低块传播的成本。</p><h2 id="1d93" class="mh lg ht bd lh mu mv mw ll mx my mz lp ke na nb lr ki nc nd lt km ne nf lv ng dt translated">BIP 157 — <a class="ae ju" href="https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki" rel="noopener ugc nofollow" target="_blank">客户端拦截过滤</a></h2><p id="7109" class="pw-post-body-paragraph jv jw ht jx b jy lx iu ka kb ly ix kd ke lz kg kh ki ma kk kl km mb ko kp kq hm dt translated">这个BIP在比特币中描述了一个新的轻量级客户端协议，它改进了当前可用的选项。目前使用的轻量级客户端协议存在已知的缺陷，会削弱客户端的安全性和隐私性，并允许在整个节点上进行拒绝服务攻击。</p><p id="d363" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">它描述了轻量级客户端向网络中的远程对等方请求数据的备用协议，以保护隐私。</p><p id="6d24" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">完整节点对提供给客户端的块数据生成确定性过滤器，而不是轻型客户端向完整节点对等体发送过滤器。如果过滤器与它正在观察的数据匹配，一个轻量级客户端就可以下载整个块。由于过滤器是确定性的，因此只要有新的块连接到链上，它们只需要构造一次并存储在磁盘上。</p><p id="b761" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated">这提高了隐私性，因为数据块可以从<em class="mr">任何来源</em>下载，所以没有一个对等方获得客户端所需数据的完整信息。此外，轻量级客户端可以更好地确保看到所有相关事务，因为它们可以比检查过滤块的完整性更容易地检查从对等体接收的过滤器的有效性。</p><h1 id="9770" class="lf lg ht bd lh li lj lk ll lm ln lo lp iz lq ja lr jc ls jd lt jf lu jg lv lw dt translated">结论</h1><p id="89b9" class="pw-post-body-paragraph jv jw ht jx b jy lx iu ka kb ly ix kd ke lz kg kh ki ma kk kl km mb ko kp kq hm dt translated">比特币点对点网络的运作方式已经有了很大的改进。关于如何进一步改进它使之变得更好，更多的事情正在被讨论和研究。</p><h1 id="7910" class="lf lg ht bd lh li lj lk ll lm ln lo lp iz lq ja lr jc ls jd lt jf lu jg lv lw dt translated">进一步阅读</h1><div class="ni nj fm fo nk nl"><a href="https://bitcointalk.org/index.php?topic=1831243.0" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab ej"><div class="nn ab no cl cj np"><h2 class="bd hu fv z el nq eo ep nr er et hs dt translated">紧凑数据块:如何在高带宽模式下验证数据块？</h2><div class="ns l"><h3 class="bd b fv z el nq eo ep nr er et ek translated">紧凑数据块:如何在高带宽模式下验证数据块？</h3></div><div class="nt l"><p class="bd b gc z el nq eo ep nr er et ek translated">紧凑数据块:如何在高带宽模式下验证数据块？bitcointalk.org</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz jo nl"/></div></div></a></div><p id="bb8e" class="pw-post-body-paragraph jv jw ht jx b jy jz iu ka kb kc ix kd ke kf kg kh ki kj kk kl km kn ko kp kq hm dt translated"><a class="ae ju" href="http://cryptoeconomics.cs.umass.edu/graphene/graphene-short.pdf" rel="noopener ugc nofollow" target="_blank">http://cryptoeconomics . cs . umass . edu/graphene/graphene-short . pdf</a></p><div class="ni nj fm fo nk nl"><a href="https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab ej"><div class="nn ab no cl cj np"><h2 class="bd hu fv z el nq eo ep nr er et hs dt translated">比特币/bips</h2><div class="ns l"><h3 class="bd b fv z el nq eo ep nr er et ek translated">比特币改进建议。通过在GitHub上创建帐户，为比特币/bips的发展做出贡献。</h3></div><div class="nt l"><p class="bd b gc z el nq eo ep nr er et ek translated">github.com</p></div></div></div></a></div><div class="ni nj fm fo nk nl"><a rel="noopener follow" target="_blank" href="/coinmonks/graphene-block-propagation-protocol-aceb8730fa5e"><div class="nm ab ej"><div class="nn ab no cl cj np"><h2 class="bd hu fv z el nq eo ep nr er et hs dt translated">石墨烯块传播协议</h2><div class="ns l"><h3 class="bd b fv z el nq eo ep nr er et ek translated">使用布隆过滤器提高吞吐量</h3></div><div class="nt l"><p class="bd b gc z el nq eo ep nr er et ek translated">medium.com</p></div></div><div class="nu l"><div class="oa l nw nx ny nu nz jo nl"/></div></div></a></div><blockquote class="ob"><p id="ffdc" class="oc od ht bd oe of og oh oi oj ok kq ek translated"><a class="ae ju" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获取最佳软件交易</a></p></blockquote><figure class="om on oo op oq jn fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff ol"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>