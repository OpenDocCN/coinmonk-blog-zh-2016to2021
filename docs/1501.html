<html>
<head>
<title>Ethernaut Lvl 15 Naught Coin Walkthrough: How to abuse ERC20 tokens and bad ICOs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太币15级零硬币演练:如何滥用ERC20代币和坏ico</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethernaut-lvl-15-naught-coin-walkthrough-how-to-abuse-erc20-tokens-and-bad-icos-6668b856a176?source=collection_archive---------1-----------------------#2018-09-15">https://medium.com/coinmonks/ethernaut-lvl-15-naught-coin-walkthrough-how-to-abuse-erc20-tokens-and-bad-icos-6668b856a176?source=collection_archive---------1-----------------------#2018-09-15</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="e203" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">这是一个围绕<a class="ae ji" href="https://openzeppelin.org/" rel="noopener ugc nofollow" target="_blank">齐柏林</a>团队的<a class="ae ji" href="https://ethernaut.zeppelin.solutions/" rel="noopener ugc nofollow" target="_blank">智能合约安全拼图</a>的<a class="ae ji" rel="noopener" href="/@nicolezhu">深度系列</a>。我们学习关键的可靠性概念，以便100%靠自己解决难题。</h2></div><p id="47d0" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">这个级别要求你滥用一个坏的ERC20实现并控制NaughtCoin令牌。</p></div><div class="ab cl kf kg hb kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hm hn ho hp hq"><h1 id="e586" class="km kn ht bd ko kp kq kr ks kt ku kv kw iz kx ja ky jc kz jd la jf lb jg lc ld dt translated">什么是ERC20</h1><p id="01d5" class="pw-post-body-paragraph jj jk ht jl b jm le iu jo jp lf ix jr js lg ju jv jw lh jy jz ka li kc kd ke hm dt translated">ERC(<em class="lj">以太坊请求评论</em>)是允许您在区块链上创建令牌的协议。具体来说，ERC20是一个<a class="ae ji" rel="noopener" href="/coinmonks/ethernaut-lvl-11-elevator-walkthrough-how-to-abuse-solidity-interfaces-and-function-state-41005470121d">契约接口</a>，它定义了围绕令牌的标准所有权和交易规则。</p><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff lk"><img src="../Images/f1a410409bd00afd217d8996b9a1230e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2DAKs3qHbu9vQ7bEreQSiA.png"/></div></div><figcaption class="lw lx fg fe ff ly lz bd b be z ek">From: zeppelin-solidity/contracts/token/ERC20/StandardToken.sol</figcaption></figure><p id="2dd0" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">从上下文来看，ERC20在2015年很酷，因为它就像是所有开发人员都同意的API。第一次，任何人都可以创造一个新的资产类别。开发人员想出了Dogecoin、Kucoin、Dentacoin等代币，并且可以相信他们的代币被各地的钱包、交易所和合同所接受。</p><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff ma"><img src="../Images/98ed4d0ef4875983c5b5b04906337739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EMHd54mlZA1NX4mhhvcujQ.png"/></div></div><figcaption class="lw lx fg fe ff ly lz bd b be z ek">Assortment of ERC20 coins that ICO’ed</figcaption></figure><p id="9201" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">ERC20一手促成了2017年的ICO热潮……以及随之而来的诸多ICO安全问题。</p><h2 id="33bd" class="mb kn ht bd ko mc md me ks mf mg mh kw js mi mj ky jw mk ml la ka mm mn lc mo dt translated">伴随ERC20的安全问题</h2><ul class=""><li id="6c68" class="mp mq ht jl b jm le jp lf js mr jw ms ka mt ke mu mv mw mx dt translated"><strong class="jl hu"> Batchoverflow </strong>:因为ERC20没有执行SafeMath，所以有可能发生整数下溢。正如我们在第5级中学到的，这意味着将你的代币消耗到0以下会给你<code class="eh my mz na nb b">2^256 - 1</code>个代币！</li><li id="a237" class="mp mq ht jl b jm nc jp nd js ne jw nf ka ng ke mu mv mw mx dt translated"><strong class="jl hu">转移“bug”</strong>:ERC 20的制作者打算让开发者使用<code class="eh my mz na nb b">approve()</code> &amp; <code class="eh my mz na nb b">transferfrom()</code>函数组合来四处移动令牌。但这在文档中从未明确说明，他们也没有警告不要使用<code class="eh my mz na nb b">transfer()</code>(这也是可用的)。许多开发者使用了<code class="eh my mz na nb b">transfer()</code>,它永远锁定了许多令牌。</li></ul><blockquote class="nh"><p id="8818" class="ni nj ht bd nk nl nm nn no np nq ke ek translated">正如我们<a class="ae ji" rel="noopener" href="/coinmonks/ethernaut-lvl-9-king-walkthrough-how-bad-contracts-can-abuse-withdrawals-db12754f359b">在第9层</a>学到的，你不能保证第三份合同会收到你的转会。如果您将代币转移到非接收方，您将永远失去代币，因为代币合同已经减少了您自己帐户的余额。</p></blockquote><ul class=""><li id="29cb" class="mp mq ht jl b jm nr jp ns js nt jw nu ka nv ke mu mv mw mx dt translated">【ERC20继承不良:部分令牌合同没有正确实现ERC接口，导致很多问题。例如，假人的GNT甚至没有实现关键的<code class="eh my mz na nb b">approve()</code>功能，留下<code class="eh my mz na nb b">transfer()</code>作为唯一有问题的选项。</li></ul><blockquote class="nw nx ny"><p id="3f8a" class="jj jk lj jl b jm jn iu jo jp jq ix jr nz jt ju jv oa jx jy jz ob kb kc kd ke hm dt translated"><strong class="jl hu">*提示* </strong>同样，这个等级没有实现一些关键功能——使得诺顿币容易受到攻击。</p></blockquote></div><div class="ab cl kf kg hb kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hm hn ho hp hq"><h1 id="7a15" class="km kn ht bd ko kp kq kr ks kt ku kv kw iz kx ja ky jc kz jd la jf lb jg lc ld dt translated">详细演练</h1><p id="03a6" class="pw-post-body-paragraph jj jk ht jl b jm le iu jo jp lf ix jr js lg ju jv jw lh jy jz ka li kc kd ke hm dt translated">在<a class="ae ji" rel="noopener" href="/coinmonks/ethernaut-lvl-11-elevator-walkthrough-how-to-abuse-solidity-interfaces-and-function-state-41005470121d">第11级</a>中，我们学会了不要盲目信任从接口继承的其他契约。简而言之，您无法确定这些合同是否I)按照预期正确地实现了一个功能，以及ii)遵守了像pure和view这样的函数修饰符承诺。</p><p id="9f50" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">在这个层面上，我们了解到<strong class="jl hu">执行不力的非对抗性合同也可能被滥用。</strong></p><figure class="ll lm ln lo fq lp fe ff paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="fe ff oc"><img src="../Images/e5e95f5129afe403bd0e282bba9098bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O4ZoHOHttIchLAgYaA3Dew.png"/></div></div></figure><ol class=""><li id="aa16" class="mp mq ht jl b jm jn jp jq js od jw oe ka of ke og mv mw mx dt translated"><a class="ae ji" href="http://remix.ethereum.org/" rel="noopener ugc nofollow" target="_blank">在Remix </a>中，访问您的合同实例。</li></ol><blockquote class="nw nx ny"><p id="30bf" class="jj jk lj jl b jm jn iu jo jp jq ix jr nz jt ju jv oa jx jy jz ob kb kc kd ke hm dt translated">注意:Remix找不到文件路径，请在<a class="ae ji" href="https://github.com/OpenZeppelin/openzeppelin-solidity/blob/4dcdd293e8b351851d5b5e555c33c062178ceb15/contracts/token/ERC20/StandardToken.sol" rel="noopener ugc nofollow" target="_blank"> StandardToken.sol文件中</a>查找工作实际路径，或将文件粘贴到Remix中。</p></blockquote><h2 id="32f7" class="mb kn ht bd ko mc md me ks mf mg mh kw js mi mj ky jw mk ml la ka mm mn lc mo dt translated"><strong class="ak">请注意以下事项:</strong></h2><ul class=""><li id="c64a" class="mp mq ht jl b jm le jp lf js mr jw ms ka mt ke mu mv mw mx dt translated">您可以使用<code class="eh my mz na nb b">transfer()</code>和<code class="eh my mz na nb b">transferFrom()</code>来移动代币</li><li id="3214" class="mp mq ht jl b jm nc jp nd js ne jw nf ka ng ke mu mv mw mx dt translated"><code class="eh my mz na nb b">lockTokens()</code>修改器仅应用于<code class="eh my mz na nb b">transfer()</code>功能</li><li id="b34d" class="mp mq ht jl b jm nc jp nd js ne jw nf ka ng ke mu mv mw mx dt translated"><code class="eh my mz na nb b">Approve()</code>和<code class="eh my mz na nb b">transferFrom()</code>功能也可在Remix IDE中使用</li></ul><p id="1d60" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">这意味着您可以使用建议的<code class="eh my mz na nb b">approve+transferfrom</code>组合移动令牌，绕过锁定令牌。</p><p id="a632" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">2.检查您的账户余额，然后用您自己的地址和准确的账户余额调用<code class="eh my mz na nb b">approve()</code>。</p><p id="fef7" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">3.使用以下参数调用<code class="eh my mz na nb b">transferFrom()</code>:I)您的玩家地址，ii)任意的外部钱包，以及iii)账户余额。</p><p id="b208" class="pw-post-body-paragraph jj jk ht jl b jm jn iu jo jp jq ix jr js jt ju jv jw jx jy jz ka kb kc kd ke hm dt translated">4.将实例提交回要通过的级别。</p></div><div class="ab cl kf kg hb kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="hm hn ho hp hq"><h1 id="c35c" class="km kn ht bd ko kp kq kr ks kt ku kv kw iz kx ja ky jc kz jd la jf lb jg lc ld dt translated">关键安全要点</h1><ul class=""><li id="b94b" class="mp mq ht jl b jm le jp lf js mr jw ms ka mt ke mu mv mw mx dt translated"><strong class="jl hu">当与合同接口或实现ERC接口时，实现所有可用的功能。</strong></li><li id="6775" class="mp mq ht jl b jm nc jp nd js ne jw nf ka ng ke mu mv mw mx dt translated">如果您计划创建自己的令牌，请考虑更新的方案，例如:ERC223、ERC721(由隐孢子虫使用)、ERC827 (ERC 20杀手)。</li><li id="1e23" class="mp mq ht jl b jm nc jp nd js ne jw nf ka ng ke mu mv mw mx dt translated">如果可以的话，检查<a class="ae ji" href="https://github.com/ethereum/EIPs/pull/881" rel="noopener ugc nofollow" target="_blank"> EIP 165符合性</a>，它确认外部契约正在实现哪个接口。相反，如果你是发行代币的人，记得要符合EIP-165。</li><li id="beee" class="mp mq ht jl b jm nc jp nd js ne jw nf ka ng ke mu mv mw mx dt translated">记得使用SafeMath来防止令牌下溢(正如我们在lvl 5 中学到的<a class="ae ji" rel="noopener" href="/coinmonks/ethernaut-lvl-5-walkthrough-how-to-abuse-arithmetic-underflows-and-overflows-2c614fa86b74"/></li></ul><h1 id="2c41" class="km kn ht bd ko kp oh kr ks kt oi kv kw iz oj ja ky jc ok jd la jf ol jg lc ld dt translated">更多级别</h1><div class="om on fm fo oo op"><a rel="noopener follow" target="_blank" href="/coinmonks/ethernaut-lvl-14-gatekeeper-2-walkthrough-how-contracts-initialize-and-how-to-do-bitwise-ddac8ad4f0fd"><div class="oq ab ej"><div class="or ab os cl cj ot"><h2 class="bd hu fv z el ou eo ep ov er et hs dt translated">Ethernaut Lvl 14网守2演练:合同如何初始化(以及如何按位…</h2><div class="ow l"><h3 class="bd b fv z el ou eo ep ov er et ek translated">这是一个围绕齐柏林团队的智能合同安全难题的深入系列。我们学习关键的可靠性概念…</h3></div><div class="ox l"><p class="bd b gc z el ou eo ep ov er et ek translated">medium.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd lu op"/></div></div></a></div><div class="om on fm fo oo op"><a rel="noopener follow" target="_blank" href="/coinmonks/ethernaut-lvl-16-preservation-walkthrough-how-to-inject-malicious-contracts-with-delegatecall-81e071f98a12"><div class="oq ab ej"><div class="or ab os cl cj ot"><h2 class="bd hu fv z el ou eo ep ov er et hs dt translated">Ethernaut Lvl 16保留演练:如何用delegatecall注入恶意契约</h2><div class="ow l"><h3 class="bd b fv z el ou eo ep ov er et ek translated">这是一个围绕齐柏林团队的智能合同安全难题的深入系列。我会给你直接的资源…</h3></div><div class="ox l"><p class="bd b gc z el ou eo ep ov er et ek translated">medium.com</p></div></div><div class="oy l"><div class="pe l pa pb pc oy pd lu op"/></div></div></a></div><blockquote class="nh"><p id="73d6" class="ni nj ht bd nk nl nm nn no np nq ke ek translated"><a class="ae ji" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="pg ph pi pj pk lp fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff pf"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>