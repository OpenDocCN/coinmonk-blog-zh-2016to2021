<html>
<head>
<title>How to get Images from ImageNet with Python in Google Colaboratory</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Google协同实验室中用Python从ImageNet获取图像</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-get-images-from-imagenet-with-python-in-google-colaboratory-aeef5c1c45e5?source=collection_archive---------2-----------------------#2018-08-17">https://medium.com/coinmonks/how-to-get-images-from-imagenet-with-python-in-google-colaboratory-aeef5c1c45e5?source=collection_archive---------2-----------------------#2018-08-17</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/ec23c337ebc284edf8dfcc0f432cf319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8HtYIE3lmSjrBz51Bb6iaA.jpeg"/></div></div></figure><p id="1309" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">计算机视觉最有趣的应用之一是图像识别，它使机器能够识别或分类它在图片上看到的东西。</p><p id="7af2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">神经网络目前在图像识别方面取得了最准确的结果，在一些任务上甚至在速度和准确性上超过了人类(关于这一点的更多细节在我的下一篇文章中:<a class="ae jz" rel="noopener" href="/@sebastiannorena/train-a-keras-neural-network-with-imagenet-synsets-in-google-colaboratory-e68dc4fd759f">https://medium . com/@ sebastiannorena/train-a-keras-neural-network-with-imagenet-synsets-in-Google-co laboratory-e 68 DC 4 FD 759 f</a></p><p id="f2fb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">训练图像识别模型的第一步是找到属于所需类别(或多个类别)的图像，ImageNet在这方面非常有用，因为它目前有14，197，122幅图像，索引了21841个同义词集。ImageNet的目标是平均提供1000幅图像来说明100，000个同义词集中的每一个，大多数同义词集都是名词(80.000+)。</p><p id="1021" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">更多关于ImageNet的信息可以在这里找到:【http://www.image-net.org/about-overview T2】</p><p id="ab59" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">同义词集来自WordNet，这是一个大型的英语词汇数据库。名词、动词、形容词和副词被分成认知同义词组(同义词组)，每个同义词组表达一个不同的概念。</p><p id="4097" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">更多关于WordNet的信息可以在这里找到:【https://wordnet.princeton.edu/ T4】</p><p id="174e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这些有用的分类影像可使用Python通过以下步骤获得:</p><p id="10eb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 1收集您需要的synsets的id:</strong></p><p id="48c0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">每个synset都有自己的id，它被称为“WordNet ID”(wnid)。它出现在每个synset的URL末尾的“=”之后。例如，如果需要的synset是船只的图片，可以通过在imagenet网站上搜索ship来找到，结果将是以下页面，其wnid为:n04194289</p><p id="71a6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae jz" href="http://www.image-net.org/synset?wnid=n04194289" rel="noopener ugc nofollow" target="_blank">http://www.image-net.org/synset?wnid=n04194289</a></p><p id="9965" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 2获取synset图像的URL列表:</strong></p><p id="c56f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">所述URL列表可以从URL<a class="ae jz" href="http://www.image-net.org/api/text/imagenet.synset.geturls?wnid=" rel="noopener ugc nofollow" target="_blank">http://www.image-net.org/api/text/imagenet.synset.geturls?下载wnid= </a>后跟wnid，因此对于船只，它将是"<a class="ae jz" href="http://www.image-net.org/api/text/imagenet.synset.geturls?wnid=n04194289" rel="noopener ugc nofollow" target="_blank">http://www.image-net.org/api/text/imagenet.synset.geturls?wnid=n04194289 </a>"这可以通过Python库BeautifulSoup:</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="3fde" class="kj kk ht kf b fv kl km l kn ko">from bs4 import BeautifulSoup<br/>import numpy as np<br/>import requests<br/>import cv2<br/>import PIL.Image<br/>import urllib</span><span id="c568" class="kj kk ht kf b fv kp km l kn ko">page = requests.get("<a class="ae jz" href="http://www.image-net.org/api/text/imagenet.synset.geturls?wnid=n04194289" rel="noopener ugc nofollow" target="_blank">http://www.image-net.org/api/text/imagenet.synset.geturls?wnid=n04194289</a>")#ship synset<br/>print(page.content)</span><span id="ddd9" class="kj kk ht kf b fv kp km l kn ko"># BeautifulSoup is an HTML parsing library</span><span id="b3bf" class="kj kk ht kf b fv kp km l kn ko">soup = BeautifulSoup(page.content, 'html.parser')#puts the content of the website into the soup variable, each url on a different line</span></pre><p id="53ba" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">自行车也是如此:</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="bd29" class="kj kk ht kf b fv kl km l kn ko">bikes_page = requests.get("<a class="ae jz" href="http://www.image-net.org/api/text/imagenet.synset.geturls?wnid=n02834778" rel="noopener ugc nofollow" target="_blank">http://www.image-net.org/api/text/imagenet.synset.geturls?wnid=n02834778</a>")#bicycle synset<br/>print(bikes_page.content)</span><span id="2df1" class="kj kk ht kf b fv kp km l kn ko"># BeautifulSoup is an HTML parsing library<br/>from bs4 import BeautifulSoup<br/>bikes_soup = BeautifulSoup(bikes_page.content, 'html.parser')#puts the content of the website into the soup variable, each url on a different line</span></pre><p id="0930" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 3分割URL，使每个URL出现在不同的行上，并将它们存储在一个列表中，以便于访问:</strong></p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="117b" class="kj kk ht kf b fv kl km l kn ko">str_soup=str(soup)#convert soup to string so it can be split<br/>type(str_soup)<br/>split_urls=str_soup.split('\r\n')#split so each url is a different possition on a list<br/>print(len(split_urls))#print the length of the list so you know how many urls you have</span></pre><p id="81e5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">自行车也是如此:</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="838f" class="kj kk ht kf b fv kl km l kn ko">bikes_str_soup=str(bikes_soup)#convert soup to string so it can be split<br/>type(bikes_str_soup)<br/>bikes_split_urls=bikes_str_soup.split('\r\n')#split so each url is a different possition on a list<br/>print(len(bikes_split_urls))</span></pre><p id="12c4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 4在谷歌协作文件系统上创建目录，以便图像可以存储在那里:</strong></p><p id="d342" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">通常会创建一个“训练”目录和一个“验证”目录来存储图像，然后使用它们来训练模型。</p><p id="9a23" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在本例中，有一个ship synset和一个bike synset，每个目录中也有一个“ships”目录和一个“bikes”目录，如下所示:</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="16ea" class="kj kk ht kf b fv kl km l kn ko">!mkdir /content/train #create the Train folder<br/>!mkdir /content/train/ships #create the ships folder<br/>!mkdir /content/train/bikes #create the bikes folder<br/>!mkdir /content/validation<br/>!mkdir /content/validation/ships #create the ships folder<br/>!mkdir /content/validation/bikes #create the bikes folder</span></pre><p id="deb3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> 5校正图像形状、格式，并存储在相应的目录下:</strong></p><p id="634b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在每个目录中存储图像的代码与其他目录是分开的，因此很容易更改每个目录的参数(图像数量、图像名称、目录、格式等)</p><pre class="ka kb kc kd fq ke kf kg kh aw ki dt"><span id="6826" class="kj kk ht kf b fv kl km l kn ko">img_rows, img_cols = 32, 32 #number of rows and columns to convert the images to<br/>input_shape = (img_rows, img_cols, 3)#format to store the images (rows, columns,channels) called channels last</span><span id="d6b3" class="kj kk ht kf b fv kp km l kn ko">def url_to_image(url):<br/> # download the image, convert it to a NumPy array, and then read<br/> # it into OpenCV format<br/> resp = urllib.request.urlopen(url)<br/> image = np.asarray(bytearray(resp.read()), dtype="uint8")<br/> image = cv2.imdecode(image, cv2.IMREAD_COLOR)<br/> <br/> # return the image<br/> return image</span><span id="16eb" class="kj kk ht kf b fv kp km l kn ko">n_of_training_images=100#the number of training images to use<br/>for progress in range(n_of_training_images):#store all the images on a directory<br/>    # Print out progress whenever progress is a multiple of 20 so we can follow the<br/>    # (relatively slow) progress<br/>    if(progress%20==0):<br/>        print(progress)<br/>    if not split_urls[progress] == None:<br/>      try:<br/>        I = url_to_image(split_urls[progress])<br/>        if (len(I.shape))==3: #check if the image has width, length and channels<br/>          save_path = '/content/train/ships/img'+str(progress)+'.jpg'#create a name of each image<br/>          cv2.imwrite(save_path,I)</span><span id="b7a1" class="kj kk ht kf b fv kp km l kn ko">except:<br/>        None</span><span id="b44d" class="kj kk ht kf b fv kp km l kn ko">#do the same for bikes:<br/>for progress in range(n_of_training_images):#store all the images on a directory<br/>    # Print out progress whenever progress is a multiple of 20 so we can follow the<br/>    # (relatively slow) progress<br/>    if(progress%20==0):<br/>        print(progress)<br/>    if not bikes_split_urls[progress] == None:<br/>      try:<br/>        I = url_to_image(bikes_split_urls[progress])<br/>        if (len(I.shape))==3: #check if the image has width, length and channels<br/>          save_path = '/content/train/bikes/img'+str(progress)+'.jpg'#create a name of each image<br/>          cv2.imwrite(save_path,I)</span><span id="dbe9" class="kj kk ht kf b fv kp km l kn ko">except:<br/>        None<br/>        <br/>        <br/>#Validation data:</span><span id="0f17" class="kj kk ht kf b fv kp km l kn ko">for progress in range(50):#store all the images on a directory<br/>    # Print out progress whenever progress is a multiple of 20 so we can follow the<br/>    # (relatively slow) progress<br/>    if(progress%20==0):<br/>        print(progress)<br/>    if not split_urls[progress] == None:<br/>      try:<br/>        I = url_to_image(split_urls[n_of_training_images+progress])#get images that are different from the ones used for training<br/>        if (len(I.shape))==3: #check if the image has width, length and channels<br/>          save_path = '/content/validation/ships/img'+str(progress)+'.jpg'#create a name of each image<br/>          cv2.imwrite(save_path,I)</span><span id="c642" class="kj kk ht kf b fv kp km l kn ko">except:<br/>        None</span><span id="3031" class="kj kk ht kf b fv kp km l kn ko">#do the same for bikes:<br/>for progress in range(50):#store all the images on a directory<br/>    # Print out progress whenever progress is a multiple of 20 so we can follow the<br/>    # (relatively slow) progress<br/>    if(progress%20==0):<br/>        print(progress)<br/>    if not bikes_split_urls[progress] == None:<br/>      try:<br/>        I = url_to_image(bikes_split_urls[n_of_training_images+progress])#get images that are different from the ones used for training<br/>        if (len(I.shape))==3: #check if the image has width, length and channels<br/>          save_path = '/content/validation/bikes/img'+str(progress)+'.jpg'#create a name of each image<br/>          cv2.imwrite(save_path,I)</span><span id="f0fe" class="kj kk ht kf b fv kp km l kn ko">except:<br/>        None<br/>        <br/>print("\nTRAIN:\n")          <br/>print("\nlist the files inside ships directory:\n")        <br/>!ls /content/train/ships #list the files inside ships<br/>print("\nlist the files inside bikes directory:\n")<br/>!ls /content/train/bikes #list the files inside bikes<br/>print("\nVALIDATION:\n")<br/>print("\nlist the files inside ships directory:\n")        <br/>!ls /content/validation/ships #list the files inside ships<br/>print("\nlist the files inside bikes directory:\n")<br/>!ls /content/validation/bikes #list the files inside bikes</span></pre><p id="6a05" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">结论:</strong>本文描述了在ImageNet上查找所需图像、获取它们的URL列表、下载它们、将它们中的一些存储在一个目录(train)中(稍后可用于训练图像识别模型)以及将其他图像存储在另一个目录(validation)中(稍后可用于验证训练好的模型)所需的步骤。</p><p id="c4f4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">目录结构是重要的，在该示例中，所使用的结构很好地用于训练Keras模型，因为Keras使用该结构来区分将用于训练的图像和将用于验证的图像，而且在每个所述目录内，Keras使用目录名称来识别每组图像的类别。</p><p id="50bd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这篇文章的所有代码也可以在谷歌合作实验室的这个链接上找到:</p><div class="kq kr fm fo ks kt"><a href="https://colab.research.google.com/drive/1MALKxRqmNdjBUXJ-6V4PFYU6inPWq7Qe" rel="noopener  ugc nofollow" target="_blank"><div class="ku ab ej"><div class="kv ab kw cl cj kx"><h2 class="bd hu fv z el ky eo ep kz er et hs dt translated">谷歌联合实验室</h2><div class="la l"><h3 class="bd b fv z el ky eo ep kz er et ek translated">编辑描述</h3></div><div class="lb l"><p class="bd b gc z el ky eo ep kz er et ek translated">colab.research.google.com</p></div></div><div class="lc l"><div class="ld l le lf lg lc lh iz kt"/></div></div></a></div><blockquote class="li"><p id="869b" class="lj lk ht bd ll lm ln lo lp lq lr jy ek translated">加入Coinmonks <a class="ae jz" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jz" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jz" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="kj kk ht bd ls lt lu lv lw lx ly lz ma jm mb mc md jq me mf mg ju mh mi mj mk dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="ml mm ht jd b je mn ji mo jm mp jq mq ju mr jy ms mt mu mv dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae jz" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated"><a class="ae jz" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae jz" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated"><a class="ae jz" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae jz" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="f33b" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae jz" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/best-crypto-apis-for-developers-5efe3a597a9f">开发者最佳加密API</a></li><li id="b359" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated">最佳<a class="ae jz" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="9487" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币</a>终极指南</li><li id="f1ee" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated"><a class="ae jz" href="https://coincodecap.com/zero-fee-crypto-exchanges" rel="noopener ugc nofollow" target="_blank"> 7个最佳零费用加密交易平台</a></li><li id="5aa5" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated"><a class="ae jz" href="https://coincodecap.com/best-online-casinos" rel="noopener ugc nofollow" target="_blank">最佳网上赌场</a> | <a class="ae jz" rel="noopener" href="/coinmonks/futures-trading-bots-5a282ccee3f5">期货交易机器人</a></li><li id="3d0e" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated"><a class="ae jz" href="https://coincodecap.com/what-are-decentralized-exchanges" rel="noopener ugc nofollow" target="_blank">分散交易所</a> | <a class="ae jz" href="https://coincodecap.com/bitbns-fip" rel="noopener ugc nofollow" target="_blank">比特FIP </a></li><li id="5cf9" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated">用信用卡购买密码的10个最佳地点</li><li id="3d13" class="ml mm ht jd b je mw ji mx jm my jq mz ju na jy ms mt mu mv dt translated"><a class="ae jz" href="https://coincodecap.com/5-best-crypto-trading-bots-in-canada" rel="noopener ugc nofollow" target="_blank">加拿大最佳加密交易机器人</a> | <a class="ae jz" href="https://coincodecap.com/bybit-binance-moonxbt" rel="noopener ugc nofollow" target="_blank"> Bybit vs币安</a></li></ul></div></div>    
</body>
</html>