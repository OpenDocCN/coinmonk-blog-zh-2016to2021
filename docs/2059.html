<html>
<head>
<title>ECDSA — The art of cryptographic signatures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ECDSA —加密签名的艺术</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ecdsa-the-art-of-cryptographic-signatures-d0bb254c8b96?source=collection_archive---------2-----------------------#2019-02-10">https://medium.com/coinmonks/ecdsa-the-art-of-cryptographic-signatures-d0bb254c8b96?source=collection_archive---------2-----------------------#2019-02-10</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="8328" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">本文旨在用一点数学知识介绍椭圆曲线数字签名算法。</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/5656c5ff51fcf8523532f4ab1ec87e3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OptGB7NcibXpyaA0wmm7Jw.jpeg"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Source: <a class="ae jy" href="https://www.google.com/search?q=cryptography&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=0ahUKEwjPzYmU3LHgAhWcxMQBHbVBDnQQ_AUIDigB&amp;biw=1366&amp;bih=639#imgrc=HMwO0HJzy6-qwM" rel="noopener ugc nofollow" target="_blank">https://www.google.com/search?q=cryptography&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=0ahUKEwjPzYmU3LHgAhWcxMQBHbVBDnQQ_AUIDigB&amp;biw=1366&amp;bih=639#imgrc=HMwO0HJzy6-qwM</a>:</figcaption></figure></div><div class="ab cl jz ka hb kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="hm hn ho hp hq"><h2 id="09d8" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">介绍</h2><p id="dc9c" class="pw-post-body-paragraph le lf ht lg b lh li iu lj lk ll ix lm kr ln lo lp kv lq lr ls kz lt lu lv lw hm dt translated">在我之前的一篇文章<a class="ae jy" href="https://blog.goodaudience.com/learn-how-to-code-elliptic-curve-cryptography-26ecc0940d1f" rel="noopener ugc nofollow" target="_blank">“学习如何编写椭圆曲线加密”</a>中，我试图根据椭圆曲线的数学原理来展示加密背后的机制。由于在椭圆曲线上取一点并将其与自身相加导致另一点也位于该曲线上，因此可以将私钥定义为大数<em class="lx"> d </em>并将公钥<em class="lx"> P </em>定义为数<em class="lx"> d </em>与曲线上的选定点<em class="lx"> G </em>的标量积:</p><blockquote class="ly"><p id="1e8a" class="lz ma ht bd mb mc md me mf mg mh lw ek translated"><strong class="ak"> P = d ⋅ G </strong></p></blockquote><p id="db4a" class="pw-post-body-paragraph le lf ht lg b lh mi iu lj lk mj ix lm kr mk lo lp kv ml lr ls kz mm lu lv lw hm dt translated">因此，公钥和私钥之间有着深刻的联系——它们属于同一个部分。这可以用来发送带有签名的消息，签名只是证明消息的发送者确实是创建它的人。接收方无需知道发送方的私钥就可以验证签名本身。以这种方式工作的密码系统通常被称为非对称系统。在这篇文章中，我想更深入一点，描述如何创建和验证签名。</p><h2 id="d0ef" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">创建签名</h2><p id="645b" class="pw-post-body-paragraph le lf ht lg b lh li iu lj lk ll ix lm kr ln lo lp kv lq lr ls kz lt lu lv lw hm dt translated">基于椭圆曲线的数学创建数字签名被称为<em class="lx">椭圆曲线数字签名算法</em>，简称ECDSA。让我们来看看这个算法的各个步骤。</p><p id="e143" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">假设网络中有两个参与者，我们称他们为Alice和Bob。实际上，这两个名字似乎总是在密码系统的实际解释中使用。爱丽丝的公钥是Pₐ，她的私钥是dₐ.签名和验证过程不需要Bob的公钥和私钥。现在，Alice想给Bob发送一条消息<em class="lx"> M </em>，并且还想给这条消息提供一个签名。在应用<em class="lx">签名算法</em>之前，第一步是对消息进行哈希运算，并截断哈希的位长，使其符合所选椭圆曲线的特性。关于创建散列，我想向你推荐我以前的一篇文章<a class="ae jy" rel="noopener" href="/wieblebub/build-a-simple-blockchain-fe7ee48090d9">“构建一个简单的区块链”</a>。在那里，我解释了加密散列函数是如何工作的，以及这种散列有什么属性。消息<em class="lx"> M </em>的散列如下:</p><blockquote class="ly"><p id="e286" class="lz ma ht bd mb mc md me mf mg mh lw ek translated">z =散列值(M)</p></blockquote><p id="4c6d" class="pw-post-body-paragraph le lf ht lg b lh mi iu lj lk mj ix lm kr mk lo lp kv ml lr ls kz mm lu lv lw hm dt translated">现在我们有了hash <em class="lx"> z </em>，我们可以看看Alice的签名算法将运行的步骤:</p><ol class=""><li id="1bc1" class="ms mt ht lg b lh mn lk mo kr mu kv mv kz mw lw mx my mz na dt translated">从数字<em class="lx"> 0，…，n-1 </em>的集合中选择一个大整数<em class="lx"> k </em>。要理解算法，没必要去理解，在什么条件下选择数字<em class="lx"> n </em>。连同用于获取公钥的点<em class="lx"> G </em>一起，曲线上的另一个点<em class="lx"> E </em>正在被计算:<br/> <strong class="lg hu"> <em class="lx"> E= kG </em> </strong></li><li id="b974" class="ms mt ht lg b lh nb lk nc kr nd kv ne kz nf lw mx my mz na dt translated">计算出的点h有一个x坐标和一个y坐标，E= (xₑ ,yₑ).使用该点的x坐标，签名的第一部分将是:<br/><strong class="lg hu"><em class="lx">r =xₑmod n<br/></em></strong>缩写mod表示应用了模运算。放心吧！一点也不复杂。它只是意味着除了休息。如果你取一个数模另一个数，例如7 mod 4，结果将是除法的余数。7除以4的余数是3，所以<br/> 7 mod 4 = 3。</li><li id="6a72" class="ms mt ht lg b lh nb lk nc kr nd kv ne kz nf lw mx my mz na dt translated">如果<em class="lx"> r </em>的结果等于零，则算法返回到步骤1，并以新的数字<em class="lx"> k </em>重新开始。</li><li id="27dc" class="ms mt ht lg b lh nb lk nc kr nd kv ne kz nf lw mx my mz na dt translated">现在将计算签名的第二部分。因此，ECDSA需要Alice打算发送的消息的Hash <em class="lx"> z </em>，她的私钥和最近计算的签名的第一部分<em class="lx"> r </em>。签名的第二部分<em class="lx"> s </em>具有以下形式:<br/><strong class="lg hu"><em class="lx">s =k⁻⋅(z+r⋅dₐ)mod n</em></strong></li><li id="5141" class="ms mt ht lg b lh nb lk nc kr nd kv ne kz nf lw mx my mz na dt translated">如果<em class="lx"> s </em>等于零，算法必须跳回第一步，重新开始。</li></ol><p id="be9b" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">经历这些步骤，最终会给你一对数字<strong class="lg hu"> <em class="lx"> (r，s)——</em></strong>这就是你想要的签名。现在我们知道了签名是如何创建的，下一个感兴趣的部分将是，消息的接收者，即Bob，如何验证它。</p><h2 id="7541" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">验证签名</h2><p id="621b" class="pw-post-body-paragraph le lf ht lg b lh li iu lj lk ll ix lm kr ln lo lp kv lq lr ls kz lt lu lv lw hm dt translated">艾丽丝发出了她的信息，鲍勃收到了，并附上了签名。现在他想知道他收到的信息是否真的来自爱丽丝。他得到的所有信息只是签名(r，s)本身、消息和爱丽丝的公钥Pₐ.必须找到一种方法，他可以仅使用这些信息来验证签名。为此，鲍勃的验证算法需要计算点<em class="lx"> E </em>，并且必须证明xₑ满足以下要求:</p><p id="3b7d" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated"><strong class="lg hu"> <em class="lx"> xₑ mod n = r </em> </strong></p><p id="8b73" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">关于E点，这个等式成立:</p><p id="b8e5" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated"><strong class="lg hu"> <em class="lx"> E = k ⋅ G </em> </strong></p><p id="bac0" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">一个问题是，鲍勃不知道k是什么。但是有一个办法！让我们来看看签名算法第四步中的等式:</p><p id="a1b8" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated"><strong class="lg hu"><em class="lx">s =k⁻⋅(z+r⋅dₐ)mod n</em>t58】</strong></p><p id="68a8" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">我们可以用这种方式重新表达，这样我们就得到数字k的表达式:</p><p id="a658" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated"><strong class="lg hu"><em class="lx">k =s⁻⋅(z+r⋅dₐ)modn</em></strong></p><p id="af06" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">对于<em class="lx"> k </em>的这个表达式，我们可以重写计算点<em class="lx"> E </em>的等式:</p><p id="c822" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated"><strong class="lg hu"><em class="lx">e =</em></strong><strong class="lg hu">t13】k⋅g =s⁻⋅(z+r⋅dₐ)⋅g mod n</strong></p><p id="6083" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">现在我们要做一点数学。我们先把括号相乘:</p><p id="f5d1" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated"><strong class="lg hu">t17】e =(s⁻⋅z⋅g)mod n+(s⁻⋅r⋅dₐ⋅g)mod nt19】</strong></p><p id="aa84" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">记住本文介绍中给出的公钥的定义</p><p id="e0ad" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated"><strong class="lg hu"> <em class="lx"> Pₐ = dₐ ⋅克</em> </strong></p><p id="9ade" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">我们可以用Alice的公钥代替私钥乘以点<em class="lx"> G </em>。因此，现在可以仅使用消息的散列值z、Alice的公钥和签名的信息来计算点E:</p><p id="3a18" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated"><strong class="lg hu">t31】e =(s⁻⋅z⋅g)mod n+(s⁻⋅r⋅pₐ)mod nt33】</strong></p><p id="fe06" class="pw-post-body-paragraph le lf ht lg b lh mn iu lj lk mo ix lm kr mp lo lp kv mq lr ls kz mr lu lv lw hm dt translated">既然我们已经得到了一种验证签名的方法，现在是总结验证算法的单个步骤的时候了:</p><ol class=""><li id="557c" class="ms mt ht lg b lh mn lk mo kr mu kv mv kz mw lw mx my mz na dt translated">取签名(r，s)并计算乘法逆s⁻。使用消息的截断散列<em class="lx"> z </em>，计算数量<br/> <strong class="lg hu"> <em class="lx"> A₁ = s⁻ ⋅ z </em> </strong></li><li id="ed6d" class="ms mt ht lg b lh nb lk nc kr nd kv ne kz nf lw mx my mz na dt translated">计算数量<strong class="lg hu"> <em class="lx"> A₂ = s⁻ ⋅ r </em> </strong>。</li><li id="448c" class="ms mt ht lg b lh nb lk nc kr nd kv ne kz nf lw mx my mz na dt translated">评估点<strong class="lg hu"> <em class="lx"> E = A₁ ⋅ G + A₂ ⋅ Pₐ </em> </strong></li><li id="0118" class="ms mt ht lg b lh nb lk nc kr nd kv ne kz nf lw mx my mz na dt translated">取点<em class="lx"> E </em>的x坐标xₑ，检查以下条件是否成立:<br/><strong class="lg hu"><em class="lx">xₑmod n = r<br/></em></strong>如果该条件成立，则签名正确！</li></ol><h2 id="f33c" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">结束了</h2><p id="dc4a" class="pw-post-body-paragraph le lf ht lg b lh li iu lj lk ll ix lm kr ln lo lp kv lq lr ls kz lt lu lv lw hm dt translated">理解椭圆曲线签名算法的工作原理可能需要一点数学知识，但是我希望您仍然能够对底层机制有一点了解。如果你喜欢我的文章，请留下一些掌声。:)也可以随意评论。感谢阅读！</p><blockquote class="ly"><p id="1543" class="lz ma ht bd mb mc md me mf mg mh lw ek translated"><a class="ae jy" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="nh ni nj nk nl jn fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff ng"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>