<html>
<head>
<title>Customize the Hyperledger Fabric Configurations as per the Company requirements</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">根据公司要求定制Hyperledger结构配置</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/customize-the-hyperledger-fabric-configurations-as-per-the-company-requirements-a1ca8dd7fac9?source=collection_archive---------0-----------------------#2018-11-08">https://medium.com/coinmonks/customize-the-hyperledger-fabric-configurations-as-per-the-company-requirements-a1ca8dd7fac9?source=collection_archive---------0-----------------------#2018-11-08</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="0473" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">正如我们所知，区块链技术正在发展，人们很想了解更多，并试图用这项新技术做实验。Hyperledger 是由Linux基金会主持的开源领先项目之一，支持如此多的框架，但人们大多选择在Hyperledger Fabric上工作。在本教程中，我们将探索Hyperledger Fabric以及如何自定义初始网络设置所需的配置文件，我们还将了解如何在现有网络中添加更多组织。我们开始吧！！！！！</p><p id="4c5d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在潜入超级账本之前。使用以下先决条件设置您的本地计算机:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="dd04" class="jy jz ht ju b fv ka kb l kc kd"><strong class="ju hu">Operating Systems:</strong> Ubuntu Linux 14.04 / 16.04 LTS (both 64-bit), or Mac OS 10.12<br/><strong class="ju hu">Docker Engine: </strong>Version 17.03 or higher<br/><strong class="ju hu">Docker-Compose:</strong> Version 1.8 or higher<br/><strong class="ju hu">Node: </strong>8.9 or higher (note version 9 is not supported)<br/><strong class="ju hu">npm:</strong> v5.x<br/><strong class="ju hu">git:</strong> 2.9.x or higher<br/><strong class="ju hu">Python: </strong>2.7.x</span></pre><p id="e6ea" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您运行的是Ubuntu，您可以使用下面的命令下载这些必备软件。请记住，在运行以下命令之前，不要使用sudo或以root用户身份登录:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="0931" class="jy jz ht ju b fv ka kb l kc kd">curl -O <a class="ae ke" href="https://ibm-blockchain.github.io/develop//develop/prereqs-ubuntu.sh" rel="noopener ugc nofollow" target="_blank">https://ibm-blockchain.github.io/develop//develop/prereqs-ubuntu.sh</a><br/>chmod u+x prereqs-ubuntu.sh</span></pre><p id="13c7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来，运行脚本，因为在执行过程中会短暂地使用sudo，所以会提示您输入密码。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="6416" class="jy jz ht ju b fv ka kb l kc kd">./prereqs-ubuntu.sh</span></pre><p id="130c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">除此之外，你还需要安装go语言包来运行go语言的chaincode。使用以下命令:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="4d29" class="jy jz ht ju b fv ka kb l kc kd">sudo apt install golang-go</span></pre><p id="b4fb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">查看和编辑代码也需要您选择的代码编辑器，我推荐<em class="jo"> VSCode </em>编辑器。</p><h2 id="c7f0" class="jy jz ht bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx dt translated"><strong class="ak">安装总账面料样品</strong></h2><p id="0992" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">在本教程中，我将使用Hyperledger Fabric示例，并在不同的配置文件中进行更改，以便在现有网络中添加一个新组织。确定您的计算机上要放置Hyperledger Fabric样本存储库的位置，并在终端窗口中打开它。然后，执行以下命令:</p><p id="8bf9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在我的例子中，我创建了一个名为fabric_tutorial的目录。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="8a60" class="jy jz ht ju b fv ka kb l kc kd">mkdir fabric_tutorial<br/>cd fabric_tutorial<br/>git clone -b master <a class="ae ke" href="https://github.com/hyperledger/fabric-samples.git" rel="noopener ugc nofollow" target="_blank">https://github.com/hyperledger/fabric-samples.git</a><br/>cd fabric-samples</span></pre><h2 id="ec67" class="jy jz ht bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx dt translated"><strong class="ak">下载特定平台的二进制文件</strong></h2><p id="701e" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">接下来，我们将安装特定于Hyperledger Fabric平台的二进制文件。该工艺旨在补充上述Hyperledger面料样品。请在fabric-sample目录中执行以下命令。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="5406" class="jy jz ht ju b fv ka kb l kc kd">curl -sSL <a class="ae ke" href="https://goo.gl/6wtTN5" rel="noopener ugc nofollow" target="_blank">https://goo.gl/6wtTN5</a> | bash -s 1.1.0 1.1.0 0.4.6</span></pre><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff ld"><img src="../Images/19c4212f70f38612178d4e83899e12fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GhH02AUx81BQ6Yb-r7Yt3w.png"/></div></div></figure><p id="e3f6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">执行上述命令后，它将开始获取平台特定的二进制文件，并将在fabric-samples中创建一个bin文件夹。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div class="fe ff ll"><img src="../Images/e44a7807210a063aec9a9d55f9cca6f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:264/format:webp/1*Xk_kLx6UaGNm8V22HZJh4w.png"/></div></figure><p id="166e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您将会注意到，在fabric-samples存储库中包含了许多样本。我们将使用第一个网络样本。现在让我们打开子目录。</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="68c4" class="jy jz ht ju b fv ka kb l kc kd">cd fabric-samples/first-network</span></pre><p id="2fe3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Hyperledger Fabric提供了完全带注释的脚本<code class="eh lm ln lo ju b">byfn.sh</code>,该脚本利用这些Docker映像来快速引导Hyperledger Fabric网络，该网络由代表两个不同组织的4个对等点和一个订购者节点组成。它还将启动一个容器来运行一个脚本执行，该脚本执行将对等体加入到一个通道中，部署和实例化链代码，并根据部署的链代码驱动事务的执行。但我们不只是运行这些<code class="eh lm ln lo ju b">byfn.sh</code>脚本，我们将向现有网络添加一个新组织，然后运行这些脚本文件，以便它能够反映这些变化。</p><h2 id="4f2a" class="jy jz ht bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx dt translated">密码生成器</h2><p id="1374" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated"><code class="eh lm ln lo ju b">cryptogen</code>工具用于为各种网络实体生成加密材料(x509证书和签名密钥)。Cryptogen使用一个包含网络拓扑的文件<code class="eh lm ln lo ju b">crypo-config.yaml</code>，并允许我们为所有组织和属于这些组织的组件生成一组证书和密钥。打开第一个网络下的<code class="eh lm ln lo ju b">crypto-config.yaml</code>文件，通过在现有网络中添加新的末端组织分别进行更改。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div class="fe ff lp"><img src="../Images/59cb21c2fcc065dbd0e6f156148b52c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*mU8G737KUTjwdR4sAXqlyA.png"/></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">crypto-config.yaml</figcaption></figure><h2 id="8fa2" class="jy jz ht bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx dt translated">创建网络工件</h2><p id="21cb" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">类似地，Configtxgen使用一个文件<code class="eh lm ln lo ju b">configtx.yaml</code>,该文件包含示例网络的定义。有四个成员——一个订购者组织(order Org)和三个对等组织(Org1，Org2 &amp; Org3 ),每个组织管理和维护两个对等节点。这个文件指定了一个联合体——sample consortium——由我们的三个对等组织组成。请特别注意该文件顶部的“<em class="jo">配置文件</em>部分。您会注意到我们有两个独特的标题。一个用于订购者生成模块<em class="jo">三个订购者生成模块</em>，一个用于我们的频道<em class="jo">三个订购者频道</em>。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff lu"><img src="../Images/7a082b8d232de1a066f4715a28408064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJBAKLC0JViYNW65Yze8_w.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">configtx.yaml</figcaption></figure><h2 id="12a0" class="jy jz ht bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx dt translated">Docker组合拓扑</h2><p id="63c2" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">完成这两个步骤后，进入<code class="eh lm ln lo ju b">docker-compose-cli.yaml</code>文件，通过添加Org3的服务来做相应的修改。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div class="fe ff lv"><img src="../Images/2fba76d872628883a5ef0b1d564049ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*Xp7ByFkkfbuNGTHUfptA9g.png"/></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">docker-compose-cli.yaml</figcaption></figure><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff lw"><img src="../Images/55eac5087eb8d1a1a28e3d09eb0e8adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Guujez_XTMRbdGhvj4ePg.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">docker-compose-cli.yaml</figcaption></figure><p id="d719" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">打开first-network下的基本文件夹，转到<code class="eh lm ln lo ju b">docker-composer-base.yaml</code>文件。为Org3的两个具有不同端口号的对等体添加新容器。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff lx"><img src="../Images/4dae8ef73c36d856a13227ca224012e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c0o0Et8M6cljWlDKvgYmsg.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">docker-compose-base.yaml</figcaption></figure><p id="672c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh lm ln lo ju b">docker-compose-e2e-template.yaml</code>被构建为使用Node.js SDK运行端到端测试。除了与SDK一起工作之外，它的主要用途是向组织ca发送REST调用，用于用户注册和登记。打开<code class="eh lm ln lo ju b">docker-composer-e2e-templete.yaml</code>并定义CA(认证机构)配置。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff ly"><img src="../Images/37e195d396245947ff9dd138e09778be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a0OgtRGBcOcLEBjgU_EqJA.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">docker-composer-e2e-template.yaml</figcaption></figure><figure class="jp jq jr js fq le fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/61b1c4110501b6133701c430fb4da379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*sO-ZS52g-gAHpkADUPYQtg.png"/></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">docker-composer-e2e-template.yaml</figcaption></figure><h2 id="5fdc" class="jy jz ht bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx dt translated">CouchDB</h2><p id="6e5f" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">现在是时候为不同的对等体处理CouchDB数据库了。<code class="eh lm ln lo ju b">docker-compose-couch.yaml</code>文件包含为组织对等体定义的存储。通过添加新的CouchDB容器为Org3配置数据库。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff ma"><img src="../Images/79c3669359e78e60b6b0f74a03d2bf51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RfM1n1ivxNet5mT-81ZaOA.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">docker-composer-couch.yaml</figcaption></figure><p id="3722" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">呼呼！！！！我认为在不同的配置文件中已经做了很多改变，现在是时候生成不同的证书了。分别在加密配置和信道伪像下发送。通过运行以下命令:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="1ac2" class="jy jz ht ju b fv ka kb l kc kd">./byfn.sh generate</span></pre><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff mb"><img src="../Images/00e0aa6170db05bf84c3322a4ed47c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A7Fho1Lh-yG7slsZ0H2G8g.png"/></div></div></figure><p id="1f6d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">运行上面的命令后。它将反映新的文件和文件夹下的加密配置如下。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/4d35b25574a257be0257badc32cd44ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*XU19LyPbhj3K9TZAgIXVjg.png"/></div></figure><p id="d2ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在生成这些网络工件后，现在它们会转向不同的文件，如<code class="eh lm ln lo ju b">byfn.sh</code>和<code class="eh lm ln lo ju b">script.sh</code>。我们在这些文件下分别做了修改，允许不同的组织加入渠道，安装链码，发起链码，查询链码。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff md"><img src="../Images/a1c5ce78b3f62d9f736718ab7d5353fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GfE5u96vxQ6Nq0n9l4CDhA.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">byfn.sh</figcaption></figure><p id="7a34" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在<code class="eh lm ln lo ju b">utils.sh</code>中加入新的组织以达成共识。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff lw"><img src="../Images/8c78757581da12df59556c91ec367984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MlwsoqmwsLaT3pCv0VjHVg.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">utils.sh</figcaption></figure><p id="e954" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们通过添加Org3对wrt <code class="eh lm ln lo ju b">script.sh</code>文件做了一些修改，并获取查询以获得结果。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff me"><img src="../Images/3272e29059573468722e4bfa7dc80f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tv5wDqcIpI5LBwu8U6MZBg.png"/></div></div><figcaption class="lq lr fg fe ff ls lt bd b be z ek">script.sh</figcaption></figure><p id="0c5d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在不同的配置文件中完成所有这些更改之后。运行命令:</p><pre class="jp jq jr js fq jt ju jv jw aw jx dt"><span id="4a0c" class="jy jz ht ju b fv ka kb l kc kd">./byfn.sh up </span></pre><p id="49bf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">它将成功运行代码并在最后显示“END”。如果你没有收到这个“结束”消息，这意味着你在不同的配置文件中做修改时犯了一些错误。</p><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff mf"><img src="../Images/bca1019556bcd54532918d469c4ebd2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33-_sc15FyraRj2mPVwoqg.png"/></div></div></figure><figure class="jp jq jr js fq le fe ff paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="fe ff mg"><img src="../Images/9e7941ebdf41135f6db691360271b9c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nep2FmIw-p9RLFJrKhQ3uw.png"/></div></div></figure><p id="1575" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">耶！！！！我们成功地将新组织(Org3)添加到<em class="jo"> mychannel </em>，安装并初始化chaincode并查询结果。</p><p id="0c48" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您可以从下面的链接获得完整的定制代码:</p><div class="mh mi fm fo mj mk"><a href="https://github.com/bhawanaSingh/hyperledger_fabric_multi_org_network" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab ej"><div class="mm ab mn cl cj mo"><h2 class="bd hu fv z el mp eo ep mq er et hs dt translated">bhawanasing/hyperledger _ fabric _ multi _ org _ network</h2><div class="mr l"><h3 class="bd b fv z el mp eo ep mq er et ek translated">根据公司要求定制Hyperledger结构配置。…</h3></div><div class="ms l"><p class="bd b gc z el mp eo ep mq er et ek translated">github.com</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my lj mk"/></div></div></a></div><blockquote class="mz"><p id="b8d2" class="na nb ht bd nc nd ne nf ng nh ni jn ek translated"><a class="ae ke" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="nk nl nm nn no le fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nj"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>