<html>
<head>
<title>Ethereum Security Analysis Tools: An Introduction and Comparison</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊安全分析工具:介绍与比较</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethereum-security-analysis-tools-an-introduction-and-comparison-1096194e64d5?source=collection_archive---------2-----------------------#2020-04-02">https://medium.com/coinmonks/ethereum-security-analysis-tools-an-introduction-and-comparison-1096194e64d5?source=collection_archive---------2-----------------------#2020-04-02</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="0431" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">MythX vs Slither vs Securify</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/48de83a4f143536050e74ce5f5336824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x4irFi1W6wSLrbp5y6CC4A.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">The three tools we’ll look at in this article</figcaption></figure><p id="776a" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">安保很难。当用户的钱岌岌可危时，这就更难了。幸运的是，以太坊生态系统在过去几年中已经成熟，现在有各种高质量的工具可以扫描你的以太坊智能合约，寻找安全漏洞。(剧透:它们都无法取代一次真正的审计)。</p><p id="b1d4" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">在本文中，我们将介绍三种更加流行的安全分析工具——Slither、MythX和Securify——并逐一完成以下步骤，以便您可以看到它们之间的比较:</p><ol class=""><li id="4f6f" class="kv kw ht ka b kb kc ke kf kh kx kl ky kp kz kt la lb lc ld dt translated">设置过程</li><li id="1421" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt la lb lc ld dt translated">运行扫描</li><li id="ce67" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt la lb lc ld dt translated">结果分析</li></ol><p id="f622" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">正如我们将在上一节中讨论的，这些工具并不完全是1:1的比较，结果应该有所保留。还要注意，本文中的所有工具都将在macOS Catalina上运行，因此步骤和命令可能会因您的操作系统而异。本文将假设您有使用Python 3、Git和Solidity的经验。</p><h1 id="8591" class="lj lk ht bd ll lm ln lo lp lq lr ls lt iz lu ja lv jc lw jd lx jf ly jg lz ma dt translated">工具介绍</h1><p id="961c" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">让我们从每个工具的高级概述开始。据我所知，这些工具都不支持Vyper，它们都要求你使用Solidity。</p><h2 id="1266" class="mg lk ht bd ll mh mi mj lp mk ml mm lt kh mn mo lv kl mp mq lx kp mr ms lz mt dt translated">滑行</h2><p id="977d" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated"><a class="ae ku" href="https://github.com/crytic/slither" rel="noopener ugc nofollow" target="_blank"> Slither </a>由安全组织<a class="ae ku" href="https://www.trailofbits.com/" rel="noopener ugc nofollow" target="_blank"> Trail of Bits </a>开发，将Slither描述为“一个用Python 3编写的可靠性静态分析框架。它运行一套漏洞检测器，打印关于合同细节的可视信息，并提供一个API来轻松编写定制分析。Slither使开发人员能够找到漏洞，增强他们对代码的理解，并快速构建定制分析的原型。”</p><p id="36ef" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">Slither还附带了一些其他有用的工具，比如一个<a class="ae ku" href="https://github.com/crytic/slither/wiki/Contract-Flattening" rel="noopener ugc nofollow" target="_blank">展平器</a>，能够<a class="ae ku" href="https://github.com/crytic/slither/wiki/ERC-Conformance" rel="noopener ugc nofollow" target="_blank">检测与各种ERC(比如ERC20和ERC721)的一致性</a>，以及<a class="ae ku" href="https://github.com/crytic/slither/wiki/Upgradeability-Checks" rel="noopener ugc nofollow" target="_blank">使用<a class="ae ku" href="https://blog.trailofbits.com/2018/09/05/contract-upgrade-anti-patterns/" rel="noopener ugc nofollow" target="_blank"> delegatecall代理模式</a>为可升级的合同检查</a>合同。</p><p id="c94c" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">Bits team团队也写了一些关于这个工具的博客，你可以在这里找到<a class="ae ku" href="https://blog.trailofbits.com/2018/10/19/slither-a-solidity-static-analysis-framework/" rel="noopener ugc nofollow" target="_blank"/>和<a class="ae ku" href="https://blog.trailofbits.com/2019/05/27/slither-the-leading-static-analyzer-for-smart-contracts/" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="1498" class="mg lk ht bd ll mh mi mj lp mk ml mm lt kh mn mo lv kl mp mq lx kp mr ms lz mt dt translated">神话</h2><p id="32a7" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">MythX——ConsenSys的一个项目——可以“自动扫描以太坊和其他位于EVM的区块链智能合约中的安全漏洞。MythX全面的分析技术—包括静态分析、动态分析和符号执行—可以准确地检测安全漏洞，以提供深入的分析报告。MythX拥有一个由世界级集成合作伙伴组成的充满活力的生态系统，可以提高开发人员的工作效率，可以在项目生命周期的所有阶段使用它。我们的安全专家团队致力于研究和改进我们用于强化您代码的工具和技术。”</p><p id="a5c2" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">MythX团队有他们自己的博客，可以在这里<a class="ae ku" href="https://blog.mythx.io/" rel="noopener ugc nofollow" target="_blank">找到</a>，以及相关资源和工具的精选列表<a class="ae ku" href="https://github.com/b-mueller/awesome-mythx-smart-contract-security-tools" rel="noopener ugc nofollow" target="_blank">。同样值得注意的是，MythX是一个完整的安全服务，而不仅仅是一个扫描工具。</a></p><h2 id="e896" class="mg lk ht bd ll mh mi mj lp mk ml mm lt kh mn mo lv kl mp mq lx kp mr ms lz mt dt translated">安全化</h2><p id="5792" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">我们要看的最后一个工具是由<a class="ae ku" href="https://chainsecurity.com/" rel="noopener ugc nofollow" target="_blank"> ChainSecurity </a>开发的<a class="ae ku" href="https://github.com/eth-sri/securify2" rel="noopener ugc nofollow" target="_blank"> Securify </a>。Securify支持<a class="ae ku" href="https://github.com/eth-sri/securify2#supported-vulnerabilities" rel="noopener ugc nofollow" target="_blank"> 38 </a>漏洞，实现新颖的上下文敏感静态分析，只能分析Solidity 0 . 5 . 8以上版本编写的契约。</p><p id="452d" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">注意，我们在这里看到的是Securify v2.0，它是最初的Securify 的继承者。</p><h1 id="cadf" class="lj lk ht bd ll lm ln lo lp lq lr ls lt iz lu ja lv jc lw jd lx jf ly jg lz ma dt translated">设置过程</h1><p id="7494" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">我们假设你已经有一个项目可以使用了，但是如果没有的话，可以随意克隆一下<a class="ae ku" href="https://github.com/scopelift/fakerdao" rel="noopener ugc nofollow" target="_blank"> FakerDAO </a>项目。对于本文来说，这是一个很好的项目，因为它相当简单，因为部署后使用的惟一契约是<code class="eh mu mv mw mx b">contracts</code>文件夹中的<code class="eh mu mv mw mx b">Faker.sol</code>。</p><h2 id="07f3" class="mg lk ht bd ll mh mi mj lp mk ml mm lt kh mn mo lv kl mp mq lx kp mr ms lz mt dt translated">滑行</h2><p id="2b89" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">Slither只是Trail of Bits的以太坊安全工具套件中的一个工具，所以如果你对其余的感兴趣，你可以在这里查看<a class="ae ku" href="https://github.com/crytic/eth-security-toolbox" rel="noopener ugc nofollow" target="_blank"/>。这意味着有两种方法安装Slither:</p><ol class=""><li id="3cb3" class="kv kw ht ka b kb kc ke kf kh kx kl ky kp kz kt la lb lc ld dt translated">通过<code class="eh mu mv mw mx b">docker pull trailofbits/eth-security-toolbox</code>使用Docker安装全套工具</li><li id="131a" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt la lb lc ld dt translated">使用Python只安装Slither</li></ol><p id="0dc8" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">这两种方法都很好，但是我们稍后会使用Python，所以我们在这里使用方法2。<em class="my">注意:本文的早期版本错误地指出eth-security-toolbox的大小是15GB。我的机器上有一个旧版本，因此出现了错误。感谢</em> <a class="ae ku" href="https://twitter.com/dguido" rel="noopener ugc nofollow" target="_blank"> <em class="my">丹圭多</em> </a> <em class="my">以及Bits团队的踪迹指出这一点。</em></p><p id="b60a" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">在项目文件夹中，使用<code class="eh mu mv mw mx b">python3 -m venv venv</code>创建Python虚拟环境，并使用<code class="eh mu mv mw mx b">source ./venv/bin/activate</code>激活它。我们现在可以通过运行<code class="eh mu mv mw mx b">pip install slither-analyzer</code>来安装Slither。(确保将<code class="eh mu mv mw mx b">venv</code>添加到您的<code class="eh mu mv mw mx b">.gitignore</code>文件中)。</p><p id="69ab" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">你完了！Slither现在已经可以使用了，但是我们将推迟使用它，直到我们安装了其余的工具。</p><h2 id="1414" class="mg lk ht bd ll mh mi mj lp mk ml mm lt kh mn mo lv kl mp mq lx kp mr ms lz mt dt translated">神话</h2><p id="4c13" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">回想一下，MythX不仅仅是一个扫描工具，所以设置要复杂一些。首先，你需要创建一个账户，方法是进入MythX网站并点击注册。</p><p id="aaf0" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">现在让我们生成我们的API密匙，并把它保存在一个名为<code class="eh mu mv mw mx b">.env </code>的文件中，文件内容为<code class="eh mu mv mw mx b">export MYTHX_API_KEY=yourApiKey</code>。确保使用准确的名称，因为MythX将查找具有该名称的变量。请确保该文件不会提交给存储库。</p><p id="8b6d" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">您将看到运行MythX有几个选项——一个VSCode插件、一个Truffle插件、一个Remix插件和一个命令行客户端。我们将尽量保持工具无关性，因此，在我们的Python虚拟环境仍然活跃的情况下，让我们用<code class="eh mu mv mw mx b">pip install mythx-cli</code>安装命令行客户端。</p><p id="d01b" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">这比Slither要复杂一点，因为我们需要创建一个帐户并获得一个API密匙，但仍然非常简单。你很快就会明白为什么我们需要创建一个帐户。</p><h2 id="7919" class="mg lk ht bd ll mh mi mj lp mk ml mm lt kh mn mo lv kl mp mq lx kp mr ms lz mt dt translated">安全化</h2><p id="a276" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">这可以用Python手动安装，但这个过程相当复杂，我无法用这种方法让Securify运行。相反，我们将使用<a class="ae ku" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker </a>来安装这个工具。如果你从未使用过Docker，它可以让你创建或安装所谓的<em class="my">容器</em>,这些容器可以在任何机器上运行，而不考虑包括所有依赖项在内的操作系统。如果你不知道如何使用Docker，没关系——只要按照这些<a class="ae ku" href="https://mattsolomon.dev/docker" rel="noopener ugc nofollow" target="_blank">安装说明</a>操作，稍后你就可以简单地运行指定的命令。</p><p id="3cfb" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">在项目根中，用<code class="eh mu mv mw mx b">git clone https://github.com/eth-sri/securify2.git</code>克隆存储库，然后将<code class="eh mu mv mw mx b">cd</code>克隆到该目录中，并用<code class="eh mu mv mw mx b">sudo docker build -t securify .</code>构建Docker容器(不要忘记句点)。</p><p id="e609" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">一旦完成，我们就完成了所有工具的安装，并可以开始运行一些扫描。</p><h1 id="2dbc" class="lj lk ht bd ll lm ln lo lp lq lr ls lt iz lu ja lv jc lw jd lx jf ly jg lz ma dt translated">运行扫描</h1><p id="0b31" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">好了，现在是有趣的时候了。让我们学习如何运行每个工具，然后我们将比较结果。确保<code class="eh mu mv mw mx b">cd</code>先回到项目根。</p><h2 id="6de6" class="mg lk ht bd ll mh mi mj lp mk ml mm lt kh mn mo lv kl mp mq lx kp mr ms lz mt dt translated">滑行</h2><p id="2a92" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">如果我们想在项目的每个合同上运行Slither，就像运行<code class="eh mu mv mw mx b">slither .</code>一样简单。我们只需要在一个文件上运行它，所以我们将运行<code class="eh mu mv mw mx b">slither path/to/contract.sol</code>，在我们的例子中它变成了<code class="eh mu mv mw mx b">slither contracts/Faker.sol</code>。</p><p id="71aa" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">如果您正在使用FakerDAO示例，您可能注意到的第一件事就是不支持<code class="eh mu mv mw mx b">@</code>样式导入。所以您需要将import语句从<code class="eh mu mv mw mx b">import “@openzeppelin/contracts-ethereum-package/contracts/math/SafeMath.sol”;</code>改为更明确的<code class="eh mu mv mw mx b">import “node_modules/@openzeppelin/contracts-ethereum-package/contracts/math/SafeMath.sol”;</code>。</p><p id="37ed" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">现在尝试再次运行该命令，您将很快得到打印到终端的结果！显示了各种<em class="my">检测器</em>的结果，其中检测器只是一类缺陷/漏洞。Slither支持的检测器的完整列表可以在这里找到<a class="ae ku" href="https://github.com/crytic/slither#detectors" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="eabe" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">现在，您应该可以看到按严重性进行颜色编码的结果，首先打印高严重性检测器，然后是中严重性和低严重性输出。</p><p id="8f21" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">它们按检测机类型分类，因此在一部分结果后，您会看到以<code class="eh mu mv mw mx b">Reference:</code>开头的一行，其中包含一个文档链接，您可以从中了解有关该特定检测机的更多信息。而这还差不多！您可以在下面看到一个输出示例。在通读了每条消息和相应的文档之后，您应该能够更好地确定需要对代码进行哪些更改。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff mz"><img src="../Images/6c13c73cd8ce86bfb87d20529d157bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h8TlBi7XP7Uyur7McDoL4A.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Sample output when running Slither</figcaption></figure><p id="58af" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">Slither还配备了各种各样的<a class="ae ku" href="https://github.com/crytic/slither/wiki/Printer-documentation" rel="noopener ugc nofollow" target="_blank">打印机</a>，可以打印不同的合同信息。例如，调用图可以用<code class="eh mu mv mw mx b">call-graph</code>打印机打印，继承关系可以用<code class="eh mu mv mw mx b">inheritance</code>或<code class="eh mu mv mw mx b">inheritance-graph</code>打印机打印，函数id可以用<code class="eh mu mv mw mx b">function-id</code>打印机轻松获得。打印机不会直接指出安全问题，而是给你额外的工具来帮助检查，并确保代码的结构符合预期。</p><p id="6cee" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">例如，我们可以使用<code class="eh mu mv mw mx b">slither contracts/Faker.sol — print call-graph</code>获得契约的调用图。这将为每个合约创建一个<code class="eh mu mv mw mx b">.dot</code>文件，查看它将显示一个调用图，如下所示:</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff na"><img src="../Images/b420bd2be9c10b44388b384dd5de9580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXsI3T9tGPpDx3Cgu6FZUQ.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Sample call-graph output from Slither</figcaption></figure><p id="74f4" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">同样值得注意的是，Trail of Bits提供了一个名为<a class="ae ku" href="https://crytic.io/" rel="noopener ugc nofollow" target="_blank"> Crytic </a>的付费产品，它允许访问额外的检测器、GitHub集成等等。我没有使用过这个工具，所以无法对它进行评论，但它似乎在范围上类似于MythX平台，从某种意义上说，它是一个完整的服务，而不仅仅是一个扫描工具。如果没有Crytic，您将需要手动控制任何想要保存和以后参考的扫描结果的版本。</p><h2 id="2899" class="mg lk ht bd ll mh mi mj lp mk ml mm lt kh mn mo lv kl mp mq lx kp mr ms lz mt dt translated">神话</h2><p id="45d3" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">MythX提供了不同的<a class="ae ku" href="https://mythx.io/plans/" rel="noopener ugc nofollow" target="_blank">计划</a>，每一个都开启了不同深度的分析。付费计划提供7天免费试用，因此我们将利用这一点来看看这里的三个计划。</p><p id="f462" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">回想一下，我们之前配置了一个环境变量，所以首先运行<code class="eh mu mv mw mx b">source .env</code>来设置它。现在我们可以运行<code class="eh mu mv mw mx b">mythx analyze</code>来分析每个Solidity文件，但是这里我们将使用<code class="eh mu mv mw mx b">mythx analyze contracts/Faker.sol</code>来分析一个文件。(您还可以指定一些其他选项，您可以在此处阅读<a class="ae ku" href="https://mythx-cli.readthedocs.io/en/latest/usage.html" rel="noopener ugc nofollow" target="_blank">。第一次运行时，编译依赖项会花费相当多的时间，所以请耐心等待！后续运行会更快。</a></p><p id="b5fc" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">就像Slither一样，<code class="eh mu mv mw mx b">@</code>样式的导入也不被支持，所以确保修改导入路径来明确列出<code class="eh mu mv mw mx b">node_modules</code>文件夹。完成后，您将看到如下所示的输出。请注意，默认情况下，该命令将以快速扫描模式运行MythX很快我们将看到标准和深度扫描模式。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nb"><img src="../Images/e2eff5e7435b3f8e78f41533483e9ca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HLJq7-ho4B3NnRhlYNh6FA.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Sample output from the MythX Free plan, Quick scan</figcaption></figure><p id="2253" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">注意警告，免费版本声明它不能检测所有的漏洞类型。但是，我找不到一个页面，其中包含了每种计划类型中可以检测到和不能检测到的漏洞的列表。虽然从文档中不能完全清楚，但我的理解是，MythX层提供了对如下功能的访问:</p><ul class=""><li id="dead" class="kv kw ht ka b kb kc ke kf kh kx kl ky kp kz kt nc lb lc ld dt translated">免费计划→仅快速扫描</li><li id="9d80" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">开发者计划→快速扫描+标准扫描</li><li id="62b2" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">专业计划→快速扫描+标准扫描+深度扫描</li></ul><p id="ed05" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">升级到开发版并重新运行后，您会看到警告被删除，因为它是相同的扫描类型，没有发现其他漏洞。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nd"><img src="../Images/61a1f7166ef8d3a4d7e26eac68e9c190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sKi_6IH0gE73nn-Qqe03g.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Sample output from the MythX Developer Plan, Quick Scan</figcaption></figure><p id="0d2f" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">我们刚刚运行了快速扫描，现在让我们运行标准和深度扫描。这些模式分别需要5分钟、30分钟和90分钟。要运行标准扫描，使用<code class="eh mu mv mw mx b">--mode</code>标志，例如<code class="eh mu mv mw mx b">mythx analyze contracts/Faker.sol --mode standard</code>。</p><p id="8caf" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">以下是标准扫描和深度扫描的结果。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ne"><img src="../Images/e8b772afad23ffc053349f560eaad5c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u_CYALyBZ9Nk6CqUNhsL9g.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Sample output from the MythX Developer Plan, Standard Scan</figcaption></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nf"><img src="../Images/34e6c87c4c936c4af545805e7a601602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XQmp1627jFpIAF0_Os2Uqw.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Sample output from the MythX Professional Plan, Deep Scan</figcaption></figure><p id="9961" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">对于我们在这里使用的FakerDAO合同，快速扫描几乎是即时的，标准扫描大约需要20分钟，深度扫描大约需要45分钟。我们可以看到，越来越多的层实际上发现了更多的潜在漏洞。在下一节中，我们将更详细地比较这些结果。</p><p id="9e82" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">回想一下，MythX不仅仅是一个扫描工具。在上面的图片中，您会注意到一个包含报告的仪表板的URL。您创建的API键与您的MythX帐户相关联，因此您可以在任何地方登录并获得所有分析的历史记录。这包括运行的日期和时间、测试的源文件以及发现的漏洞。下面是您可以在仪表板中找到的三个不同的页面，显示了我们上面运行的标准扫描。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ng"><img src="../Images/6368d64c069df6ad3564c247fc756644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ETo_IHKknYgGzFpbTVyH_g.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">MythX Dashboard “View Analyses” page</figcaption></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nh"><img src="../Images/8cb6c3a05a65d31de6453c03726e35e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Du-Q1OAuCos_IT9srTnqhg.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">High-level overview of a given scan</figcaption></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ni"><img src="../Images/d320c5e7d5963caf2d8446a28917fd40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l71SnHScmTvBXTe2ISum-Q.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Details page for a given scan</figcaption></figure><h2 id="c4c4" class="mg lk ht bd ll mh mi mj lp mk ml mm lt kh mn mo lv kl mp mq lx kp mr ms lz mt dt translated">安全化</h2><p id="42f3" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">最后一个工具。Securify目前仅支持平面合同，这意味着我们的<code class="eh mu mv mw mx b">import</code>语句不受支持。因此，要使用Securify，您必须手动将导入替换为完整的Solidity文件。有一些削平工具可以帮你做到这一点，比如<a class="ae ku" href="https://github.com/merklejerk/solpp" rel="noopener ugc nofollow" target="_blank"> solpp </a>、<a class="ae ku" href="https://github.com/nomiclabs/truffle-flattener" rel="noopener ugc nofollow" target="_blank">松露削平器</a>、<a class="ae ku" href="https://github.com/BlockCatIO/solidity-flattener" rel="noopener ugc nofollow" target="_blank">坚固性削平器</a>，还有一个叫做<a class="ae ku" href="https://github.com/poanetwork/solidity-flattener" rel="noopener ugc nofollow" target="_blank">坚固性削平器</a>，甚至还有一个上面提到的<a class="ae ku" href="https://github.com/crytic/slither/wiki/Contract-Flattening" rel="noopener ugc nofollow" target="_blank">附带的滑动器</a>。</p><p id="c910" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">一旦你完成了这些，你就可以用<code class="eh mu mv mw mx b">sudo docker run -it -v &lt;full/path/to/contracts&gt;:/share securify /share/&lt;contract.sol&gt;</code>进行分析了。在我们的例子中，因为我们只想运行<code class="eh mu mv mw mx b">Faker.sol</code>契约，所以我们将使用<code class="eh mu mv mw mx b">sudo docker run -it -v $(pwd)/contracts:/share securify /share/Faker.sol</code>。</p><p id="f7c9" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">如果您不熟悉Docker，以下是该命令的简要概述:</p><ul class=""><li id="f559" class="kv kw ht ka b kb kc ke kf kh kx kl ky kp kz kt nc lb lc ld dt translated"><code class="eh mu mv mw mx b">sudo docker run</code>:以管理员身份运行docker容器(我不知道为什么它需要管理员权限)</li><li id="ea72" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated"><code class="eh mu mv mw mx b">-it</code>:将容器作为交互进程运行(这允许您在Docker容器中的终端上输入命令)</li><li id="f369" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated"><code class="eh mu mv mw mx b">-v $(pwd)/contracts:/share</code>:与Docker容器的<code class="eh mu mv mw mx b">/share</code>目录共享我们的本地<code class="eh mu mv mw mx b">contracts</code>目录，由完整的文件路径<code class="eh mu mv mw mx b">$(pwd)/contracts</code>指定。Securify工具存在于容器中，因此它允许容器读取我们的本地合同文件。</li><li id="b4d3" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated"><code class="eh mu mv mw mx b">securify /share/Faker.sol</code>:在Docker容器中运行以执行分析的命令</li></ul><p id="9f02" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">现在我们等待分析运行，您应该会看到类似下图的内容。这里的输出有点混乱，因为颜色似乎与严重性不对应——注意黄色消息是如何分为中、高的，而红色消息是信息、中、高和关键。此外，请注意最上面的两条消息都是中等级别的<code class="eh mu mv mw mx b">Missing input validation</code>，但是它们以不同的颜色显示。阅读这里的输出时要小心，以免误解任何内容。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nj"><img src="../Images/f9d1aa5f880377fb910be9a619a036bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FMBI5cW24u_PwcLMEQ0bsw.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Securify v2 output</figcaption></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nk"><img src="../Images/049e4af317f9d4971cfb95f60f17cdd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*koydPF84NUvV-kWjmdPzUQ.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Additional Securify v2 output from the same run</figcaption></figure><h1 id="eb3a" class="lj lk ht bd ll lm ln lo lp lq lr ls lt iz lu ja lv jc lw jd lx jf ly jg lz ma dt translated">结果分析</h1><p id="3aef" class="pw-post-body-paragraph jy jz ht ka b kb mb iu kd ke mc ix kg kh md kj kk kl me kn ko kp mf kr ks kt hm dt translated">在得出结果之前，我们应该注意，这篇文章还远远不够全面，还有很多可以扩展的地方，例如:</p><ul class=""><li id="682e" class="kv kw ht ka b kb kc ke kf kh kx kl ky kp kz kt nc lb lc ld dt translated">这些工具并不完全是公平的一对一比较。例如，MythX将运行一个<a class="ae ku" href="https://en.wikipedia.org/wiki/Static_program_analysis" rel="noopener ugc nofollow" target="_blank">静态分析</a>，一个<a class="ae ku" href="https://en.wikipedia.org/wiki/Symbolic_execution" rel="noopener ugc nofollow" target="_blank">符号分析器</a>，以及一个<a class="ae ku" href="https://en.wikipedia.org/wiki/Fuzzing" rel="noopener ugc nofollow" target="_blank">模糊器</a>。另一方面，Slither只是一个静态分析工具，相关的符号分析器和模糊器被分解成单独的工具，分别称为<a class="ae ku" href="https://github.com/trailofbits/manticore" rel="noopener ugc nofollow" target="_blank">蝎狮</a>和<a class="ae ku" href="https://github.com/trailofbits/echidna" rel="noopener ugc nofollow" target="_blank">鼹鼠</a>。</li><li id="8329" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">我们没有深入探究Slither的打印机，也没有涉及它的API。</li><li id="63fa" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">我们没有涉及到由Bits Trail提供的<a class="ae ku" href="https://github.com/crytic/eth-security-toolbox" rel="noopener ugc nofollow" target="_blank">其他工具</a>，比如它的模糊测试器<a class="ae ku" href="https://github.com/trailofbits/echidna" rel="noopener ugc nofollow" target="_blank">鼹鼠</a>或者符号分析器<a class="ae ku" href="https://github.com/trailofbits/manticore" rel="noopener ugc nofollow" target="_blank">蝎狮</a>。</li><li id="5a68" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">我们没有查看每个工具提供的全套服务，例如CI/CD集成、GitHub集成或支持。</li><li id="af78" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">我们没有考虑产品的成本。</li></ul><p id="6d19" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">好了，现在我们准备比较结果了！</p><p id="8844" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">我们将使用<a class="ae ku" href="https://swcregistry.io/" rel="noopener ugc nofollow" target="_blank"> SWC注册中心</a>——智能合同缺陷分类注册中心——进行对比。这包含一个潜在契约弱点和漏洞的列表，以及每个弱点、漏洞的解释、参考和测试用例。</p><p id="11a2" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">下表列出了每次扫描的结果。关于此表的几点注意事项:</p><ul class=""><li id="513a" class="kv kw ht ka b kb kc ke kf kh kx kl ky kp kz kt nc lb lc ld dt translated">为了清楚起见，隐藏了没有被任何工具发现的SWC</li><li id="e8b4" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">不是每个工具都直接映射到这个注册表，所以有括号解释工具描述的具体问题。</li><li id="6501" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">带星号的SWC id是我添加的，因为我在SWC注册表中找不到与工具输出匹配的id。这些“新”SWC id的名称是从工具输出中提取的。</li><li id="17a6" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">我没有根据合同手动验证每份报告的有效性和准确性，所以请对此表持保留意见。</li><li id="f811" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">不要认为计数最高的那个就是最好的。</li></ul><p id="75e3" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">事不宜迟，下面是结果！</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff nl"><img src="../Images/59add8fdcf2404d8ba57e3466102c549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OwbTeppIRWfH954JlsIxUA.png"/></div></div><figcaption class="ju jv fg fe ff jw jx bd b be z ek">Summary of results</figcaption></figure><p id="ecf7" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">那么我们能从这里带走什么呢？我想到了一些想法:</p><ul class=""><li id="e61c" class="kv kw ht ka b kb kc ke kf kh kx kl ky kp kz kt nc lb lc ld dt translated">没有一种安全工具能够彻底到取代审计！如果你还记得一件事，那就是这个。</li><li id="cdfa" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">没有一个单一的安全工具能囊括一切:只有Slither提到了严格的不平等，只有MythX提到了时间戳依赖性，只有Securify提到了输入净化和未初始化的状态变量。</li><li id="238f" class="kv kw ht ka b kb le ke lf kh lg kl lh kp li kt nc lb lc ld dt translated">即使工具捕捉到相同的漏洞类别，它们也会捕捉到不同的实例和频率。</li></ul><p id="6599" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">还值得注意的是，Securify的输出特别奇怪，包含一些误报。除了上面提到的令人困惑的颜色编码之外，一些输出不太有意义，并且没有提供URL来查找更多信息。例如，<code class="eh mu mv mw mx b">Uninitialized State Variable</code>消息没有检测到那些变量在构造函数中被初始化。同样，不清楚对<code class="eh mu mv mw mx b">Unrestricted write to storage</code>的担忧是什么，以及它在寻找什么检查作为补救措施。</p><p id="1fb1" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">像这样的安全扫描工具在合同开发过程中肯定有它们的位置，并且应该总是被使用。使用多种工具而不是只依赖一种工具似乎是捕捉潜在bug的最佳方法，但是没有一种工具或工具组合可以取代全面的审计。</p><p id="cb71" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">如果您必须在没有审计的情况下部署到mainnet，请在您的网站和代码中添加警告，并考虑限制您的合同持有的最大资金金额。</p><p id="ecec" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated">祝你好运！</p><p id="20a7" class="pw-post-body-paragraph jy jz ht ka b kb kc iu kd ke kf ix kg kh ki kj kk kl km kn ko kp kq kr ks kt hm dt translated"><em class="my">免责声明:本文是MythX团队资助的git coin</em><a class="ae ku" href="https://gitcoin.co/issue/EtherDotBlue/MythX/4/4147" rel="noopener ugc nofollow" target="_blank"><em class="my">bounty</em></a><em class="my">的一部分，目的是为了对上述工具进行客观的比较。</em></p><blockquote class="nm"><p id="b744" class="nn no ht bd np nq nr ns nt nu nv kt ek translated"><a class="ae ku" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="nx ny nz oa ob jn fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nw"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><figure class="jj jk jl jm fq jn fe ff paragraph-image"><a href="https://coincodecap.com"><div class="fe ff oc"><img src="../Images/e9dbce386c4f90837b5db529a4c87766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fZu_SfnNF6m_BGbXlsl-A@2x.png"/></div></a></figure></div></div>    
</body>
</html>