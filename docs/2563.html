<html>
<head>
<title>Adding /Updating Channel Capabilities in Hyperledger Fabric</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Hyperledger结构中添加/更新渠道功能</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/adding-updating-channel-capabilities-in-hyperledger-fabric-6cb2a1aaea21?source=collection_archive---------0-----------------------#2019-12-06">https://medium.com/coinmonks/adding-updating-channel-capabilities-in-hyperledger-fabric-6cb2a1aaea21?source=collection_archive---------0-----------------------#2019-12-06</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="9361" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在启用功能之前，用最新版本更新所有二进制文件。一旦启用了某项功能，既不建议也不支持禁用它。</p><p id="afcb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将按照以下顺序启用功能。<br/>订购者系统渠道</p><ul class=""><li id="9d40" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">订购者团体</li><li id="3aaa" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">信道组</li></ul><p id="d4b3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现有渠道渠道</p><ul class=""><li id="4077" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw dt translated">订购者团体</li><li id="69ea" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">信道组</li><li id="e52a" class="jo jp ht is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw dt translated">应用程序组</li></ul></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><blockquote class="kj"><p id="3af0" class="kk kl ht bd km kn ko kp kq kr ks jn ek translated"><a class="ae kt" href="https://coincodecap.com" rel="noopener ugc nofollow" target="_blank">发现并回顾最佳区块链软件</a></p></blockquote><p id="4780" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hm dt translated">我们需要遵循三个步骤来更新通道配置<br/> 1)获取最新的配置块<br/> 2)修改必要的更改<br/> 3)将签名的交易发送给订购者</p><p id="319a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">订购者系统渠道能力<br/> </strong>请确保所有容器都已启动并运行。<br/>登录cli容器。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="373d" class="li lj ht le b fv lk ll l lm ln">docker exec -it cli bash</span></pre><p id="2fcb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">只有订购组织管理员可以更新订购系统渠道。为系统渠道设置环境变量</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="e1ad" class="li lj ht le b fv lk ll l lm ln">CORE_PEER_LOCALMSPID="OrdererMSP"<br/><br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem<br/><br/>CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/users/Admin@example.com/msp<br/><br/>ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span></pre><p id="bd27" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果我们从v1.3升级到v1.4.3，我们需要将系统通道名设置为<code class="eh lo lp lq le b">testchainid</code>:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="c12e" class="li lj ht le b fv lk ll l lm ln">CH_NAME=testchainid</span></pre><p id="c8de" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果我们从v1.4.1升级到v1.4.3，我们需要将系统通道名设置为<code class="eh lo lp lq le b">byfn-sys-channel</code>:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="573f" class="li lj ht le b fv lk ll l lm ln">CH_NAME=byfn-sys-channel</span></pre><h2 id="9895" class="li lj ht bd lr ls lt lu lv lw lx ly lz jb ma mb mc jf md me mf jj mg mh mi mj dt translated">订购者团体</h2><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="945a" class="li lj ht le b fv lk ll l lm ln">peer channel fetch config config_block.pb -o orderer.example.com:7050 -c $CH_NAME --tls --cafile $ORDERER_CA<br/><br/>configtxlator proto_decode --input config_block.pb --type common.Block --output config_block.json<br/><br/>jq .data.data[0].payload.data.config config_block.json &gt; config.json</span><span id="3b67" class="li lj ht le b fv mk ll l lm ln">jq -s '.[0] * {"channel_group":{"groups":{"Orderer": {"values": {"Capabilities": .[1].orderer}}}}}' config.json ./scripts/capabilities.json &gt; modified_config.json</span><span id="a446" class="li lj ht le b fv mk ll l lm ln">configtxlator proto_encode --input config.json --type common.Config --output config.pb<br/><br/>configtxlator proto_encode --input modified_config.json --type common.Config --output modified_config.pb<br/><br/>configtxlator compute_update --channel_id $CH_NAME --original config.pb --updated modified_config.pb --output config_update.pb</span></pre></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><pre class="ld le lf lg aw lh dt"><span id="7982" class="li lj ht le b fv ml mm mn mo mp ll l lm ln">configtxlator proto_decode --input config_update.pb --type common.ConfigUpdate --output config_update.json<br/><br/>echo '{"payload":{"header":{"channel_header":{"channel_id":"'$CH_NAME'", "type":2}},"data":{"config_update":'$(cat config_update.json)'}}}' | jq . &gt; config_update_in_envelope.json<br/><br/>configtxlator proto_encode --input config_update_in_envelope.json --type common.Envelope --output config_update_in_envelope.pb</span></pre></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><p id="a5e6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">提交配置更新事务:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="b02e" class="li lj ht le b fv lk ll l lm ln">peer channel update -f config_update_in_envelope.pb -c $CH_NAME -o orderer.example.com:7050 --tls true --cafile $ORDERER_CA</span></pre><h2 id="777a" class="li lj ht bd lr ls lt lu lv lw lx ly lz jb ma mb mc jf md me mf jj mg mh mi mj dt translated">信道组</h2><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="3546" class="li lj ht le b fv lk ll l lm ln">peer channel fetch config config_block.pb -o orderer.example.com:7050 -c $CH_NAME --tls --cafile $ORDERER_CA<br/><br/>configtxlator proto_decode --input config_block.pb --type common.Block --output config_block.json<br/><br/>jq .data.data[0].payload.data.config config_block.json &gt; config.json</span><span id="9b6a" class="li lj ht le b fv mk ll l lm ln">jq -s '.[0] * {"channel_group":{"values": {"Capabilities": .[1].channel}}}' config.json ./scripts/capabilities.json &gt; modified_config.json</span></pre></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><pre class="ld le lf lg aw lh dt"><span id="8c26" class="li lj ht le b fv ml mm mn mo mp ll l lm ln">configtxlator proto_encode --input config.json --type common.Config --output config.pb<br/><br/>configtxlator proto_encode --input modified_config.json --type common.Config --output modified_config.pb<br/><br/>configtxlator compute_update --channel_id $CH_NAME --original config.pb --updated modified_config.pb --output config_update.pb<br/></span></pre></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><pre class="ld le lf lg aw lh dt"><span id="886d" class="li lj ht le b fv ml mm mn mo mp ll l lm ln">configtxlator proto_decode --input config_update.pb --type common.ConfigUpdate --output config_update.json<br/><br/>echo '{"payload":{"header":{"channel_header":{"channel_id":"'$CH_NAME'", "type":2}},"data":{"config_update":'$(cat config_update.json)'}}}' | jq . &gt; config_update_in_envelope.json<br/><br/>configtxlator proto_encode --input config_update_in_envelope.json --type common.Envelope --output config_update_in_envelope.pb</span></pre><p id="fc14" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">提交配置更新事务:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="4406" class="li lj ht le b fv lk ll l lm ln">peer channel update -f config_update_in_envelope.pb -c $CH_NAME -o orderer.example.com:7050 --tls true --cafile $ORDERER_CA</span></pre><p id="049b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">现有频道—我的频道</strong></p><blockquote class="mq mr ms"><p id="e473" class="iq ir mt is b it iu iv iw ix iy iz ja mu jc jd je mv jg jh ji mw jk jl jm jn hm dt translated">导出CH_NAME=mychannel</p></blockquote><h1 id="e186" class="mx lj ht bd lr my mz na lv nb nc nd lz ne nf ng mc nh ni nj mf nk nl nm mi nn dt translated">订购者团体</h1><p id="26bd" class="pw-post-body-paragraph iq ir ht is b it no iv iw ix np iz ja jb nq jd je jf nr jh ji jj ns jl jm jn hm dt translated">与订购系统通道一样，我们的应用程序通道也有订购者组。</p><p id="4556" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">获取频道配置:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="bcdf" class="li lj ht le b fv lk ll l lm ln">peer channel fetch config config_block.pb -o orderer.example.com:7050 -c $CH_NAME  --tls --cafile $ORDERER_CA</span><span id="2f18" class="li lj ht le b fv mk ll l lm ln">configtxlator proto_decode --input config_block.pb --type common.Block --output config_block.json</span><span id="e20f" class="li lj ht le b fv mk ll l lm ln">jq .data.data[0].payload.data.config config_block.json &gt; config.json</span><span id="43ed" class="li lj ht le b fv mk ll l lm ln">jq -s '.[0] * {"channel_group":{"groups":{"Orderer": {"values": {"Capabilities": .[1].orderer}}}}}' config.json ./scripts/capabilities.json &gt; modified_config.json</span></pre></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><pre class="ld le lf lg aw lh dt"><span id="369f" class="li lj ht le b fv ml mm mn mo mp ll l lm ln">configtxlator proto_encode --input config.json --type common.Config --output config.pb<br/><br/>configtxlator proto_encode --input modified_config.json --type common.Config --output modified_config.pb<br/><br/>configtxlator compute_update --channel_id $CH_NAME --original config.pb --updated modified_config.pb --output config_update.pb</span><span id="038c" class="li lj ht le b fv mk ll l lm ln">configtxlator proto_decode --input config_update.pb --type common.ConfigUpdate --output config_update.json<br/><br/>echo '{"payload":{"header":{"channel_header":{"channel_id":"'$CH_NAME'", "type":2}},"data":{"config_update":'$(cat config_update.json)'}}}' | jq . &gt; config_update_in_envelope.json<br/><br/>configtxlator proto_encode --input config_update_in_envelope.json --type common.Envelope --output config_update_in_envelope.pb</span></pre><p id="f650" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">提交配置更新事务:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="8e31" class="li lj ht le b fv lk ll l lm ln">peer channel update -f config_update_in_envelope.pb -c $CH_NAME -o orderer.example.com:7050 --tls true --cafile $ORDERER_CA</span></pre><h1 id="98ff" class="mx lj ht bd lr my mz na lv nb nc nd lz ne nf ng mc nh ni nj mf nk nl nm mi nn dt translated">信道组</h1><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="f8b9" class="li lj ht le b fv lk ll l lm ln">peer channel fetch config config_block.pb -o orderer.example.com:7050 -c $CH_NAME --tls --cafile $ORDERER_CA<br/><br/>configtxlator proto_decode --input config_block.pb --type common.Block --output config_block.json<br/><br/>jq .data.data[0].payload.data.config config_block.json &gt; config.json</span><span id="1de2" class="li lj ht le b fv mk ll l lm ln">jq -s '.[0] * {"channel_group":{"values": {"Capabilities": .[1].channel}}}' config.json ./scripts/capabilities.json &gt; modified_config.json</span></pre></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><pre class="ld le lf lg aw lh dt"><span id="cf03" class="li lj ht le b fv ml mm mn mo mp ll l lm ln">configtxlator proto_encode --input config.json --type common.Config --output config.pb<br/><br/>configtxlator proto_encode --input modified_config.json --type common.Config --output modified_config.pb<br/><br/>configtxlator compute_update --channel_id $CH_NAME --original config.pb --updated modified_config.pb --output config_update.pb</span><span id="3efa" class="li lj ht le b fv mk ll l lm ln">configtxlator proto_decode --input config_update.pb --type common.ConfigUpdate --output config_update.json<br/><br/>echo '{"payload":{"header":{"channel_header":{"channel_id":"'$CH_NAME'", "type":2}},"data":{"config_update":'$(cat config_update.json)'}}}' | jq . &gt; config_update_in_envelope.json<br/><br/>configtxlator proto_encode --input config_update_in_envelope.json --type common.Envelope --output config_update_in_envelope.pb</span></pre><p id="99b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">更新<code class="eh lo lp lq le b">channel</code>组的配置，相关组织——org 1、Org2和order org——需要在<strong class="is hu">上签名</strong></p><p id="fc75" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">与ORG1管理员用户一起唱歌</strong></p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="26a8" class="li lj ht le b fv lk ll l lm ln">CORE_PEER_LOCALMSPID="Org1MSP"<br/><br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt<br/><br/>CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp<br/><br/>CORE_PEER_ADDRESS=peer0.org1.example.com:7051<br/><br/>peer channel signconfigtx -f config_update_in_envelope.pb</span></pre><p id="b06d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">与ORG2管理员用户一起唱歌</strong></p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="027f" class="li lj ht le b fv lk ll l lm ln">CORE_PEER_LOCALMSPID="Org2MSP"</span><span id="773f" class="li lj ht le b fv mk ll l lm ln">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</span><span id="9527" class="li lj ht le b fv mk ll l lm ln">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp</span><span id="7974" class="li lj ht le b fv mk ll l lm ln">CORE_PEER_ADDRESS=peer0.org1.example.com:7051</span><span id="9ddb" class="li lj ht le b fv mk ll l lm ln">peer channel signconfigtx -f config_update_in_envelope.pb</span></pre><p id="481a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">与订购者组织管理员用户一起唱歌</strong></p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="d8ab" class="li lj ht le b fv lk ll l lm ln">CORE_PEER_LOCALMSPID="OrdererMSP"</span><span id="13bb" class="li lj ht le b fv mk ll l lm ln">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span><span id="85f5" class="li lj ht le b fv mk ll l lm ln">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/users/Admin@example.com/msp</span></pre></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><p id="afc3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将签名信封发送给订购者</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="6e06" class="li lj ht le b fv lk ll l lm ln">peer channel update -f config_update_in_envelope.pb -c $CH_NAME -o orderer.example.com:7050 --tls true --cafile $ORDERER_CA</span></pre><h1 id="d58f" class="mx lj ht bd lr my mz na lv nb nc nd lz ne nf ng mc nh ni nj mf nk nl nm mi nn dt translated">应用程序组</h1><p id="a36c" class="pw-post-body-paragraph iq ir ht is b it no iv iw ix np iz ja jb nq jd je jf nr jh ji jj ns jl jm jn hm dt translated">对于应用程序组，我们需要与两个组织的管理员用户签署事务。</p><p id="378c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">设置以下环境变量。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="2523" class="li lj ht le b fv lk ll l lm ln">CORE_PEER_LOCALMSPID="Org1MSP"</span><span id="6931" class="li lj ht le b fv mk ll l lm ln">CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt</span><span id="0cae" class="li lj ht le b fv mk ll l lm ln">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp</span><span id="1e82" class="li lj ht le b fv mk ll l lm ln">CORE_PEER_ADDRESS=peer0.org1.example.com:7051</span></pre></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><pre class="ld le lf lg aw lh dt"><span id="0da5" class="li lj ht le b fv ml mm mn mo mp ll l lm ln">peer channel fetch config config_block.pb -o orderer.example.com:7050 -c $CH_NAME --tls --cafile $ORDERER_CA<br/><br/>configtxlator proto_decode --input config_block.pb --type common.Block --output config_block.json<br/><br/>jq .data.data[0].payload.data.config config_block.json &gt; config.json</span><span id="bbb0" class="li lj ht le b fv mk ll l lm ln">jq -s '.[0] * {"channel_group":{"groups":{"Application": {"values": {"Capabilities": .[1].application}}}}}' config.json ./scripts/capabilities.json &gt; modified_config.json</span></pre></div><div class="ab cl kc kd hb ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="hm hn ho hp hq"><pre class="ld le lf lg aw lh dt"><span id="d207" class="li lj ht le b fv ml mm mn mo mp ll l lm ln">configtxlator proto_encode --input config.json --type common.Config --output config.pb<br/><br/>configtxlator proto_encode --input modified_config.json --type common.Config --output modified_config.pb<br/><br/>configtxlator compute_update --channel_id $CH_NAME --original config.pb --updated modified_config.pb --output config_update.pb</span><span id="a74d" class="li lj ht le b fv mk ll l lm ln">configtxlator proto_decode --input config_update.pb --type common.ConfigUpdate --output config_update.json<br/><br/>echo '{"payload":{"header":{"channel_header":{"channel_id":"'$CH_NAME'", "type":2}},"data":{"config_update":'$(cat config_update.json)'}}}' | jq . &gt; config_update_in_envelope.json<br/><br/>configtxlator proto_encode --input config_update_in_envelope.json --type common.Envelope --output config_update_in_envelope.pb</span></pre><p id="152f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Org1签署交易:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="a882" class="li lj ht le b fv lk ll l lm ln">peer channel signconfigtx -f config_update_in_envelope.pb</span></pre><p id="a2e7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在我们需要用ORG2 admin用户签署事务，将env设置为ORG2。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="ecd8" class="li lj ht le b fv lk ll l lm ln">export CORE_PEER_LOCALMSPID="Org2MSP"<br/><br/>export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt<br/><br/>export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp<br/><br/>export CORE_PEER_ADDRESS=peer0.org2.example.com:9051</span></pre><p id="d607" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当我们向ordere发送交易时，它会根据CORE_PEER_MSPCONFIGPATH和CORE_PEER_LOCALMSPID变量中的可用信息自动与管理员用户进行签名。</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="6db7" class="li lj ht le b fv lk ll l lm ln">peer channel update -f config_update_in_envelope.pb -c $CH_NAME -o orderer.example.com:7050 --tls true --cafile $ORDERER_CA</span></pre><p id="c2ba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，在启用功能后验证交易</p><ol class=""><li id="ed5a" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn nt ju jv jw dt translated">引起</li></ol><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="aacd" class="li lj ht le b fv lk ll l lm ln">peer chaincode invoke -o orderer.example.com:7050 --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt --peerAddresses peer0.org2.example.com:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt --tls --cafile $ORDERER_CA -C $CH_NAME -n mycc -c '{"Args":["invoke","a","b","10"]}'</span></pre><p id="ab97" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2)查询</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="8abd" class="li lj ht le b fv lk ll l lm ln">peer chaincode query -C mychannel -n mycc -c '{"Args":["query","a"]}'</span></pre><blockquote class="kj"><p id="74e3" class="kk kl ht bd km kn nu nv nw nx ny jn ek translated"><a class="ae kt" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="oa ob oc od oe of fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff nz"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>