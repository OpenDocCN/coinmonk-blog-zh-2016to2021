<html>
<head>
<title>Chaincode on the Go — Smart contracts on the Hyperledger Fabric blockchain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">移动中的链码Hyperledger结构区块链上的智能合约</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/chaincode-on-the-go-smart-contracts-on-the-hyperledger-fabric-blockchain-82dd61b3c669?source=collection_archive---------1-----------------------#2017-09-29">https://medium.com/coinmonks/chaincode-on-the-go-smart-contracts-on-the-hyperledger-fabric-blockchain-82dd61b3c669?source=collection_archive---------1-----------------------#2017-09-29</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div role="button" tabindex="0" class="hw hx di hy bf hz"><div class="fe ff hr"><img src="../Images/ea060d5feeeca4495c74b35f0d382696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*suOYMJKNaj2-e2Xa6zDEBw.jpeg"/></div></div><figcaption class="ic id fg fe ff ie if bd b be z ek">Image courtesy of pixabay.com</figcaption></figure><div class=""/><p id="e9b2" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">关于区块链的简单英语介绍，请阅读<a class="ae kd" href="https://www.linkedin.com/pulse/blockchain-businessperson-rammohan-raja" rel="noopener ugc nofollow" target="_blank">商务人士区块链</a>。关于Fabric(Hyperledger Fabric的简称)的简要概述，请浏览<a class="ae kd" href="https://www.linkedin.com/pulse/hyperledger-fabric-brings-blockchain-enterprise-rammohan-raja" rel="noopener ugc nofollow" target="_blank"> Hyperledger Fabric为企业带来区块链</a>。</p><blockquote class="ke"><p id="6a48" class="kf kg ii bd kh ki kj kk kl km kn kc ek translated"><a class="ae kd" href="https://coincodecap.com" rel="noopener ugc nofollow" target="_blank">发现并回顾最佳区块链软件</a></p></blockquote><p id="ac80" class="pw-post-body-paragraph jf jg ii jh b ji ko jk jl jm kp jo jp jq kq js jt ju kr jw jx jy ks ka kb kc hm dt translated">我花了十年甚至更长时间才最终将我的链表知识付诸实践。如果不是区块链科技，我到死都不会使用我的链表技能。下次有人在那些悲伤的面试中问你链表的时候，你可以满足于它在你的职业生涯中确实有一些实际用途。</p><blockquote class="kt ku kv"><p id="5657" class="jf jg kw jh b ji jj jk jl jm jn jo jp kx jr js jt ky jv jw jx kz jz ka kb kc hm dt translated"><em class="ii">最后……一个现实生活中的链表用例。</em></p></blockquote><p id="9f9e" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">区块链实际上是一系列数据块。就像链表中的节点一样，区块链中的块使用指针/引用相互链接。您从最近的块(链表的头节点)开始，可以遍历链一直到起源块。像链表中的节点一样，区块链中的块中包含一些数据(例如事务数据)，前一个块的安全散列和当前块中所有数据的安全散列。</p><p id="2609" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">您最好使用现有的实现，而不是从头开始构建自己的区块链。Fabric是IBM支持的开源区块链实现。这是一个允许在现实世界的商业应用中使用的区块链。Fabric提供对数据的受控访问，同时仍提供区块链的所有优势，如共享分类帐、智能合同、隐私和共识。本文将停留在一个相对较高的水平，以尽可能保持学习曲线的正常。为了进一步缩小范围，我将集中讨论与开发人员相关的那些方面。</p><blockquote class="ke"><p id="5511" class="kf kg ii bd kh ki kj kk kl km kn kc ek translated"><a class="ae kd" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="lb lc ld le lf hv fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff la"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><blockquote class="kt ku kv"><p id="5008" class="jf jg kw jh b ji jj jk jl jm jn jo jp kx jr js jt ky jv jw jx kz jz ka kb kc hm dt translated"><em class="ii">链码≈存储过程</em></p></blockquote><p id="4d96" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">开发人员编写与共享账本交互的链码(结构世界中的智能合约)。一个恰当的类比是用于操作数据库中数据的存储过程。Fabric是用Go语言写的。您可能已经猜到了，第一个支持编写智能合同/链码的语言也是Go。支持其他语言的工作正在进行中。但是作为一个积极努力的人，我们将学习Go语言，并撰写我们的第一份智能合同。</p><p id="dccd" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">我们生活在一个计算机语言变得像好莱坞作品一样的世界里。甚至在一种语言成为热门之前，一种新的语言就已经发布了。计算机语言的权力游戏似乎是趋势。掌握这些语言中的任何一种都没有意义。当你这么做的时候，另一个人可能已经废黜了旧的最爱。</p><p id="17bd" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">分类帐上的所有交易(查询或更新)都是通过链码完成的。允许访问链码。这样，我们可以确保医生可以运行链码来查看病历，但其他人不能。药剂师只能运行链码来查看处方，而医生可以运行链码来开处方。</p><pre class="lg lh li lj fq lk ll lm ln aw lo dt"><span id="86c8" class="lp lq ii ll b fv lr ls l lt lu">func (s *SmartContract) Init(APIstub shim.ChaincodeStubInterface) sc.Response {<br/>          return shim.Success(nil)<br/>}<br/> <br/>func (s *SmartContract) Invoke(APIstub shim.ChaincodeStubInterface) sc.Response {<br/> <br/>          function, args := APIstub.GetFunctionAndParameters()<br/> <br/>          if function == "queryCar" {<br/>                   return s.queryCar(APIstub, args)<br/>          } else if function == "initLedger" {<br/>                   return s.initLedger(APIstub)<br/>          } else if function == "createCar" {<br/>                   return s.createCar(APIstub, args)<br/>          } else if function == "queryAllCars" {<br/>                   return s.queryAllCars(APIstub)<br/>          } else if function == "changeCarOwner" {<br/>                   return s.changeCarOwner(APIstub, args)<br/>          }<br/> <br/>          return shim.Error("Invalid Smart Contract function name.")<br/>}</span></pre><p id="51e4" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">这是一个简单链码实现的框架。它有两个函数Init和Invoke。当首次安装链码或升级现有链码时，会调用Init。例如，在首次安装链码时创建资产。当我们需要链码来查询或修改共享的leger时，调用Invoke。这两个函数都引用了shim API (shim。ChaincodeStubInterface)，它实际上用于查询或更新共享分类帐。共享分类帐的状态更改仅在交易被验证并成功提交后生效。这里的<a class="ae kd" href="http://hyperledger-fabric.readthedocs.io/en/latest/chaincode4ade.html#pulling-it-all-together" rel="noopener ugc nofollow" target="_blank">显示了完整的样本以及执行它们的指令。</a></p><p id="6fbe" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">虽然我们只能在Go中编写链代码，但我们可以使用多种语言的多个API来调用它们。例如，这就是使用JavaScript调用链码的方式。</p><pre class="lg lh li lj fq lk ll lm ln aw lo dt"><span id="2802" class="lp lq ii ll b fv lr ls l lt lu">var options = {<br/>    wallet_path: path.join(__dirname, './network/creds'),<br/>    user_id: 'PeerAdmin',<br/>    channel_id: 'mychannel',<br/>    chaincode_id: 'fabcar',<br/>    network_url: 'grpc://localhost:7051',<br/>};<br/> <br/>const request = {<br/>      chaincodeId: options.chaincode_id,<br/>      txId: transaction_id,<br/>      fcn: 'queryAllCars',<br/>      args: ['']<br/>};</span></pre><p id="9fc3" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">完整的来源可在<a class="ae kd" href="https://github.com/hyperledger/fabric-samples/blob/release/fabcar/query.js" rel="noopener ugc nofollow" target="_blank">这里</a>。上例调用了<em class="kw"> fabcar </em>智能合约中的以下函数。</p><pre class="lg lh li lj fq lk ll lm ln aw lo dt"><span id="81bd" class="lp lq ii ll b fv lr ls l lt lu">func (s *SmartContract) queryAllCars(APIstub shim.ChaincodeStubInterface) sc.Response {<br/> <br/>        startKey := "CAR0"<br/>        endKey := "CAR999"<br/>       <br/>        ................<br/>        ................<br/>        ................<br/> <br/>        return shim.Success(buffer.Bytes())<br/>}</span></pre><p id="79ea" class="pw-post-body-paragraph jf jg ii jh b ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc hm dt translated">显而易见，为Fabric编写链代码并不是什么难事。但是建立网络并让它运行起来并不容易。Fabric project在<a class="ae kd" href="http://hyperledger-fabric.readthedocs.io/en/latest/build_network.html" rel="noopener ugc nofollow" target="_blank">记录</a>步骤方面做得非常出色。我不打算在这里重复。所以，留出几天时间，耐心等待吧！</p><figure class="lg lh li lj fq hv fe ff paragraph-image"><a href="http://bit.ly/2G71Sp7"><div class="fe ff lv"><img src="../Images/449450761cd76f44f9ae574333f9e9af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKX2mtg7p1lOs7JmosPLsA.png"/></div></a></figure></div></div>    
</body>
</html>