<html>
<head>
<title>BSOL: Benchmarking Solidity Smart Contract</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BSOL:基准可靠性智能合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/bsol-benchmarking-solidity-smart-contract-acd78f3b259b?source=collection_archive---------3-----------------------#2020-03-07">https://medium.com/coinmonks/bsol-benchmarking-solidity-smart-contract-acd78f3b259b?source=collection_archive---------3-----------------------#2020-03-07</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/ecc7350576dd7de2a1eced30db62c38a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*CKyLV-XhcIbS3If5g2E--Q.png"/></div></figure><p id="2124" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">当你编码时，你会做许多重复的动作，这些动作可以自动化，许多人会创建脚本来删除它们，有时他们甚至会向公众发布这些脚本。几周前，我制作了一个工具，可以自动估算智能合同中的天然气用量，这样我就不必为它编写无聊的Javascript了，我决定发布它。</p><p id="eac5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我把这个工具叫做BSOL(又名。基准坚固性)。BSOL的目标是使估算天然气用量和执行时间变得更容易，并消除在智能合同中编写Javascript来估算天然气用量和执行时间的需要。那么现在，为什么它会有用，如何使用它呢？</p><h1 id="4fa9" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dt translated">为什么要对智能合同进行基准测试？</h1><p id="ac61" class="pw-post-body-paragraph ix iy ht iz b ja kt jc jd je ku jg jh ji kv jk jl jm kw jo jp jq kx js jt ju hm dt translated">首先想到的是跟踪你的智能合同需要多少汽油才能工作，但如果你正在测试EVM，你可能也会对你的<a class="ae ky" href="https://blog.coincodecap.com/tag/smart-contact/" rel="noopener ugc nofollow" target="_blank">智能合同</a>执行需要多长时间感兴趣。</p><p id="c95c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">任何人都可以通过编写一些javascript来估计智能合约需要的气体，而使用BSOL，你可以不用编写任何javascript，只需使用你的Solidity代码就可以做到这一点。</p><p id="259a" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">此外，您还可以检查您的<a class="ae ky" href="https://blog.coincodecap.com/tag/smart-contact/" rel="noopener ugc nofollow" target="_blank">智能合同</a>平均执行时间。这在研究气体使用和执行时间之间的关系时很有用。例如，它可以用来发现<a class="ae ky" href="https://blog.coincodecap.com/tag/ethereum/" rel="noopener ugc nofollow" target="_blank">以太坊</a> EVM中的漏洞和可能的DDOS攻击。</p><h1 id="eaaa" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dt translated">你如何衡量你的智能合同</h1><p id="53d6" class="pw-post-body-paragraph ix iy ht iz b ja kt jc jd je ku jg jh ji kv jk jl jm kw jo jp jq kx js jt ju hm dt translated">首先，你需要实际安装BSOL:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="5d1a" class="li jw ht le b fv lj lk l ll lm">git clone https://github.com/Giulio2002/bsol<br/>cd bsol<br/>sudo sh install.sh</span></pre><p id="a879" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">一旦安装了BSOL，我们就可以开始工作了:现在让我们假设以下令牌</p><figure class="kz la lb lc fq iu"><div class="bz el l di"><div class="ln lo l"/></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">token.sol</figcaption></figure><p id="7747" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在让我们编写以下基准契约:</p><figure class="kz la lb lc fq iu"><div class="bz el l di"><div class="ln lo l"/></div><figcaption class="lp lq fg fe ff lr ls bd b be z ek">token_benchmark.sol</figcaption></figure><p id="ff28" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">BSOL要做的是，获取每一份名称以“基准”开头的合同，并分析它们以“基准”开头的每一项功能。第一个基准契约在接收者尚未初始化时分析令牌传递函数。第二个基准契约通过在构造函数中初始化接收方来分析令牌传递函数。现在让我们运行我们的基准测试:</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="0934" class="li jw ht le b fv lj lk l ll lm">bsol --sol token_benchmark.sol</span><span id="2536" class="li jw ht le b fv lt lk l ll lm">Contract: BenchmarkToken<br/>Method: BenchmarkToken.BenchmarkTransfer() # Initialized<br/>Gas Usage: 33367 Gas<br/>Gas Usage per execution: 12367 Gas</span><span id="3895" class="li jw ht le b fv lt lk l ll lm">Contract: BenchmarkTokenCreate<br/>Method: BenchmarkTokenCreate.BenchmarkTransfer() # Not Initialized<br/>Gas Usage: 48367 Gas<br/>Gas Usage per execution: 27367 Gas</span></pre><p id="6c87" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果我们添加标志<code class="eh lu lv lw le b">--execution-time</code>,那么我们也得到了代码的平均计算时间(500次运行):</p><pre class="kz la lb lc fq ld le lf lg aw lh dt"><span id="9743" class="li jw ht le b fv lj lk l ll lm">bsol --sol token_benchmark.sol --execution-time</span><span id="ed13" class="li jw ht le b fv lt lk l ll lm">Contract: BenchmarkToken<br/>Method: BenchmarkToken.BenchmarkTransfer()<br/>Average Computation time: 353.599576µs<br/>Gas Usage: 33367 Gas<br/>Gas Usage per execution: 12367 Gas</span><span id="badf" class="li jw ht le b fv lt lk l ll lm">Contract: BenchmarkTokenCreate<br/>Method: BenchmarkTokenCreate.BenchmarkTransfer()<br/>Average Computation time: 327.343436µs<br/>Gas Usage: 48367 Gas<br/>Gas Usage per execution: 27367 Gas</span></pre><h1 id="af76" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dt translated">额外的东西</h1><ul class=""><li id="c5e3" class="lx ly ht iz b ja kt je ku ji lz jm ma jq mb ju mc md me mf dt translated"><code class="eh lu lv lw le b">--runs specifies out of how many runs we get our average</code></li><li id="13d0" class="lx ly ht iz b ja mg je mh ji mi jm mj jq mk ju mc md me mf dt translated"><code class="eh lu lv lw le b">--sol specify single solidity source</code></li><li id="7d6d" class="lx ly ht iz b ja mg je mh ji mi jm mj jq mk ju mc md me mf dt translated"><code class="eh lu lv lw le b">--sol-dir specify an entire directory + subdirectories of solidity sources</code></li></ul><blockquote class="ml"><p id="d182" class="mm mn ht bd mo mp mq mr ms mt mu ju ek translated"><a class="ae ky" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获取最佳软件交易</a></p></blockquote><figure class="mw mx my mz na iu fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff mv"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure><figure class="kz la lb lc fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="fe ff nb"><img src="../Images/e9dbce386c4f90837b5db529a4c87766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fZu_SfnNF6m_BGbXlsl-A@2x.png"/></div></div></figure></div></div>    
</body>
</html>