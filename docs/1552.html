<html>
<head>
<title>Leveraging Stellar for settling transactions on Hyperledger fabric network — part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用Stellar在Hyperledger fabric网络上结算交易—第2部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/leveraging-stellar-for-settling-transactions-on-hyperledger-fabric-network-part-2-d474a414385c?source=collection_archive---------2-----------------------#2018-09-25">https://medium.com/coinmonks/leveraging-stellar-for-settling-transactions-on-hyperledger-fabric-network-part-2-d474a414385c?source=collection_archive---------2-----------------------#2018-09-25</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="ce63" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="jo">本部分包含Hyperledger Fabric smart contract中所做更改的技术细节，以及用于结算交易和完成Fabric网络中转账的Stellar APIs。建议你看一下这个系列的</em> <a class="ae jp" rel="noopener" href="/@sachinjha/leveraging-stellar-for-settling-transactions-on-hyperledger-fabric-network-8c22c141af70"> <em class="jo">第一部</em> </a> <em class="jo">以便获得完整的背景。</em></p><ol class=""><li id="d4c4" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy dt translated"><strong class="is hu">对marbles.go的更改</strong>(资产定义) :</li></ol><figure class="ka kb kc kd fq ke fe ff paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="fe ff jz"><img src="../Images/808aeb781c29aa921c60bd55950bc768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d8lNGI5WE8uKbLX-oVn6WQ.png"/></div></div><figcaption class="kl km fg fe ff kn ko bd b be z ek">Fig 1. (marbles.go )</figcaption></figure><p id="c923" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2.<strong class="is hu">在write_ledger.go中添加了方法</strong>来构建工作流，在该工作流中，卖家可以将弹珠标记为待售，买家可以创建带有报价的报价。鉴于上述结构，golang smart contract发生了直接变化。这些方法是:</p><p id="8735" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">a)标记待售b)发出要约c)接受要约。</p><p id="2c87" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">代码更改可以在<a class="ae jp" href="https://github.com/sachinjha/marbles/blob/master/chaincode/src/write_ledger.go" rel="noopener ugc nofollow" target="_blank">这个文件</a>中找到。</p><p id="6073" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">3.<strong class="is hu">支付客户端代码:</strong></p><figure class="ka kb kc kd fq ke"><div class="bz el l di"><div class="kp kq l"/></div></figure><p id="5b43" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">几乎不需要对样本进行修改，在Stellar API reference<a class="ae jp" href="https://www.stellar.org/developers/guides/get-started/transactions.html" rel="noopener ugc nofollow" target="_blank">中给出了发送付款</a>的示例。备忘录字段包括offerId。</p><p id="9c72" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">已经使用了本地货币，但是人们可以很容易地将货币转换成某种锚定资产。</p><p id="2f20" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> 4。出售stellar sdk </strong>及其在marbles chaincode中的依赖项</p><p id="7cbe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Stellar使用'<a class="ae jp" href="https://github.com/golang/dep" rel="noopener ugc nofollow" target="_blank"><em class="jo">dep</em></a><em class="jo">'</em>进行依赖性管理，而fabric依靠'<a class="ae jp" href="https://github.com/kardianos/govendor" rel="noopener ugc nofollow" target="_blank"><em class="jo">vendoring</em></a><em class="jo">'</em>技术来管理外部依赖性。此<a class="ae jp" href="https://github.com/sachinjha/marbles/tree/master/chaincode/src/marbles/vendor" rel="noopener ugc nofollow" target="_blank">自述文件中记录了管理所有依赖项和完成此任务的步骤。</a></p><p id="269f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">5.<strong class="is hu">write _ ledger . go和lib.go <strong class="is hu">中的智能合约更改</strong>，以验证已为给定的offer_id支付</strong></p><figure class="ka kb kc kd fq ke"><div class="bz el l di"><div class="kp kq l"/></div></figure><p id="10a6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">解释用于验证支付的Stellar API</strong></p><p id="5620" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">a)</strong><strong class="is hu">get transaction:</strong>/transactions/&lt;id&gt;:</p><p id="2cf9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">返回给定事务的详细信息。可以从这里读取memo字段，以交叉检查付款所依据的offerId。</p><p id="9016" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> b)getPayments </strong> <strong class="is hu">用于给定交易</strong>:/transactions/&lt;id&gt;/支付</p><p id="8a45" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">返回给定交易中的付款操作。由于支付交易只有一个操作，我们可以从第一个操作中获取支付细节，该操作的类型为payment。</p></div><div class="ab cl kr ks hb kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hm hn ho hp hq"><p id="ef57" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了测试这一点端到端的一些更多的变化将需要在大理石客户端仍然悬而未决。</p><blockquote class="ky"><p id="7f19" class="kz la ht bd lb lc ld le lf lg lh jn ek translated"><a class="ae jp" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">在您的收件箱中直接获得最佳软件交易</a></p></blockquote><figure class="lj lk ll lm ln ke fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff li"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>