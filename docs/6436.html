<html>
<head>
<title>How to revoke any token approval using web3.js on KCC</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在KCC上使用web3.js撤销任何令牌批准</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-revoke-any-token-approval-using-web3-js-on-kcc-187050067840?source=collection_archive---------2-----------------------#2021-12-12">https://medium.com/coinmonks/how-to-revoke-any-token-approval-using-web3-js-on-kcc-187050067840?source=collection_archive---------2-----------------------#2021-12-12</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div class="fe ff iq"><img src="../Images/ff3a46288c2ed043d05403431371bf9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*rQJhUsaJaJh2cduX-E3xAw.png"/></div></figure><p id="f33e" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在ERC-20标准中，批准功能允许用户允许诸如智能合同或普通地址之类的其他方花费规定的数量。但是，由于交易需要重复批准，大多数DEX指定的金额大于第一次批准功能所需的金额，因此用户不必在以后批准相同的令牌。这导致了一些安全风险，尤其是对于不值得信任的站点/项目。为了应对这一点，建议删除你在看起来可疑的网站中给予的任何象征性的批准。在本教程中，我们将使用web3.js撤销令牌批准，还有其他方法可以做到这一点，如使用KCC浏览器，但如果合同未经验证，这是不可能的。</p><p id="0c8c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">通常在两种情况下，您会允许使用某个地址:</p><ul class=""><li id="f84c" class="jv jw ht iz b ja jb je jf ji jx jm jy jq jz ju ka kb kc kd dt translated">在DEX上交易</li><li id="f1b5" class="jv jw ht iz b ja ke je kf ji kg jm kh jq ki ju ka kb kc kd dt translated">转移到另一个地址</li></ul><p id="8e7a" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">要找出一个DEX的路由器地址，你可以做一个小交易，在explorer上查看。</p><p id="a238" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">先决条件:</strong></p><ul class=""><li id="2ee3" class="jv jw ht iz b ja jb je jf ji jx jm jy jq jz ju ka kb kc kd dt translated">已安装安全帽</li></ul><p id="9c54" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">现在让我们开始撤销津贴吧！</p><p id="691c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> # 1:创建一个安全帽样本项目:</strong></p><p id="0cfb" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">您可以使用以下命令创建一个示例项目</p><pre class="kj kk kl km fq kn ko kp kq aw kr dt"><span id="b98b" class="ks kt ht ko b fv ku kv l kw kx">npx hardhat </span></pre><p id="24bd" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> # 2:将KCC网络设置放入hardhat.config.js: </strong></p><figure class="kj kk kl km fq iu fe ff paragraph-image"><div class="fe ff ky"><img src="../Images/0b2b769460416df8abb02f03df765eba.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*7HlSk-yvzCwK7qcWoBlkCw.png"/></div><figcaption class="kz la fg fe ff lb lc bd b be z ek">In this case we put the rpc of KCC testnet</figcaption></figure><p id="9a09" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在帐户数组中，您应该输入钱包的私钥，并在前面加上0x。</p><p id="6d29" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> # 3:将ERC-20令牌复制到合约中，然后编译:</strong></p><p id="0fd5" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在这种情况下，我从Kuswap github复制了KUS令牌。你可以从<a class="ae ld" href="https://github.com/KuSwap/KuSwap-Core" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="8dde" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">然后使用以下命令编译合同:</p><pre class="kj kk kl km fq kn ko kp kq aw kr dt"><span id="d3b2" class="ks kt ht ko b fv ku kv l kw kx">npx hardhat compile</span></pre><p id="3563" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> # 4:将撤销权限代码复制到sample-script.js: </strong></p><p id="6f18" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">复制以下示例代码并替换sample-script.js主函数中的示例代码</p><pre class="kj kk kl km fq kn ko kp kq aw kr dt"><span id="0a40" class="ks kt ht ko b fv ku kv l kw kx">const singAddress = await hre.ethers.getSigner()</span><span id="100b" class="ks kt ht ko b fv le kv l kw kx">var RouterAddress = ‘0xc5f442007e08e3b13C9f95fA22F2a2B9369d7C8C’</span><span id="9b83" class="ks kt ht ko b fv le kv l kw kx">var TokenAdd = ‘0x67f6a7BbE0da067A747C6b2bEdF8aBBF7D6f60dc’</span><span id="5688" class="ks kt ht ko b fv le kv l kw kx">var TokenCon = await hre.ethers.getContractFactory(“contracts/KUSToken.sol:KUSToken”);</span><span id="37f8" class="ks kt ht ko b fv le kv l kw kx">var Tokencontract = await TokenCon.attach(</span><span id="1b4b" class="ks kt ht ko b fv le kv l kw kx">TokenAdd// The deployed contract address</span><span id="b1ed" class="ks kt ht ko b fv le kv l kw kx">);</span><span id="c20d" class="ks kt ht ko b fv le kv l kw kx">await Tokencontract.approve(RouterAddress, 0)</span><span id="3665" class="ks kt ht ko b fv le kv l kw kx">console.log(await Tokencontract.allowance(singAddress.address,RouterAddress));</span></pre><p id="075e" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> RouterAddress </strong>是您给予令牌津贴的地址。</p><p id="be99" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> TokenAdd </strong>是你批准消费的令牌地址。</p><p id="cea1" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">上面的脚本基本上是通过调用approve函数来工作的，但这一次使用的值是0，这将覆盖以前批准的值，从而使它实际上取消了对路由器地址的允许。</p><p id="b809" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu"> # 5:执行撤销脚本:</strong></p><pre class="kj kk kl km fq kn ko kp kq aw kr dt"><span id="c261" class="ks kt ht ko b fv ku kv l kw kx">npx hardhat run .\scripts\remove_approval.js --network kcc</span></pre><p id="7f3d" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz hu">事后思考:</strong></p><p id="3427" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在本文中，您已经学习了如何使用web3.js和hardhat撤销地址的消费津贴，虽然脚本很简单，但它肯定会让您安心，因为您知道您的令牌更安全。:)</p><p id="709c" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">不要忘记检查KCC更多可怕的加密项目。</p><p id="fe2e" class="pw-post-body-paragraph ix iy ht iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">社交网络<br/>不和:<a class="ae ld" href="https://discord.gg/NhpWu5tqzc" rel="noopener ugc nofollow" target="_blank">https://discord.gg/H5ucJydSyd</a>T3】推特:<a class="ae ld" href="https://twitter.com/KCCOfficialTW" rel="noopener ugc nofollow" target="_blank">https://twitter.com/KCCOfficialTW</a>T6】电报:<a class="ae ld" href="https://t.me/KCCOfficialEnglishCommunity" rel="noopener ugc nofollow" target="_blank">https://t.me/KCCOfficialEnglishCommunity</a>T9】电报频道:<a class="ae ld" href="https://t.me/KCCOfficialChannel" rel="noopener ugc nofollow" target="_blank">https://t.me/KCCOfficialChannel</a></p><blockquote class="lf"><p id="b065" class="lg lh ht bd li lj lk ll lm ln lo ju ek translated">加入Coinmonks <a class="ae ld" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae ld" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="09af" class="lp kt ht bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml dt translated">另外，阅读</h1><ul class=""><li id="fb8a" class="jv jw ht iz b ja mm je mn ji mo jm mp jq mq ju ka kb kc kd dt translated"><a class="ae ld" href="https://coincodecap.com/crypto-exchanges-in-germany" rel="noopener ugc nofollow" target="_blank">德国最佳加密交易所</a> | <a class="ae ld" href="https://coincodecap.com/arbitrum" rel="noopener ugc nofollow" target="_blank"> Arbitrum:第二层解决方案</a></li><li id="a552" class="jv jw ht iz b ja ke je kf ji kg jm kh jq ki ju ka kb kc kd dt translated"><a class="ae ld" rel="noopener" href="/coinmonks/binance-trading-bots-d0d57bb62c4c">币安交易机器人</a> | <a class="ae ld" rel="noopener" href="/coinmonks/okex-review-6b369304110f"> OKEx评论</a> | <a class="ae ld" href="https://coincodecap.com/atani-review" rel="noopener ugc nofollow" target="_blank">阿塔尼评论</a></li><li id="5067" class="jv jw ht iz b ja ke je kf ji kg jm kh jq ki ju ka kb kc kd dt translated"><a class="ae ld" rel="noopener" href="/coinmonks/best-crypto-signals-telegram-5785cdbc4b2b">最佳加密交易信号电报</a> | <a class="ae ld" rel="noopener" href="/coinmonks/moonxbt-review-6e4ab26d037"> MoonXBT评论</a></li><li id="0f69" class="jv jw ht iz b ja ke je kf ji kg jm kh jq ki ju ka kb kc kd dt translated">如何在Bitbns上购买柴犬(SHIB)币？ | <a class="ae ld" href="https://coincodecap.com/buy-floki-inu-token" rel="noopener ugc nofollow" target="_blank">买弗洛基</a></li><li id="e5cf" class="jv jw ht iz b ja ke je kf ji kg jm kh jq ki ju ka kb kc kd dt translated"><a class="ae ld" href="https://coincodecap.com/coinflex-review" rel="noopener ugc nofollow" target="_blank"> CoinFLEX评论</a> | <a class="ae ld" href="https://coincodecap.com/aex-exchange-review" rel="noopener ugc nofollow" target="_blank"> AEX交易所评论</a> | <a class="ae ld" href="https://coincodecap.com/upbit-review" rel="noopener ugc nofollow" target="_blank"> UPbit评论</a></li><li id="f20a" class="jv jw ht iz b ja ke je kf ji kg jm kh jq ki ju ka kb kc kd dt translated"><a class="ae ld" href="https://coincodecap.com/best-cryptocurrency-blogs" rel="noopener ugc nofollow" target="_blank">十大最佳加密货币博客</a> | <a class="ae ld" href="https://coincodecap.com/youhodler-review" rel="noopener ugc nofollow" target="_blank"> YouHodler评论</a></li></ul></div></div>    
</body>
</html>