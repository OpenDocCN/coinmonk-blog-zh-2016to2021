<html>
<head>
<title>A Deeper Dive into Cordite’s Metering Notaries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入了解Cordite的计量公证人</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/a-deeper-dive-into-cordites-metering-notaries-316adfe093af?source=collection_archive---------3-----------------------#2018-10-04">https://medium.com/coinmonks/a-deeper-dive-into-cordites-metering-notaries-316adfe093af?source=collection_archive---------3-----------------------#2018-10-04</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><figure class="hs ht fm fo hu hv fe ff paragraph-image"><div class="fe ff hr"><img src="../Images/7e2ff5df4cb8b0f91ccb4ddc4d14b0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*19nzJB0W1ej2ok4_Pvk2TQ.png"/></div></figure><div class=""/><p id="e596" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在Richard Crook的中型文章中，他带我们踏上了一段区块链激励之旅，从工作证明、股权证明，到计量<a class="ae jv" href="https://cordite.foundation/" rel="noopener ugc nofollow" target="_blank">cordit</a>。</p><p id="96a7" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在本文中，我将介绍Cordite中当前的计量实现、我们做出的设计选择以及最终的工作原理。</p><p id="d0c1" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我应该强调，目前，计量的当前实施是许多可能性中的一种，我们不局限于单一的计量方法——我们并不固执己见！</p><p id="7dab" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这里提供了一个简短的版本，供那些赶时间的人使用</p><p id="d046" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">“用9个要点衡量为什么、什么、如何”</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff jx"><img src="../Images/e68cd6196faa4d9c5264e21930e6d1b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*yji2Hs9SFst98t8OfBef_w.png"/></div></figure><p id="381b" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">为什么？</p><p id="e954" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">1.计量的目的是激励组织经营公证，并确保交易成本在高用量和低用量用户之间公平分配，而不是回到环境昂贵的算法。</p><p id="a85c" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">什么？</p><p id="10a4" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">2.计量是一种成本回收模型，其中公证人对业务节点处理的所有交易进行计数，然后向其发送这些交易的发票。这非常类似于你的电费账单。</p><p id="b15e" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">怎么会？</p><p id="b3ab" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">3.计量目前作为Corda服务在单节点验证或非验证公证上运行。</p><p id="5198" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">4.交易成本、令牌类型和费用分配保存在一个名为“meteringModelData”的DAO状态中。</p><p id="953b" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">5.使用标准的Corda Collect Sigs/Finality流将计量发票设置到发起交易的业务节点。</p><p id="31c8" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">6.业务节点可以支付或争议发票。</p><p id="8d10" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">7.计量支付被发送到DAO节点，然后该节点根据DAO规则分散费用。</p><p id="7a77" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">8.要将计量集成到现有的Cordapp中，它需要公证“感知”并具有Cordite jars。</p><p id="9cb3" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">9.与现有的PoW和PoS协议不同，计量设计不局限于单个奖励模型。</p><h1 id="fa61" class="kc kd ia bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">还在吗？—更深的潜水</h1><p id="7b3a" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">接下来的两个部分用我自己的话概括了为什么和什么是计量——如果你对这两个部分都感到满意，那么请随意进入设计考虑部分。</p><h2 id="8bff" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated">为什么要测光？</h2><p id="4b66" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">“如果Alice和Bob为不同的交易使用支付相同的价格，这公平吗？”</p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="fe ff lt"><img src="../Images/441579ad0a0876cbfc33326b59dfc4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w65O3Nyh2EBLg_BUO6gzBw.png"/></div></div></figure><p id="e4df" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">想象一下，你认为计量的概念完全是无稽之谈，你开始了自己的公证业务，名为“坚如磐石公证公司”。</p><p id="ac27" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">你买了一个具有16个内核和64 GB内存的值得生产的云服务器，每小时花费70便士，如果全速运行，一个月大约500英镑。</p><p id="ed77" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">你已经有两个客户，并决定每月向他们收取250英镑的公证费；你暗自希望，在你创业的头几个月，服务器没有得到充分利用，你将从中获利。</p><p id="ee54" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">您的第一个客户是Alice，她在Mega corp .工作，他们在第一个月就完成了10，000笔交易。爱丽丝很高兴，因为她的交易费用是每笔2.5便士。</p><p id="2e4d" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">您的第二位客户是鲍勃，他刚刚开始自己的alt币经纪业务。他对新客户使用他的服务非常兴奋，所以他支付了250英镑的公证费。不幸的是，鲍勃有一个糟糕的月份，只做了两笔交易，做了两笔交易，结果他的交易成本是125英镑。</p><p id="6d0c" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">月底，你、鲍勃和爱丽丝出去庆祝你的新生意。</p><p id="1626" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">爱丽丝和鲍勃开始聊天。当鲍勃听说爱丽丝每笔交易付2.5便士时，他的脸沉了下来。鲍勃看起来很悲伤，所以你决定用你的利润给他买瓶啤酒，但是当你查看你的银行账户时，余额为零，因为你的服务器100%被利用了。</p><p id="823c" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果您想要一个更公平的商业模式，您可以决定计量实际上可能是一个好主意。</p><h2 id="bd18" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated">什么是计量？</h2><p id="6662" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated"><em class="jw">“公用事业公司计费是成本回收的良好模式”</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/6f20fed9bd3acd55f86b54a35db0a526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*0XggeiGEnuQUOCPxSlcILw.png"/></div></figure><p id="92ba" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量遵循与公用事业账单相同的模式，因为您使用一些资源，无论是煤气、电力还是移动电话数据，并且在未来的某个时候您会收到使用账单；在未来的某个时候，您将支付账单！</p><p id="635d" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在计量公证人的情况下，交易是资源，“计量”发票被发送给这些交易的创建者。</p><p id="8740" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">采用计量和账单模式的优势之一是，我们有机会创建多种不同的商业模式，以反映当前实用新型的运作方式；这使得公司能够控制和计划他们的现金流。下面是几个例子:</p><ul class=""><li id="7d8d" class="lz ma ia iz b ja jb je jf ji mb jm mc jq md ju me mf mg mh dt translated">按需付费—只需支付使用费用。</li><li id="c846" class="lz ma ia iz b ja mi je mj ji mk jm ml jq mm ju me mf mg mh dt translated">free mium——前1000笔交易是免费的，然后您开始付款。</li><li id="70ee" class="lz ma ia iz b ja mi je mj ji mk jm ml jq mm ju me mf mg mh dt translated">预付折扣——您先支付一笔“更便宜”的交易，然后在用完这笔交易后支付正常费率。</li><li id="16aa" class="lz ma ia iz b ja mi je mj ji mk jm ml jq mm ju me mf mg mh dt translated">延迟还款——您有90天的时间支付计量费用。</li></ul><p id="3ea8" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">上述模型都不是特别有创意，但是如果你把这种灵活性与比特币、以太网和一些新生的“股权证明”模型的单一货币和单一交易成本模型相比较，那么我希望你会同意，有机会创造适合各种形式和规模的成本模型。</p><h1 id="f1f1" class="kc kd ia bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">设计考虑</h1><p id="2bb4" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated"><em class="jw">“在每笔Corda交易中加入成本状态可能不是一个好主意”</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff mn"><img src="../Images/e85dc8991d52ee1b472b46a13ea1677f.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*nl5hn1l9gGQrLIBFbcp0Ng.png"/></div></figure><p id="ae13" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">当我们为Cordite设计成本回收模型时，我们围绕业务和技术含义进行了多次讨论。当时，我们不知道最终会采用计量方式，但我们最终还是通过问一些关键问题来实现这一目标。</p><h2 id="ca10" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated">我们应该在每笔Corda交易中嵌入交易成本吗？</h2><p id="8f80" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">今天的大多数加密货币都是这样工作的；为了让您的比特币交易得到处理，您必须在交易中嵌入您准备支付的金额。</p><p id="316c" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">对于已经构建了Cordapp并想使用这种模型的人来说，他们必须改变所有的流程，以便在每一个事务中嵌入某种“令牌”状态；这将立即给采用制造一个昂贵的障碍。</p><p id="5be5" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们认为，如果你能神奇地将你的Cordapp指向一个计量公证人，成本回收就可以了——我们已经非常接近了。</p><h2 id="e522" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated">我们应该改变核心的Corda代码库吗？</h2><p id="5b12" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">另一个选择是将交易成本模型嵌入到Corda核心代码中，这样无论发生什么，每个人都能得到它。</p><p id="dc02" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们对Cordite的一般原则是，它将建立在Corda之上，只有在绝对必要的情况下，我们才会向Corda核心添加更多的功能。</p><p id="4008" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们可以选择自己的发布周期，这一点与不把Corda变成一个做太多事情的<a class="ae jv" href="https://en.wikipedia.org/wiki/God_object" rel="noopener ugc nofollow" target="_blank">‘上帝’</a>对象一样重要。</p><p id="e3a2" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">按照David Rutter关于Corda是操作系统的比喻，Cordite是“办公套件”,提供一套关键工具来支持您的业务。</p><p id="b9a9" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">`为什么要把自己局限于单一的经济模式？`</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff mo"><img src="../Images/94d38b97a4e31538f87ab58e3e9b0f86.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*OMP13XLhK7iDRlmPrV4-KQ.png"/></div></figure><h2 id="3dbe" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated">我们应该使用什么货币/代币进行成本回收？</h2><p id="da06" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">拥有一个单一的令牌和一个单一的发行，因此经济模式将适用于一些商业网络，但可能不是所有的。</p><p id="e7b6" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们的观点是，我们需要某种代币来支付交易，但我们无法预测未来的企业会如何交换价值；有些人可能只希望交换法定支持的代币，而其他企业可能希望拥有自己的公用代币、奖励代币或企业代币。</p><p id="e635" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们决定让商业网络和公证人所有者决定他们使用哪些代币。</p><p id="a012" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">`支付交易费用来开具发票可能会让你陷入鸡生蛋的悖论`</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="fe ff mp"><img src="../Images/c3d64749760193eec59a69be28595510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A83w7-caVvVcOYI0NuuNOw.jpeg"/></div></div></figure><h2 id="e211" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated">用户没钱支付交易怎么办？</h2><p id="da8a" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">想象一下这样一个矛盾的场景:为了从你的生意中获得一些钱，你需要发送一张发票；但是为了发送发票，你需要支付交易费用？</p><p id="3b51" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">通常情况下，新企业没有太多的现金流动，需要以后支付账单——如今大多数发票都有90天的回收期。</p><p id="0156" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们仔细考虑了如何在Cordite中进行管理，并基于现有的公用服务模型提出了计量概念。公用事业公司计量你交易，然后给你寄账单。</p><p id="a022" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">`授权用户抗议糟糕的服务`</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/5d46b537bce518b94925939b1fd50e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:286/format:webp/1*qb_CHKXRIP-p3t9SWLWGiQ.png"/></div><figcaption class="mr ms fg fe ff mt mu bd b be z ek">The UK Power Industry Regulator</figcaption></figure><h2 id="b3d1" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated"><strong class="ak">如果节点所有者收到的服务很差怎么办？</strong></h2><p id="e1fa" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">一旦我们有了“发票”系统，我们现在需要处理公证人提供的服务很差或节点没有按时支付账单的情况。我们决定实现“争议”功能，这样我们就可以管理糟糕的服务和不准确的收费。</p><h2 id="ea11" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated">我们如何控制计量成本和分配资金？</h2><p id="a7c4" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">至此，我们已经充实了心刀的概念；我们决定用它来管理商业网络的计量规则，如令牌类型、交易成本和对计量“方”的奖励分配。这有效地实现了对定价和费用分配的一定程度的控制；就像DLT的“ofgem”一样。(注:这些是英国的水电监管机构)。</p><p id="cdc7" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">`谁管理警察？`</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff mv"><img src="../Images/226533ca40ec86d0c8c37ded7ac2d88f.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*XK2zLeKK-4bNIx2CFznLcg.png"/></div></figure><h2 id="3dcc" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated"><strong class="ak">计量公证人应该能够公证他们自己的发票交易吗？</strong></h2><p id="9139" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">我们持悲观态度，认为计量公证人可能是恶意的，我们不应该相信他们会公证自己的计量发票。</p><p id="28b8" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">因此，我们需要引入另一个公证人，最初称为“警察”公证人，但后来改为更友好的“监护人”公证人。这与前一周在电影院看《银河护卫队二世》没有任何关系。</p><p id="5514" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在提出这些问题时，我们希望提出一个成本回收模型，该模型可以适应许多不同类型的业务网络的要求。</p><p id="5ece" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">`计量是科迪特吃自己的狗粮`</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="fe ff mw"><img src="../Images/c89f6f0eb45c78314836e9d8932078e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YkdJg_TUXU55OPKdzTszXw.png"/></div></div></figure><h1 id="fa55" class="kc kd ia bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dt translated">计量是如何工作的？</h1><p id="ef85" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">在我详细介绍计量是如何工作的之前，值得一提的是计量利用了Cordite的另外两个组件，DGL和DAO。如果您对这些不熟悉，那么您可以在此阅读它们<a class="ae jv" href="https://cordite.readthedocs.io/en/latest/content/concepts.html" rel="noopener ugc nofollow" target="_blank">:</a></p><p id="5c0e" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量由一组Corda收集签名/终结流和两个运行在计量公证和DAO节点上的Corda服务构建而成。</p><p id="7fd1" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果你不熟悉Corda服务，那么你可以在Cordite贡献者Dan Newton <a class="ae jv" rel="noopener" href="/corda/corda-services-101-245e2126ba58">这里</a>的一篇精彩文章中了解这些服务的内幕。</p><p id="a41d" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">该图显示了计量中的关键角色以及他们如何编排计量流程。</p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="fe ff mx"><img src="../Images/2816315bde25f05644f30c16b9ddf5fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JELy98PNOHYTC3FjrMhGsQ.png"/></div></div></figure><p id="e0cf" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在此图中，有四个独立的“事务”在起作用。这种隔离可以防止计量影响初始业务事务的整体性能，并减少整体操作中的摩擦。</p><p id="3859" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">事务编号为1–4，并执行以下操作:</p><p id="86fe" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">1.在节点A和节点B之间发生商业交易；这由计量公证人进行公证。</p><p id="d823" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">2.计量服务从公证人的保险库中检索交易，并向创建交易的节点A发出计量发票；这是由监护人公证员公证的。</p><p id="4dd6" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">3.节点A使用指定的DGL令牌支付计量发票，并将该支付发送到DAO节点；这个也是监护人公证员公证的。</p><p id="d856" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">4.费用分散服务根据DAO中的计量规则分割计量费用，并向计量公证人、监护人公证人和DAO基金会基金付款。</p><p id="9f9d" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw"> `Corda服务是计量最好的朋友`</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff my"><img src="../Images/da8fefaaf8050312d816d48ae68bb74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*dBjIp4tj_3PumUtw80Tlug.png"/></div></figure><p id="b59d" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量的关键驱动因素是计量服务和费用分散服务。</p><h2 id="f05e" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated"><strong class="ak">计量服务是如何工作的？</strong></h2><p id="07f8" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">对于在公证人上启动的计量服务，您需要一个小的配置文件。这是它最辉煌的时刻。</p><pre class="jy jz ka kb fq mz na nb nc aw nd dt"><span id="2f84" class="lf kd ia na b fv ne nf l ng nh">{<br/>“meteringRefreshInterval” : 2000,<br/>“meteringServiceType” : “SingleNodeMeterer”,<br/>“daoPartyName” : “Cordite Committee”,<br/>“meteringNotaryAccountId”: “metering-account-acc1”,<br/>“meteringPartyName”: “Cordite Metering Notary”,<br/>“daoName”:”Cordite Committee”<br/>}</span></pre><p id="fefe" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">值得讨论每个参数，因为这将充实计量故事。</p><ul class=""><li id="7875" class="lz ma ia iz b ja jb je jf ji mb jm mc jq md ju me mf mg mh dt translated"><strong class="iz ib">计量刷新间隔</strong></li></ul><p id="6919" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">目前，计数服务的轮询时间为2秒。在每次轮询期间，它检查其配置，然后读取公证人保险库中的已提交交易。</p><p id="124c" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">对于单节点公证，事务存储在下表中:</p><pre class="jy jz ka kb fq mz na nb nc aw nd dt"><span id="6927" class="lf kd ia na b fv ne nf l ng nh">NODE_NOTARY_COMMIT_LOG</span></pre><p id="7320" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在您自己的计量实现中，您可能希望在安静时间、预定时间甚至每天进行计量；这些选项中的每一个都将适合您自己的使用案例。</p><ul class=""><li id="60b7" class="lz ma ia iz b ja jb je jf ji mb jm mc jq md ju me mf mg mh dt translated"><strong class="iz ib">计量服务类型</strong></li></ul><p id="dafc" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们预计未来会有许多不同类型的公证人和计量类型；此参数驱动从“抽象”meter类继承的“meter”类型。</p><ul class=""><li id="41b7" class="lz ma ia iz b ja jb je jf ji mb jm mc jq md ju me mf mg mh dt translated"><strong class="iz ib">道党名</strong></li></ul><p id="3be5" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量发票从业务节点支付给DAO。计量公证人将此参数放在每张计量发票上，因此业务节点知道将付款发送到哪里。</p><ul class=""><li id="3139" class="lz ma ia iz b ja jb je jf ji mb jm mc jq md ju me mf mg mh dt translated"><strong class="iz ib">计量NotaryAccountId </strong></li></ul><p id="a370" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这是计量费支付到的科迪特DGL帐户的名称；同样，这些都印在每张发票上。此外，在当今的商业世界中，许多发票在开具时并没有实际说明应该向哪个账户付款——如果你仔细想想，这是相当令人震惊的！</p><ul class=""><li id="37c1" class="lz ma ia iz b ja jb je jf ji mb jm mc jq md ju me mf mg mh dt translated"><strong class="iz ib">计量方名称</strong></li></ul><p id="c909" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量服务根据该参数检查计量公证人的节点组织名称。如果它们不匹配，计量服务将退出；这充当了额外的带子和支架，防止计量意外地在错误的节点上运行。</p><ul class=""><li id="681d" class="lz ma ia iz b ja jb je jf ji mb jm mc jq md ju me mf mg mh dt translated"><strong class="iz ib">道名</strong></li></ul><p id="3ca6" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量配置的其余部分保持在特定的DAO状态。注意:网络中可以有很多DAO状态。对于我们的测试网络，我们的道州简称为“科迪特委员会”</p><p id="8786" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量服务在每次轮询时检查DAO状态，以确保它具有最新的计量费用和配置。</p><p id="0668" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果它没有找到包含计量参数的DAO状态，那么什么都不会被计量！</p><p id="a1f0" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">`您的业务网络成员最终控制计量规则`</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="fe ff mp"><img src="../Images/42bfc76fa5aab03ad54cf58dae80f091.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXnp2zRu6za5o7sehIOR1w.jpeg"/></div></div></figure><p id="f422" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量配置的其余部分存储在名为“meteringModelData”的类中，该类存储在DAO状态中。</p><p id="b2ad" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这是它在json中的样子，为了简洁做了一些编辑</p><pre class="jy jz ka kb fq mz na nb nc aw nd dt"><span id="4d3f" class="lf kd ia na b fv ne nf l ng nh">{<br/><strong class="na ib">meteringTransactionCost:</strong><br/>{ meteringTransactionCost: 10,<br/>  meteringTransactionTokenDescriptor:{ symbol: ‘XTS’ }<br/>},</span><span id="b80d" class="lf kd ia na b fv ni nf l ng nh"><strong class="na ib">meteringNotaryMembers:</strong>{ </span><span id="63cc" class="lf kd ia na b fv ni nf l ng nh">‘OU=Cordite Foundation, O=Cordite Metering Notary, L=London, C=GB’:{ accountId: ‘metering-notary-account1’,<br/>description: ‘I am a cool metering notary’,<br/>meteringNotaryType: ‘METERER’ },</span><span id="52da" class="lf kd ia na b fv ni nf l ng nh">‘OU=Cordite Foundation, O=Cordite Guardian Notary, L=London, C=GB’:{ accountId: ‘guardian-notary-account1’,<br/>description: ‘I am a guardian of the galaxy’,<br/>meteringNotaryType: ‘GUARDIAN’ }<br/>},</span><span id="54d9" class="lf kd ia na b fv ni nf l ng nh"><strong class="na ib">meteringFeeAllocation:</strong>{<br/>daoHoldingAccountId: ‘dao-holding-account’,<br/>daoFoundationAllocation: 50,<br/>meterNotaryAllocation: 40,<br/>guardianNotaryAllocation: 10,<br/>daoFoundationAccount: ‘dao-foundation-account’ }<br/>}<br/></span></pre><p id="04d0" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">该配置分为三个主要部分。</p><p id="dab2" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz ib">计量交易成本:</strong></p><p id="087f" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这决定了用于支付计量费用的DGL令牌的类型以及应该支付该单位的多少。</p><p id="6fc5" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz ib">计量公证成员:</strong></p><p id="9f35" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这定义了由DAO“批准”的所有公证人的列表。计量公证人从该列表中挑选其监护人公证人。有了Corda 4，我们将能够使用Roger Willis出色的参考状态实现来强制使用这个列表。</p><p id="5028" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz ib">计量费用分摊:</strong></p><p id="7106" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这决定了如何在计量公证人、监护人公证人和您的业务网络基金之间分割计量费用。</p><p id="7e07" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">上述所有参数均由您的业务网络管理的DAO通过投票和提案机制进行控制；这使得DAO成员能够治理计量。</p><p id="2724" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在当前的实现中，计量和监护公证人是DAO的投票成员，因此他们可以投票反对任何“免费”交易的提议！！！</p><p id="d579" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这很好地把我们带到了费用分散服务。</p><p id="9612" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">`根据业务网络设置的规则发放奖励`</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff nj"><img src="../Images/9428a19329d6f4001ff5eacd875ac50c.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*Wyvft_4OaQLJQ87XbBJOQQ.png"/></div></figure><h2 id="fc75" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated"><strong class="ak">费用分散服务是如何工作的？</strong></h2><p id="ce5f" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">到目前为止，您可能已经猜到费用分散服务需要一个配置文件，所以这里是:</p><pre class="jy jz ka kb fq mz na nb nc aw nd dt"><span id="1fd1" class="lf kd ia na b fv ne nf l ng nh">{<br/>“feeDispersalRefreshInterval”:2000,<br/>“feeDispersalServicePartyName”:”Cordite Committee”,<br/>“daoName”: “Cordite Committee”<br/>}</span></pre><p id="26c8" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">像计量服务一样，费用分散服务在2秒钟的轮询中运行，然后从DAO状态中提取“meteringModelData”。</p><p id="5f96" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">该服务运行在收集计量费用的指定DAO节点上。</p><p id="cebe" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量费用被支付到被称为“持有账户”的DGL科迪特账户。</p><p id="2830" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">费用分散服务检查其金库中的“已支付”计量发票，并且当它找到已支付的计量发票时，它读取计量费用分配结构，并且根据计量费用分配表来划分持有账户中的代币。</p><p id="7d55" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">然后，它为每笔分配创建一个“计量发票分割”，并将这些分配发送给计量和监护人公证人，并将一些资金放入“Dao基金会帐户”，用于资助您的业务网络的进一步发展。</p><p id="aed4" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">所有这些计量交易都由监护人公证人进行公证，这留下了一个小问题，即我们需要为监护人公证人的勇敢努力支付报酬。因此，我们必须先向计量公证人进行公证转账，然后才能向监护人公证人付款。</p><p id="a053" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在这一点上，你可能会说，‘计量公证人肯定会计量这个交易，并创建一个无限的计量循环’——直到我修改了代码，不对监护人公证人的交易收费，它才这样做！</p><p id="2457" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">“没有一套强大的流程，任何Cordapp都没有任何用处”</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff nk"><img src="../Images/43dfed228f3769cea6478b345d1ad491.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DoPUnHSZjkInevrmK_LAHg.png"/></div></figure><h2 id="499b" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated"><strong class="ak">计量流量</strong></h2><p id="e251" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">没有一套健壮的流程，Cordapp就不是一个真正的Cordapp，值得讨论一下这些流程，以补充一些额外的细节。</p><p id="3353" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量发票经历了从发行到支付再到分发的生命周期。这是管理业务流的一种非常普通的标准状态机方法。这些状态在“计量状态”枚举中定义——我将在解释流程时提到这些状态。</p><p id="0410" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">‘所有计量交易均可批量完成’</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="fe ff nl"><img src="../Images/e4569cb2fdf7216c96b5070b1fa30854.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nQl3OlmUztXWzFAJEaDCwA.jpeg"/></div></div></figure><p id="69d3" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz ib">IssueMeteringInvoicesFlow:</strong></p><p id="7126" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如tin上所述，这将从计量公证人向发起交易的业务节点发出计量发票。与所有计量流量一样，这由监护人公证人进行公证。</p><p id="1666" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">您可能已经注意到，流名称是复数形式的；这是因为所有计量流都可以处理多个发票和付款。计量发票契约还煞费苦心地验证在事务中提交多个状态时没有欺诈行为。</p><p id="f95a" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在该流程的接收端，业务节点检查它是否确实创建了交易，并且由计量公证人进行了公证。这再次反映了我的观点，我们应该不信任任何东西，无论它来自何方。</p><p id="a10d" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">此时，计量发票处于“已发行”状态，由节点所有者所有。</p><p id="1f20" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">“在原子交易中支付物品的强大概念”</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff nm"><img src="../Images/baddfd815976290fe66cb8cbd86b791c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*aPsns5Dzi66BaGWiJy2BuA.png"/></div></figure><p id="d2fe" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz ib"> PayMeteringInvoicesFlow: </strong></p><p id="3b75" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">这是由业务节点发起的，这实质上意味着节点所有者控制她何时支付计量账单。</p><p id="4d40" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">该流程的参数是计量交易id列表和支付费用的Cordite DGL帐户Id。</p><p id="3450" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">在这个简单的流程中，有一个非常强大的概念，我称之为“支付物品”交易。</p><p id="0482" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">到目前为止，在技术解决方案中，支付发票导致数据转移到不同的轨道上，一个用于支付(BACS、SWIFT等)，一个用于发票(电子邮件、传真、邮寄！😱).</p><p id="20f2" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">当我们可以将支付和已付发票结合在一个单一的原子操作中时，它是非常强大的——全球的账户职员将不再花费无尽的时间来匹配发票和支付；向小公司发送随机发票的欺诈者将逃之夭夭。</p><p id="113e" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">该流程使用Cordite DGL来实现这一点，这样我们可以确保您可以轻松地将DGL令牌状态集成到自己的流程中，以支付发票、数字媒体、贷款、抵押贷款和加密仓鼠等数字项目。</p><p id="d9ee" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">此时，计量发票处于“已支付”状态，由DAO分散节点所有。</p><p id="9347" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">“用业务网络选择的DGL令牌分割发票”</em></p><p id="5c6a" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz ib">分散流量计流量:</strong></p><p id="f3c2" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我在上面介绍了分散，所以唯一要添加的是计量发票被分割成三个“计量发票分割”,并在DAO选择的DGL令牌中与相应的付款一起发送——同样，原子操作减少了对帐的需要。</p><p id="a4b7" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果一切顺利，那么计量发票将最终处于“资金分散”状态。</p><p id="803c" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">此外，三种计量发票分割状态将以“分割_分散”状态结束</p><p id="ab11" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">“论账本数字纠纷”</p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff nn"><img src="../Images/d2256a830b302a24156ab250b920066b.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*j1c8QqommV-K1sItK-tZFg.png"/></div></figure><p id="960a" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz ib">争议干预声音流:</strong></p><p id="dcc1" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果业务节点所有者认为计量发票不公平，她可以使用此流程将它们发送回计量公证人。它简单明了！</p><p id="f5b3" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">此时，计量发票处于“有争议”状态，由计量公证人所有</p><p id="9f1c" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><em class="jw">“唯一性和解决数字争议”</em></p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff no"><img src="../Images/cf72e48eeb7fa2016315a4c4f2312725.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*9rx6CoORifc2kXAUGPCfSA.png"/></div></figure><p id="378b" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated"><strong class="iz ib">reissuemeteringivoiceflow:</strong></p><p id="0c71" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">计量公证人“所有者”可以重新签发计量发票，但对发票中可以更改的字段(当前为金额、令牌类型和目标帐户)权力有限。</p><p id="4725" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">争议/再发行周期可能会发生很多次，就像在当前的商业模式中一样。这突出了另一个问题，即我们需要非常小心地保持计量发票的唯一性，以防止创建重复的发票。</p><p id="0b07" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">我们通过在保险库中的计量发票上强制执行唯一索引以及仔细检查计量发票合同中的“重新发行计数”来做到这一点。</p><p id="e448" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">“开源，开放思想”</p><figure class="jy jz ka kb fq hv fe ff paragraph-image"><div class="fe ff np"><img src="../Images/38d41f2e69c02701e66e64b67662d1af.png" data-original-src="https://miro.medium.com/v2/resize:fit:404/format:webp/1*_I-SECP4d4_8YPG_b7Rtwg.png"/></div></figure><h2 id="cea2" class="lf kd ia bd ke lg lh li ki lj lk ll km ji lm ln kq jm lo lp ku jq lq lr ky ls dt translated"><strong class="ak">总之</strong></h2><p id="570e" class="pw-post-body-paragraph ix iy ia iz b ja la jc jd je lb jg jh ji lc jk jl jm ld jo jp jq le js jt ju hm dt translated">感谢您到此为止，我希望这篇文章能让您深入了解Cordite计量，它如何消耗其他Cordite组件，以及最终如何使用Corda流和服务构建相当复杂的Cordapps。</p><p id="a426" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">如果您想为您的Cordapp设置cordite计量，那么值得看看我们贯穿整个过程的端到端计量集成测试。在cordite repo中查看该类:</p><pre class="jy jz ka kb fq mz na nb nc aw nd dt"><span id="74ef" class="lf kd ia na b fv ne nf l ng nh"><a class="ae jv" href="https://gitlab.com/cordite/cordite/blob/master/cordapps/metering-cordapp/src/integrationTest/kotlin/io/cordite/metering/MeteringIntegrationTest.kt" rel="noopener ugc nofollow" target="_blank">MeteringIntegrationTest</a></span></pre><p id="2023" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">以下是测试的预览:</p><pre class="jy jz ka kb fq mz na nb nc aw nd dt"><span id="74a9" class="lf kd ia na b fv ne nf l ng nh">private fun runEndToEndTest() {<br/>  createDaoAndMembers()<br/>  setUpDaoMeteringParameters()<br/>  createAndLoadAccountsForMeteringFunds()<br/>  createAccountsAndDoSomeTransfers()<br/>  checkForMeteringInvoicesAndPayThem()<br/>  checkFinalBalances()<br/>}</span></pre><p id="fca0" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">Cordite是作为开源共享的，这篇文章也是我们尝试分享我们的思维过程——“为什么”和“如何”一样重要</p><p id="c994" class="pw-post-body-paragraph ix iy ia iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju hm dt translated">cordite的贡献者越来越多，我们欢迎各种规模的提交和设计想法；要了解更多信息，请从这里的<a class="ae jv" href="https://cordite.foundation/" rel="noopener ugc nofollow" target="_blank">开始</a>！</p><blockquote class="nq"><p id="c7f9" class="nr ns ia bd nt nu nv nw nx ny nz ju ek translated"><a class="ae jv" href="https://coincodecap.com/?utm_source=coinmonks" rel="noopener ugc nofollow" target="_blank">直接在您的收件箱中获得最佳软件交易</a></p></blockquote><figure class="ob oc od oe of hv fe ff paragraph-image"><a href="https://coincodecap.com/?utm_source=coinmonks"><div class="fe ff oa"><img src="../Images/7c0b3dfdcbfea594cc0ae7d4f9bf6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/0*OJ-qb5G6i863msBB.png"/></div></a></figure></div></div>    
</body>
</html>