<html>
<head>
<title>Setup GCC 8.1 Cross Compiler Toolchain for Raspberry Pi 3 on macOS High Sierra</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在macOS High Sierra上设置覆盆子Pi 3的GCC 8.1交叉编译器工具链</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/setup-gcc-8-1-cross-compiler-toolchain-for-raspberry-pi-3-on-macos-high-sierra-cb3fc8b6443e?source=collection_archive---------0-----------------------#2018-08-13">https://medium.com/coinmonks/setup-gcc-8-1-cross-compiler-toolchain-for-raspberry-pi-3-on-macos-high-sierra-cb3fc8b6443e?source=collection_archive---------0-----------------------#2018-08-13</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/fe87db9d9ef16b8db7d9fd6916d44e15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IB-eaCjgcw50-erL"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">Photo by <a class="ae jf" href="https://unsplash.com/@mat_graphik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jordane Mathieu</a> on <a class="ae jf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="480e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在今年的亚马逊黄金日期间，我发现了一本由德里克·莫洛伊先生写的书《T2 》( T3)。我认为这是开始系统学习嵌入式开发的好时机。所以我的旅程开始了。</p><p id="60a6" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">有了一些使用<em class="ke"> AOSP </em>平台的实践经验，我知道人们会在开发机器上使用<strong class="ji hu"> gcc </strong>交叉编译器来为目标设备生成二进制文件。在一台功能强大的计算机上，编译一个需要超过10千兆字节硬盘空间，不低于4千兆字节内存的程序是有意义的。此外，在您最需要的操作系统上构建和侵入您最喜欢的文本编辑器/IDE也很不错。因此，拥有一个支持最新的<em class="ke"> C/C++ </em>标准的<em class="ke">覆盆子Pi </em>的交叉编译器听起来是我的<em class="ke"> Pi </em>冒险的一个好开始。</p><p id="968c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">生活在互联网时代真是太棒了。你不必找百科全书来尝试你的想法。只需在<em class="ke">谷歌</em>搜索框中键入“<a class="ae jf" href="https://www.google.com/search?newwindow=1&amp;rlz=1C5CHFA_enUS805US805&amp;ei=ymReW5vtIKqB0wLqzreoDw&amp;q=Raspberry+Pi+cross+compiler+macOS&amp;oq=Raspberry+Pi+cross+compiler+macOS&amp;gs_l=psy-ab.3..35i39k1j0i22i30k1l3.2749.11366.0.13239.11.9.2.0.0.0.305.995.7j1j0j1.9.0....0...1.1.64.psy-ab..0.4.229...0i30k1j0i8i30k1j0i13i30k1j0i8i13i30k1.0.pBZf0PNyZLc" rel="noopener ugc nofollow" target="_blank"> <em class="ke">覆盆子Pi </em>交叉编译器macOS </a>”就会得到一些<a class="ae jf" href="https://www.jaredwolff.com/blog/cross-compiling-on-mac-osx-for-raspberry-pi/" rel="noopener ugc nofollow" target="_blank">有希望的结果</a>(感谢沃尔夫先生这么好的博文:)。在我注意到它的出版日期是2016年9月之前，这篇文章的所有内容看起来都很精彩。当时，本文正在为“<em class="ke">arm V7-rpi 2-Linux-gnueabihf</em>”构建工具链，该工具链代表<em class="ke">覆盆子Pi 2 </em>(尽管它声明该指南支持<em class="ke"> RPi3 </em>)。它只支持<strong class="ji hu"> gcc </strong> 5.2，没有<em class="ke"> C++17/C++20 </em>。虽然有一些限制，但该指南仍然是我的交叉编译器实验的黄金参考，因为它提供了如何使用<a class="ae jf" href="https://crosstool-ng.github.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ji hu"> crosstool-ng </strong> </a>的便捷技巧，这是一个为各种平台配置和编译<strong class="ji hu"> GNU </strong>工具链的极好项目。</p><p id="ffdb" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">经过一整个周末对编译器/链接器/工具错误的沮丧，我能够在<em class="ke"> macOS High Sierra </em>版本10.13.6上获得一个功能完整的<strong class="ji hu"> GNU </strong>工具链，该工具链为平台“<em class="ke">arm V8-RP i3-Linux-gnueabihf</em>生成二进制文件。如果您想尝试二进制文件，构建工件托管在<a class="ae jf" href="https://github.com/yc2986/armv8-rpi3-linux-gnueabihf-gcc-8.1.0-macos-high-sierra" rel="noopener ugc nofollow" target="_blank"> my GitHub repo </a>中。该项目包含一个用于<strong class="ji hu"> crosstool-ng </strong>和以下<strong class="ji hu"> GNU </strong>工具的<a class="ae jf" href="https://github.com/yc2986/armv8-rpi3-linux-gnueabihf-gcc-8.1.0-macos-high-sierra/blob/master/.config" rel="noopener ugc nofollow" target="_blank">配置文件</a>:</p><ul class=""><li id="831c" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd kk kl km kn dt translated"><strong class="ji hu"><em class="ke">GNU make</em></strong><em class="ke">4 . 2 . 1</em></li><li id="bc4f" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hu"> <em class="ke"> GNU编译器集合(gcc) </em> </strong> <em class="ke"> 8.1.0 </em></li><li id="79ea" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hu"> <em class="ke"> GNU C库(glibc) </em> </strong> <em class="ke"> 2.27 </em></li><li id="c774" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hu">T33】GNU Binutils</strong>T36】2.28</li><li id="c3e8" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hu">T39】GNU M4T41<em class="ke">1 . 4 . 18</em></strong></li><li id="b8c5" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hu"> <em class="ke"> GNU调试器(gdb) </em> </strong> <em class="ke"> 8.1 </em></li><li id="ee58" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hu"> <em class="ke"> GNU构建系统:autoconf </em> </strong> <em class="ke"> 2.69、</em><strong class="ji hu"><em class="ke">automake</em></strong><em class="ke">1.15、</em><strong class="ji hu"><em class="ke">libtool</em></strong><em class="ke">2 . 4 . 6</em></li></ul><p id="3e70" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">现在我将向您展示如何从<strong class="ji hu"> ct-ng </strong>编译器获得这些工具。在第一部分，我将列出使<strong class="ji hu"> ct-ng </strong>工作所需的正确的依赖关系和程序。在第二部分，我将分享我使用<strong class="ji hu"> crosstool-ng </strong>配置菜单界面的经验。在第三部分，我会给你看一些我遇到的错误和我的解决方法。</p></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><h2 id="a173" class="la lb ht bd lc ld le lf lg lh li lj lk jr ll lm ln jv lo lp lq jz lr ls lt lu dt translated">第1部分:成功的编译过程</h2><p id="5ba8" class="pw-post-body-paragraph jg jh ht ji b jj lv jl jm jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd hm dt translated">安装<strong class="ji hu">自制软件</strong>来获得我们需要的对<em class="ke"> macOS </em>的依赖</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="a246" class="la lb ht mf b fv mj mk l ml mm">/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</span></pre><p id="139c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">安装<strong class="ji hu">十字工具-ng </strong></p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="9344" class="la lb ht mf b fv mj mk l ml mm">brew install crosstool-ng</span></pre><p id="ac97" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">找到<strong class="ji hu">十字工具的安装目录</strong></p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="7991" class="la lb ht mf b fv mj mk l ml mm">brew info crosstool-ng</span></pre><p id="a1aa" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在我的例子中，该命令返回以下结果</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="4d2f" class="la lb ht mf b fv mj mk l ml mm">crosstool-ng: stable 1.23.0 (bottled)</span><span id="52e6" class="la lb ht mf b fv mn mk l ml mm">Tool for building toolchains</span><span id="7fb7" class="la lb ht mf b fv mn mk l ml mm">http://crosstool-ng.org</span><span id="a086" class="la lb ht mf b fv mn mk l ml mm"><em class="ke">/usr/local/Cellar/crosstool-ng/1.23.0_1</em> (1,294 files, 7.7MB) *</span><span id="2fbd" class="la lb ht mf b fv mn mk l ml mm">Poured from bottle on 2018-07-20 at 23:37:27</span><span id="c69e" class="la lb ht mf b fv mn mk l ml mm">From: https://github.com/Homebrew/homebrew-core/blob/master/Formula/crosstool-ng.rb</span></pre><p id="571e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们需要向crosstool-NG.sh脚本授予执行权限，以解决潜在的工作流错误。</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="c001" class="la lb ht mf b fv mj mk l ml mm">chmod +x <em class="ke">/usr/local/Cellar/crosstool-ng/1.23.0_1/lib/crosstool-ng-1.23.0/scripts/crosstool-NG.sh</em></span></pre><p id="4836" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated"><strong class="ji hu"> libtool </strong>和<strong class="ji hu"> gcc </strong> 8.1编译需要一些额外的依赖项。</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="e914" class="la lb ht mf b fv mj mk l ml mm">brew install help2man bison</span></pre><p id="1ce9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">gcc  8.1编译要求<strong class="ji hu"> GNU bison </strong>比系统默认版本更高。我们需要链接brew版本的<strong class="ji hu"> bison </strong>，因为<em class="ke"> macOS </em>会从<em class="ke"> /usr/bin/bison </em>而不是<strong class="ji hu"> brew的</strong><em class="ke">/usr/local/bin/bison</em>中选择系统默认的一个。</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="85bc" class="la lb ht mf b fv mj mk l ml mm">brew link --force bison</span><span id="b718" class="la lb ht mf b fv mn mk l ml mm"># this linkage can be later reverted by running:<br/>#   brew unlink bison</span><span id="48b7" class="la lb ht mf b fv mn mk l ml mm"># after the linking we should restart the console or run:<br/>#   source <em class="ke">~/.bash_profile</em><br/># to correctly apply the linkage. by running:<br/>#   which bison<br/># the console should return something other than <em class="ke">/usr/bin/bison</em></span></pre><p id="6cb3" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">接下来，我们需要创建一个区分大小写的磁盘卷来存放所有工具链编译工件。这可以通过简单地打开<strong class="ji hu">磁盘实用程序</strong>并点击红色圆圈按钮来实现。</p><figure class="ma mb mc md fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mo"><img src="../Images/4e51860759224fb8833233dc7a331e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nsTV-ACniskrEN7hMuLySA.png"/></div></div></figure><p id="1aac" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">有了<em class="ke"> macOS High Sierra </em>，我们有了<em class="ke"> APFS </em>磁盘格式，它具有更好的性能和文件大小优化。既然我们正在尝试最新的<strong class="ji hu"> GNU </strong>工具链，为什么不在最新的文件系统上也尝试一下呢。我知道新的编译器+新的文件系统格式可能会让我四倍头痛，但为什么不呢:)。在我的例子中，我将其命名为<em class="ke">“xtool-build-env”</em>，它使用了“<em class="ke">(区分大小写)</em>”磁盘格式。我们将需要10gb的空间来存放所有中间对象文件，并在一个<em class="ke"> APFS </em>卷上安装文件。使用“大小选项”按钮进行空间预分配工作。</p><figure class="ma mb mc md fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mp"><img src="../Images/f32b0ede07459ad2b486dc6b5f0f608a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z52b115DvVSK0YCLE8KzeA.png"/></div></div></figure><p id="b25c" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">现在在<em class="ke">/Volumes/xtool-build-env/</em>中已经准备好区分大小写的卷，是时候开始使用<strong class="ji hu"> ct-ng </strong>构建系统了。配置该工具最简单的方法是直接使用我成功构建的<a class="ae jf" href="https://github.com/yc2986/armv8-rpi3-linux-gnueabihf-gcc-8.1.0-macos-high-sierra/blob/master/.config" rel="noopener ugc nofollow" target="_blank">配置文件</a>。将此配置放在</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="bb49" class="la lb ht mf b fv mj mk l ml mm"><em class="ke">/Volumes/xtool-build-env/.config</em></span></pre><p id="6759" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">然后打开它，编辑这些路径以匹配您的系统设置。您可以根据自己的喜好更改卷名或使用区分大小写的<em class="ke"> APFS </em>卷下的任何文件夹。就我而言:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="c430" class="la lb ht mf b fv mj mk l ml mm">CT_WORK_DIR="<em class="ke">/Volumes/xtool-build-env/.build</em>"<br/>CT_PREFIX_DIR="<em class="ke">/Volumes/xtool-build-env/${CT_TARGET}</em>"<br/>CT_LOCAL_PATCH_DIR="<em class="ke">/Volumes/xtool-build-env/packages</em>"</span></pre><p id="a7d4" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">请注意，在上述设置中，我已经在配置中设置了<strong class="ji hu"> CT_LOCAL_PATCH_DIR </strong>以及捆绑补丁规则上的本地补丁。这需要我们复制<a class="ae jf" href="https://github.com/crosstool-ng/crosstool-ng/tree/master/packages" rel="noopener ugc nofollow" target="_blank"> <strong class="ji hu"> crosstool-ng </strong>的packages文件夹</a>下的所有内容，并将其放在<em class="ke">/Volumes/xtool-build-env/packages/</em>下。</p><p id="57f6" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">让我们通过命令来检查<em class="ke"> macOS </em>的用户限制:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="a159" class="la lb ht mf b fv mj mk l ml mm">ulimit -n</span></pre><p id="a64e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">如果系统将资源限制为仅256，请尝试使用以下命令将其增加到至少1024:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="c04b" class="la lb ht mf b fv mj mk l ml mm">ulimit -n 1024<br/># re-run "ulimit -n" to make sure this step succeeded</span></pre><p id="fcb7" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">为了方便起见，我在配置文件中启用了选项<strong class="ji hu"> CT_DEBUG_CT_SAVE_STEPS </strong>。这确保了无论何时一个构建步骤失败，我们都可以修复问题并从失败点重新开始。由于工具链构建是一个耗时的过程，启用保存步骤将为我们节省大量时间。</p><p id="9b9a" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">至此我们已经完成了编译<strong class="ji hu"> gcc </strong> 8.1.0的所有先决条件。然而，需要对<strong class="ji hu"> gcc </strong> 8.1.0源代码进行一些更改，以解决一个编译器错误。</p><p id="27c7" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">让我们首先使用以下命令列出可用的构建步骤:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="781f" class="la lb ht mf b fv mj mk l ml mm">ct-ng list-steps</span></pre><p id="91d1" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在我的本地环境<strong class="ji hu">中，ct-ng </strong>返回以下构建步骤</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="2e26" class="la lb ht mf b fv mj mk l ml mm">Available build steps, in order:<br/>- companion_tools_for_build<br/>- companion_libs_for_build<br/>- binutils_for_build<br/>- companion_tools_for_host<br/>- companion_libs_for_host<br/>- binutils_for_host<br/>- cc_core_pass_1<br/>- kernel_headers<br/>- libc_start_files<br/>- cc_core_pass_2<br/>- libc<br/>- cc_for_build<br/>- cc_for_host<br/>- libc_post_cc<br/>- companion_libs_for_target<br/>- binutils_for_target<br/>- debug<br/>- test_suite<br/>- finish<br/>Use "&lt;step&gt;" as action to execute only that step.<br/>Use "+&lt;step&gt;" as action to execute up to that step.<br/>Use "&lt;step&gt;+" as action to execute from that step onward.</span></pre><p id="cad2" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">例如，如果构建在步骤<strong class="ji hu"> cc_for_build </strong>失败，这意味着保存的最后一个成功步骤是步骤<strong class="ji hu"> libc </strong>，我们可以排除故障并修复问题，然后使用命令重新开始构建:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="0d27" class="la lb ht mf b fv mj mk l ml mm">ct-ng libc+</span></pre><p id="e6a0" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">尾部的加号表示从<strong class="ji hu"> libc </strong>步骤开始执行以下动作。</p><p id="d487" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">现在，我们将下载源代码，配置构建工具依赖项，并对<strong class="ji hu"> gcc </strong> 8.1.0源代码进行一些更改。运行这个:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="7d68" class="la lb ht mf b fv mj mk l ml mm">ct-ng +companion_tools_for_build</span></pre><p id="65d1" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在第一步正确完成后，我们将使用<em class="ke">/Volumes/xtool-build-env/packages/</em>文件夹中的git补丁文件下载、解压缩并修补所有源代码。现在我们应该编辑这个文件:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="e0fc" class="la lb ht mf b fv mj mk l ml mm">vi <em class="ke">/Volumes/xtool-build-env/.build/src/gcc-8.1.0/libatomic/configure</em></span></pre><p id="9e09" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">搜索并更改以下行</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="d527" class="la lb ht mf b fv mj mk l ml mm">XCFLAGS="$XCFLAGS -Wall -Werror"</span></pre><p id="448d" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">到</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="0d78" class="la lb ht mf b fv mj mk l ml mm">XCFLAGS="$XCFLAGS -Wall"</span></pre><p id="0d92" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这是解决编译<strong class="ji hu"> gcc libatomic时生成的警告错误的一种方法。</strong>警告消息是关于-mcpu与-march编译器标志冲突。这不是一个好的解决方案，任何合适的建议都是值得赞赏的。</p><p id="048b" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">一切就绪后，让我们开始构建。下面的命令将从最后一个保存点恢复我们的构建，并修改我们编辑过的源代码。</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="b4c2" class="la lb ht mf b fv mj mk l ml mm">ct-ng companion_tools_for_build+</span></pre><p id="b2b8" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">是时候喝杯茶，等待我们闪亮的编译器在40分钟内准备好了。</p><p id="81cf" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">如果一切顺利，工具链应该可以在<em class="ke">/Volumes/xtool-build-env/arm V8-RP i3-Linux-gnueabihf/</em>中找到。让我们用一个<a class="ae jf" href="https://github.com/yc2986/CMakeRPiExample" rel="noopener ugc nofollow" target="_blank">示例项目</a>来测试一下最新的<em class="ke"> C++17/C++20 </em>特性。该项目需要<strong class="ji hu"> CMake </strong>进行配置，因此获得依赖关系:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="0bb4" class="la lb ht mf b fv mj mk l ml mm">brew install cmake</span></pre><p id="1e8a" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">然后克隆到git repo中，运行以下命令来构建交叉工具链:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="68b7" class="la lb ht mf b fv mj mk l ml mm">cd build<br/>cmake .. &amp;&amp; make</span></pre><p id="1810" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">测试应用程序将在<em class="ke">cmakepiexample/build/executable/executable</em>中提供。使用下面的rsync命令将这个应用程序复制到您的RPi3设备上。我已经给了我的Raspberry Pi主机名pi0，所以我的命令将是</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="f311" class="la lb ht mf b fv mj mk l ml mm">rsync -rtzh <em class="ke">CMakeRPiExample/build/executable/executable</em> pi@pi0:/home/pi</span></pre><p id="57eb" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">然后ssh到您的设备，并从主目录执行应用程序。它将创建10个<em class="ke"> std::thread </em>对象，其中几个std:: <em class="ke"> any </em>对象被初始化并用于存储整数变量。一个<em class="ke">c++ 20</em>style<em class="ke">_ _ VA _ OPT _ _</em>宏用于测试<em class="ke"> C++2a </em>的功能。如果一切编译正常，应用程序应该会返回类似下面的内容</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="e159" class="la lb ht mf b fv mj mk l ml mm">thread 0 finished<br/>thread 8 finished<br/>thread 1 finished<br/>thread 2 finished<br/>thread 3 finished<br/>thread 4 finished<br/>thread 5 finished<br/>thread 6 finished<br/>thread 7 finished<br/>thread 9 finished<br/>double params foo: static c1 optional c2 param<br/>single param foo: static c1</span></pre><p id="5b05" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们已经通过一个小样本项目成功测试了<em class="ke"> C++11/C++17/C++20 </em>的特性:)该编译器已经准备好用于我们激动人心的未来项目了！</p></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><h2 id="5d8a" class="la lb ht bd lc ld le lf lg lh li lj lk jr ll lm ln jv lo lp lq jz lr ls lt lu dt translated">第2部分:使用crosstool-ng配置文件</h2><p id="a7cb" class="pw-post-body-paragraph jg jh ht ji b jj lv jl jm jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd hm dt translated">在第1部分中，我提供了一个微调过的配置文件，它支持构建最新的<strong class="ji hu"> gcc </strong>，设置补丁应用规则，并使用逐步构建。在本节中，我将解释如何使用<strong class="ji hu"> crosstool-ng </strong>的<em class="ke"> menuconfig </em>以及如何修改配置文件以采用最新的<em class="ke"> gcc/gdb </em>和其他工具集。</p><p id="e4ce" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">首先，我将开始为目标平台初始化一个配置文件。可用目标可以在<a class="ae jf" href="https://github.com/crosstool-ng/crosstool-ng/tree/master/samples" rel="noopener ugc nofollow" target="_blank">样本目录</a>下从<strong class="ji hu"> crosstool-ng </strong>的Git repo中找到。在我们的例子中，目标为<em class="ke"> RPi3，</em>让我们在目录<em class="ke">/Volumes/xtool-build-env/</em>中运行下面的init命令</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="b321" class="la lb ht mf b fv mj mk l ml mm">ct-ng armv8-rpi3-linux-gnueabihf</span></pre><p id="aeda" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">然后为<strong class="ji hu"> ct-ng </strong>启动<em class="ke">菜单配置</em>。运行以下命令启动界面:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="a945" class="la lb ht mf b fv mj mk l ml mm">ct-ng menuconfig</span></pre><figure class="ma mb mc md fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mq"><img src="../Images/85b270c52d4abf066f37429319af1289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xeslgvBVtg63E9zKshef3w.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek"><strong class="bd mr">ct-ng</strong> menuconfig interface</figcaption></figure><p id="d322" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">基本上，<em class="ke">路径/补丁/调试</em>相关选项将驻留在<em class="ke">路径和杂项选项</em>子菜单中。<em class="ke"> C库</em>用于配置<strong class="ji hu"> glibc </strong>相关参数。<em class="ke"> C编译器</em>菜单为<strong class="ji hu"> gcc </strong>编译器提供选项。<em class="ke">调试工具</em>让你为<em class="ke"> RPi3 </em>选择<strong class="ji hu"> gdb </strong>和你想要的内存跟踪工具。</p><p id="6b6d" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">对于路径配置，我使用了以下菜单项:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="7eb7" class="la lb ht mf b fv mj mk l ml mm">Paths and misc options<br/>-- (<em class="ke">/Volumes/xtool-build-env/src</em>) Local tarballs directory<br/>-- (<em class="ke">/Volumes/xtool-build-env/.build</em>) Working directory<br/>-- (<em class="ke">/Volumes/xtool-build-env/${CT_TARGET}</em>) Prefix directory</span></pre><p id="d542" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">对于补丁应用:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="4479" class="la lb ht mf b fv mj mk l ml mm">Paths and misc options<br/>-- Patches origin (Local only, bundled if no local)<br/>-- (<em class="ke">/Volumes/xtool-build-env/packages</em>)   Local patch directory</span></pre><p id="04ca" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">对于调试选项:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="0ddd" class="la lb ht mf b fv mj mk l ml mm">Paths and misc options<br/>[*] Debug crosstool-NG<br/>[*]   Save intermediate steps<br/>[*]     gzip saved states</span></pre><p id="016b" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">对于<strong class="ji hu"> glibc </strong>和<strong class="ji hu"> gcc </strong>与当前<em class="ke"> menuconfig </em>在<strong class="ji hu"> crosstool-ng </strong> 1.23.0下，我们只能有以下选项:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="a130" class="la lb ht mf b fv mj mk l ml mm">C-library<br/>-- glibc version (2.25)</span><span id="97c1" class="la lb ht mf b fv mn mk l ml mm">C compiler<br/>-- gcc version (6.3.0)</span></pre><p id="0898" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这意味着我们可以从官方<strong class="ji hu"> ct-ng </strong> config接口得到的<strong class="ji hu"> glibc </strong>和<strong class="ji hu"> gcc </strong>的最新版本是<strong class="ji hu">glibc</strong>T56】2.25和<strong class="ji hu">gcc</strong>T60】6 . 3 . 0。不算太老，但也不是最新的。其他工具也是如此，如<strong class="ji hu"> gdb </strong>等…</p><p id="be96" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">有了官方支持的<strong class="ji hu"> ct-ng </strong>配置工具，如果你做的一切都正确的话，你应该可以得到部分<em class="ke"> C++17 </em>支持的<strong class="ji hu"> gcc </strong> 6.3.0周围的工具链。</p><p id="35c5" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">要获得一个更“现代”的编译器版本，是时候打开配置文件，自己动手弄乱它了:)。在编辑并保存了<em class="ke"> menuconfig </em>之后，您应该能够在<em class="ke">/Volumes/xtool-build-env/</em>下找到一个. config文件。用您喜欢编辑器打开配置，确定这些选项:</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="e610" class="la lb ht mf b fv mj mk l ml mm">CT_CC_GCC_VERSION="6.3.0"<br/>CT_LIBC_VERSION="2.25"<br/>CT_GDB_VERSION="7.12.1"</span></pre><p id="58f3" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">这些是版本字符串，<strong class="ji hu"> ct-ng </strong>将使用它们从<em class="ke"> sourceforge </em>中提取源代码tarball。我们可以用最新的可用版本来替代它们。找到带补丁支持的工具链的正确版本的一个好地方是<a class="ae jf" href="https://github.com/crosstool-ng/crosstool-ng/tree/master/packages" rel="noopener ugc nofollow" target="_blank"> <strong class="ji hu"> crosstool-ng </strong>的补丁包</a>目录。例如打开这个<a class="ae jf" href="https://github.com/crosstool-ng/crosstool-ng/tree/master/packages/gcc" rel="noopener ugc nofollow" target="_blank"> <strong class="ji hu"> gcc </strong> patch </a>文件夹，你会看到<strong class="ji hu"> crosstool-ng </strong>已经正式带来了对8.1.0版本的补丁支持。在这种情况下，我们可以安全地将我们的<strong class="ji hu"> CT_CC_GCC_VERSION </strong>更改为“8.1.0 ”,因为这意味着<strong class="ji hu"> crosstool-ng </strong>正在积极支持<strong class="ji hu"> gcc </strong> 8.1.0。同样规则适用于所有其他工具链组件。</p><p id="38af" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">只要有补丁可用，您总是可以尝试不同的组合。即使没有补丁支持，我们也可以把它作为本地资源，应用我们自己的补丁，使它与ct-ng兼容！我对这个地区不熟悉。很高兴看到有人发布这样的文章来玩定制工具链。</p><p id="83be" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在修改了配置文件之后，我们可以用命令进行测试了</p><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="e42e" class="la lb ht mf b fv mj mk l ml mm">ct-ng build</span></pre><p id="60d1" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">启用调试步骤保存后，解析构建日志并修复问题，然后从故障点恢复就很简单了。</p></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><h2 id="dc05" class="la lb ht bd lc ld le lf lg lh li lj lk jr ll lm ln jv lo lp lq jz lr ls lt lu dt translated">第3部分:故障排除</h2><p id="4dc1" class="pw-post-body-paragraph jg jh ht ji b jj lv jl jm jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd hm dt translated">在这一节中，我将记录可能阻碍编译过程的错误，并提供解决方法。通过<em class="ke"> Google </em>可以找到很多<strong class="ji hu"> ct-ng </strong>相关的故障排除文章。这里我只重点讲一下编译<strong class="ji hu"> gcc </strong> 8.1.0提出的问题。</p><p id="7101" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我的本地环境参数:</p><ul class=""><li id="fbb2" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd kk kl km kn dt translated"><strong class="ji hu"> crosstool-ng </strong>路径:<em class="ke">/usr/local/Cellar/cross tool-ng/1 . 23 . 0 _ 1/</em></li><li id="a497" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">区分大小写<em class="ke"> APFS </em>卷根:<em class="ke">/Volumes/xtool-build-env/</em></li><li id="303d" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">配置文件路径:<em class="ke"> /Volumes/xtool-build-env/。配置</em></li><li id="47a1" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><strong class="ji hu"> crosstool-ng </strong>构建日志路径:<em class="ke">/Volumes/xtool-build-env/build . log</em></li><li id="e1cf" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">工具链源tarball路径:<em class="ke"> /Volumes/xtool-build-env/。build/tarballs/ </em></li><li id="5216" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">工具链源路径:<em class="ke"> /Volumes/xtool-build-env/。build/src/ </em></li><li id="7d97" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">工具链安装路径:<em class="ke">/Volumes/xtool-build-env/arm V8-RP i3-Linux-gnueabihf</em></li></ul><p id="2c63" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">问题和解决方案列表:</p><ol class=""><li id="5435" class="kf kg ht ji b jj jk jn jo jr kh jv ki jz kj kd ms kl km kn dt translated">运行<strong class="ji hu"> ct-ng </strong> build命令后出现权限被拒绝错误</li></ol><blockquote class="mt mu mv"><p id="f833" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">错误信息:</strong></p><p id="6ba8" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">/bin/bash:/usr/local/Cellar/cross tool-ng/1 . 23 . 0 _ 1/lib/cross tool-ng-1 . 23 . 0/scripts/cross tool-ng . sh:权限被拒绝</p><p id="bd8b" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">解决方案:</strong></p><p id="7cc6" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">授予crosstool-NG.sh脚本执行权限:</p></blockquote><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="41e6" class="la lb ht mf b fv mj mk l ml mm">chmod +x /usr/local/Cellar/crosstool-ng/1.23.0_1/lib/crosstool-ng-1.23.0/scripts/crosstool-NG.sh</span></pre><p id="8a83" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">2.<strong class="ji hu">编译<strong class="ji hu"> libtool </strong>期间，crosstool-ng </strong>构建失败</p><blockquote class="mt mu mv"><p id="979c" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">错误信息:</strong></p><p id="2c1f" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">[EXTRA]Building libtool<br/>[ERROR]make[3]:* * *[Makefile:2328:/Volumes/Unix/CT-ng/。build/src/libtool-2 . 4 . 6/doc/libtool . 1]错误127</p><p id="4dfe" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">构建日志错误消息:</strong></p><p id="aeba" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">[ALL ]警告:您的系统中缺少“help2man”。<br/> [ALL ]只有在修改了手册页的依赖项时才需要它。<br/>【全部】你可能要安装GNU Help2man包:<br/>【全部】&lt;<a class="ae jf" href="http://www.gnu.org/software/help2man/" rel="noopener ugc nofollow" target="_blank">http://www.gnu.org/software/help2man/</a>&gt;</p><p id="3f47" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">解决方案:</strong></p><p id="d03e" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">安装help2man with Homebrew:</p></blockquote><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="58d0" class="la lb ht mf b fv mj mk l ml mm">brew install help2man</span></pre><p id="e9be" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">3.<strong class="ji hu"> crosstool-ng </strong>构建在步骤<em class="ke">安装pass-1 core C gcc编译器时失败</em></p><blockquote class="mt mu mv"><p id="48f0" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">错误信息:</strong></p><p id="0c32" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">[信息]安装pass-1 core C gcc编译器<br/> [EXTRA]配置core C gcc编译器<br/> [EXTRA]构建gcc<br/>[错误] clang:错误:链接器命令失败，退出代码为1(使用-v查看调用)</p><p id="62bd" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">构建日志错误消息:</strong></p><p id="a727" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">[全部] ld:找不到框架../libiberty/pic/libiberty.a</p><p id="5473" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">解决方案:</strong></p><p id="a52e" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">确保在构建开始时下载所有补丁并应用于源代码。具体来说，补丁来自crosstool-ng的官方Github repo <a class="ae jf" href="https://github.com/crosstool-ng/crosstool-ng/tree/master/packages" rel="noopener ugc nofollow" target="_blank">包目录</a>。这些补丁应该放在与配置文件中的<strong class="ji hu"> CT_LOCAL_PATCH_DIR </strong>选项相匹配的本地文件夹中。</p><p id="ead7" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">请注意，如果构建在这一步失败，我们应该使用上面的解决方案，并通过以下方式从头开始构建:</p></blockquote><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="7531" class="la lb ht mf b fv mj mk l ml mm">ct-ng build</span></pre><p id="62ab" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">4.<strong class="ji hu"> crosstool-ng </strong>构建在步骤<em class="ke">为多库</em>构建时失败</p><blockquote class="mt mu mv"><p id="e27c" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">错误信息:</strong></p><p id="47ec" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">[错误]&gt; &gt;在步骤“为多库1/1构建”中构建失败</p><p id="09c1" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">构建日志错误消息:</strong></p><p id="6fef" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">[CFG ]正在检查bison的版本… 2.3，不好</p><p id="ca58" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">解决方案:</strong></p><p id="9553" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">用家酿安装bison并强制link使用brew版本:</p></blockquote><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="fe79" class="la lb ht mf b fv mj mk l ml mm">brew install bison<br/>brew link --force bison</span><span id="e162" class="la lb ht mf b fv mn mk l ml mm"># this linkage can be later reverted by running:<br/>#   brew unlink bison</span><span id="0443" class="la lb ht mf b fv mn mk l ml mm"># after the linking we should restart the console or run:<br/>#   source <em class="ke">~/.bash_profile</em><br/># to correctly apply the linkage. by running:<br/>#   which bison<br/># the console should return something other than <em class="ke">/usr/bin/bison</em></span></pre><p id="2305" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">5.<strong class="ji hu"> crosstool-ng </strong>构建在步骤<em class="ke">安装最终gcc编译器时失败</em></p><blockquote class="mt mu mv"><p id="4108" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">错误信息:</strong></p><p id="7d3e" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">[错误]&gt; &gt;在“安装最终gcc编译器”步骤中构建失败</p><p id="f1b7" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">构建日志错误消息:</strong></p><p id="c7a8" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">[错误] cc1:错误:开关-mcpu=cortex-a53与-march=armv7-a开关[-Werror]冲突</p><p id="79fe" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">解决方案:</strong></p><p id="8b25" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">这是一个通过从配置文件中禁用Werror的暴力解决方案。如果有人能想出一个好的解决方案来解决这个错误，请在下面评论，谢谢！</p><p id="a135" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">要禁用Werror，请编辑<em class="ht"> /Volumes/xtool-build-env/。build/src/gcc-8 . 1 . 0/libatomic/configure</em>文件。替代线</p></blockquote><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="fcd6" class="la lb ht mf b fv mj mk l ml mm">XCFLAGS="$XCFLAGS -Wall -Werror"</span></pre><blockquote class="mt mu mv"><p id="2db6" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">到</p></blockquote><pre class="ma mb mc md fq me mf mg mh aw mi dt"><span id="aff2" class="la lb ht mf b fv mj mk l ml mm">XCFLAGS="$XCFLAGS -Wall"</span></pre><p id="0452" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">6.其他错误</p><blockquote class="mt mu mv"><p id="49e5" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated"><strong class="ji hu">解决方案:</strong></p><p id="2002" class="jg jh ke ji b jj jk jl jm jn jo jp jq mw js jt ju mx jw jx jy my ka kb kc kd hm dt translated">直接搜索错误信息，或者忽略它，如果它不会破坏您的构建:)</p></blockquote></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><h2 id="da50" class="la lb ht bd lc ld le lf lg lh li lj lk jr ll lm ln jv lo lp lq jz lr ls lt lu dt translated"><strong class="ak">结局</strong></h2><p id="da6f" class="pw-post-body-paragraph jg jh ht ji b jj lv jl jm jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd hm dt translated">现在我们有了RPi3的交叉编译器，无限的可能性在我们手中，使这个小设备成为家庭自动化、物联网、嵌入式计算机视觉等的强大工具…</p><p id="bec9" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">至于我，我会很高兴地使用我自己构建的交叉编译器继续阅读我的书。如果在我的嵌入式Linux学习中发生了有趣的故事，我会随时通知你:)</p></div><div class="ab cl kt ku hb kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hm hn ho hp hq"><h2 id="dfe9" class="la lb ht bd lc ld le lf lg lh li lj lk jr ll lm ln jv lo lp lq jz lr ls lt lu dt translated">参考</h2><p id="4004" class="pw-post-body-paragraph jg jh ht ji b jj lv jl jm jn lw jp jq jr lx jt ju jv ly jx jy jz lz kb kc kd hm dt translated">[1] <a class="ae jf" href="https://www.jaredwolff.com/blog/cross-compiling-on-mac-osx-for-raspberry-pi/" rel="noopener ugc nofollow" target="_blank">贾里德·沃尔夫<a class="ae jf" href="https://www.jaredwolff.com/" rel="noopener ugc nofollow" target="_blank">在Mac OSX上为树莓Pi </a>进行交叉编译</a></p><p id="2e5f" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">[2]<a class="ae jf" href="https://github.com/crosstool-ng/crosstool-ng" rel="noopener ugc nofollow" target="_blank"><strong class="ji hu">cross tool-ng</strong>Github repo</a></p><p id="b70e" class="pw-post-body-paragraph jg jh ht ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">[3] <a class="ae jf" href="http://crosstool-ng.github.io/docs/" rel="noopener ugc nofollow" target="_blank"> <strong class="ji hu"> crosstool-ng </strong>官方文档</a></p><blockquote class="mz"><p id="9abf" class="na nb ht bd nc nd ne nf ng nh ni kd ek translated">加入Coinmonks <a class="ae jf" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jf" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jf" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h2 id="15d6" class="la lb ht bd lc ld nj lf lg lh nk lj lk jr nl lm ln jv nm lp lq jz nn ls lt lu dt translated">另外，阅读</h2><ul class=""><li id="20fb" class="kf kg ht ji b jj lv jn lw jr no jv np jz nq kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a> | <a class="ae jf" rel="noopener" href="/coinmonks/crypto-tax-software-ed4b4810e338">加密税务软件</a></li><li id="723e" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易</a> | <a class="ae jf" rel="noopener" href="/coinmonks/the-best-cryptocurrency-hardware-wallets-of-2020-e28b1c124069">加密硬件钱包</a></li><li id="874f" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" href="http://Top 4 Telegram Channels for Crypto Traders" rel="noopener ugc nofollow" target="_blank">密码电报信号</a> | <a class="ae jf" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a></li><li id="50d2" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/binance-trading-bots-d0d57bb62c4c">币安交易机器人</a> | <a class="ae jf" rel="noopener" href="/coinmonks/okex-review-6b369304110f"> OKEx审查</a> | <a class="ae jf" href="https://coincodecap.com/atani-review" rel="noopener ugc nofollow" target="_blank">阿塔尼审查</a></li><li id="3b1f" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/best-crypto-signals-telegram-5785cdbc4b2b">最佳加密交易信号电报</a> | <a class="ae jf" rel="noopener" href="/coinmonks/moonxbt-review-6e4ab26d037"> MoonXBT评论</a></li><li id="c44c" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" href="https://coincodecap.com/buy-shiba-bitbns" rel="noopener ugc nofollow" target="_blank">如何在Bitbns上购买柴犬(SHIB)币？</a> | <a class="ae jf" href="https://coincodecap.com/buy-floki-inu-token" rel="noopener ugc nofollow" target="_blank">购买Floki </a></li><li id="af80" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" href="https://coincodecap.com/coinflex-review" rel="noopener ugc nofollow" target="_blank"> CoinFLEX评论</a> | <a class="ae jf" href="https://coincodecap.com/aex-exchange-review" rel="noopener ugc nofollow" target="_blank"> AEX交易所评论</a> | <a class="ae jf" href="https://coincodecap.com/upbit-review" rel="noopener ugc nofollow" target="_blank"> UPbit评论</a></li><li id="29b5" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" href="https://coincodecap.com/best-cryptocurrency-blogs" rel="noopener ugc nofollow" target="_blank">十大最佳加密货币博客</a> | <a class="ae jf" href="https://coincodecap.com/youhodler-review" rel="noopener ugc nofollow" target="_blank"> YouHodler评论</a></li><li id="f33b" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769">最佳加密交易所</a> | <a class="ae jf" rel="noopener" href="/coinmonks/bitcoin-exchange-in-india-7f1fe79715c9">印度最佳加密交易所</a></li><li id="47a8" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">开发人员的最佳加密API</li><li id="b359" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated">最佳<a class="ae jf" rel="noopener" href="/coinmonks/top-5-crypto-lending-platforms-in-2020-that-you-need-to-know-a1b675cec3fa">密码借贷平台</a></li><li id="3c98" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/free-crypto-signals-48b25e61a8da">免费加密信号</a> | <a class="ae jf" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a></li><li id="9487" class="kf kg ht ji b jj ko jn kp jr kq jv kr jz ks kd kk kl km kn dt translated"><a class="ae jf" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币的终极指南</a></li></ul></div></div>    
</body>
</html>