<html>
<head>
<title>Making a URL shortener on Ethereum Blockchain â›“</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨â›“åŒºå—é“¾ä»¥å¤ªåŠåˆ¶ä½œä¸€ä¸ªç½‘å€ç¼©çŸ­å™¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/coinmonks/making-a-url-shortener-on-ethereum-blockchain-5947e52fd3a3?source=collection_archive---------4-----------------------#2018-12-02">https://medium.com/coinmonks/making-a-url-shortener-on-ethereum-blockchain-5947e52fd3a3?source=collection_archive---------4-----------------------#2018-12-02</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="ff56" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">æ°¸è¿œä¿å­˜åŒºå—é“¾çš„é“¾æ¥</h2></div><h2 id="51a4" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">è¯¥äº§å“</h2><figure class="kg kh ki kj fq kk"><div class="bz el l di"><div class="kl km l"/></div></figure><h1 id="7d30" class="kn jj ht bd jk ko kp kq jo kr ks kt js iz ku ja jw jc kv jd ka jf kw jg ke kx dt translated">å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„</h1><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div class="fe ff ky"><img src="../Images/d0755379a713a54f9a10750aefffc28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/1*e6uPKHACWbRzuaci0bxpXQ.gif"/></div></figure><p id="7883" class="pw-post-body-paragraph lb lc ht ld b le lf iu lg lh li ix lj jt lk ll lm jx ln lo lp kb lq lr ls lt hm dt translated">éƒ¨ç½²åœ¨<a class="ae lu" href="https://0x.now.sh" rel="noopener ugc nofollow" target="_blank"> 0x.now.sh </a>çš„web appä¸éƒ¨ç½²åœ¨<a class="ae lu" href="https://ropsten.etherscan.io/address/0x4b8241f24537d2539d0b310bc074fd68a782e182" rel="noopener ugc nofollow" target="_blank">ä»¥å¤ªåŠRopsten testnet </a>ä¸Šçš„æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚åœ¨testnetä¸Šæ„å‘³ç€ä½ å¯ä»¥ç”¨è‡ªç”±é†šä¸å®ƒäº’åŠ¨ã€‚ç‚¹å‡»è·å–æ‚¨çš„<a class="ae lu" href="https://faucet.metamask.io" rel="noopener ugc nofollow" target="_blank">å…è´¹ä¹™é†šã€‚</a></p><h2 id="f892" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">è¯¥è¿‡ç¨‹</h2><ul class=""><li id="a828" class="lv lw ht ld b le lx lh ly jt lz jx ma kb mb lt mc md me mf dt translated">ç”¨æˆ·è¿›è¡Œäº¤æ˜“ï¼Œè¯·æ±‚åŒºå—é“¾å­˜å‚¨URLå­—ç¬¦ä¸²ã€‚</li><li id="2b59" class="lv lw ht ld b le mg lh mh jt mi jx mj kb mk lt mc md me mf dt translated">ç”±äºè¿™æ˜¯ä¸€é¡¹æ”¹å˜åŒºå—é“¾ç°çŠ¶çš„äº¤æ˜“ï¼Œå› æ­¤éœ€è¦é™„å¸¦ä¸€å®šæ•°é‡çš„ä¹™é†šï¼Œä»¥ä¾¿çŸ¿å·¥å°†å…¶å¼€é‡‡åˆ°åŒºå—é“¾ã€‚</li><li id="445d" class="lv lw ht ld b le mg lh mh jt mi jx mj kb mk lt mc md me mf dt translated">è´¹ç”¨(ä¹Ÿç§°ä¸º<a class="ae lu" href="https://www.cryptocompare.com/coins/guides/what-is-the-gas-in-ethereum/" rel="noopener ugc nofollow" target="_blank">æ°”ä½“</a>)çš„æ•°é‡ç”±Metamask chromeæ‰©å±•å†³å®šï¼Œå¹¶æ˜¾ç¤ºåœ¨æç¤ºæ¡†ä¸­ã€‚</li><li id="cc2c" class="lv lw ht ld b le mg lh mh jt mi jx mj kb mk lt mc md me mf dt translated">äº¤æ˜“ç¡®è®¤éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´(5-10ç§’),å…·ä½“å–å†³äºåŒºå—é“¾çš„ç¹å¿™ç¨‹åº¦ã€‚</li><li id="50be" class="lv lw ht ld b le mg lh mh jt mi jx mj kb mk lt mc md me mf dt translated">ç”Ÿæˆäº†ç¼©çŸ­çš„URLã€‚https://0x.now.sh/s?id=23</li><li id="b345" class="lv lw ht ld b le mg lh mh jt mi jx mj kb mk lt mc md me mf dt translated">å½“ç”¨æˆ·ç‚¹å‡»ç¼©çŸ­çš„URLæ—¶ï¼Œè¿›è¡Œå¦ä¸€ä¸ªäº‹åŠ¡ï¼Œè¯·æ±‚åŒºå—é“¾å“ªä¸ªURLå­—ç¬¦ä¸²ä½äºæ‰€æä¾›çš„å¼•ç”¨å¤„(åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯23)</li><li id="b254" class="lv lw ht ld b le mg lh mh jt mi jx mj kb mk lt mc md me mf dt translated">å› ä¸ºè¿™ä¸ªäº¤æ˜“æ²¡æœ‰æ”¹å˜åŒºå—é“¾çš„çŠ¶æ€ï¼Œæ‰€ä»¥è¿™æ¬¡æˆ‘ä»¬ä¸éœ€è¦æ”¯ä»˜ä»»ä½•ETHï¼Œç”¨æˆ·è¢«æ— ç¼åœ°é‡å®šå‘åˆ°é•¿URLã€‚</li></ul><h2 id="0ddb" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">dApp</h2><p id="bdfd" class="pw-post-body-paragraph lb lc ht ld b le lx iu lg lh ly ix lj jt ml ll lm jx mm lo lp kb mn lr ls lt hm dt translated">ä½œä¸ºä¸€ä¸ªåˆ†æ•£çš„åº”ç”¨ç¨‹åºæ„å‘³ç€è¿™ä¸ªwebåº”ç”¨ç¨‹åºä¸éœ€è¦ä»»ä½•é›†ä¸­çš„æ•°æ®åº“æ¥è¿è¡Œã€‚å®ƒä»…ä¸éƒ¨ç½²åœ¨åŒºå—é“¾ä¸Šçš„æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚</p><h2 id="14c8" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">æ™ºèƒ½åˆåŒğŸ“ƒ</h2><pre class="kg kh ki kj fq mo mp mq mr aw ms dt"><span id="57c1" class="ji jj ht mp b fv mt mu l mv mw">pragma solidity ^0.4.24;</span><span id="23d7" class="ji jj ht mp b fv mx mu l mv mw">contract e0x {<br/> event Log(string message);<br/> event LinkAdded(uint linkId, string url);<br/> <br/> struct LinkTemplate {<br/>  address userAddress;<br/>  string url;<br/> }<br/> <br/> uint lastLinkId;<br/> mapping (uint =&gt; LinkTemplate) public linkMapping;<br/> <br/> constructor() public {<br/>  lastLinkId = 0;<br/> }<br/> <br/> <br/> function createNewLink(string url) public returns (uint) {<br/>     lastLinkId++;<br/>  linkMapping[lastLinkId] = LinkTemplate(msg.sender, url);<br/>  emit LinkAdded(lastLinkId, url);<br/>  return lastLinkId;<br/> }<br/> <br/> modifier linkExists(uint linkId) {<br/>     //link with the given hash does not exist<br/>  if(linkMapping[linkId].userAddress == 0x0000000000000000000000000000000000000000) {<br/>   revert();<br/>  }<br/>  _;<br/> }<br/> <br/> function getLink(uint linkId) linkExists(linkId) public constant<br/>  returns(<br/>   address,<br/>   string<br/>  ) {<br/>      LinkTemplate memory link = linkMapping[linkId];<br/>   return(<br/>    link.userAddress,<br/>       link.url<br/>   );<br/>  }</span><span id="923a" class="ji jj ht mp b fv mx mu l mv mw">}</span></pre></div><div class="ab cl my mz hb na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="hm hn ho hp hq"><h1 id="0837" class="kn jj ht bd jk ko nf kq jo kr ng kt js iz nh ja jw jc ni jd ka jf nj jg ke kx dt translated">æŠ€æœ¯æŒ‘æˆ˜</h1><h2 id="84c6" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">ä¸æ™ºèƒ½åˆåŒäº¤äº’</h2><p id="27c0" class="pw-post-body-paragraph lb lc ht ld b le lx iu lg lh ly ix lj jt ml ll lm jx mm lo lp kb mn lr ls lt hm dt translated">EthersJSåº“ç”¨äºä¸åŒºå—é“¾å¯¹è¯</p><pre class="kg kh ki kj fq mo mp mq mr aw ms dt"><span id="e5e5" class="ji jj ht mp b fv mt mu l mv mw">// provider picks up the Metamask injected web3 object from browser <br/>let provider = new ethers.providers.Web3Provider(web3.currentProvider);<br/>let address = "ADDRESS_OF_DEPLOYED_SMART_CONTRACT";<br/>let abi = [...] //defines JSON interface for the smart contract</span></pre><h2 id="d796" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">åœ¨åŒºå—é“¾ä¸Šå­˜å‚¨æ•°æ®</h2><pre class="kg kh ki kj fq mo mp mq mr aw ms dt"><span id="59c6" class="ji jj ht mp b fv mt mu l mv mw">// calling the createNewLink function defined in the smart contract<br/>tx = await contract.createNewLink(url);<br/>console.log(tx.hash);</span></pre><h2 id="53c1" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">æ”¶å¬åŒºå—é“¾äº‹ä»¶</h2><pre class="kg kh ki kj fq mo mp mq mr aw ms dt"><span id="a0a6" class="ji jj ht mp b fv mt mu l mv mw">contract.on("LinkAdded", (linkId, linkUrl) =&gt; {<br/>        <br/>        var shortUrl = '{0}/s?id={1}'.f(window.location.origin, linkId.toNumber())<br/>        $("#info").prepend( "Short URL: &lt;a href='{0}'&gt;{0}&lt;/a&gt;&lt;br&gt;".f(shortUrl) );<br/>        <br/>    });</span></pre><h2 id="93de" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">æ­£åœ¨ç”Ÿæˆæœ€è¿‘ç¼©çŸ­çš„URLåˆ—è¡¨</h2><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="fe ff nk"><img src="../Images/968c35c71a9238e315386d48fd02a198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uNfUXj3_USvLnvUAQjbrhQ.png"/></div></div></figure><p id="4c9e" class="pw-post-body-paragraph lb lc ht ld b le lf iu lg lh li ix lj jt lk ll lm jx ln lo lp kb lq lr ls lt hm dt translated">EthersJSä¸æ”¯æŒäº‹ä»¶æ‰¹é‡ç›‘å¬ï¼Œæ‰€ä»¥æˆ‘å¿…é¡»ä½¿ç”¨web3jsçš„allEvents()å‡½æ•°è°ƒç”¨</p><pre class="kg kh ki kj fq mo mp mq mr aw ms dt"><span id="34a1" class="ji jj ht mp b fv mt mu l mv mw">MyContract = web3.eth.contract(abi);<br/>    myContractInstance = MyContract.at(address);<br/>    events = myContractInstance.allEvents({event: 'LinkAdded', fromBlock: 0, toBlock: 'latest'});<br/>    events.watch(function(error, result){<br/>      console.log(result.args.url, result.args.linkId.toNumber());<br/>      ...<br/>});</span></pre><h2 id="58a2" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">ä½¿å¾—ç¼©çŸ­çš„URLåœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­éƒ½æ˜¯å¯è®¿é—®çš„</h2><figure class="kg kh ki kj fq kk fe ff paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="fe ff np"><img src="../Images/e2a149f2ee564b8e8ece02147db383a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4E9XthrjTPB5oB_3360eUA.png"/></div></div></figure><p id="2d8b" class="pw-post-body-paragraph lb lc ht ld b le lf iu lg lh li ix lj jt lk ll lm jx ln lo lp kb lq lr ls lt hm dt translated">è¿™ç›¸å½“æ£˜æ‰‹ï¼Œå› ä¸ºä¸åŒºå—é“¾äº¤äº’éœ€è¦æµè§ˆå™¨æ”¯æŒweb3ï¼Œå¹¶å®‰è£…ä¸€äº›é’±åŒ…(å…ƒæ©ç æˆ–ç±»ä¼¼çš„)ã€‚ç›®å‰ï¼Œweb3å’Œé’±åŒ…æ”¯æŒä»…é€‚ç”¨äºæ¡Œé¢ç‰ˆçš„Chromeå’ŒFirefoxã€‚</p><p id="0782" class="pw-post-body-paragraph lb lc ht ld b le lf iu lg lh li ix lj jt lk ll lm jx ln lo lp kb lq lr ls lt hm dt translated">ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¸å¾—ä¸åˆ›å»ºä¸€ä¸ªé’±åŒ…ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><pre class="kg kh ki kj fq mo mp mq mr aw ms dt"><span id="193b" class="ji jj ht mp b fv mt mu l mv mw">provider = ethers.getDefaultProvider('ropsten');<br/>wallet = ethers.Wallet.createRandom();<br/>wallet = wallet.connect(provider);</span></pre><p id="5a72" class="pw-post-body-paragraph lb lc ht ld b le lf iu lg lh li ix lj jt lk ll lm jx ln lo lp kb lq lr ls lt hm dt translated">å‘ä»¤äººæ•¬ç•çš„<a class="ae lu" href="https://github.com/ethers-io/ethers.js/" rel="noopener ugc nofollow" target="_blank"> ethersJSåº“</a>å¤§å£°ç–¾å‘¼ï¼Œæ„Ÿè°¢å®ƒå¯¹æ­¤çš„æ”¯æŒã€‚</p><h2 id="2234" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dt translated">ç»Ÿè®¡URLè®¿é—®é‡</h2><p id="9903" class="pw-post-body-paragraph lb lc ht ld b le lx iu lg lh ly ix lj jt ml ll lm jx mm lo lp kb mn lr ls lt hm dt translated">ä½¿ç”¨è¿™ç§æµè§ˆå™¨çš„çµæ´»æ€§æ˜¯æœ‰ä»£ä»·çš„ã€‚æ¯æ¬¡ç”¨æˆ·ç‚¹å‡»ç¼©çŸ­çš„ç½‘å€æ²¡æœ‰æ”¹å˜åŒºå—é“¾çš„çŠ¶æ€ï¼Œå› æ­¤ä¸å¯èƒ½ç¡®å®šæ¯ä¸ªé“¾æ¥è¢«ç‚¹å‡»äº†å¤šå°‘æ¬¡ã€‚è¿™ä¸ªé—®é¢˜ä»ç„¶æ²¡æœ‰è§£å†³ã€‚</p><p id="8ba8" class="pw-post-body-paragraph lb lc ht ld b le lf iu lg lh li ix lj jt lk ll lm jx ln lo lp kb lq lr ls lt hm dt translated">è¯¥é¡¹ç›®çš„å®Œæ•´æºä»£ç åœ¨<a class="ae lu" href="https://github.com/sauravtom/ethereum-url-shortener" rel="noopener ugc nofollow" target="_blank"> Github </a>ä¸Šã€‚</p><p id="8d91" class="pw-post-body-paragraph lb lc ht ld b le lf iu lg lh li ix lj jt lk ll lm jx ln lo lp kb lq lr ls lt hm dt translated">æ¬¢è¿æå–è¯·æ±‚ğŸ˜</p><figure class="kg kh ki kj fq kk fe ff paragraph-image"><a href="http://bit.ly/2G71Sp7"><div class="fe ff nq"><img src="../Images/449450761cd76f44f9ae574333f9e9af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKX2mtg7p1lOs7JmosPLsA.png"/></div></a><figcaption class="nr ns fg fe ff nt nu bd b be z ek"><a class="ae lu" href="http://bit.ly/2G71Sp7" rel="noopener ugc nofollow" target="_blank"><strong class="bd nv">Click to read todayâ€™s top story</strong></a></figcaption></figure></div></div>    
</body>
</html>